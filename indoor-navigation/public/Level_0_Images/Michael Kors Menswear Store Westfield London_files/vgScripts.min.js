var mapviewer,visioLoop=setInterval(InitiateMapLoading,0);function InitiateMapLoading(){null!=loadMap&&(clearInterval(visioLoop),void 0!==assetServerUrl)&&getScript(assetServerUrl+"/dist/newunibailreactapp/js/vg.mapviewer.web.min.js?version="+jssCssVersion,function(e,t,i){null!=visioGlobeStoreList&&null!=visioGlobeStoreId&&null!=logoUrl&&null!=document.getElementById("mapofthemall")&&loadMap(visioGlobeStoreId,visioGlobeStoreList,logoUrl)})}function getScript(e,i){var n=document.createElement("script"),t=document.getElementsByTagName("script")[0];n.async=1,n.onload=n.onreadystatechange=function(e,t){!t&&n.readyState&&!/loaded|complete/.test(n.readyState)||(n.onload=n.onreadystatechange=null,n=void 0,t)||!i||setTimeout(i,0)},n.src=e,t.parentNode.insertBefore(n,t)}function loadMap(e,t,i){mapviewer=new vg.mapviewer.web.Mapviewer,-1==navigator.platform.indexOf("iPhone")&&-1==navigator.platform.indexOf("iPad")&&-1==navigator.platform.indexOf("iPod")||document.getElementById("mapContainer")&&(document.getElementById("mapContainer").addEventListener("gesturestart",function(e){e.preventDefault()},!1),document.getElementById("mapContainer").addEventListener("gesturechange",function(e){e.preventDefault()},!1),document.getElementById("mapContainer").addEventListener("gestureend",function(e){e.preventDefault()},!1),document.getElementById("mapContainer").addEventListener("touchmove",function(e){e.preventDefault()},!1)),null!=window.logoUrl&&(visioGlobeStoreId=e.toString().split(";"),storeDataList=t,bubbleLogoUrl=i),isWebGLSupported()&&document?.addEventListener("mapviewerready",function(){}),null!=window.viewParams&&null!=(e=document.getElementById(mapViewerId))&&mapviewer.initialize(e,{path:mapURL,initialFloorName:viewParams.floorName,cameraType:viewParams.cameraType,onObjectMouseOver:onObjectMouseOver,onObjectMouseOut:onObjectMouseOut,onObjectMouseUp:onObjectMouseUp,enableObjectMouseOver:!0,enableObjectMouseOut:!0}).done(onLoadCompleted)}var storeDataList,bubbleLogoUrl,site={id:"",prefix:"www.les4temps.com",mapUrl:"https://mapmanager-unibail.visioglobe.com/public/d8f7daec05cfa389/content/map.svg"},mapViewerId="mapContainer",mapViewerCommandBarClassName="mapViewerCommandBar",poiPlaces=[],hostType="http",host="unibail",query={},useMouseover=!1,initialPoi="",initialFloor="",initialAnimation=0,cameraType="perspective",showSidebar=!1,activePlaceColor="#00FF00",pathColor="#19E0FF",mouseOverColor="#a0a0a0",viewType="",appParams={},accessibleRoute=!1,useNavigation=!0,instructionsOverlayVisible=!0,changeFloorAnimationDuration=500;function onObjectMouseUp(e,t){var i,n;t instanceof Array||t.vg&&t.vg.poi?(shopCenterSelectorDataPush(i=t.options("id")),URWindowLocation(n=getStoreUrl(i))):(null!=e.target&&null!=e.target&&null!=e.target.closest(".gtmCommonEvents")&&null!=e.target.closest(".gtmCommonEvents")&&0<e.target.closest(".gtmCommonEvents").length&&e.target.closest(".gtmCommonEvents").click(),n=getStoreUrl(i=t.vg.id),shopCenterSelectorDataPush(i),URWindowLocation(n))}function getStoreUrl(o){var a="#mall-map";return null!=o&&null!=storeDataList&&storeDataList.forEach(function(e,t){var i=e.storeId.split(";"),n=e;i.forEach(function(e,t){if(e==o)return a=n.pageURL})}),a}function onLoadCompleted(){query.remote&&(window?.addEventListener("message",onRemoteMessage,!1),window.parent.postMessage("mapviewerready","*")),logVisioWebTitle(),window?.addEventListener("resize",function(e){mapviewer.resize(document.getElementById(mapViewerId).offsetWidth,document.getElementById(mapViewerId).offsetHeight),null!==viewParams.maxRadius&&void 0!==viewParams.maxRadius&&0<viewParams.maxRadius&&(mapviewer.camera.maxRadius=viewParams.maxRadius)},!0),mapviewer.start(),mapviewer.resize(document.getElementById(mapViewerId).offsetWidth,document.getElementById(mapViewerId).offsetHeight),initializeButtons(),"boolean"==typeof enableStats&&enableStats&&(mapviewer.setLogStatistic(!0),"undefined"!=typeof statURL&&mapviewer.setLogStatisticURL(statURL),mapviewer.camera.track=!0);var e=mapviewer.getExtraData(),e=(void 0!==(appParams=e&&void 0!==e.app_params?e.app_params:appParams).navigationParams&&(useNavigation=appParams.navigationParams.navigationViewAvailable),loadLabels(),void 0!==query.viewtype&&(viewType=query.viewtype),"translation");void 0!==query.animationtype&&(e=query.animationtype),"orthographic"===cameraType&&(viewType="multifloor"),setupDefaultUI(),initializeCamera();return void 0!==viewType&&-1!==["singlefloor","multifloor","multibuilding"].indexOf(viewType)?(mapviewer.setupMultiBuildingView({containerDivSelector:mapViewerId,viewType:viewType,animationType:e}),mapviewer.multiBuildingView.buildingModeEnabled="multifloor"===viewType,"orthographic"!==cameraType&&void 0!==appParams.exploreParams&&(mapviewer.camera.pitch=-90,mapviewer.multiBuildingView.floorModePitch=appParams.exploreParams.pitch),mapviewer.cameraDrivenExplorer.setEnabled(!0),mapviewer.cameraDrivenExplorer.maxExploreDistance=10,void 0!==appParams.cameraDrivenExplorer&&(mapviewer.cameraDrivenExplorer.setEnabled(appParams.cameraDrivenExplorer.enabled),mapviewer.cameraDrivenExplorer.maxExploreDistance=appParams.cameraDrivenExplorer.distanceThreshold),setupMultiBuildingUI(),mapviewer.multiBuildingView.goTo({mode:"global",buildingID:mapviewer.multiBuildingView.DEFAULT}).then(setupInitialPosition)):setupInitialPosition()}function initializeButtons(){document.getElementById("zoomOut")?.addEventListener("click",e=>{var t=mapviewer.camera.position;t.radius*=2,mapviewer.camera.goTo(t)}),document.getElementById("zoomIn")?.addEventListener("click",e=>{var t=mapviewer.camera.position;t.radius/=2,mapviewer.camera.goTo(t)})}function loadLabels(){let n=[];visioGlobeStoreList.forEach(function(e,t){var i=e.strSIName;e.storeId.split(";").forEach(function(e,t){mapviewer.setPlaceName(e,{text:i}),n.push(e)})}),Object.keys(mapviewer.getPlaces()).filter(e=>!n.includes(e)).forEach(e=>{mapviewer.setPlaceName(e,"")}),doRoutingFromURLParameters()}function setupInitialPosition(){var e;return""!==initialPoi?mapviewer.multiBuildingView?mapviewer.multiBuildingView.goTo({mode:"floor",place:initialPoi,animationDuration:initialAnimation}).catch(function(e){return mapviewer.multiBuildingView.goTo({mode:"global",buildingID:mapviewer.multiBuildingView.DEFAULT,floorID:mapviewer.multiBuildingView.DEFAULT,animationDuration:initialAnimation})}):(e=mapviewer.getPlace(initialPoi).vg.floor,mapviewer.changeFloor(e).then(function(){return mapviewer.camera.goTo(initialPoi,{animationDuration:1e3*initialAnimation})}).catch(function(e){return mapviewer.changeFloor(mapviewer.getFloors()[0].name,{animationDuration:1e3*initialAnimation})})):""!==initialFloor?mapviewer.multiBuildingView?mapviewer.multiBuildingView.goTo({mode:"floor",floorID:initialFloor,animationDuration:initialAnimation}).catch(function(e){return mapviewer.multiBuildingView.goTo({mode:"global",buildingID:mapviewer.multiBuildingView.DEFAULT,floorID:mapviewer.multiBuildingView.DEFAULT,animationDuration:initialAnimation})}):mapviewer.changeFloor(initialFloor,{animationDuration:1e3*initialAnimation}).catch(function(e){return mapviewer.changeFloor(mapviewer.getFloors()[0].name,{animationDuration:1e3*initialAnimation})}):void 0}function gotoFloorAndPosition(e,t,i){var n;return mapviewer.multiBuildingView?mapviewer.multiBuildingView.goTo({mode:"floor",floorID:e,viewpoint:{position:t}}):(n=function(){return mapviewer.camera.goTo(t,{animationDuration:500}).then(i)},mapviewer.getCurrentFloor()==e?n():mapviewer.changeFloor(e,{animationDuration:changeFloorAnimationDuration}).then(n))}function setupBubbleUI(){document.getElementById("place_bubble_set_origin")?.addEventListener("click",e=>{var t,e=e.currentTarget.getAttribute("vg_id"),i=(routeStartID=e,routeWaypointIDs=[],document.getElementById("vg_route_from"));return 1==i.length&&-1!=(t=i.option["value="+e].index)&&((i=i[0]).selectedIndex=t,document.getElementById("vg_route_from-input").value=i[t].value),closePlaceBubble(),null!=(routeStartEnd=null==routeStartEnd?new MyRoute(mapviewer):routeStartEnd)&&(i=mapviewer.getPlace(e))&&(t={x:i.vg.position.x,y:i.vg.position.y,z:3},routeStartEnd.remove(),routeStartEnd.addStartPOI(i.vg.floor,t)),doRouting(routeStartID,routeWaypointIDs.concat(routeEndID)),!1}),document.getElementById("place_bubble_set_destination")?.addEventListener("click",e=>{var t,e=e.currentTarget.getAttribute("vg_id"),i=(routeEndID=e,document.getElementById("vg_route_to"));return 1==i.length&&-1!=(t=i.option[value=""+e].index)&&((i=i[0]).selectedIndex=t,document.getElementById("vg_route_to-input").value=i[t].value),closePlaceBubble(),null!=(routeStartEnd=null==routeStartEnd?new MyRoute(mapviewer):routeStartEnd)&&(i=mapviewer.getPlace(e))&&(t={x:i.vg.position.x,y:i.vg.position.y,z:3},routeStartEnd.remove(),routeStartEnd.addEndPOI(i.vg.floor,t)),doRouting(routeStartID,routeWaypointIDs.concat(routeEndID)),!1}),document.getElementById("place_bubble_set_waypoint")?.addEventListener("click",e=>{return URWindowLocation(e.currentTarget.getAttribute("data-location")),!1}),document.getElementById("place_bubble_close_button")?.addEventListener("click",e=>(closePlaceBubble(),!1)),document.getElementById("place_bubble_info_button")?.addEventListener("click",e=>{var t=document.getElementById("place_bubble_description");return"none"!==window.getComputedStyle(t).style.display?(document.getElementById("place_bubble_description").style.display="none",document.getElementById("place_bubble_set_origin").style.display="block",document.getElementById("place_bubble_set_destination").style.display="block",document.getElementById("place_bubble_set_waypoint").style.display="block"):(document.getElementById("place_bubble_description").style.display="block",document.getElementById("place_bubble_set_origin").style.display="none",document.getElementById("place_bubble_set_destination").style.display="none",document.getElementById("place_bubble_set_waypoint").style.display="none"),!1})}function setupRouteUI(){mapviewer.on("routeComputed",function(e){document.getElementById("route_clear").style.display="block"}),document.getElementById("route_clear")?.addEventListener("click",e=>{clearRouting()}),document.getElementById("vg_toggles")?.addEventListener("click",t=>{if(e.target.closest("#vg_toggles #toggle_handicap"))return accessibleRoute=!accessibleRoute,null!=document.getElementById("toggle_handicap")&&(document.getElementById("toggle_handicap").checked=accessibleRoute),null!=currentRoute&&doRouting(),!0})}function setupNavigationUI(){document.getElementById("instructions_prev_button")?.addEventListener("click",e=>("object"==typeof currentNavigation&&null!==currentNavigation&&(currentNavigation.displayPrevInstruction(),updateNavigationUI()),!1)),document.getElementById("instructions_next_button")?.addEventListener("click",e=>("object"==typeof currentNavigation&&null!==currentNavigation&&(currentNavigation.displayNextInstruction(),updateNavigationUI()),!1)),null!=document.getElementById("toggle_instructions")&&(document.getElementById("toggle_instructions").checked=instructionsOverlayVisible),document.getElementById("vg_toggles")?.addEventListener("click",t=>{if(e.target.closest("#vg_toggles #toggle_instructions"))return instructionsOverlayVisible=!instructionsOverlayVisible,null!=document.getElementById("toggle_instructions")&&(document.getElementById("toggle_instructions").checked=instructionsOverlayVisible),toggleNavigationUI(),!0})}function hideNavigationUI(e){parseInt(document.getElementById("instructions").offsetHeight,10)}function toggleNavigationUI(){instructionsOverlayVisible&&"object"==typeof currentNavigation&&null!==currentNavigation?document.getElementsById("instructions").style.visibility="visible":hideNavigationUI(function(){document.getElementsById("instructions").style.visibility="hidden"})}function resetNavigationUI(){document.getElementById("instructions_detail").innerHtml="",document.getElementById("instructions_brief").innerHtml="",document.getElementById("instructions_count").innerHtml="",document.getElementById("instructions_time").innerHtml="",document.getElementById("instructions_icon").setAttribute("src","")}function updateNavigationUI(){var e,t=currentNavigation.getNbInstructions(),i=currentNavigation.getCurrentInstructionIndex(),n=currentNavigation.getInstructionData(i);void 0!==n&&(document.getElementById("instructions_detail").innerHtml=n.detail,document.getElementById("instructions_brief").innerHtml=n.brief,document.getElementById("instructions_count").innerHtml=i+1+"/"+t,e=void 0!==n.durationString?n.durationString:n.duration,document.getElementById("instructions_time").innerHtml(e),document.getElementById("instructions_icon").setAttribute("src",(vg.imagePath||"../media")+"/"+n.icon)),document.getElementById("instructions_prev_button").style.display="block",document.getElementById("instructions_next_button").style.display="block",0==i&&(document.getElementById("#instructions_prev_button").style.display="none"),i==t-1&&(document.getElementById("#instructions_next_button").style.display="none")}function setupSidebarUI(){""!==mapviewer.getRoutingURL()?document.getElementById("vg_sidebar_routing").style.display="block":document.getElementById("vg_sidebar_routing").style.display="none"}function setupDefaultUI(){showSidebar&&setupSidebarUI();var e,t=mapviewer.getFloors();for(e in t)createFloorButton(t[e].name);document.getElementById("vg_footer")?.addEventListener("click",e=>{if(e.target.closest("#vg_footer .change_floor"))return e=e.target.getAttribute("data-floor"),mapviewer.changeFloor(e,{animationDuration:changeFloorAnimationDuration}),document.getElementById("change_floor").querySelectorAll(".vg_button").forEach(e=>{e.classList.remove("floor-button-current")}),!1}),updateActiveFloorButton(mapviewer.getCurrentFloor()),mapviewer.on("floorChanged",function(e){updateActiveFloorButton(e.args.target)}),""!==mapviewer.getRoutingURL()&&(setupBubbleUI(),setupRouteUI(),useNavigation)&&setupNavigationUI()}function setupMultiBuildingUI(){showSidebar&&setupSidebarUI(),""!==mapviewer.getRoutingURL()&&(setupBubbleUI(),setupRouteUI(),useNavigation)&&setupNavigationUI();var o=document.getElementById("global_mode_button"),a=document.getElementById("building_mode_button"),r=document.getElementById("floor_mode_button"),l=document.getElementById("change_building_select"),u=document.getElementById("change_floor_select"),d=mapviewer.multiBuildingView.getVenueLayout(),e=(o?.addEventListener("click",e=>{var t=mapviewer.multiBuildingView.getCurrentExploreState();mapviewer.multiBuildingView.goTo({mode:"global",buildingID:t.buildingID||mapviewer.multiBuildingView.DEFAULT})}),a?.addEventListener("click",e=>{mapviewer.multiBuildingView.goTo({mode:"building",buildingID:""===l.value?mapviewer.multiBuildingView.DEFAULT:l.value,floorID:""===u.value?mapviewer.multiBuildingView.DEFAULT:u.value})}),l?.addEventListener("change",e=>{var t,i;""!==this.value&&(t=mapviewer.multiBuildingView.DEFAULT,"global"!==(i=mapviewer.multiBuildingView.getCurrentExploreState()).mode&&void 0!==(i=d.buildingByID[i.buildingID].floorByID[i.floorID]).connectedFloors[this.value]&&(t=i.connectedFloors[this.value].floor),mapviewer.multiBuildingView.goTo({mode:"building",buildingID:this.value,floorID:t}))}),r?.addEventListener("click",e=>{var t=mapviewer.multiBuildingView.getCurrentExploreState();mapviewer.multiBuildingView.goTo({mode:"floor",buildingID:t.buildingID,floorID:t.floorID})}),u?.addEventListener("change",e=>{var t;""!==this.value&&(t=mapviewer.multiBuildingView.getCurrentExploreState(),mapviewer.cameraDrivenExplorer.isEnabled?mapviewer.multiBuildingView.goTo({mode:"global"==t.mode?"floor":t.mode,buildingID:t.buildingID,floorID:this.value,noViewpoint:"floor"==t.mode}):mapviewer.multiBuildingView.goTo({mode:"global"==t.mode?"building":t.mode,buildingID:t.buildingID,floorID:this.value,noViewpoint:!0}))}),!1),t=!1,i=!1;for(n in d.buildings)if(1<d.buildings[n].floors.length){e=!0;break}1<d.buildings.length?t=!0:1==d.buildings.length&&(i=!0),d.hasGlobalLayer?o.style.display="block":o.style.display="none",e&&!0===mapviewer.multiBuildingView.buildingModeEnabled?a.style.display="block":a.style.display="none",l.style.display=t||e?"block":"none",i||t?(r.style.display="block",u.style.display="block"):(r.style.display="none",u.style.display="none");var n,s,c=[];for(n in d.buildingByID)c.push(d.buildingByID[n]);c.sort(function(e,t){return(e.displayIndex||0)-(t.displayIndex||0)}),l.innerHTML="";var m=document.createElement("option");for(n in m.text="Select building",m.value="",l.add(m),c)(m=document.createElement("option")).text=mapviewer.multiBuildingView.getLocalizedName(c[n].id),m.value=c[n].id,l.add(m);mapviewer.on("MultiBuildingView.exploreStateWillChange",e=>{e=e.args.target;switch(e.mode){case"global":o.classList.add("selected"),a.classList.remove("selected"),r.classList.remove("selected");break;case"building":o.classList.remove("selected"),a.classList.add("selected"),r.classList.remove("selected");break;case"floor":o.classList.remove("selected"),a.classList.remove("selected"),r.classList.add("selected")}if(u.innerHTML="",void 0!==e.buildingID){l.value=e.buildingID,u.innerHTML="";var t=d.buildingByID[e.buildingID];if(t){for(s=t.floors.length-1;0<=s;s--){var i=t.floors[s].id,n=document.createElement("option");n.text=mapviewer.multiBuildingView.getLocalizedName(i),n.value=i,u.add(n)}void 0!==e.floorID?u.value=e.floorID:u.value=""}}else l.value=""})}var floorButtonIDs={};function createFloorButton(e){var t="floor_link"+e,i='<button class="vg_button change_floor" type="button" data-floor="'+e+'" id="'+t+'">'+e+"</button> ";document.getElementById("change_floor").innerHTML+=i,floorButtonIDs["floor"+e]=t}function updateActiveFloorButton(e){for(var t in floorButtonIDs)document.getElementById(floorButtonIDs[t]).classList.remove("selected");document.getElementById(floorButtonIDs["floor"+e]).classList.add("selected")}var placeBubble,currentNavigation,highlightedPlace=null,activePlace=null;function setActivePlace(e){!1===e||e.vg&&e.vg.poi&&!1===(e=mapviewer.getPlace(e.options?e.options("id"):e.vg.id))||(e==activePlace?activeplace=e:(resetActivePlace(),void 0===e||!1===e||e.vg.poi||(mapviewer.setPlaceColor(e,activePlaceColor),highlightedPlace==(activePlace=e)&&(highlightedPlace=null))))}function resetActivePlace(){null===activePlace||activePlace.vg.poi||(mapviewer.resetPlaceColor(activePlace),activePlace=null)}function setHighlightedPlace(e){!1===e||e instanceof Array||e.vg&&e.vg.poi||e!=highlightedPlace&&(resetHighlightedPlace(),void 0!==e)&&(mapviewer.setPlaceColor(e,mouseOverColor),highlightedPlace=e)}function resetHighlightedPlace(){var i=!1;null!=highlightedPlace&&(visioGlobeStoreId.forEach(function(e,t){highlightedPlace.vg.id==e&&(mapviewer.setPlaceColor(mapviewer.getPlace(e),16777215-mapviewer.getPlace(e).vg.originalColor),i=!0)}),i)?highlightedPlace=null:null!==highlightedPlace&&highlightedPlace!=activePlace&&(mapviewer.resetPlaceColor(highlightedPlace),highlightedPlace=null)}function selectPlace(e){var t=mapviewer.getPlace(e);resetActivePlace(),!1!==t&&gotoFloorAndPosition(t.vg.floor,t,function(){setActivePlace(t)})}function openPlaceBubble(e){var t,i,n,o=!1;if(void 0!==e&&!1!==e){if("string"==typeof e&&!1===(e=mapviewer.getPlace(e)))return o;if(closePlaceBubble(),void 0!==e.vg.id)t=e.vg.id,i=e.vg.position,n=e.vg.floor;else{if(!e.vg.poi)return;t=e.options("id"),i=e.options("position"),n=e.options("floor")}placeBubble=mapviewer.addPOI({selector:"#place_bubble",floor:n,position:i,alignment:{x:0,y:1}}),document.getElementById("place_bubble_description").style.display="none",document.getElementById("place_bubble_set_origin").style.display="block",document.getElementById("place_bubble_set_destination").style.display="block",!(document.getElementById("place_bubble_set_waypoint").style.display="block")!==mapviewer.getRoutingNode(t)?(document.getElementById("place_bubble_set_origin").setAttribute("vg_id",t),document.getElementById("place_bubble_set_origin").disabled=!1,document.getElementById("place_bubble_set_origin").style.opacity="1.0",document.getElementById("place_bubble_set_destination").setAttribute("vg_id",t),document.getElementById("place_bubble_set_destination").disabled=!1,document.getElementById("place_bubble_set_destination").style.opacity="1.0",document.getElementById("place_bubble_set_waypoint").setAttribute("vg_id",t),document.getElementById("place_bubble_set_waypoint").disabled=!1,document.getElementById("place_bubble_set_waypoint").style.opacity="1.0"):(document.getElementById("place_bubble_set_origin").setAttribute("vg_id",""),document.getElementById("place_bubble_set_origin").disabled=!0,document.getElementById("place_bubble_set_origin").style.opacity="0.4",document.getElementById("place_bubble_set_destination").setAttribute("vg_id",""),document.getElementById("place_bubble_set_destination").disabled=!0,document.getElementById("place_bubble_set_destination").style.opacity="0.4",document.getElementById("place_bubble_set_waypoint").setAttribute("vg_id",""),document.getElementById("place_bubble_set_waypoint").disabled=!0,document.getElementById("place_bubble_set_waypoint").style.opacity="0.4"),o=!0}return o}function closePlaceBubble(){placeBubble&&(placeBubble.remove(),placeBubble=!1)}var currentRoute=null,routeStartEnd=null,routeStartID=!1,routeEndID=!1,routeWaypointIDs=[];function doRouting(i,e){if(void 0===i||!1===i){var t=document.getElementById("vg_route_from");if(void 0===t||-1==t.selectedIndex)return;var n=t[t.selectedIndex],o=n.value;i=o}if(void 0===e){if(-1==(t=document.getElementById("vg_route_to")).selectedIndex)return;e=o=(n=t[t.selectedIndex]).value}""==i||""==e||!1===i||!1===e||Array.isArray(e)&&1==e.length&&!1===e[0]||((t={}).src=i,t.dst=e,t.routingParameters={},accessibleRoute&&(null!==appParams&&void 0!==appParams.routingParameters&&void 0!==appParams.routingParameters.excludedAttributes&&void 0!==appParams.routingParameters.excludedModalities?(t.routingParameters.excludedAttributes=appParams.routingParameters.excludedAttributes,t.routingParameters.excludedModalities=appParams.routingParameters.excludedModalities):t.routingParameters.excludedAttributes=["escalator","stairway"]),t.computeNavigation=useNavigation,t.navigationParameters=t.navigationParameters||{},t.navigationParameters.modalityParameters=t.navigationParameters.mModalityParameters||{},t.navigationParameters.modalityParameters.shuttle=t.navigationParameters.modalityParameters.shuttle||{},t.navigationParameters.modalityParameters.shuttle.straightAngleThreshold=t.navigationParameters.modalityParameters.shuttle.straightAngleThreshold||180,t.navigationParameters.modalityParameters.shuttle.distanceFromCouloirThreshold=t.navigationParameters.modalityParameters.shuttle.distanceFromCouloirThreshold||1e3,void 0!==query.firstnode&&(t.navigationParameters.firstNodeAsIntersection=!0),void 0!==query.nomerge&&(t.navigationParameters.mergeFloorChangeInstructions=!1),void 0!==query.language&&(t.language=query.language),null!=routeStartEnd&&routeStartEnd.remove(),mapviewer.computeRoute(t).then(function(e){var t;return null!=currentRoute&&(currentRoute.remove(),currentRoute=null),null!=currentNavigation&&(resetNavigationUI(),currentNavigation.remove(),currentNavigation=null),e.data.status&&200!=e.data.status?(clearRouting(),Promise.reject("Sorry, no route available between "+e.request.src+" and "+e.request.dst+".")):(e.data.pathColor=pathColor,(currentRoute=new MyRoute(mapviewer,e.data)).isValid()?(currentRoute.show(),useNavigation&&(currentNavigation=new MyNavigation(mapviewer,e.data,vgPlaces),updateNavigationUI(),toggleNavigationUI()),setActivePlace(mapviewer.getPlace(i)),t=currentRoute.getInitialViewpointPosition(),gotoFloorAndPosition(currentRoute.getInitialFloor(),t)):Promise.reject("Problems rendering the route between "+e.request.src+" and "+e.request.dst+"."))}).catch(function(e){clearRouting()}))}function doRoutingFromURLParameters(){var e,t,i,n;if(void 0!==query.src&&void 0!==query.dst)return routeStartID=query.src,routeEndID=query.dst,i=document.getElementById("vg_route_from"),n=document.getElementById("vg_route_to"),1==i.length&&1==n.length&&(e=i.option[value=""+query.src].index,t=n.option[value=""+query.dst].index,-1!=e)&&-1!=t&&(i=i[0],n=n[0],i.selectedIndex=e,n.selectedIndex=t,document.getElementById("vg_route_from-input'").value=i[e].value,document.getElementById("vg_route_to-input'").value=n[t].value),void 0!==query.waypoint?doRouting(query.src+"",[query.waypoint+"",query.dst+""]):doRouting(query.src+"",query.dst+"")}function clearRouting(){null!=currentRoute&&(currentRoute.remove(),currentRoute=null),useNavigation&&hideNavigationUI(function(){document.getElementById("instructions").style.visibility="hidden",null!=currentNavigation&&(resetNavigationUI(),currentNavigation.remove(),currentNavigation=null)});var e=document.getElementById("vg_route_from"),e=(1==e.length&&(e[0].selectedIndex=-1,document.getElementById("vg_route_from-input").value=""),routeStartID=!1,document.getElementById("vg_route_to"));1==e.length&&(e[0].selectedIndex=-1,document.getElementById("vg_route_to-input").value=""),routeEndID=!1,routeWaypointIDs=[],document.getElementById("route_clear").style.display="none"}var animationOffset,animationValue,statusbarTimeout=null;function onObjectMouseOver(e,t){if(t.vg&&t.vg.poi&&!(t=t.options&&mapviewer.getPlace(t.options("id"))))return!(document.getElementById(mapViewerId).style.cursor="auto");"#mall-map"!=getStoreUrl(t.vg.id)&&(document.getElementById(mapViewerId).style.cursor="pointer"),null!==statusbarTimeout&&(clearTimeout(statusbarTimeout),statusbarTimeout=null),setHighlightedPlace(t)}function onObjectMouseOut(e,t){resetHighlightedPlace(),document.getElementById(mapViewerId).style.cursor=""}function logVisioWebTitle(){}function isWebGLSupported(){var e,t=!1;return t=window.WebGLRenderingContext&&((e=document.createElement("canvas")).getContext("webgl")||e.getContext("experimental-webgl"))?!0:t}function updateProgress(e){}function checkMoreThanTwoTouches(e){e&&e.touches&&2<e.touches.length&&document.removeEventListener("touchstart",checkMoreThanTwoTouches)}function onRemoteMessage(e){return Promise.resolve(e.data).then(JSON.parse).then(function(t){var e;return void 0===t.method?Promise.reject("message without method"):(e="goTo"===t.method?mapviewer.camera[t.method].apply(mapviewer.camera,t.arguments):"function"==typeof mapviewer[t.method]?mapviewer[t.method].apply(mapviewer,t.arguments):mapviewer[t.method],Promise.resolve(e).then(function(e){window.parent.postMessage(JSON.stringify({requestID:t.requestID,response:e}),"*")}).catch(function(e){window.parent.postMessage(JSON.stringify({requestID:t.requestID,reason:e}),"*")}))})}function initializeCamera(){var e,n=mapviewer.getPlace(visioGlobeStoreId),i=!1;if(visioGlobeStoreId.forEach(function(e,t){i||null==mapviewer.getPlace(e)||null==mapviewer.getPlace(e).vg||(n=mapviewer.getPlace(e),i=!0)}),storeDetailPlace=activePlace=n,visioGlobeStoreId.length<=0||null==n||null==n.vg){(e=mapviewer.camera.position).radius=viewParams.cameraRadius,viewParams.initialX&&void 0!==viewParams.initialX&&(e.x=viewParams.initialX),viewParams.initialY&&void 0!==viewParams.initialY&&(e.y=viewParams.initialY);try{changeFloor(viewParams.floorName)}catch(e){}}else{if(visioGlobeStoreId.forEach(function(e,t){var i=mapviewer.getPlace(e);null!=i&&null!=i.vg&&(mapviewer.setPlaceColor(mapviewer.getPlace(e),16777215-n.vg.originalColor),""!=logoUrl)&&addBubble(e,mapviewer.getPlace(e),bubbleLogoUrl)}),null!=n&&null!=n.vg)try{changeFloor(n.vg.floor)}catch(e){}(e=mapviewer.camera.position)?((e=mapviewer.camera.position).x=n.vg.position.x,e.y=n.vg.position.y,e.radius/=7):e=n}mapviewer.camera.goTo(e),null!==viewParams.maxRadius&&void 0!==viewParams.maxRadius&&0<viewParams.maxRadius&&(mapviewer.camera.maxRadius=viewParams.maxRadius)}function changeFloor(e){document.getElementById("change_floor").querySelectorAll(".vg_button").forEach(e=>{e.classList.remove("floor-button-current")}),document.getElementById("floor_link"+e).classList.add("floor-button-current"),mapviewer.changeFloor(e)}function initializeButtons(){document.getElementById("zoomOut").addEventListener("click",function(){var e=mapviewer.camera.position;e.radius*=2,mapviewer.camera.goTo(e)}),document.getElementById("zoomIn").addEventListener("click",function(){var e=mapviewer.camera.position;e.radius/=2,mapviewer.camera.goTo(e)})}function addBubble(e,t,i){e="bubble-"+e.replace(/[-_\/\\~!@%$^&*+?.s()|[\]{}]/g,"");document.getElementById("poiContainer").innerHTML+="<div class='bubble' id='"+e+"'><div class='webLogo'><img src='"+i+"' /></div></div>",mapviewer.addPOI({selector:"#"+e,floor:t.vg.floor,position:t.vg.position,alignment:{x:0,y:.25}});poiPlaces[poiPlaces.length]=t}function URWindowLocation(e){window.location.href=URWindowURLReturn(e)}function URWindowURLReturn(e){var t,i,n="";return 0<=location.href.indexOf("webview")?1==getUrlQuerystringVarsWebviewEqualsOne().webview&&(e.includes(t="webview=1")?n=e:"#"!=e&&"/"!=e&&"javascript: void (0)"!=e&&(e.includes("#")?2==(i=e.split("#")).length&&(n=e=i[0]+(i[0].match(/\?/)?"&":"?")+t+"#"+i[1]):n=e+=(e.match(/\?/)?"&":"?")+t)):n=e,n}function getUrlQuerystringVarsWebviewEqualsOne(){for(var e,t,i=[],n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),o=0;o<n.length;o++)null!=(t=n[o].split("="))[1]&&null!=t[1]&&""!=t[1]&&t[1].includes("#")?2==(e=t[1].split("#")).length&&(i.push(t[0]),i[t[0]]=e[0]):(i.push(t[0]),i[t[0]]=t[1]);return i}function shopCenterSelectorDataPush(o){var a="",r="",l="";null!=o&&null!=storeDataList&&storeDataList.forEach(function(e,t){var i=e.storeId.split(";"),n=e;i.forEach(function(e,t){e==o&&(a=n.retailerId,r=n.retailerName,l=n.shopId,n.templateName)})}),(null!==a&&""!==a||null!==r&&""!==r||null!==l&&""!==l)&&void 0!==window&&null!==window&&void 0!==window.dataLayer&&null!==window.dataLayer&&window.dataLayer.push({event:"click_shop_center_map",retailer_id:null!=a&&""!==a?a:void 0,retailer_name:null!=r&&""!==r?r:void 0,shop_id:null!=l&&""!==l?l:void 0})}document?.addEventListener("touchstart",checkMoreThanTwoTouches,!1);