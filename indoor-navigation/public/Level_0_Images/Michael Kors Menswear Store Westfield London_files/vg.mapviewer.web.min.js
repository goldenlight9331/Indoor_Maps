var vg=function(l){var t,mt,h,o,u,p,f,d,m,r,g,v,a,e;function s(t,e){var i,r,n,o,a,s,l,c,h,u=e&&e.split("/"),p=f.map,d=p&&p["*"]||{};if(t&&"."===t.charAt(0))if(e){for(t=(u=u.slice(0,u.length-1)).concat(t.split("/")),c=0;c<t.length;c+=1)if("."===(i=t[c]))t.splice(c,1),--c;else if(".."===i){if(1===c&&(".."===t[2]||".."===t[0]))break;0<c&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((u||d)&&p){for(c=(i=t.split("/")).length;0<c;--c){if(r=i.slice(0,c).join("/"),u)for(h=u.length;0<h;--h)if((n=p[u.slice(0,h).join("/")])&&(n=n[r])){o=n,a=c;break}if(o)break;!s&&d&&d[r]&&(s=d[r],l=c)}!o&&s&&(o=s,a=l),o&&(i.splice(0,a,o),t=i.join("/"))}return t}function y(t,e){return function(){return o.apply(h,r.call(arguments,0).concat([t,e]))}}function b(t){var e;if(m.call(p,t)&&(e=p[t],delete p[t],d[t]=!0,a.apply(h,e)),!m.call(u,t)&&!m.call(d,t))throw Error("No "+t);return u[t]}function x(t){var e,i=t?t.indexOf("!"):-1;return-1<i&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}u={},p={},f={},d={},m=Object.prototype.hasOwnProperty,r=[].slice,g=function(t,e){var i,r,n=x(t),o=n[0];return t=n[1],o&&(i=b(o=s(o,e))),o?t=i&&i.normalize?i.normalize(t,(r=e,function(t){return s(t,r)})):s(t,e):(o=(n=x(t=s(t,e)))[0],t=n[1],o&&(i=b(o))),{f:o?o+"!"+t:t,n:t,pr:o,p:i}},v={require:function(t){return y(t)},exports:function(t){var e=u[t];return void 0!==e?e:u[t]={}},module:function(t){return{id:t,uri:"",exports:u[t],config:(e=t,function(){return f&&f.config&&f.config[e]||{}})};var e}},a=function(t,e,i,r){var n,o,a,s,l,c=[];if(r=r||t,"function"==typeof i){for(e=!e.length&&i.length?["require","exports","module"]:e,s=0;s<e.length;s+=1)if("require"===(o=(a=g(e[s],r)).f))c[s]=v.require(t);else if("exports"===o)c[s]=v.exports(t),l=!0;else if("module"===o)n=c[s]=v.module(t);else if(m.call(u,o)||m.call(p,o)||m.call(d,o))c[s]=b(o);else{if(!a.p)throw Error(t+" missing "+o);a.p.load(a.n,y(r,!0),function(e){return function(t){u[e]=t}}(o),{}),c[s]=u[o]}e=i.apply(u[t],c),t&&(n&&n.exports!==h&&n.exports!==u[t]?u[t]=n.exports:e===h&&l||(u[t]=e))}else t&&(u[t]=i)},t=o=function(t,e,i,r,n){return"string"==typeof t?v[t]?v[t](e):b(g(t,e).f):(t&&t.splice||(f=t,callbak&&e.splice?(t=e,e=i,i=null):t=h),"function"==typeof i&&(i=r,r=n),a(h,t,e=e||function(){},i),o)},o.config=function(t){return(f=t).deps&&o(f.deps,f.callback),o},!((mt=function(t,e,i){e&&e.splice||(i=e,e=[]),m.call(u,t)||m.call(p,t)||(p[t]=[t,e,i])}).amd={jQuery:!0})=="performance"in(_=this)&&(_.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},!1=="now"in _.performance&&(e=_.performance.timing&&_.performance.timing.navigationStart?performance.timing.navigationStart:Date.now(),_.performance.now=function(){return Date.now()-e});var n,w,te=te||(n=[],{REVISION:"14",getAll:function(){return n},removeAll:function(){n=[]},add:function(t){n.push(t)},remove:function(t){-1!==(t=n.indexOf(t))&&n.splice(t,1)},update:function(t){if(0===n.length)return!1;var e=0;for(t=void 0!==t?t:window.performance.now();e<n.length;)n[e].update(t)?e++:n.splice(e,1);return!0}});te.Tween=function(a){var t,s={},l={},c={},h=1e3,u=0,p=!1,i=!1,d=!1,f=0,m=null,g=te.Easing.Linear.None,v=te.Interpolation.Linear,y=[],b=null,x=!1,w=null,M=null,e=null;for(t in a)s[t]=parseFloat(a[t],10);this.to=function(t,e){return void 0!==e&&(h=e),l=t,this},this.start=function(t){for(var e in te.add(this),x=!(i=!0),m=void 0!==t?t:window.performance.now(),m+=f,l){if(l[e]instanceof Array){if(0===l[e].length)continue;l[e]=[a[e]].concat(l[e])}s[e]=a[e],!1==s[e]instanceof Array&&(s[e]*=1),c[e]=s[e]||0}return this},this.stop=function(){return i&&(te.remove(this),i=!1,null!==e&&e.call(a),this.stopChainedTweens()),this},this.stopChainedTweens=function(){for(var t=0,e=y.length;t<e;t++)y[t].stop()},this.delay=function(t){return f=t,this},this.repeat=function(t){return u=t,this},this.yoyo=function(t){return p=t,this},this.easing=function(t){return g=t,this},this.interpolation=function(t){return v=t,this},this.chain=function(){return y=arguments,this},this.onStart=function(t){return b=t,this},this.onUpdate=function(t){return w=t,this},this.onComplete=function(t){return M=t,this},this.onStop=function(t){return e=t,this},this.update=function(t){if(t<m)return!0;!1===x&&(null!==b&&b.call(a),x=!0);var e=1<(e=(t-m)/h)?1:e,i=g(d?1-e:e);for(var r in l){var n=s[r]||0,o=l[r];o instanceof Array?a[r]=v(o,i):"number"==typeof(o="string"==typeof o?n+parseFloat(o,10):o)&&(a[r]=n+(o-n)*i)}if(null!==w&&w.call(a,i),1==e){if(!(0<u)){for(null!==M&&M.call(a),r=0,e=y.length;r<e;r++)y[r].start(t);return!1}for(r in isFinite(u)&&u--,c)"string"==typeof l[r]&&(c[r]+=parseFloat(l[r],10)),p&&(e=c[r],c[r]=l[r],l[r]=e),s[r]=c[r];p&&(d=!d),m=t+f}return!0}},te.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*--t)*Math.sin(2*(t-e)*Math.PI/.4)))},Out:function(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/.4)+1)},InOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?-.5*i*Math.pow(2,10*--t)*Math.sin(2*(t-e)*Math.PI/.4):i*Math.pow(2,-10*--t)*Math.sin(2*(t-e)*Math.PI/.4)*.5+1)}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){return(t*=2)<1?.5*t*t*(3.5949095*t-2.5949095):.5*((t-=2)*t*(3.5949095*t+2.5949095)+2)}},Bounce:{In:function(t){return 1-te.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*te.Easing.Bounce.In(2*t):.5*te.Easing.Bounce.Out(2*t-1)+.5}}},te.Interpolation={Linear:function(t,e){var i=t.length-1,r=i*e,n=Math.floor(r),o=te.Interpolation.Utils.Linear;return e<0?o(t[0],t[1],r):1<e?o(t[i],t[i-1],i-r):o(t[n],t[i<n+1?i:n+1],r-n)},Bezier:function(t,e){for(var i=0,r=t.length-1,n=Math.pow,o=te.Interpolation.Utils.Bernstein,a=0;a<=r;a++)i+=n(1-e,r-a)*n(e,a)*t[a]*o(r,a);return i},CatmullRom:function(t,e){var i=t.length-1,r=i*e,n=Math.floor(r),o=te.Interpolation.Utils.CatmullRom;return t[0]===t[i]?o(t[((n=e<0?Math.floor(r=i*(1+e)):n)-1+i)%i],t[n],t[(n+1)%i],t[(n+2)%i],r-n):e<0?t[0]-(o(t[0],t[0],t[1],t[1],-r)-t[0]):1<e?t[i]-(o(t[i],t[i],t[i-1],t[i-1],r-i)-t[i]):o(t[n?n-1:0],t[n],t[i<n+1?i:n+1],t[i<n+2?i:n+2],r-n)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=te.Interpolation.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:(w=[1],function(t){var e,i=1;if(w[t])return w[t];for(e=t;1<e;e--)i*=e;return w[t]=i}),CatmullRom:function(t,e,i,r,n){var o=n*n;return(2*e-2*i+(t=.5*(i-t))+(r=.5*(r-e)))*n*o+(-3*e+3*i-2*t-r)*o+t*n+e}}},A=this,mt.amd?mt([],function(){return te}):"object"==typeof exports?module.exports=te:A.TWEEN=te;var M,_,A,P,ee={defaultDatum:"WGS84",transform:function(t,e,i){return t.readyToUse?e.readyToUse?(("900913"==t.srsProjNumber&&"WGS84"!=e.datumCode&&!e.datum_params||"900913"==e.srsProjNumber&&"WGS84"!=t.datumCode&&!t.datum_params)&&(r=ee.WGS84,this.transform(t,r,i),t=r),"enu"!=t.axis&&this.adjust_axis(t,!1,i),"longlat"==t.projName?(i.x*=ee.common.D2R,i.y*=ee.common.D2R):(t.to_meter&&(i.x*=t.to_meter,i.y*=t.to_meter),t.inverse(i)),t.from_greenwich&&(i.x+=t.from_greenwich),i=this.datum_transform(t.datum,e.datum,i),e.from_greenwich&&(i.x-=e.from_greenwich),"longlat"==e.projName?(i.x*=ee.common.R2D,i.y*=ee.common.R2D):(e.forward(i),e.to_meter&&(i.x/=e.to_meter,i.y/=e.to_meter)),"enu"!=e.axis&&this.adjust_axis(e,!0,i)):this.reportError("Proj4js initialization for:"+e.srsCode+" not yet complete"):this.reportError("Proj4js initialization for:"+t.srsCode+" not yet complete"),i;var r},datum_transform:function(t,e,i){return t.compare_datums(e)||t.datum_type==ee.common.PJD_NODATUM||e.datum_type==ee.common.PJD_NODATUM||(t.datum_type==ee.common.PJD_GRIDSHIFT&&alert("ERROR: Grid shift transformations are not implemented yet."),e.datum_type==ee.common.PJD_GRIDSHIFT&&alert("ERROR: Grid shift transformations are not implemented yet."),t.es==e.es&&t.a==e.a&&t.datum_type!=ee.common.PJD_3PARAM&&t.datum_type!=ee.common.PJD_7PARAM&&e.datum_type!=ee.common.PJD_3PARAM&&e.datum_type!=ee.common.PJD_7PARAM||(t.geodetic_to_geocentric(i),t.datum_type!=ee.common.PJD_3PARAM&&t.datum_type!=ee.common.PJD_7PARAM||t.geocentric_to_wgs84(i),e.datum_type!=ee.common.PJD_3PARAM&&e.datum_type!=ee.common.PJD_7PARAM||e.geocentric_from_wgs84(i),e.geocentric_to_geodetic(i)),e.datum_type==ee.common.PJD_GRIDSHIFT&&alert("ERROR: Grid shift transformations are not implemented yet.")),i},adjust_axis:function(t,e,i){for(var r,n,o=i.x,a=i.y,s=i.z||0,l=0;l<3;l++)if(!e||2!=l||void 0!==i.z)switch(n=0==l?(r=o,"x"):1==l?(r=a,"y"):(r=s,"z"),t.axis[l]){case"e":i[n]=r;break;case"w":i[n]=-r;break;case"n":i[n]=r;break;case"s":i[n]=-r;break;case"u":void 0!==i[n]&&(i.z=r);break;case"d":void 0!==i[n]&&(i.z=-r);break;default:return alert("ERROR: unknow axis ("+t.axis[l]+") - check definition of "+t.projName),null}return i},reportError:function(t){},extend:function(t,e){if(t=t||{},e)for(var i in e){var r=e[i];void 0!==r&&(t[i]=r)}return t},Class:function(){function t(){this.initialize.apply(this,arguments)}for(var e,i={},r=0;r<arguments.length;++r)e="function"==typeof arguments[r]?arguments[r].prototype:arguments[r],ee.extend(i,e);return t.prototype=i,t},bind:function(e,i){var r=Array.prototype.slice.apply(arguments,[2]);return function(){var t=r.concat(Array.prototype.slice.apply(arguments,[0]));return e.apply(i,t)}},scriptName:"proj4js.js",defsLookupService:"http://spatialreference.org/ref",libPath:null,getScriptLocation:function(){if(this.libPath)return this.libPath;for(var t=this.scriptName,e=t.length,i=document.getElementsByTagName("script"),r=0;r<i.length;r++){var n=i[r].getAttribute("src");if(n){var o=n.lastIndexOf(t);if(-1<o&&o+e==n.length){this.libPath=n.slice(0,-e);break}}}return this.libPath||""},loadScript:function(t,e,i,r){var n=document.createElement("script");n.defer=!1,n.type="text/javascript",n.id=t,n.src=t,n.onload=e,n.onerror=i,n.loadCheck=r,/MSIE/.test(navigator.userAgent)&&(n.onreadystatechange=this.checkReadyState),document.getElementsByTagName("head")[0].appendChild(n)},checkReadyState:function(){"loaded"==this.readyState&&(this.loadCheck()?this.onload():this.onerror())}};function E(a,t,e){var s,o,l,c,h,u=0,p=[],d=0,f=!1,m=!1,n=[],g=[],v=!1,i=(e=e||{}).encoding||"UTF8",y=e.numRounds||1,b=F(t,i);if(y!==parseInt(y,10)||y<1)throw Error("numRounds must a integer >= 1");if(c=function(t,e){return q(t,e,a)},h=function(t,e,i,r){var n,o;if("SHA-224"!==a&&"SHA-256"!==a)throw Error("Unexpected error in SHA-2 implementation");for(n=15+(e+65>>>9<<4),o=16;t.length<=n;)t.push(0);for(t[e>>>5]|=128<<24-e%32,t[n]=e+i,i=t.length,e=0;e<i;e+=o)r=q(t.slice(e,e+o),r,a);if("SHA-224"===a)t=[r[0],r[1],r[2],r[3],r[4],r[5],r[6]];else{if("SHA-256"!==a)throw Error("Unexpected error in SHA-2 implementation");t=r}return t},"SHA-224"===a)l=512,o=224;else{if("SHA-256"!==a)throw Error("Chosen SHA variant is not supported");l=512,o=256}s=X(a),this.setHMACKey=function(t,e,i){var r;if(!0===m)throw Error("HMAC key already set");if(!0===f)throw Error("Cannot set HMAC key after finalizing hash");if(!0===v)throw Error("Cannot set HMAC key after calling update");if(t=(e=F(e,(i||{}).encoding||"UTF8")(t)).binLen,e=e.value,i=(r=l>>>3)/4-1,r<t/8){for(e=h(e,t,0,X(a));e.length<=i;)e.push(0);e[i]&=4294967040}else if(t/8<r){for(;e.length<=i;)e.push(0);e[i]&=4294967040}for(t=0;t<=i;t+=1)n[t]=909522486^e[t],g[t]=1549556828^e[t];s=c(n,s),u=l,m=!0},this.update=function(t){var e,i,r=0,n=l>>>5,o=b(t,p,d);for(t=o.binLen,e=o.value,o=t>>>5,i=0;i<o;i+=n)r+l<=t&&(s=c(e.slice(i,i+n),s),r+=l);u+=r,p=e.slice(r>>>5),d=t%l,v=!0},this.getHash=function(t,e){var i,r,n;if(!0===m)throw Error("Cannot call getHash after setting HMAC key");switch(n=D(e),t){case"HEX":i=function(t){return R(t,n)};break;case"B64":i=function(t){return L(t,n)};break;case"BYTES":i=I;break;default:throw Error("format must be HEX, B64, or BYTES")}if(!1===f)for(s=h(p,d,u,s),r=1;r<y;r+=1)s=h(s,o,0,X(a));return f=!0,i(s)},this.getHMAC=function(t,e){var i,r;if(!1===m)throw Error("Cannot call getHMAC without first setting HMAC key");switch(r=D(e),t){case"HEX":i=function(t){return R(t,r)};break;case"B64":i=function(t){return L(t,r)};break;case"BYTES":i=I;break;default:throw Error("outputFormat must be HEX, B64, or BYTES")}return!1===f&&(t=h(p,d,u,s),s=c(g,X(a)),s=h(t,o,l,s)),f=!0,i(s)}}function S(){}function T(t,e,i){var r,n,o,a,s,l=t.length;if(e=e||[0],s=(i=i||0)>>>3,0!=l%2)throw Error("String of HEX type must be in byte increments");for(r=0;r<l;r+=2){if(n=parseInt(t.substr(r,2),16),isNaN(n))throw Error("String of HEX type contains invalid characters");for(o=(a=(r>>>1)+s)>>>2;e.length<=o;)e.push(0);e[o]|=n<<8*(3-a%4)}return{value:e,binLen:4*l+i}}function C(t,e,i){for(var r,n,o=[],o=e||[0],a=(i=i||0)>>>3,s=0;s<t.length;s+=1)e=t.charCodeAt(s),o.length<=(r=(n=s+a)>>>2)&&o.push(0),o[r]|=e<<8*(3-n%4);return{value:o,binLen:8*t.length+i}}function O(t,e,i){var r,n,o,a,s,l,c=[],h=0,c=e||[0];if(e=(i=i||0)>>>3,-1===t.search(/^[a-zA-Z0-9=+\/]+$/))throw Error("Invalid character in base-64 string");if(n=t.indexOf("="),t=t.replace(/\=/g,""),-1!==n&&n<t.length)throw Error("Invalid '=' found in base-64 string");for(n=0;n<t.length;n+=4){for(s=t.substr(n,4),o=a=0;o<s.length;o+=1)a|=(r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(s[o]))<<18-6*o;for(o=0;o<s.length-1;o+=1){for(r=(l=h+e)>>>2;c.length<=r;)c.push(0);c[r]|=(a>>>16-8*o&255)<<8*(3-l%4),h+=1}}return{value:c,binLen:8*h+i}}function R(t,e){for(var i,r="",n=4*t.length,o=0;o<n;o+=1)i=t[o>>>2]>>>8*(3-o%4),r+="0123456789abcdef".charAt(i>>>4&15)+"0123456789abcdef".charAt(15&i);return e.outputUpper?r.toUpperCase():r}function L(t,e){for(var i,r,n="",o=4*t.length,a=0;a<o;a+=3)for(i=t.length<=(r=a+1>>>2)?0:t[r],r=t.length<=(r=a+2>>>2)?0:t[r],r=(t[a>>>2]>>>8*(3-a%4)&255)<<16|(i>>>8*(3-(a+1)%4)&255)<<8|r>>>8*(3-(a+2)%4)&255,i=0;i<4;i+=1)8*a+6*i<=32*t.length?n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>>6*(3-i)&63):n+=e.b64Pad;return n}function I(t){for(var e,i="",r=4*t.length,n=0;n<r;n+=1)e=t[n>>>2]>>>8*(3-n%4)&255,i+=String.fromCharCode(e);return i}function D(t){var e={outputUpper:!1,b64Pad:"="};if(e.outputUpper=(t=t||{}).outputUpper||!1,!0===t.hasOwnProperty("b64Pad")&&(e.b64Pad=t.b64Pad),"boolean"!=typeof e.outputUpper)throw Error("Invalid outputUpper formatting option");if("string"!=typeof e.b64Pad)throw Error("Invalid b64Pad formatting option");return e}function F(t,u){var e;switch(u){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(t){case"HEX":e=T;break;case"TEXT":e=function(t,e,i){var r,n,o,a,s=[],l=[],c=0,s=e||[0],h=(e=i||0)>>>3;if("UTF8"===u)for(r=0;r<t.length;r+=1)for(l=[],(i=t.charCodeAt(r))<128?l.push(i):i<2048?(l.push(192|i>>>6),l.push(128|63&i)):i<55296||57344<=i?l.push(224|i>>>12,128|i>>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&t.charCodeAt(r+=1)),l.push(240|i>>>18,128|i>>>12&63,128|i>>>6&63,128|63&i)),n=0;n<l.length;n+=1){for(o=(a=c+h)>>>2;s.length<=o;)s.push(0);s[o]|=l[n]<<8*(3-a%4),c+=1}else if("UTF16BE"===u||"UTF16LE"===u)for(r=0;r<t.length;r+=1){for(i=t.charCodeAt(r),"UTF16LE"===u&&(i=(n=255&i)<<8|i>>>8),o=(a=c+h)>>>2;s.length<=o;)s.push(0);s[o]|=i<<8*(2-a%4),c+=2}return{value:s,binLen:8*c+e}};break;case"B64":e=O;break;case"BYTES":e=C;break;default:throw Error("format must be HEX, TEXT, B64, or BYTES")}return e}function j(t,e){return t>>>e|t<<32-e}function N(t,e,i){return t&e^~t&i}function k(t,e,i){return t&e^t&i^e&i}function z(t){return j(t,2)^j(t,13)^j(t,22)}function U(t){return j(t,6)^j(t,11)^j(t,25)}function V(t){return j(t,7)^j(t,18)^t>>>3}function B(t){return j(t,17)^j(t,19)^t>>>10}function H(t,e){var i=(65535&t)+(65535&e);return((t>>>16)+(e>>>16)+(i>>>16)&65535)<<16|65535&i}function G(t,e,i,r){var n=(65535&t)+(65535&e)+(65535&i)+(65535&r);return((t>>>16)+(e>>>16)+(i>>>16)+(r>>>16)+(n>>>16)&65535)<<16|65535&n}function W(t,e,i,r,n){var o=(65535&t)+(65535&e)+(65535&i)+(65535&r)+(65535&n);return((t>>>16)+(e>>>16)+(i>>>16)+(r>>>16)+(n>>>16)+(o>>>16)&65535)<<16|65535&o}function X(t){var e=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],i=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];switch(t){case"SHA-224":t=e;break;case"SHA-256":t=i;break;case"SHA-384":case"SHA-512":t=[new S,new S,new S,new S,new S,new S,new S,new S];break;default:throw Error("Unknown SHA variant")}return t}function q(t,e,i){var r,n,o,a,s,l,c,h,u,p,d,f,m,g,v,y,b,x,w,M,_,A,E,S=[];if("SHA-224"!==i&&"SHA-256"!==i)throw Error("Unexpected error in SHA-2 implementation");for(p=64,f=1,A=Number,m=H,g=G,v=W,y=V,b=B,x=z,w=U,_=k,M=N,E=P,i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],d=0;d<p;d+=1)d<16?(h=t.length<=(u=d*f)?0:t[u],u=t.length<=u+1?0:t[u+1],S[d]=new A(h,u)):S[d]=g(b(S[d-2]),S[d-7],y(S[d-15]),S[d-16]),h=v(c,w(a),M(a,s,l),E[d],S[d]),u=m(x(i),_(i,r,n)),c=l,l=s,s=a,a=m(o,h),o=n,n=r,r=i,i=m(h,u);return e[0]=m(i,e[0]),e[1]=m(r,e[1]),e[2]=m(n,e[2]),e[3]=m(o,e[3]),e[4]=m(a,e[4]),e[5]=m(s,e[5]),e[6]=m(l,e[6]),e[7]=m(c,e[7]),e}ee.Proj=ee.Class({readyToUse:!1,title:null,projName:null,units:null,datum:null,x0:0,y0:0,localCS:!1,queue:null,initialize:function(t,e){var i;this.srsCodeInput=t,this.queue=[],e&&this.queue.push(e),0<=t.indexOf("GEOGCS")||0<=t.indexOf("GEOCCS")||0<=t.indexOf("PROJCS")||0<=t.indexOf("LOCAL_CS")?(this.parseWKT(t),this.deriveConstants(),this.loadProjCode(this.projName)):(0==t.indexOf("urn:")?"ogc"!=(i=t.split(":"))[1]&&"x-ogc"!=i[1]||"def"!=i[2]||"crs"!=i[3]||(t=i[4]+":"+i[i.length-1]):0==t.indexOf("http://")&&((i=t.split("#"))[0].match(/epsg.org/)?t="EPSG:"+i[1]:i[0].match(/RIG.xml/)&&(t="IGNF:"+i[1])),this.srsCode=t.toUpperCase(),0==this.srsCode.indexOf("EPSG")?(this.srsCode=this.srsCode,this.srsAuth="epsg",this.srsProjNumber=this.srsCode.substring(5)):0==this.srsCode.indexOf("IGNF")?(this.srsCode=this.srsCode,this.srsAuth="IGNF",this.srsProjNumber=this.srsCode.substring(5)):0==this.srsCode.indexOf("CRS")?(this.srsCode=this.srsCode,this.srsAuth="CRS",this.srsProjNumber=this.srsCode.substring(4)):(this.srsAuth="",this.srsProjNumber=this.srsCode),this.loadProjDefinition())},loadProjDefinition:function(){var t;ee.defs[this.srsCode]?this.defsLoaded():(t=ee.getScriptLocation()+"defs/"+this.srsAuth.toUpperCase()+this.srsProjNumber+".js",ee.loadScript(t,ee.bind(this.defsLoaded,this),ee.bind(this.loadFromService,this),ee.bind(this.checkDefsLoaded,this)))},loadFromService:function(){ee.loadScript(ee.defsLookupService+"/"+this.srsAuth+"/"+this.srsProjNumber+"/proj4js/",ee.bind(this.defsLoaded,this),ee.bind(this.defsFailed,this),ee.bind(this.checkDefsLoaded,this))},defsLoaded:function(){this.parseDefs(),this.loadProjCode(this.projName)},checkDefsLoaded:function(){return!!ee.defs[this.srsCode]},defsFailed:function(){ee.reportError("failed to load projection definition for: "+this.srsCode),ee.defs[this.srsCode]=ee.defs.WGS84,this.defsLoaded()},loadProjCode:function(t){var e;ee.Proj[t]?this.initTransforms():(e=ee.getScriptLocation()+"projCode/"+t+".js",ee.loadScript(e,ee.bind(this.loadProjCodeSuccess,this,t),ee.bind(this.loadProjCodeFailure,this,t),ee.bind(this.checkCodeLoaded,this,t)))},loadProjCodeSuccess:function(t){ee.Proj[t].dependsOn?this.loadProjCode(ee.Proj[t].dependsOn):this.initTransforms()},loadProjCodeFailure:function(t){ee.reportError("failed to find projection file for: "+t)},checkCodeLoaded:function(t){return!!ee.Proj[t]},initTransforms:function(){if(ee.extend(this,ee.Proj[this.projName]),this.init(),this.readyToUse=!0,this.queue)for(var t;t=this.queue.shift();)t.call(this,this)},wktRE:/^(\w+)\[(.*)\]$/,parseWKT:function(t){if(t=t.match(this.wktRE)){var e=t[1],i=t[2].split(","),r="TOWGS84"==e.toUpperCase()?e:i.shift();r=(r=r.replace(/^\"/,"")).replace(/\"$/,""),t=[];for(var n=0,o="",a=0;a<i.length;++a){for(var s=i[a],l=0;l<s.length;++l)"["==s.charAt(l)&&++n,"]"==s.charAt(l)&&--n;o+=s,0===n?(t.push(o),o=""):o+=","}switch(e){case"LOCAL_CS":this.projName="identity",this.localCS=!0,this.srsCode=r;break;case"GEOGCS":this.projName="longlat",this.geocsCode=r,this.srsCode||(this.srsCode=r);break;case"PROJCS":this.srsCode=r;break;case"PROJECTION":this.projName=ee.wktProjections[r];break;case"DATUM":this.datumName=r;break;case"LOCAL_DATUM":this.datumCode="none";break;case"SPHEROID":this.ellps=r,this.a=parseFloat(t.shift()),this.rf=parseFloat(t.shift());break;case"PRIMEM":this.from_greenwich=parseFloat(t.shift());break;case"UNIT":this.units=r,this.unitsPerMeter=parseFloat(t.shift());break;case"PARAMETER":switch(e=r.toLowerCase(),i=parseFloat(t.shift()),e){case"false_easting":this.x0=i;break;case"false_northing":this.y0=i;break;case"scale_factor":this.k0=i;break;case"central_meridian":this.long0=i*ee.common.D2R;break;case"latitude_of_origin":this.lat0=i*ee.common.D2R}break;case"TOWGS84":this.datum_params=t;break;case"AXIS":switch(e=r.toLowerCase(),i=t.shift()){case"EAST":i="e";break;case"WEST":i="w";break;case"NORTH":i="n";break;case"SOUTH":i="s";break;case"UP":i="u";break;case"DOWN":i="d";break;default:i=" "}switch(this.axis||(this.axis="enu"),e){case"X":this.axis=i+this.axis.substr(1,2);break;case"Y":this.axis=this.axis.substr(0,1)+i+this.axis.substr(2,1);break;case"Z":this.axis=this.axis.substr(0,2)+i}}for(a=0;a<t.length;++a)this.parseWKT(t[a])}},parseDefs:function(){var t,e;if(this.defData=ee.defs[this.srsCode],this.defData){for(var i=this.defData.split("+"),r=0;r<i.length;r++)switch(e=i[r].split("="),t=e[0].toLowerCase(),e=e[1],t.replace(/\s/gi,"")){case"title":this.title=e;break;case"proj":this.projName=e.replace(/\s/gi,"");break;case"units":this.units=e.replace(/\s/gi,"");break;case"datum":this.datumCode=e.replace(/\s/gi,"");break;case"nadgrids":this.nagrids=e.replace(/\s/gi,"");break;case"ellps":this.ellps=e.replace(/\s/gi,"");break;case"a":this.a=parseFloat(e);break;case"b":this.b=parseFloat(e);break;case"rf":this.rf=parseFloat(e);break;case"lat_0":this.lat0=e*ee.common.D2R;break;case"lat_1":this.lat1=e*ee.common.D2R;break;case"lat_2":this.lat2=e*ee.common.D2R;break;case"lat_ts":this.lat_ts=e*ee.common.D2R;break;case"lon_0":this.long0=e*ee.common.D2R;break;case"alpha":this.alpha=parseFloat(e)*ee.common.D2R;break;case"lonc":this.longc=e*ee.common.D2R;break;case"x_0":this.x0=parseFloat(e);break;case"y_0":this.y0=parseFloat(e);break;case"k_0":case"k":this.k0=parseFloat(e);break;case"r_a":this.R_A=!0;break;case"zone":this.zone=parseInt(e);break;case"south":this.utmSouth=!0;break;case"towgs84":this.datum_params=e.split(",");break;case"to_meter":this.to_meter=parseFloat(e);break;case"from_greenwich":this.from_greenwich=e*ee.common.D2R;break;case"pm":e=e.replace(/\s/gi,""),this.from_greenwich=ee.PrimeMeridian[e]||parseFloat(e),this.from_greenwich*=ee.common.D2R;break;case"axis":3==(e=e.replace(/\s/gi,"")).length&&-1!="ewnsud".indexOf(e.substr(0,1))&&-1!="ewnsud".indexOf(e.substr(1,1))&&-1!="ewnsud".indexOf(e.substr(2,1))&&(this.axis=e)}this.deriveConstants()}},deriveConstants:function(){var t;"@null"==this.nagrids&&(this.datumCode="none"),!this.datumCode||"none"==this.datumCode||(t=ee.Datum[this.datumCode])&&(this.datum_params=t.towgs84?t.towgs84.split(","):null,this.ellps=t.ellipse,this.datumName=t.datumName||this.datumCode),this.a||ee.extend(this,ee.Ellipsoid[this.ellps]||ee.Ellipsoid.WGS84),this.rf&&!this.b&&(this.b=(1-1/this.rf)*this.a),Math.abs(this.a-this.b)<ee.common.EPSLN&&(this.sphere=!0,this.b=this.a),this.a2=this.a*this.a,this.b2=this.b*this.b,this.es=(this.a2-this.b2)/this.a2,this.e=Math.sqrt(this.es),this.R_A&&(this.a*=1-this.es*(ee.common.SIXTH+this.es*(ee.common.RA4+this.es*ee.common.RA6)),this.a2=this.a*this.a,this.b2=this.b*this.b,this.es=0),this.ep2=(this.a2-this.b2)/this.b2,this.k0||(this.k0=1),this.axis||(this.axis="enu"),this.datum=new ee.datum(this)}}),ee.Proj.longlat={init:function(){},forward:function(t){return t},inverse:function(t){return t}},ee.Proj.identity=ee.Proj.longlat,ee.defs={WGS84:"+title=long/lat:WGS84 +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees","EPSG:4326":"+title=long/lat:WGS84 +proj=longlat +a=6378137.0 +b=6356752.31424518 +ellps=WGS84 +datum=WGS84 +units=degrees","EPSG:4269":"+title=long/lat:NAD83 +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees","EPSG:3785":"+title= Google Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"},ee.defs.GOOGLE=ee.defs["EPSG:3785"],ee.defs["EPSG:900913"]=ee.defs["EPSG:3785"],ee.defs["EPSG:102113"]=ee.defs["EPSG:3785"],ee.common={PI:3.141592653589793,HALF_PI:1.5707963267948966,TWO_PI:6.283185307179586,FORTPI:.7853981633974483,R2D:57.29577951308232,D2R:.017453292519943295,SEC_TO_RAD:484813681109536e-20,EPSLN:1e-10,MAX_ITER:20,COS_67P5:.3826834323650898,AD_C:1.0026,PJD_UNKNOWN:0,PJD_3PARAM:1,PJD_7PARAM:2,PJD_GRIDSHIFT:3,PJD_WGS84:4,PJD_NODATUM:5,SRS_WGS84_SEMIMAJOR:6378137,SIXTH:.16666666666666666,RA4:.04722222222222222,RA6:.022156084656084655,RV4:.06944444444444445,RV6:.04243827160493827,msfnz:function(t,e,i){return t*=e,i/Math.sqrt(1-t*t)},tsfnz:function(t,e,i){return i*=t,i=Math.pow((1-i)/(1+i),.5*t),Math.tan(.5*(this.HALF_PI-e))/i},phi2z:function(t,e){for(var i,r=.5*t,n=this.HALF_PI-2*Math.atan(e),o=0;o<=15;o++)if(i=t*Math.sin(n),n+=i=this.HALF_PI-2*Math.atan(e*Math.pow((1-i)/(1+i),r))-n,Math.abs(i)<=1e-10)return n;return alert("phi2z has NoConvergence"),-9999},qsfnz:function(t,e){var i;return 1e-7<t?(1-t*t)*(e/(1-(i=t*e)*i)-.5/t*Math.log((1-i)/(1+i))):2*e},asinz:function(t){return 1<Math.abs(t)&&(t=1<t?1:-1),Math.asin(t)},e0fn:function(t){return 1-.25*t*(1+t/16*(3+1.25*t))},e1fn:function(t){return.375*t*(1+.25*t*(1+.46875*t))},e2fn:function(t){return.05859375*t*t*(1+.75*t)},e3fn:function(t){return 35/3072*t*t*t},mlfn:function(t,e,i,r,n){return t*n-e*Math.sin(2*n)+i*Math.sin(4*n)-r*Math.sin(6*n)},srat:function(t,e){return Math.pow((1-t)/(1+t),e)},sign:function(t){return t<0?-1:1},adjust_lon:function(t){return Math.abs(t)<this.PI?t:t-this.sign(t)*this.TWO_PI},adjust_lat:function(t){return Math.abs(t)<this.HALF_PI?t:t-this.sign(t)*this.PI},latiso:function(t,e,i){return Math.abs(e)>this.HALF_PI?+Number.NaN:e==this.HALF_PI?Number.POSITIVE_INFINITY:e==-1*this.HALF_PI?-1*Number.POSITIVE_INFINITY:(i*=t,Math.log(Math.tan((this.HALF_PI+e)/2))+t*Math.log((1-i)/(1+i))/2)},fL:function(t,e){return 2*Math.atan(t*Math.exp(e))-this.HALF_PI},invlatiso:function(t,e){for(var i,r,n=this.fL(1,e);i=n,r=t*Math.sin(i),n=this.fL(Math.exp(t*Math.log((1+r)/(1-r))/2),e),1e-12<Math.abs(n-i););return n},sinh:function(t){return((t=Math.exp(t))-1/t)/2},cosh:function(t){return((t=Math.exp(t))+1/t)/2},tanh:function(t){return((t=Math.exp(t))-1/t)/(t+1/t)},asinh:function(t){return(0<=t?1:-1)*Math.log(Math.abs(t)+Math.sqrt(t*t+1))},acosh:function(t){return 2*Math.log(Math.sqrt((t+1)/2)+Math.sqrt((t-1)/2))},atanh:function(t){return Math.log((t-1)/(t+1))/2},gN:function(t,e,i){return e*=i,t/Math.sqrt(1-e*e)}},ee.datum=ee.Class({initialize:function(t){if(this.datum_type=ee.common.PJD_WGS84,t.datumCode&&"none"==t.datumCode&&(this.datum_type=ee.common.PJD_NODATUM),t&&t.datum_params){for(var e=0;e<t.datum_params.length;e++)t.datum_params[e]=parseFloat(t.datum_params[e]);0==t.datum_params[0]&&0==t.datum_params[1]&&0==t.datum_params[2]||(this.datum_type=ee.common.PJD_3PARAM),3<t.datum_params.length&&(0!=t.datum_params[3]||0!=t.datum_params[4]||0!=t.datum_params[5]||0!=t.datum_params[6])&&(this.datum_type=ee.common.PJD_7PARAM,t.datum_params[3]*=ee.common.SEC_TO_RAD,t.datum_params[4]*=ee.common.SEC_TO_RAD,t.datum_params[5]*=ee.common.SEC_TO_RAD,t.datum_params[6]=t.datum_params[6]/1e6+1)}t&&(this.a=t.a,this.b=t.b,this.es=t.es,this.ep2=t.ep2,this.datum_params=t.datum_params)},compare_datums:function(t){return!(this.datum_type!=t.datum_type||this.a!=t.a||5e-11<Math.abs(this.es-t.es))&&(this.datum_type==ee.common.PJD_3PARAM?this.datum_params[0]==t.datum_params[0]&&this.datum_params[1]==t.datum_params[1]&&this.datum_params[2]==t.datum_params[2]:this.datum_type==ee.common.PJD_7PARAM?this.datum_params[0]==t.datum_params[0]&&this.datum_params[1]==t.datum_params[1]&&this.datum_params[2]==t.datum_params[2]&&this.datum_params[3]==t.datum_params[3]&&this.datum_params[4]==t.datum_params[4]&&this.datum_params[5]==t.datum_params[5]&&this.datum_params[6]==t.datum_params[6]:this.datum_type!=ee.common.PJD_GRIDSHIFT||(alert("ERROR: Grid shift transformations are not implemented yet."),!1))},geodetic_to_geocentric:function(t){var e,i,r,n=t.x,o=t.y,a=t.z||0;if(o<-ee.common.HALF_PI&&o>-1.001*ee.common.HALF_PI)o=-ee.common.HALF_PI;else if(o>ee.common.HALF_PI&&o<1.001*ee.common.HALF_PI)o=ee.common.HALF_PI;else if(o<-ee.common.HALF_PI||o>ee.common.HALF_PI)return ee.reportError("geocent:lat out of range:"+o),null;return n>ee.common.PI&&(n-=2*ee.common.PI),i=Math.sin(o),r=Math.cos(o),o=((e=this.a/Math.sqrt(1-this.es*i*i))+a)*r*Math.cos(n),n=(e+a)*r*Math.sin(n),a=(e*(1-this.es)+a)*i,t.x=o,t.y=n,t.z=a,0},geocentric_to_geodetic:function(t){var e,i,r,n,o,a,s,l=t.x,c=t.y,h=t.z||0,u=Math.sqrt(l*l+c*c),p=Math.sqrt(l*l+c*c+h*h);if(u/this.a<1e-12){if(l=0,p/this.a<1e-12)return}else l=Math.atan2(c,l);for(c=h/p,e=u/p,i=1/Math.sqrt(1-this.es*(2-this.es)*e*e),n=e*(1-this.es)*i,o=c*i,s=0;s++,p=u*n+h*o-(r=this.a/Math.sqrt(1-this.es*o*o))*(1-this.es*o*o),r=e*(1-(r=this.es*r/(r+p)))*(i=1/Math.sqrt(1-r*(2-r)*e*e)),a=(i*=c)*n-r*o,n=r,o=i,1e-24<a*a&&s<30;);return u=Math.atan(i/Math.abs(r)),t.x=l,t.y=u,t.z=p,t},geocentric_to_geodetic_noniter:function(t){var e,i,r,n,o=t.x,a=t.y,s=t.z||0,o=parseFloat(o),a=parseFloat(a),s=parseFloat(s),l=!1;if(0!=o)e=Math.atan2(a,o);else if(0<a)e=ee.common.HALF_PI;else if(a<0)e=-ee.common.HALF_PI;else if(l=!0,(e=0)<s)i=ee.common.HALF_PI;else{if(!(s<0))return;i=-ee.common.HALF_PI}return r=o*o+a*a,o=Math.sqrt(r),a=s*ee.common.AD_C,r=Math.sqrt(a*a+r),a=s+this.b*this.ep2*(a/=r)*a*a,n=o-this.a*this.es*(r=o/r)*r*r,a/=r=Math.sqrt(a*a+n*n),r=n/r,n=this.a/Math.sqrt(1-this.es*a*a),s=r>=ee.common.COS_67P5?o/r-n:r<=-ee.common.COS_67P5?o/-r-n:s/a+n*(this.es-1),0==l&&(i=Math.atan(a/r)),t.x=e,t.y=i,t.z=s,t},geocentric_to_wgs84:function(t){var e,i,r,n,o;this.datum_type==ee.common.PJD_3PARAM?(t.x+=this.datum_params[0],t.y+=this.datum_params[1],t.z+=this.datum_params[2]):this.datum_type==ee.common.PJD_7PARAM&&(o=this.datum_params[3],e=this.datum_params[4],i=this.datum_params[5],n=(r=this.datum_params[6])*(i*t.x+t.y-o*t.z)+this.datum_params[1],o=r*(-e*t.x+o*t.y+t.z)+this.datum_params[2],t.x=r*(t.x-i*t.y+e*t.z)+this.datum_params[0],t.y=n,t.z=o)},geocentric_from_wgs84:function(t){var e,i,r,n,o,a;this.datum_type==ee.common.PJD_3PARAM?(t.x-=this.datum_params[0],t.y-=this.datum_params[1],t.z-=this.datum_params[2]):this.datum_type==ee.common.PJD_7PARAM&&(e=this.datum_params[3],i=this.datum_params[4],r=this.datum_params[5],a=this.datum_params[6],n=(t.x-this.datum_params[0])/a,o=(t.y-this.datum_params[1])/a,a=(t.z-this.datum_params[2])/a,t.x=n+r*o-i*a,t.y=-r*n+o+e*a,t.z=i*n-e*o+a)}}),ee.Point=ee.Class({initialize:function(t,e,i){"object"==typeof t?(this.x=t[0],this.y=t[1],this.z=t[2]||0):"string"==typeof t&&void 0===e?(t=t.split(","),this.x=parseFloat(t[0]),this.y=parseFloat(t[1]),this.z=parseFloat(t[2])||0):(this.x=t,this.y=e,this.z=i||0)},clone:function(){return new ee.Point(this.x,this.y,this.z)},toString:function(){return"x="+this.x+",y="+this.y},toShortString:function(){return this.x+", "+this.y}}),ee.PrimeMeridian={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},ee.Ellipsoid={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},"APL4.":{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS72:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},ee.Datum={WGS84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},GGRS87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},NAD83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},NAD27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},OSGB36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"}},ee.WGS84=new ee.Proj("WGS84"),ee.Datum.OSB36=ee.Datum.OSGB36,ee.wktProjections={"Lambert Tangential Conformal Conic Projection":"lcc",Mercator:"merc","Popular Visualisation Pseudo Mercator":"merc",Transverse_Mercator:"tmerc","Transverse Mercator":"tmerc","Lambert Azimuthal Equal Area":"laea","Universal Transverse Mercator System":"utm"},ee.defs.UTM31="+proj=utm +zone=31 +ellps=WGS84 +units=m +nadgrids=@null +no_defs",ee.defs.UTM40="+proj=utm +zone=40 +ellps=WGS84 +units=m +nadgrids=@null +no_defs",ee.Proj.utm={dependsOn:"tmerc",init:function(){this.zone?(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*ee.common.D2R,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,ee.Proj.tmerc.init.apply(this),this.forward=ee.Proj.tmerc.forward,this.inverse=ee.Proj.tmerc.inverse):ee.reportError("utm:init: zone must be specified for UTM")}},ee.Proj.lcc={init:function(){var t,e,i,r,n,o;this.lat2||(this.lat2=this.lat0),this.k0||(this.k0=1),Math.abs(this.lat1+this.lat2)<ee.common.EPSLN?ee.reportError("lcc:init: Equal Latitudes"):(t=this.b/this.a,this.e=Math.sqrt(1-t*t),t=Math.sin(this.lat1),e=Math.cos(this.lat1),e=ee.common.msfnz(this.e,t,e),i=ee.common.tsfnz(this.e,this.lat1,t),n=Math.sin(this.lat2),r=Math.cos(this.lat2),r=ee.common.msfnz(this.e,n,r),n=ee.common.tsfnz(this.e,this.lat2,n),o=ee.common.tsfnz(this.e,this.lat0,Math.sin(this.lat0)),Math.abs(this.lat1-this.lat2)>ee.common.EPSLN?this.ns=Math.log(e/r)/Math.log(i/n):this.ns=t,this.f0=e/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(o,this.ns),this.title||(this.title="Lambert Conformal Conic"))},forward:function(t){var e=t.x,i=t.y;if(!(i<=90&&-90<=i&&e<=180&&-180<=e))return ee.reportError("lcc:forward: llInputOutOfRange: "+e+" : "+i),null;if(Math.abs(Math.abs(i)-ee.common.HALF_PI)>ee.common.EPSLN)i=ee.common.tsfnz(this.e,i,Math.sin(i)),i=this.a*this.f0*Math.pow(i,this.ns);else{if(i*this.ns<=0)return ee.reportError("lcc:forward: No Projection"),null;i=0}return e=this.ns*ee.common.adjust_lon(e-this.long0),t.x=this.k0*i*Math.sin(e)+this.x0,t.y=this.k0*(this.rh-i*Math.cos(e))+this.y0,t},inverse:function(t){var e,i=(t.x-this.x0)/this.k0,r=this.rh-(t.y-this.y0)/this.k0,n=0<this.ns?(e=Math.sqrt(i*i+r*r),1):(e=-Math.sqrt(i*i+r*r),-1),o=0;if(0!=e&&(o=Math.atan2(n*i,n*r)),0!=e||0<this.ns){if(n=1/this.ns,e=Math.pow(e/(this.a*this.f0),n),-9999==(e=ee.common.phi2z(this.e,e)))return null}else e=-ee.common.HALF_PI;return o=ee.common.adjust_lon(o/this.ns+this.long0),t.x=o,t.y=e,t}},ee.Proj.tmerc={init:function(){this.e0=ee.common.e0fn(this.es),this.e1=ee.common.e1fn(this.es),this.e2=ee.common.e2fn(this.es),this.e3=ee.common.e3fn(this.es),this.ml0=this.a*ee.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e=t.y,i=ee.common.adjust_lon(t.x-this.long0);s=Math.sin(e);var r=Math.cos(e);if(this.sphere){var n=r*Math.sin(i);if(Math.abs(Math.abs(n)-1)<1e-10)return ee.reportError("tmerc:forward: Point projects into infinity"),93;o=.5*this.a*this.k0*Math.log((1+n)/(1-n)),s=Math.acos(r*Math.cos(i)/Math.sqrt(1-n*n)),e=this.a*this.k0*((s=e<0?-s:s)-this.lat0)}else{var o=r*i,i=Math.pow(o,2),r=this.ep2*Math.pow(r,2),n=Math.tan(e),a=Math.pow(n,2),s=1-this.es*Math.pow(s,2);s=this.a/Math.sqrt(s),e=this.a*ee.common.mlfn(this.e0,this.e1,this.e2,this.e3,e),o=this.k0*s*o*(1+i/6*(1-a+r+i/20*(5-18*a+Math.pow(a,2)+72*r-58*this.ep2)))+this.x0,e=this.k0*(e-this.ml0+s*n*i*(.5+i/24*(5-a+9*r+4*Math.pow(r,2)+i/30*(61-58*a+Math.pow(a,2)+600*r-330*this.ep2))))+this.y0}return t.x=o,t.y=e,t},inverse:function(t){if(this.sphere){var e,i=.5*((e=Math.exp(t.x/(this.a*this.k0)))-1/e),r=this.lat0+t.y/(this.a*this.k0),n=Math.cos(r),o=Math.sqrt((1-n*n)/(1+i*i));e=ee.common.asinz(o),r<0&&(e=-e),o=0==i&&0==n?this.long0:ee.common.adjust_lon(Math.atan2(i,n)+this.long0)}else{var a,s,l,c,i=t.x-this.x0,h=t.y-this.y0;for(e=o=(this.ml0+h/this.k0)/this.a,n=0;e+=r=(o+this.e1*Math.sin(2*e)-this.e2*Math.sin(4*e)+this.e3*Math.sin(6*e))/this.e0-e,!(Math.abs(r)<=ee.common.EPSLN);n++)if(6<=n)return ee.reportError("tmerc:inverse: Latitude failed to converge"),95;o=Math.abs(e)<ee.common.HALF_PI?(o=Math.sin(e),r=Math.cos(e),c=Math.tan(e),n=this.ep2*Math.pow(r,2),h=Math.pow(n,2),a=Math.pow(c,2),s=Math.pow(a,2),o=1-this.es*Math.pow(o,2),o=(l=this.a/Math.sqrt(o))*(1-this.es)/o,i/=l*this.k0,e-=l*c*(c=Math.pow(i,2))/o*(.5-c/24*(5+3*a+10*n-4*h-9*this.ep2-c/30*(61+90*a+298*n+45*s-252*this.ep2-3*h))),ee.common.adjust_lon(this.long0+i*(1-c/6*(1+2*a+n-c/20*(5-2*n+28*a-3*h+8*this.ep2+24*s)))/r)):(e=ee.common.HALF_PI*ee.common.sign(h),this.long0)}return t.x=o,t.y=e,t}},ee.Proj.somerc={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,r=2*(r=1/this.rf)-Math.pow(r,2),n=this.e=Math.sqrt(r);this.R=this.k0*i*Math.sqrt(1-r)/(1-r*Math.pow(e,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha),this.K=Math.log(Math.tan(Math.PI/4+this.b0/2))-this.alpha*Math.log(Math.tan(Math.PI/4+t/2))+this.alpha*n/2*Math.log((1+n*e)/(1-n*e))},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),i=2*(Math.atan(Math.exp(-this.alpha*(e+i)+this.K))-Math.PI/4),r=this.alpha*(t.x-this.lambda0),e=Math.atan(Math.sin(r)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(r))),i=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(r));return t.y=this.R/2*Math.log((1+Math.sin(i))/(1-Math.sin(i)))+this.y0,t.x=this.R*e+this.x0,t},inverse:function(t){for(var e=(t.x-this.x0)/this.R,i=2*(Math.atan(Math.exp((t.y-this.y0)/this.R))-Math.PI/4),r=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(e)),e=Math.atan(Math.sin(e)/(Math.cos(this.b0)*Math.cos(e)-Math.sin(this.b0)*Math.tan(i))),e=this.lambda0+e/this.alpha,n=r,o=-1e3,a=0;1e-7<Math.abs(n-o);){if(20<++a)return void ee.reportError("omercFwdInfinity");i=1/this.alpha*(Math.log(Math.tan(Math.PI/4+r/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(n))/2)),o=n,n=2*Math.atan(Math.exp(i))-Math.PI/2}return t.x=e,t.y=n,t}},mt("com/visioglobe/web/helpers/StringUtils",[],function(){function t(){}return t.ucfirst=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},t}),mt("com/visioglobe/web/helpers/MathUtils",[],function(){function u(){}return u.sign=function(t){return 0===t?0:0<t?1:-1},u.easeIn=function(t){return 1<t?1:t<0?0:1-Math.sin(Math.sqrt(1-t)*u.PI_2)},u.easeOut=function(t){return 1<t?1:t<0?0:Math.sin(Math.sqrt(t)*u.PI_2)},u.easeInOut=function(t){return 1<t?1:t<0?0:(t=Math.sin(t*u.PI_2))*t},u.isInside2D=function(t,e){for(var i=t.x,r=t.y,n=!1,o=0,a=e.length-1;o<e.length;a=o++){var s=e[o].x,l=e[o].y,c=e[a].x;r<l!=r<(a=e[a].y)&&i<(c-s)*(r-l)/(a-l)+s&&(n=!n)}return n},u.dot=function(t,e){return t.x*e.x+t.y*e.y},u.squareDistanceToSegment=function(t,e){var i={x:e.end.x-e.start.x,y:e.end.y-e.start.y},r={x:t.x-e.start.x,y:t.y-e.start.y};if((o=u.dot(r,i))<=0)return{squareDistance:u.dot(r,r),closestPoint:e.start};if((n=u.dot(i,i))<=o)return r={x:t.x-e.end.x,y:t.y-e.end.y},{squareDistance:u.dot(r,r),closestPoint:e.end};var t=Math.sqrt(n),n=i.x/t,i=i.y/t,o=o/t;return{squareDistance:u.dot(r,r)-o*o,closestPoint:{x:e.start.x+o*n,y:e.start.y+o*i}}},u.projectPointToPolygon=function(t,e){if(e.length<3||u.isInside2D(t,e))return t;for(var i=1e9,r=e[0],n=0;n<e.length-1;n++){var o=e[n],a=e[n+1],s=o.x-t.x,l=o.y-t.y,c=a.x-t.x,h=a.y-t.y;i<=s*s&&i<=c*c&&0<s*c||i<=l*l&&i<=h*h&&0<l*h||(o=u.squareDistanceToSegment(t,{start:o,end:a})).squareDistance<i&&(i=o.squareDistance,r=o.closestPoint)}return r},u.DEG2RAD=Math.PI/180,u.RAD2DEG=180/Math.PI,u.TWOPI=2*Math.PI,u.PI_2=Math.PI/2,u}),_=function(){return function r(n,o,a){function s(i,t){if(!o[i]){if(!n[i]){var e="function"==typeof _dereq_&&_dereq_;if(!t&&e)return e(i,!0);if(l)return l(i,!0);throw(e=Error("Cannot find module '"+i+"'")).code="MODULE_NOT_FOUND",e}e=o[i]={exports:{}},n[i][0].call(e.exports,function(t){var e=n[i][1][t];return s(e||t)},e,e.exports,r,n,o,a)}return o[i].exports}for(var l="function"==typeof _dereq_&&_dereq_,t=0;t<a.length;t++)s(a[t]);return s}({1:[function(t,e,i){e.exports=function(t){function e(t){var e=(t=new i(t)).promise();return t.setHowMany(1),t.setUnwrap(),t.init(),e}var i=t._SomePromiseArray;t.any=e,t.prototype.any=function(){return e(this)}}},{}],2:[function(t,e,i){function r(){this._isTickUsed=this._customScheduler=!1,this._lateQueue=new l(16),this._normalQueue=new l(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=s}function n(t,e,i){this._lateQueue.push(t,e,i),this._queueTick()}function o(t,e,i){this._normalQueue.push(t,e,i),this._queueTick()}function a(t){this._normalQueue._pushOne(t),this._queueTick()}try{throw Error()}catch(t){i=t}var s=t("./schedule"),l=t("./queue"),c=t("./util");r.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},r.prototype.hasCustomScheduler=function(){return this._customScheduler},r.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},r.prototype.disableTrampolineIfNecessary=function(){c.hasDevTools&&(this._trampolineEnabled=!1)},r.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},r.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),process.exit(2)):this.throwLater(t)},r.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(t){throw Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},c.hasDevTools?(r.prototype.invokeLater=function(t,e,i){this._trampolineEnabled?n.call(this,t,e,i):this._schedule(function(){setTimeout(function(){t.call(e,i)},100)})},r.prototype.invoke=function(t,e,i){this._trampolineEnabled?o.call(this,t,e,i):this._schedule(function(){t.call(e,i)})},r.prototype.settlePromises=function(t){this._trampolineEnabled?a.call(this,t):this._schedule(function(){t._settlePromises()})}):(r.prototype.invokeLater=n,r.prototype.invoke=o,r.prototype.settlePromises=a),r.prototype._drainQueue=function(t){for(;0<t.length();){var e,i,r=t.shift();"function"==typeof r?(e=t.shift(),i=t.shift(),r.call(e,i)):r._settlePromises()}},r.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},r.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},r.prototype._reset=function(){this._isTickUsed=!1},e.exports=r,e.exports.firstLineError=i},{"./queue":26,"./schedule":29,"./util":36}],3:[function(t,e,i){e.exports=function(n,o,a,s){function i(t,e){this._reject(e)}function l(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(i,i,null,this,t)}function c(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)}function h(t,e){e.promiseRejectionQueued||this._reject(t)}var u=!1;n.prototype.bind=function(t){u||(u=!0,n.prototype._propagateFrom=s.propagateFromFunction(),n.prototype._boundValue=s.boundValueFunction()),t=a(t);var e=new n(o);e._propagateFrom(this,1);var i,r=this._target();return e._setBoundTo(t),t instanceof n?(r._then(o,l,void 0,e,i={promiseRejectionQueued:!1,promise:e,target:r,bindingPromise:t}),t._then(c,h,void 0,e,i),e._setOnCancel(t)):e._resolveCallback(r),e},n.prototype._setBoundTo=function(t){void 0!==t?(this._bitField|=2097152,this._boundTo=t):this._bitField&=-2097153},n.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},n.bind=function(t,e){return n.resolve(e).bind(t)}}},{}],4:[function(t,e,i){var r;"undefined"!=typeof Promise&&(r=Promise);var n=t("./promise")();n.noConflict=function(){try{Promise===n&&(Promise=r)}catch(t){}return n},e.exports=n},{"./promise":22}],5:[function(t,e,i){var r=Object.create;r&&(i=r(null),r=r(null),i[" size"]=r[" size"]=0),e.exports=function(r){function i(t){var e,i=this.pop();if("function"!=typeof(e=null!=t?t[i]:e))throw t="Object "+a.classString(t)+" has no method '"+a.toString(i)+"'",new r.TypeError(t);return e.apply(t,this)}function n(t){return t[this]}function o(t){var e=+this;return t[e=e<0?Math.max(0,e+t.length):e]}var a=t("./util"),s=a.canEvaluate;a.isIdentifier,r.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(i,void 0,void 0,e,void 0)},r.prototype.get=function(t){var e="number"==typeof t?o:s?null!==(e=(void 0)(t))?e:n:n;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(l,t,e){t.exports=function(t,e,i,r){var n=l("./util"),o=n.tryCatch,a=n.errorObj,s=t._async;t.prototype.break=t.prototype.cancel=function(){if(!r.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var i=t._cancellationParent;if(null==i||!i._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=i}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),s.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){0<this._length()&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(t,e){if(n.isArray(t))for(var i=0;i<t.length;++i)this._doInvokeOnCancel(t[i],e);else void 0!==t&&("function"==typeof t?e||(i=o(t).call(this._boundValue()))===a&&(this._attachExtraTrace(i.e),s.throwLater(i.e)):t._resultCancelled(this))},t.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),s.invoke(this._doInvokeOnCancel,this,t)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,i){e.exports=function(h){var u=t("./util"),p=t("./es5").keys,d=u.tryCatch,f=u.errorObj;return function(s,l,c){return function(t){var e=c._boundValue(),i=0;t:for(;i<s.length;++i){var r=s[i];if(r===Error||null!=r&&r.prototype instanceof Error){if(t instanceof r)return d(l).call(e,t)}else if("function"==typeof r){if((r=d(r).call(e,t))===f)return r;if(r)return d(l).call(e,t)}else if(u.isObject(t)){for(var n=p(r),o=0;o<n.length;++o){var a=n[o];if(r[a]!=t[a])continue t}return d(l).call(e,t)}}return h}}}},{"./es5":13,"./util":36}],8:[function(t,e,i){e.exports=function(o){function a(){this._trace=new a.CapturedTrace(s())}function s(){var t=i.length-1;return 0<=t?i[t]:void 0}var l=!1,i=[];return o.prototype._promiseCreated=function(){},o.prototype._pushContext=function(){},o.prototype._popContext=function(){return null},o._peekContext=o.prototype._peekContext=function(){},a.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,i.push(this._trace))},a.prototype._popContext=function(){if(void 0===this._trace)return null;var t=i.pop(),e=t._promiseCreated;return t._promiseCreated=null,e},a.CapturedTrace=null,a.create=function(){return l?new a:void 0},a.deactivateLongStackTraces=function(){},a.activateLongStackTraces=function(){var t=o.prototype._pushContext,e=o.prototype._popContext,i=o._peekContext,r=o.prototype._peekContext,n=o.prototype._promiseCreated;a.deactivateLongStackTraces=function(){o.prototype._pushContext=t,o.prototype._popContext=e,o._peekContext=i,o.prototype._peekContext=r,o.prototype._promiseCreated=n,l=!1},l=!0,o.prototype._pushContext=a.prototype._pushContext,o.prototype._popContext=a.prototype._popContext,o._peekContext=o.prototype._peekContext=s,o.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},a}},{}],9:[function(K,t,e){t.exports=function(n,i){function t(t,e){return{promise:e}}function r(){return!1}function o(t,e,i){var r=this;try{t(e,i,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+T.toString(t));r._attachCancellationCallback(t)})}catch(t){return t}}function a(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?T.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function s(){return this._onCancelField}function l(t){this._onCancelField=t}function c(){this._onCancelField=this._cancellationParent=void 0}function h(t,e){var i;0!=(1&e)&&(i=(this._cancellationParent=t)._branchesRemainingToCancel,t._branchesRemainingToCancel=(i=void 0===i?0:i)+1),0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function e(){var t=this._boundTo;return void 0!==t&&t instanceof n?t.isFulfilled()?t.value():void 0:t}function u(){this._trace=new w(this._peekContext())}function p(t,e){var i;C(t)&&(void 0!==(i=void 0!==(i=this._trace)&&e?i._parent:i)?i.attachExtraTrace(t):t.__stackCleaned__||(i=m(t),T.notEnumerableProp(t,"stack",i.message+"\n"+i.stack.join("\n")),T.notEnumerableProp(t,"__stackCleaned__",!0)))}function d(t,e,i){var r;Y.warnings&&(t=new P(t),e?i._attachExtraTrace(t):Y.longStackTraces&&(r=n._peekContext())?r.attachExtraTrace(t):(e=m(t),t.stack=e.message+"\n"+e.stack.join("\n")),H("warning",t)||g(t,"",!0))}function f(t){for(var e=[],i=0;i<t.length;++i){var r=t[i],n="    (No stack trace)"===r||I.test(r),o=n&&W(r);n&&!o&&(F&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function m(t){var e=t.stack,i=t.toString();if("string"==typeof e&&0<e.length){for(var r=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<r.length;++n){var o=r[n];if("    (No stack trace)"===o||I.test(o))break}n=r=0<n&&"SyntaxError"!=t.name?r.slice(n):r}else n=["    (No stack trace)"];return e=n,{message:i,stack:"SyntaxError"==t.name?e:f(e)}}function g(t,e,i){"undefined"!=typeof console&&(t=T.isObject(t)?e+D(t.stack,t):e+String(t),"function"==typeof A?A(t,i):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(t))}function v(t,e,i,r){var n=!1;try{"function"==typeof e&&(n=!0,"rejectionHandled"===t?e(r):e(i,r))}catch(t){S.throwLater(t)}"unhandledRejection"===t?H(t,i,r)||n||g(i,"Unhandled rejection "):H(t,r)}function y(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{if(e=t&&"function"==typeof t.toString?t.toString():T.toString(t),/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+(e.length<41?e:e.substr(0,38)+"...")+">, no stack trace)"}function b(){return"function"==typeof q}function x(t){return(t=t.match(X))?{fileName:t[1],line:parseInt(t[2],10)}:void 0}function w(t){this._parent=t,this._promisesCreated=0,t=this._length=1+(void 0===t?0:t._length),q(this,w),32<t&&this.uncycle()}var M,_,A,E=n._getDomain,S=n._async,P=K("./errors").Warning,T=K("./util"),C=T.canAttachTrace,O=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,R=/\((?:timers\.js):\d+:\d+\)/,L=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,I=null,D=null,F=!1,j=!(0==T.env("BLUEBIRD_DEBUG")||!T.env("BLUEBIRD_DEBUG")&&"development"!==T.env("NODE_ENV")),N=!(0==T.env("BLUEBIRD_WARNINGS")||!j&&!T.env("BLUEBIRD_WARNINGS")),j=!(0==T.env("BLUEBIRD_LONG_STACK_TRACES")||!j&&!T.env("BLUEBIRD_LONG_STACK_TRACES")),k=0!=T.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(N||!!T.env("BLUEBIRD_W_FORGOTTEN_RETURN"));n.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},n.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),S.invokeLater(this._notifyUnhandledRejection,this,void 0))},n.prototype._notifyUnhandledRejectionIsHandled=function(){v("rejectionHandled",M,void 0,this)},n.prototype._setReturnedNonUndefined=function(){this._bitField|=268435456},n.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},n.prototype._notifyUnhandledRejection=function(){var t;this._isRejectionUnhandled()&&(t=this._settledValue(),this._setUnhandledRejectionIsNotified(),v("unhandledRejection",_,t,this))},n.prototype._setUnhandledRejectionIsNotified=function(){this._bitField|=262144},n.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField&=-262145},n.prototype._isUnhandledRejectionNotified=function(){return 0<(262144&this._bitField)},n.prototype._setRejectionIsUnhandled=function(){this._bitField|=1048576},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField&=-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},n.prototype._isRejectionUnhandled=function(){return 0<(1048576&this._bitField)},n.prototype._warn=function(t,e,i){return d(t,e,i||this)},n.onPossiblyUnhandledRejection=function(t){var e=E();_="function"==typeof t?null===e?t:T.domainBind(e,t):void 0},n.onUnhandledRejectionHandled=function(t){var e=E();M="function"==typeof t?null===e?t:T.domainBind(e,t):void 0};var z=function(){};n.longStackTraces=function(){if(S.haveItemsQueued()&&!Y.longStackTraces)throw Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");var t,e;!Y.longStackTraces&&b()&&(t=n.prototype._captureStackTrace,e=n.prototype._attachExtraTrace,Y.longStackTraces=!0,z=function(){if(S.haveItemsQueued()&&!Y.longStackTraces)throw Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");n.prototype._captureStackTrace=t,n.prototype._attachExtraTrace=e,i.deactivateLongStackTraces(),S.enableTrampoline(),Y.longStackTraces=!1},n.prototype._captureStackTrace=u,n.prototype._attachExtraTrace=p,i.activateLongStackTraces(),S.disableTrampolineIfNecessary())},n.hasLongStackTraces=function(){return Y.longStackTraces&&b()};var U=function(){try{if("function"!=typeof CustomEvent)return"function"==typeof Event?(t=new Event("CustomEvent"),T.global.dispatchEvent(t),function(t,e){t=new Event(t.toLowerCase(),{cancelable:!0});return t.detail=e,!T.global.dispatchEvent(t)}):((t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),T.global.dispatchEvent(t),function(t,e){var i=document.createEvent("CustomEvent");return i.initCustomEvent(t.toLowerCase(),!1,!0,e),!T.global.dispatchEvent(i)});var t=new CustomEvent("CustomEvent");return T.global.dispatchEvent(t),function(t,e){e=new CustomEvent(t.toLowerCase(),{detail:e,cancelable:!0});return!T.global.dispatchEvent(e)}}catch(t){}return function(){return!1}}(),V=T.isNode?function(){return process.emit.apply(process,arguments)}:T.global?function(t){var e="on"+t.toLowerCase();return!!(e=T.global[e])&&(e.apply(T.global,[].slice.call(arguments,1)),!0)}:function(){return!1},B={promiseCreated:t,promiseFulfilled:t,promiseRejected:t,promiseResolved:t,promiseCancelled:t,promiseChained:function(t,e,i){return{promise:e,child:i}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,i){return{reason:e,promise:i}},rejectionHandled:t},H=function(t){var e=!1;try{e=V.apply(null,arguments)}catch(t){S.throwLater(t),e=!0}var i=!1;try{i=U(t,B[t].apply(null,arguments))}catch(t){S.throwLater(t),i=!0}return i||e};n.config=function(t){var e;if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?n.longStackTraces():!t.longStackTraces&&n.hasLongStackTraces()&&z()),"warnings"in t&&(e=t.warnings,Y.warnings=!!e,k=Y.warnings,T.isObject(e)&&"wForgottenReturn"in e&&(k=!!e.wForgottenReturn)),"cancellation"in t&&t.cancellation&&!Y.cancellation){if(S.haveItemsQueued())throw Error("cannot enable cancellation after promises are in use");n.prototype._clearCancellationData=c,n.prototype._propagateFrom=h,n.prototype._onCancel=s,n.prototype._setOnCancel=l,n.prototype._attachCancellationCallback=a,n.prototype._execute=o,G=h,Y.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!Y.monitoring?(Y.monitoring=!0,n.prototype._fireEvent=H):!t.monitoring&&Y.monitoring&&(Y.monitoring=!1,n.prototype._fireEvent=r)),n},n.prototype._fireEvent=r,n.prototype._execute=function(t,e,i){try{t(e,i)}catch(t){return t}},n.prototype._onCancel=function(){},n.prototype._setOnCancel=function(t){},n.prototype._attachCancellationCallback=function(t){},n.prototype._captureStackTrace=function(){},n.prototype._attachExtraTrace=function(){},n.prototype._clearCancellationData=function(){},n.prototype._propagateFrom=function(t,e){};var G=function(t,e){0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)},W=function(){return!1},X=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;T.inherits(w,Error),(i.CapturedTrace=w).prototype.uncycle=function(){if(!((r=this._length)<2)){for(var t=[],e={},i=0,r=this;void 0!==r;++i)t.push(r),r=r._parent;for(i=(r=this._length=i)-1;0<=i;--i){var n=t[i].stack;void 0===e[n]&&(e[n]=i)}for(i=0;i<r;++i)if(void 0!==(n=e[t[i].stack])&&n!==i){for(0<n&&(t[n-1]._parent=void 0,t[n-1]._length=1),t[i]._parent=void 0,t[i]._length=1,e=0<i?t[i-1]:this,n<r-1?(e._parent=t[n+1],e._parent.uncycle(),e._length=e._parent._length+1):(e._parent=void 0,e._length=1),r=e._length+1,i-=2;0<=i;--i)t[i]._length=r,r++;break}}},w.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=(i=m(t)).message,i=[i.stack],r=this;void 0!==r;)i.push(f(r.stack.split("\n"))),r=r._parent;for(var r=i[0],n=1;n<i.length;++n){for(var o=i[n],a=r.length-1,s=r[a],l=-1,c=o.length-1;0<=c;--c)if(o[c]===s){l=c;break}for(c=l;0<=c&&r[a]===o[c];--c)r.pop(),a--;r=o}for(r=0;r<i.length;++r)(0===i[r].length||r+1<i.length&&i[r][0]===i[r+1][0])&&(i.splice(r,1),r--);T.notEnumerableProp(t,"stack",function(t,e){for(var i=0;i<e.length-1;++i)e[i].push("From previous event:"),e[i]=e[i].join("\n");return i<e.length&&(e[i]=e[i].join("\n")),t+"\n"+e.join("\n")}(e,i)),T.notEnumerableProp(t,"__stackCleaned__",!0)}};var q=function(){function t(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():y(e)}var e=/^\s*at\s*/;if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,I=e,D=t;var i=Error.captureStackTrace;return W=function(t){return O.test(t)},function(t,e){Error.stackTraceLimit+=6,i(t,e),Error.stackTraceLimit-=6}}var r,n=Error();if("string"==typeof n.stack&&0<=n.stack.split("\n")[0].indexOf("stackDetection@"))return I=/@/,D=t,F=!0,function(t){t.stack=Error().stack};try{throw Error()}catch(t){r="stack"in t}return"stack"in n||!r||"number"!=typeof Error.stackTraceLimit?(D=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?y(e):e.toString()},null):(I=e,D=t,function(e){Error.stackTraceLimit+=6;try{throw Error()}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(A=function(t){console.warn(t)},T.isNode&&process.stderr.isTTY?A=function(t,e){console.warn((e?"[33m":"[31m")+t+"[0m\n")}:T.isNode||"string"!=typeof Error().stack||(A=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var Y={warnings:N,longStackTraces:!1,cancellation:!1,monitoring:!1};return j&&n.longStackTraces(),{longStackTraces:function(){return Y.longStackTraces},warnings:function(){return Y.warnings},cancellation:function(){return Y.cancellation},monitoring:function(){return Y.monitoring},propagateFromFunction:function(){return G},boundValueFunction:function(){return e},checkForgottenReturns:function(t,e,i,r,n){if(void 0===t&&null!==e&&k&&(void 0===n||!n._returnedNonUndefined())&&0!=(65535&r._bitField)){if(i&&(i+=" "),n=t="",e._trace){for(var o=e._trace.stack.split("\n"),a=f(o),s=a.length-1;0<=s;--s){var l=a[s];if(!R.test(l)){(s=l.match(L))&&(t="at "+s[1]+":"+s[2]+":"+s[3]+" ");break}}if(0<a.length)for(a=a[0],s=0;s<o.length;++s)if(o[s]===a){0<s&&(n="\n"+o[s-1]);break}}r._warn("a promise was created in a "+i+"handler "+t+"but was not returned from it, see http://goo.gl/rRqMUw"+n,!0,e)}},setBounds:function(t,e){if(b()){for(var i,r,n=t.stack.split("\n"),o=e.stack.split("\n"),a=-1,s=-1,l=0;l<n.length;++l){var c=x(n[l]);if(c){i=c.fileName,a=c.line;break}}for(l=0;l<o.length;++l)if(c=x(o[l])){r=c.fileName,s=c.line;break}a<0||s<0||!i||!r||i!==r||s<=a||(W=function(t){return!!O.test(t)||!!((t=x(t))&&t.fileName===i&&a<=t.line&&t.line<=s)})}},warn:d,deprecated:function(t,e){t+=" is deprecated and will be removed in a future version.";return e&&(t+=" Use "+e+" instead."),d(t)},CapturedTrace:w,fireDomEvent:U,fireGlobalEvent:V}}},{"./errors":12,"./util":36}],10:[function(t,e,i){e.exports=function(i){function r(){return this.value}function n(){throw this.reason}i.prototype.return=i.prototype.thenReturn=function(t){return t instanceof i&&t.suppressUnhandledRejections(),this._then(r,void 0,void 0,{value:t},void 0)},i.prototype.throw=i.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},i.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1];return this.caught(t,function(){throw e})},i.prototype.catchReturn=function(t){if(arguments.length<=1)return t instanceof i&&t.suppressUnhandledRejections(),this._then(void 0,r,void 0,{value:t},void 0);var e=arguments[1];return e instanceof i&&e.suppressUnhandledRejections(),this.caught(t,function(){return e})}}},{}],11:[function(t,e,i){e.exports=function(t,i){function r(){return e(this)}var n=t.reduce,e=t.all;t.prototype.each=function(t){return n(this,t,i,0)._then(r,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return n(this,t,i,i)},t.each=function(t,e){return n(t,e,i,0)._then(r,void 0,void 0,t,void 0)},t.mapSeries=function(t,e){return n(t,e,i,i)}}},{}],12:[function(t,e,i){function r(e,i){function r(t){return this instanceof r?(c(this,"message","string"==typeof t?t:i),c(this,"name",e),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new r(t)}return l(r,Error),r}function n(t){return this instanceof n?(c(this,"name","OperationalError"),c(this,"message",t),this.cause=t,this.isOperational=!0,void(t instanceof Error?(c(this,"message",t.message),c(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new n(t)}var o,a,s=(i=t("./es5")).freeze,l=(t=t("./util")).inherits,c=t.notEnumerableProp;t=r("Warning","warning");var h=r("CancellationError","cancellation error"),u=r("TimeoutError","timeout error"),p=r("AggregateError","aggregate error");try{o=TypeError,a=RangeError}catch(t){o=r("TypeError","type error"),a=r("RangeError","range error")}for(var d="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),f=0;f<d.length;++f)"function"==typeof Array.prototype[d[f]]&&(p.prototype[d[f]]=Array.prototype[d[f]]);i.defineProperty(p.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),p.prototype.isOperational=!0;var m=0;p.prototype.toString=function(){var t="\n"+(e=Array(4*m+1).join(" "))+"AggregateError of:\n";m++;for(var e=Array(4*m+1).join(" "),i=0;i<this.length;++i){for(var r=(r=this[i]===this?"[Circular AggregateError]":this[i]+"").split("\n"),n=0;n<r.length;++n)r[n]=e+r[n];t+=(r=r.join("\n"))+"\n"}return m--,t},l(n,Error),(d=Error.__BluebirdErrorTypes__)||(d=s({CancellationError:h,TimeoutError:u,OperationalError:n,RejectionError:n,AggregateError:p}),i.defineProperty(Error,"__BluebirdErrorTypes__",{value:d,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:o,RangeError:a,CancellationError:d.CancellationError,OperationalError:d.OperationalError,TimeoutError:d.TimeoutError,AggregateError:d.AggregateError,Warning:t}},{"./es5":13,"./util":36}],13:[function(t,e,i){var r,n,o;(t=function(){return void 0===this}())?e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:t,propertyIsWritable:function(t,e){e=Object.getOwnPropertyDescriptor(t,e);return!(e&&!e.writable&&!e.set)}}:(r={}.hasOwnProperty,n={}.toString,o={}.constructor.prototype,i=function(t){var e,i=[];for(e in t)r.call(t,e)&&i.push(e);return i},e.exports={isArray:function(t){try{return"[object Array]"===n.call(t)}catch(t){return!1}},keys:i,names:i,defineProperty:function(t,e,i){return t[e]=i.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return o}},isES5:t,propertyIsWritable:function(){return!0}})},{}],14:[function(t,e,i){e.exports=function(t,r){var n=t.map;t.prototype.filter=function(t,e){return n(this,t,e,r)},t.filter=function(t,e,i){return n(t,e,i,r)}}},{}],15:[function(t,e,i){e.exports=function(a,r,n){function o(t,e,i){this.promise=t,this.type=e,this.handler=i,this.called=!1,this.cancelPromise=null}function s(t){this.finallyHandler=t}function l(t,e){return null!=t.cancelPromise&&(1<arguments.length?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,1)}function c(){return u.call(this,this.promise._target()._settledValue())}function h(t){return l(this,t)?void 0:(f.e=t,f)}function u(t){var e=this.promise,i=this.handler;if(!this.called){if(this.called=!0,(i=this.isFinallyHandler()?i.call(e._boundValue()):i.call(e._boundValue(),t))===n)return i;if(void 0!==i&&(e._setReturnedNonUndefined(),(i=r(i,e))instanceof a)){if(null!=this.cancelPromise){if(i._isCancelled())return t=new d("late cancellation observer"),e._attachExtraTrace(t),f.e=t,f;i.isPending()&&i._attachCancellationCallback(new s(this))}return i._then(c,h,void 0,this,void 0)}}return e.isRejected()?(l(this),f.e=t,f):(l(this),t)}var p=t("./util"),d=a.CancellationError,f=p.errorObj,m=t("./catch_filter")(n);return o.prototype.isFinallyHandler=function(){return 0===this.type},s.prototype._resultCancelled=function(){l(this.finallyHandler)},a.prototype._passThrough=function(t,e,i,r){return"function"!=typeof t?this.then():this._then(i,r,void 0,new o(this,e,t),void 0)},a.prototype.lastly=a.prototype.finally=function(t){return this._passThrough(t,0,u,u)},a.prototype.tap=function(t){return this._passThrough(t,1,u)},a.prototype.tapCatch=function(t){var e=arguments.length;if(1===e)return this._passThrough(t,1,void 0,u);for(var i=Array(e-1),r=0,n=0;n<e-1;++n){var o=arguments[n];if(!p.isObject(o))return a.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+p.classString(o)));i[r++]=o}return i.length=r,this._passThrough(m(i,arguments[n],this),1,void 0,u)},o}},{"./catch_filter":7,"./util":36}],16:[function(r,t,e){t.exports=function(s,i,a,l,t,c){function h(t,e,i,r){var n,o;c.cancellation()?(n=new s(a),o=this._finallyPromise=new s(a),this._promise=n.lastly(function(){return o}),n._captureStackTrace(),n._setOnCancel(this)):(this._promise=new s(a))._captureStackTrace(),this._stack=r,this._generatorFunction=t,this._receiver=e,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(f):f,this._yieldedPromise=null,this._cancellationPhase=!1}var u=r("./errors").TypeError,e=r("./util"),p=e.errorObj,d=e.tryCatch,f=[];e.inherits(h,t),h.prototype._isResolved=function(){return null===this._promise},h.prototype._cleanup=function(){this._promise=this._generator=null,c.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},h.prototype._promiseCancelled=function(){var t;this._isResolved()||(t=void 0!==this._generator.return?(this._promise._pushContext(),d(this._generator.return).call(this._generator,void 0)):(t=new s.CancellationError("generator .return() sentinel"),s.coroutine.returnSentinel=t,this._promise._attachExtraTrace(t),this._promise._pushContext(),d(this._generator.throw).call(this._generator,t)),this._promise._popContext(),this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t))},h.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext(),t=d(this._generator.next).call(this._generator,t),this._promise._popContext(),this._continue(t)},h.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext(),t=d(this._generator.throw).call(this._generator,t),this._promise._popContext(),this._continue(t)},h.prototype._resultCancelled=function(){var t;this._yieldedPromise instanceof s&&(t=this._yieldedPromise,this._yieldedPromise=null,t.cancel())},h.prototype.promise=function(){return this._promise},h.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},h.prototype._continue=function(t){var e=this._promise;if(t===p)return this._cleanup(),this._cancellationPhase?e.cancel():e._rejectCallback(t.e,!1);var i=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?e.cancel():e._resolveCallback(i);if(e=!((t=l(i,this._promise))instanceof s)){t:{for(var r=t,n=this._yieldHandlers,e=this._promise,o=0;o<n.length;++o){e._pushContext();var a=d(n[o])(r);if(e._popContext(),a===p){e._pushContext(),r=s.reject(p.e),e._popContext(),e=r;break t}if((a=l(a,e))instanceof s){e=a;break t}}e=null}e=null===(t=e)}e?this._promiseRejected(new u("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(i))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n"))):0==(50397184&(i=(t=t._target())._bitField))?(this._yieldedPromise=t)._proxy(this,null):0!=(33554432&i)?s._async.invoke(this._promiseFulfilled,this,t._value()):0!=(16777216&i)?s._async.invoke(this._promiseRejected,this,t._reason()):this._promiseCancelled()},s.coroutine=function(r,t){if("function"!=typeof r)throw new u("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(t).yieldHandler,o=Error().stack;return function(){var t=r.apply(this,arguments),e=new h(void 0,void 0,n,o),i=e.promise();return e._generator=t,e._promiseFulfilled(void 0),i}},s.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new u("expecting a function but got "+e.classString(t));f.push(t)},s.spawn=function(t){if(c.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return i("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var e=(t=new h(t,this)).promise();return t._run(s.spawn),e}}},{"./errors":12,"./util":36}],17:[function(a,t,e){t.exports=function(t,i,e,r,n,o){(e=a("./util")).canEvaluate,e.tryCatch,e.errorObj,t.join=function(){var t,e=arguments.length-1;return 0<e&&"function"==typeof arguments[e]&&(t=arguments[e]),e=[].slice.call(arguments),t&&e.pop(),e=new i(e).promise(),void 0!==t?e.spread(t):e}}},{"./util":36}],18:[function(e,t,i){t.exports=function(c,t,o,h,n,u){function a(t,e,i,r){this.constructor$(t),this._promise._captureStackTrace(),t=s(),this._callback=null===t?e:l.domainBind(t,e),this._preservedValues=r===n?Array(this.length()):null,this._limit=i,this._inFlight=0,this._queue=[],f.invoke(this._asyncInit,this,void 0)}function i(t,e,i,r){if("function"!=typeof e)return o("expecting a function but got "+l.classString(e));var n=0;if(void 0!==i){if("object"!=typeof i||null===i)return c.reject(new TypeError("options argument must be an object but it is "+l.classString(i)));if("number"!=typeof i.concurrency)return c.reject(new TypeError("'concurrency' must be a number but it is "+l.classString(i.concurrency)));n=i.concurrency}return new a(t,e,n="number"==typeof n&&isFinite(n)&&1<=n?n:0,r).promise()}var s=c._getDomain,l=e("./util"),p=l.tryCatch,d=l.errorObj,f=c._async;l.inherits(a,t),a.prototype._asyncInit=function(){this._init$(void 0,-2)},a.prototype._init=function(){},a.prototype._promiseFulfilled=function(t,e){var i=this._values,r=this.length(),n=this._preservedValues,o=this._limit;if(e<0){if(i[e=-1*e-1]=t,1<=o&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(1<=o&&this._inFlight>=o)return i[e]=t,this._queue.push(e),!1;null!==n&&(n[e]=t);var a=this._promise,s=this._callback,l=a._boundValue();if(a._pushContext(),s=p(s).call(l,t,e,r),l=a._popContext(),u.checkForgottenReturns(s,l,null!==n?"Promise.filter":"Promise.map",a),s===d)return this._reject(s.e),!0;if((a=h(s,this._promise))instanceof c){if(0==(50397184&(s=(a=a._target())._bitField)))return 1<=o&&this._inFlight++,(i[e]=a)._proxy(this,-1*(e+1)),!1;if(0==(33554432&s))return 0!=(16777216&s)?this._reject(a._reason()):this._cancel(),!0;s=a._value()}i[e]=s}return++this._totalResolved>=r&&(null!==n?this._filter(i,n):this._resolve(i),!0)},a.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,i=this._values;0<t.length&&this._inFlight<e&&!this._isResolved();){var r=t.pop();this._promiseFulfilled(i[r],r)}},a.prototype._filter=function(t,e){for(var i=e.length,r=Array(i),n=0,o=0;o<i;++o)t[o]&&(r[n++]=e[o]);r.length=n,this._resolve(r)},a.prototype.preservedValues=function(){return this._preservedValues},c.prototype.map=function(t,e){return i(this,t,e,null)},c.map=i}},{"./util":36}],19:[function(e,t,i){t.exports=function(n,o,t,a,s){var l=e("./util"),c=l.tryCatch;n.method=function(r){if("function"!=typeof r)throw new n.TypeError("expecting a function but got "+l.classString(r));return function(){var t=new n(o);t._captureStackTrace(),t._pushContext();var e=c(r).apply(this,arguments),i=t._popContext();return s.checkForgottenReturns(e,i,"Promise.method",t),t._resolveFromSyncValue(e),t}},n.attempt=n.try=function(t){if("function"!=typeof t)return a("expecting a function but got "+l.classString(t));var e,i,r=new n(o);return r._captureStackTrace(),r._pushContext(),e=1<arguments.length?(s.deprecated("calling Promise.try with more than 1 argument"),e=arguments[1],i=arguments[2],l.isArray(e)?c(t).apply(i,e):c(t).call(i,e)):c(t)(),i=r._popContext(),s.checkForgottenReturns(e,i,"Promise.try",r),r._resolveFromSyncValue(e),r},n.prototype._resolveFromSyncValue=function(t){t===l.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,i){var c=t("./util"),h=c.maybeWrapAsError,u=t("./errors").OperationalError,p=t("./es5"),d=/^(?:name|message|stack|cause)$/;e.exports=function(s,l){return function(t,e){if(null!==s){if(t){var i,r=h(t);if(r instanceof Error&&p.getPrototypeOf(r)===Error.prototype){(i=new u(r)).name=r.name,i.message=r.message,i.stack=r.stack;for(var n=p.keys(r),o=0;o<n.length;++o){var a=n[o];d.test(a)||(i[a]=r[a])}r=i}else c.markAsOriginatingFromRejection(r);s._attachExtraTrace(r),s._reject(r)}else l?(r=[].slice.call(arguments,1),s._fulfill(r)):s._fulfill(e);s=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,t,i){t.exports=function(t){function r(t,e){if(!i.isArray(t))return n.call(this,t,e);t=s(e).apply(this._boundValue(),[null].concat(t));t===l&&a.throwLater(t.e)}function n(t,e){var i=this._boundValue();(i=void 0===t?s(e).call(i,null):s(e).call(i,null,t))===l&&a.throwLater(i.e)}function o(t,e){var i;t||((i=Error(t+"")).cause=t,t=i),(i=s(e).call(this._boundValue(),t))===l&&a.throwLater(i.e)}var i=e("./util"),a=t._async,s=i.tryCatch,l=i.errorObj;t.prototype.asCallback=t.prototype.nodeify=function(t,e){var i;return"function"==typeof t&&(i=n,void 0!==e&&Object(e).spread&&(i=r),this._then(i,o,void 0,this,t)),this}}},{"./util":36}],22:[function(T,C,t){C.exports=function(){function s(){}function h(t){if(t!==g){if(null==this||this.constructor!==h)throw new f("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new f("expecting a function but got "+u.classString(t))}this._bitField=0,this._receiver0=this._promise0=this._rejectionHandler0=this._fulfillmentHandler0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function t(t){this.promise._resolveCallback(t)}function e(t){this.promise._rejectCallback(t,!1)}function i(t){var e=new h(g);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}function o(){return new f("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")}function l(){return new h.PromiseInspection(this._target())}function a(t){return h.reject(new f(t))}var c={},u=T("./util"),p=u.isNode?function(){var t=process.domain;return t=void 0===t?null:t}:function(){return null};u.notEnumerableProp(h,"_getDomain",p);var r=T("./es5"),n=T("./async"),d=new n;r.defineProperty(h,"_async",{value:d});var r=T("./errors"),f=h.TypeError=r.TypeError;h.RangeError=r.RangeError;var m=h.CancellationError=r.CancellationError;h.TimeoutError=r.TimeoutError,h.OperationalError=r.OperationalError,h.RejectionError=r.OperationalError,h.AggregateError=r.AggregateError;var g=function(){},v={},y={},b=T("./thenables")(h,g),x=T("./promise_array")(h,g,b,a,s),w=(r=T("./context")(h)).create,M=T("./debuggability")(h,r),_=(M.CapturedTrace,T("./finally")(h,b,y)),A=T("./catch_filter")(y),E=T("./nodeback"),S=u.errorObj,P=u.tryCatch;return h.prototype.toString=function(){return"[object Promise]"},h.prototype.caught=h.prototype.catch=function(t){var e=arguments.length;if(1<e){for(var i=Array(e-1),r=0,n=0;n<e-1;++n){var o=arguments[n];if(!u.isObject(o))return a("Catch statement predicate: expecting an object but got "+u.classString(o));i[r++]=o}return i.length=r,t=arguments[n],this.then(void 0,A(i,t,this))}return this.then(void 0,t)},h.prototype.reflect=function(){return this._then(l,l,void 0,this,void 0)},h.prototype.then=function(t,e){var i;return M.warnings()&&0<arguments.length&&"function"!=typeof t&&"function"!=typeof e&&(i=".then() only accepts functions but was passed: "+u.classString(t),1<arguments.length&&(i+=", "+u.classString(e)),this._warn(i)),this._then(t,e,void 0,void 0,void 0)},h.prototype.done=function(t,e){this._then(t,e,void 0,void 0,void 0)._setIsFinal()},h.prototype.spread=function(t){return"function"!=typeof t?a("expecting a function but got "+u.classString(t)):this.all()._then(t,void 0,void 0,v,void 0)},h.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},h.prototype.all=function(){return 0<arguments.length&&this._warn(".all() was passed arguments but it does not take any"),new x(this).promise()},h.prototype.error=function(t){return this.caught(u.originatesFromRejection,t)},h.getNewLibraryCopy=C.exports,h.is=function(t){return t instanceof h},h.fromNode=h.fromCallback=function(t){var e=new h(g);e._captureStackTrace();var i=1<arguments.length&&!!Object(arguments[1]).multiArgs;return(i=P(t)(E(e,i)))===S&&e._rejectCallback(i.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},h.all=function(t){return new x(t).promise()},h.cast=function(t){var e=b(t);return e instanceof h||((e=new h(g))._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},h.resolve=h.fulfilled=h.cast,h.reject=h.rejected=function(t){var e=new h(g);return e._captureStackTrace(),e._rejectCallback(t,!0),e},h.setScheduler=function(t){if("function"!=typeof t)throw new f("expecting a function but got "+u.classString(t));return d.setScheduler(t)},h.prototype._then=function(t,e,i,r,n){var o=void 0!==n;n=o?n:new h(g);var a,s,l,c=(i=this._target())._bitField;return o||(n._propagateFrom(this,3),n._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(r=0!=(50397184&c)?this._boundValue():i===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,n)),o=p(),0!=(50397184&c)?(l=i._settlePromiseCtx,0!=(33554432&c)?(s=i._rejectionHandler0,a=t):0!=(16777216&c)?(s=i._fulfillmentHandler0,a=e,i._unsetRejectionIsUnhandled()):(l=i._settlePromiseLateCancellationObserver,s=new m("late cancellation observer"),i._attachExtraTrace(s),a=e),d.invoke(l,i,{handler:null===o?a:"function"==typeof a&&u.domainBind(o,a),promise:n,receiver:r,value:s})):i._addCallbacks(t,e,n,r,o),n},h.prototype._length=function(){return 65535&this._bitField},h.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},h.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},h.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},h.prototype._setFulfilled=function(){this._bitField|=33554432,this._fireEvent("promiseFulfilled",this)},h.prototype._setRejected=function(){this._bitField|=16777216,this._fireEvent("promiseRejected",this)},h.prototype._setFollowing=function(){this._bitField|=67108864,this._fireEvent("promiseResolved",this)},h.prototype._setIsFinal=function(){this._bitField|=4194304},h.prototype._isFinal=function(){return 0<(4194304&this._bitField)},h.prototype._unsetCancelled=function(){this._bitField&=-65537},h.prototype._setCancelled=function(){this._bitField|=65536,this._fireEvent("promiseCancelled",this)},h.prototype._setWillBeCancelled=function(){this._bitField|=8388608},h.prototype._setAsyncGuaranteed=function(){d.hasCustomScheduler()||(this._bitField|=134217728)},h.prototype._receiverAt=function(t){return(t=0===t?this._receiver0:this[4*t-4+3])===c?void 0:void 0===t&&this._isBound()?this._boundValue():t},h.prototype._promiseAt=function(t){return this[4*t-4+2]},h.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4]},h.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},h.prototype._boundValue=function(){},h.prototype._migrateCallback0=function(t){var e=(t._bitField,t._fulfillmentHandler0),i=t._rejectionHandler0,r=t._promise0;t=t._receiverAt(0),this._addCallbacks(e,i,r,t=void 0===t?c:t,null)},h.prototype._migrateCallbackAt=function(t,e){var i=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),n=t._promiseAt(e),e=t._receiverAt(e);this._addCallbacks(i,r,n,e=void 0===e?c:e,null)},h.prototype._addCallbacks=function(t,e,i,r,n){var o,a=this._length();return 65531<=a&&this._setLength(a=0),0===a?(this._promise0=i,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=null===n?t:u.domainBind(n,t)),"function"==typeof e&&(this._rejectionHandler0=null===n?e:u.domainBind(n,e))):(this[2+(o=4*a-4)]=i,this[3+o]=r,"function"==typeof t&&(this[o]=null===n?t:u.domainBind(n,t)),"function"==typeof e&&(this[1+o]=null===n?e:u.domainBind(n,e))),this._setLength(a+1),a},h.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},h.prototype._resolveCallback=function(t,e){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(o(),!1);var i=b(t,this);if(!(i instanceof h))return this._fulfill(t);if(e&&this._propagateFrom(i,2),(i=i._target())!==this){var r=i._bitField;if(0==(50397184&r)){0<(r=this._length())&&i._migrateCallback0(this);for(var n=1;n<r;++n)i._migrateCallbackAt(this,n);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else 0!=(33554432&r)?this._fulfill(i._value()):0!=(16777216&r)?this._reject(i._reason()):(r=new m("late cancellation observer"),i._attachExtraTrace(r),this._reject(r))}else this._reject(o())}},h.prototype._rejectCallback=function(t,e,i){var r=u.ensureErrorObject(t),n=r===t;n||i||!M.warnings()||(i="a promise was rejected with a non-error: "+u.classString(t),this._warn(i,!0)),this._attachExtraTrace(r,!!e&&n),this._reject(t)},h.prototype._resolveFromExecutor=function(t){var e,i;t!==g&&((e=this)._captureStackTrace(),this._pushContext(),i=!0,t=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,i)}),i=!1,this._popContext(),void 0!==t&&e._rejectCallback(t,!0))},h.prototype._settlePromiseFromHandler=function(t,e,i,r){var n;0==(65536&r._bitField)&&(r._pushContext(),e===v?i&&"number"==typeof i.length?n=P(t).apply(this._boundValue(),i):(n=S).e=new f("cannot .spread() a non-array: "+u.classString(i)):n=P(t).call(e,i),t=r._popContext(),0==(65536&r._bitField)&&(n===y?r._reject(i):n===S?r._rejectCallback(n.e,!1):(M.checkForgottenReturns(n,t,"",r,this),r._resolveCallback(n))))},h.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},h.prototype._followee=function(){return this._rejectionHandler0},h.prototype._setFollowee=function(t){this._rejectionHandler0=t},h.prototype._settlePromise=function(t,e,i,r){var n=t instanceof h,o=this._bitField,a=0!=(134217728&o);0!=(65536&o)?(n&&t._invokeInternalOnCancel(),i instanceof _&&i.isFinallyHandler()?(i.cancelPromise=t,P(e).call(i,r)===S&&t._reject(S.e)):e===l?t._fulfill(l.call(i)):i instanceof s?i._promiseCancelled(t):n||t instanceof x?t._cancel():i.cancel()):"function"==typeof e?n?(a&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,i,r,t)):e.call(i,r,t):i instanceof s?i._isResolved()||(0!=(33554432&o)?i._promiseFulfilled(r,t):i._promiseRejected(r,t)):n&&(a&&t._setAsyncGuaranteed(),0!=(33554432&o)?t._fulfill(r):t._reject(r))},h.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,i=t.promise,r=t.receiver;t=t.value,"function"==typeof e?i instanceof h?this._settlePromiseFromHandler(e,r,t,i):e.call(r,t,i):i instanceof h&&i._reject(t)},h.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},h.prototype._settlePromise0=function(t,e,i){i=this._promise0;var r=this._receiverAt(0);this._receiver0=this._promise0=void 0,this._settlePromise(i,t,r,e)},h.prototype._clearCallbackDataAtIndex=function(t){this[(t=4*t-4)+2]=this[t+3]=this[t+0]=this[t+1]=void 0},h.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this)return t=o(),this._attachExtraTrace(t),this._reject(t);this._setFulfilled(),this._rejectionHandler0=t,0<(65535&e)&&(0!=(134217728&e)?this._settlePromises():d.settlePromises(this))}},h.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16))return this._setRejected(),this._fulfillmentHandler0=t,this._isFinal()?d.fatalError(t,u.isNode):void(0<(65535&e)?d.settlePromises(this):this._ensurePossibleRejectionHandled())},h.prototype._fulfillPromises=function(t,e){for(var i=1;i<t;i++){var r=this._fulfillmentHandlerAt(i),n=this._promiseAt(i),o=this._receiverAt(i);this._clearCallbackDataAtIndex(i),this._settlePromise(n,r,o,e)}},h.prototype._rejectPromises=function(t,e){for(var i=1;i<t;i++){var r=this._rejectionHandlerAt(i),n=this._promiseAt(i),o=this._receiverAt(i);this._clearCallbackDataAtIndex(i),this._settlePromise(n,r,o,e)}},h.prototype._settlePromises=function(){var t,e=this._bitField,i=65535&e;0<i&&(0!=(16842752&e)?(t=this._fulfillmentHandler0,this._settlePromise0(this._rejectionHandler0,t,e),this._rejectPromises(i,t)):(t=this._rejectionHandler0,this._settlePromise0(this._fulfillmentHandler0,t,e),this._fulfillPromises(i,t)),this._setLength(0)),this._clearCancellationData()},h.prototype._settledValue=function(){var t=this._bitField;return 0!=(33554432&t)?this._rejectionHandler0:0!=(16777216&t)?this._fulfillmentHandler0:void 0},h.defer=h.pending=function(){return M.deprecated("Promise.defer","new Promise"),{promise:new h(g),resolve:t,reject:e}},u.notEnumerableProp(h,"_makeSelfResolutionError",o),T("./method")(h,g,b,a,M),T("./bind")(h,g,b,M),T("./cancel")(h,x,a,M),T("./direct_resolve")(h),T("./synchronous_inspection")(h),T("./join")(h,x,b,g,d,p),(h.Promise=h).version="3.5.0",T("./map.js")(h,x,a,b,g,M),T("./call_get.js")(h),T("./using.js")(h,a,b,w,g,M),T("./timers.js")(h,g,M),T("./generators.js")(h,a,g,b,s,M),T("./nodeify.js")(h),T("./promisify.js")(h,g),T("./props.js")(h,x,b,a),T("./race.js")(h,g,b,a),T("./reduce.js")(h,x,a,b,g,M),T("./settle.js")(h,x,M),T("./some.js")(h,x,a),T("./filter.js")(h,g),T("./each.js")(h,g),T("./any.js")(h),u.toFastProperties(h),u.toFastProperties(h.prototype),i({a:1}),i({b:2}),i({c:3}),i(1),i(function(){}),i(void 0),i(!1),i(new h(g)),M.setBounds(n.firstLineError,u.lastLineError),h}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(r,t,e){t.exports=function(s,i,l,o,t){function e(t){var e=this._promise=new s(i);t instanceof s&&e._propagateFrom(t,3),e._setOnCancel(this),this._values=t,this._totalResolved=this._length=0,this._init(void 0,-2)}var a=r("./util");return a.isArray,a.inherits(e,t),e.prototype.length=function(){return this._length},e.prototype.promise=function(){return this._promise},e.prototype._init=function t(e,i){if((r=l(this._values,this._promise))instanceof s){var r,n=(r=r._target())._bitField;if(this._values=r,0==(50397184&n))return this._promise._setAsyncGuaranteed(),r._then(t,this._reject,void 0,this,i);if(0==(33554432&n))return 0!=(16777216&n)?this._reject(r._reason()):this._cancel();r=r._value()}return null===(r=a.asArray(r))?(r=o("expecting an array or an iterable object but got "+a.classString(r)).reason(),void this._promise._rejectCallback(r,!1)):0===r.length?void(-5===i?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}(i))):void this._iterate(r)},e.prototype._iterate=function(t){var e=this.getActualLength(t.length);this._length=e,this._values=this.shouldCopyValues()?Array(e):this._values;for(var i=this._promise,r=!1,n=null,o=0;o<e;++o){var a=l(t[o],i),n=a instanceof s?(a=a._target())._bitField:null;r?null!==n&&a.suppressUnhandledRejections():null!==n?0==(50397184&n)?(a._proxy(this,o),this._values[o]=a):r=0!=(33554432&n)?this._promiseFulfilled(a._value(),o):0!=(16777216&n)?this._promiseRejected(a._reason(),o):this._promiseCancelled(o):r=this._promiseFulfilled(a,o)}r||i._setAsyncGuaranteed()},e.prototype._isResolved=function(){return null===this._values},e.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},e.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},e.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},e.prototype._promiseFulfilled=function(t,e){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},e.prototype._promiseCancelled=function(){return this._cancel(),!0},e.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},e.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof s)t.cancel();else for(var e=0;e<t.length;++e)t[e]instanceof s&&t[e].cancel()}},e.prototype.shouldCopyValues=function(){return!0},e.prototype.getActualLength=function(t){return t},e}},{"./util":36}],24:[function(r,t,e){t.exports=function(c,h){function i(t){return!e.test(t)}function u(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function p(t,e,i,r,n){var o=new RegExp(e.replace(/([$])/,"\\$")+"$");i=function(t,e,i,r){for(var n=f.inheritedDataKeys(t),o=[],a=0;a<n.length;++a){var s,l=n[a],c=t[l],h=r===x||x(l,c,t);(s=!(s="function"!=typeof c||u(c))?!!(s=f.getDataPropertyOrDefault(t,l+e,b))&&u(s):s)||!r(l,c,t,h)||o.push(l,c)}for(t=0;t<o.length;t+=2)if(r=o[t],i.test(r))for(r=r.replace(i,""),n=0;n<o.length;n+=2)if(o[n]===r)throw new y("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e));return o}(t,e,o,i);for(var o=0,a=i.length;o<a;o+=2){var s,l=i[o],c=i[o+1],h=l+e;r===w?t[h]=w(l,d,l,c,e,n):(s=r(c,function(){return w(l,d,l,c,e,n)}),f.notEnumerableProp(s,"__isPromisified__",!0),t[h]=s)}return f.toFastProperties(t),t}var d={},f=r("./util"),m=r("./nodeback"),g=f.withAppended,v=f.maybeWrapAsError,t=f.canEvaluate,y=r("./errors").TypeError,b={__isPromisified__:!0},e=/^(?:arity|length|name|arguments|caller|callee|prototype|__isPromisified__)$/,x=function(t){return f.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t},w=t?void 0:function(n,o,t,e,i,a){function r(){var t=o;o===d&&(t=this);var e=new c(h);e._captureStackTrace();var i="string"==typeof l&&this!==s?this[l]:n,r=m(e,a);try{i.apply(t,g(arguments,r))}catch(t){e._rejectCallback(v(t),!0,!0)}return e._isFateSealed()||e._setAsyncGuaranteed(),e}var s=function(){return this}(),l=n;return"string"==typeof l&&(n=e),f.notEnumerableProp(r,"__isPromisified__",!0),r};c.promisify=function(t,e){if("function"!=typeof t)throw new y("expecting a function but got "+f.classString(t));if(u(t))return t;e=Object(e);e=w(t,void 0===e.context?d:e.context,void 0,t,null,!!e.multiArgs);return f.copyDescriptors(t,e,i),e},c.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new y("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var i=!!(e=Object(e)).multiArgs,r=e.suffix,n=e.filter;"function"!=typeof n&&(n=x);var o=e.promisifier;if("function"!=typeof o&&(o=w),!f.isIdentifier(r="string"!=typeof r?"Async":r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=f.inheritedDataKeys(t),s=0;s<a.length;++s){var l=t[a[s]];"constructor"!==a[s]&&f.isClass(l)&&(p(l.prototype,r,n,o,i),p(l,r,n,o,i))}return p(t,r,n,o,i)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(f,t,e){t.exports=function(i,t,r,n){function o(t){var e=!1;if(void 0!==s&&t instanceof s)n=p(t),e=!0;else for(var i=c.keys(t),r=i.length,n=Array(2*r),o=0;o<r;++o){var a=i[o];n[o]=t[a],n[o+r]=a}this.constructor$(n),this._isMap=e,this._init$(void 0,e?-6:-3)}function e(t){var e;return t=r(t),l(t)?(e=t instanceof i?t._then(i.props,void 0,void 0,void 0,void 0):new o(t).promise(),t instanceof i&&e._propagateFrom(t,2),e):n("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var s,a=f("./util"),l=a.isObject,c=f("./es5");"function"==typeof Map&&(s=Map);var h,u,p=(u=0,function(t){h=t.size,u=0;var e=Array(2*t.size);return t.forEach(d,e),e});function d(t,e){this[u]=t,this[u+h]=e,u++}a.inherits(o,t),o.prototype._init=function(){},o.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){if(this._isMap){for(var i=this._values,r=new s,n=i.length/2|0,o=0;o<n;++o)r.set(i[n+o],i[o]);i=r}else for(i={},r=this.length(),n=0,o=this.length();n<o;++n)i[this._values[n+r]]=this._values[n];return this._resolve(i),!0}return!1},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(t){return t>>1},i.prototype.props=function(){return e(this)},i.props=e}},{"./es5":13,"./util":36}],26:[function(t,e,i){function r(t){this._capacity=t,this._front=this._length=0}r.prototype._willBeOverCapacity=function(t){return this._capacity<t},r.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},r.prototype.push=function(t,e,i){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(i);var n=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[n&o]=t,this[1+n&o]=e,this[2+n&o]=i,this._length=r},r.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},r.prototype.length=function(){return this._length},r.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},r.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,t=this._front+this._length&e-1;for(var i=0;i<t;++i)this[i+e]=this[i+0],this[i+0]=void 0},e.exports=r},{}],27:[function(t,e,i){e.exports=function(l,c,h,u){function i(t,e){var i=h(t);if(i instanceof l)return d(i);if(null===(t=p.asArray(t)))return u("expecting an array or an iterable object but got "+p.classString(t));i=new l(c),void 0!==e&&i._propagateFrom(e,3);for(var r=i._fulfill,n=i._reject,o=0,a=t.length;o<a;++o){var s=t[o];(void 0!==s||o in t)&&l.cast(s)._then(r,n,void 0,i,null)}return i}var p=t("./util"),d=function(e){return e.then(function(t){return i(t,e)})};l.race=function(t){return i(t,void 0)},l.prototype.race=function(){return i(this,void 0)}}},{"./util":36}],28:[function(f,t,e){t.exports=function(n,t,o,e,a,s){function l(t,e,i,r){this.constructor$(t),t=u(),this._fn=null===t?e:p.domainBind(t,e),void 0!==i&&(i=n.resolve(i))._attachCancellationCallback(this),this._initialValue=i,this._currentCancellable=null,this._eachValues=r===a?Array(this._length):0===r?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function c(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function i(t,e,i,r){return"function"!=typeof e?o("expecting a function but got "+p.classString(e)):new l(t,e,i,r).promise()}function h(t){return this.accum=t,this.array._gotAccum(t),(t=e(this.value,this.array._promise))instanceof n?(this.array._currentCancellable=t)._then(r,void 0,void 0,this,void 0):r.call(this,t)}function r(t){var e=this.array,i=e._promise,r=d(e._fn);return i._pushContext(),(t=void 0!==e._eachValues?r.call(i._boundValue(),t,this.index,this.length):r.call(i._boundValue(),this.accum,t,this.index,this.length))instanceof n&&(e._currentCancellable=t),r=i._popContext(),s.checkForgottenReturns(t,r,void 0!==e._eachValues?"Promise.each":"Promise.reduce",i),t}var u=n._getDomain,p=f("./util"),d=p.tryCatch;p.inherits(l,t),l.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==a&&this._eachValues.push(t)},l.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},l.prototype._init=function(){},l.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},l.prototype.shouldCopyValues=function(){return!1},l.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},l.prototype._resultCancelled=function(t){return t===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof n&&this._currentCancellable.cancel(),this._initialValue instanceof n&&this._initialValue.cancel()))},l.prototype._iterate=function(t){var e,i=(this._values=t).length,r=void 0!==this._initialValue?(e=this._initialValue,0):(e=n.resolve(t[0]),1);if(!(this._currentCancellable=e).isRejected())for(;r<i;++r)e=e._then(h,void 0,void 0,{accum:null,value:t[r],index:r,length:i,array:this},void 0);(e=void 0!==this._eachValues?e._then(this._eachComplete,void 0,void 0,this,void 0):e)._then(c,c,void 0,e,this)},n.prototype.reduce=function(t,e){return i(this,t,e,null)},n.reduce=i}},{"./util":36}],29:[function(t,e,i){i=function(){throw Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")};var r,n,o,a,s,l,c,h=(t=t("./util")).getNativePromise();t=t.isNode&&"undefined"==typeof MutationObserver?(r=global.setImmediate,n=process.nextTick,t.isRecentNode?function(t){r.call(global,t)}:function(t){n.call(process,t)}):"function"==typeof h&&"function"==typeof h.resolve?(o=h.resolve(),function(t){o.then(t)}):"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:i:(a=document.createElement("div"),l=!(s={attributes:!0}),c=document.createElement("div"),new MutationObserver(function(){a.classList.toggle("foo"),l=!1}).observe(c,s),function(t){var e=new MutationObserver(function(){e.disconnect(),t()});e.observe(a,s),l||(l=!0,c.classList.toggle("foo"))}),e.exports=t},{"./util":36}],30:[function(o,t,e){t.exports=function(t,e,i){function r(t){this.constructor$(t)}var n=t.PromiseInspection;o("./util").inherits(r,e),r.prototype._promiseResolved=function(t,e){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},r.prototype._promiseFulfilled=function(t,e){var i=new n;return i._bitField=33554432,i._settledValueField=t,this._promiseResolved(e,i)},r.prototype._promiseRejected=function(t,e){var i=new n;return i._bitField=16777216,i._settledValueField=t,this._promiseResolved(e,i)},t.settle=function(t){return i.deprecated(".settle()",".reflect()"),new r(t).promise()},t.prototype.settle=function(){return t.settle(this)}}},{"./util":36}],31:[function(h,t,e){t.exports=function(t,e,r){function n(t){this.constructor$(t),this._howMany=0,this._initialized=this._unwrap=!1}function i(t,e){if((0|e)!==e||e<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var i=new n(t),t=i.promise();return i.setHowMany(e),i.init(),t}var o=h("./util"),a=h("./errors").RangeError,s=h("./errors").AggregateError,l=o.isArray,c={};o.inherits(n,e),n.prototype._init=function(){var t;this._initialized&&(0!==this._howMany?(this._init$(void 0,-5),t=l(this._values),!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))):this._resolve([]))},n.prototype.init=function(){this._initialized=!0,this._init()},n.prototype.setUnwrap=function(){this._unwrap=!0},n.prototype.howMany=function(){return this._howMany},n.prototype.setHowMany=function(t){this._howMany=t},n.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},n.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},n.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(c),this._checkOutcome())},n.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new s,e=this.length();e<this._values.length;++e)this._values[e]!==c&&t.push(this._values[e]);return 0<t.length?this._reject(t):this._cancel(),!0}return!1},n.prototype._fulfilled=function(){return this._totalResolved},n.prototype._rejected=function(){return this._values.length-this.length()},n.prototype._addRejected=function(t){this._values.push(t)},n.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},n.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},n.prototype._getRangeError=function(t){return new a("Input array must contain at least "+this._howMany+" items but contains only "+t+" items")},n.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=i,t.prototype.some=function(t){return i(this,t)},t._SomePromiseArray=n}},{"./errors":12,"./util":36}],32:[function(t,e,i){e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var i=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},n=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},a=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},s=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return a.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return n.call(this._target())},t.prototype.isResolved=function(){return s.call(this._target())},t.prototype.value=function(){return i.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,i){e.exports=function(a,s){var l=t("./util"),c=l.errorObj,n=l.isObject,o={}.hasOwnProperty;return function(t,e){if(n(t)){if(t instanceof a)return t;var i,r;try{i=t.then}catch(t){c.e=t,i=c}if(i===c)return e&&e._pushContext(),i=a.reject(i.e),e&&e._popContext(),i;if("function"==typeof i){try{r=o.call(t,"_promise0")}catch(t){r=!1}return r?(i=new a(s),t._then(i._fulfill,i._reject,void 0,i,null),i):function(t,e,i){var r=new a(s),n=r;i&&i._pushContext(),r._captureStackTrace(),i&&i._popContext();var o=!0;return t=l.tryCatch(e).call(t,function(t){r&&(r._resolveCallback(t),r=null)},function(t){r&&(r._rejectCallback(t,o,!0),r=null)}),o=!1,r&&t===c&&(r._rejectCallback(t.e,!0,!0),r=null),n}(t,i,e)}}return t}}},{"./util":36}],34:[function(t,e,i){e.exports=function(r,n,a){function s(t){this.handle=t}function e(t){return clearTimeout(this.handle),t}function i(t){throw clearTimeout(this.handle),t}var l=t("./util"),c=r.TimeoutError;s.prototype._resultCancelled=function(){clearTimeout(this.handle)};function o(t){return h(+this).thenReturn(t)}var h=r.delay=function(t,e){var i;return void 0!==e?(i=r.resolve(e)._then(o,null,null,t,void 0),a.cancellation()&&e instanceof r&&i._setOnCancel(e)):(i=new r(n),t=setTimeout(function(){i._fulfill()},+t),a.cancellation()&&i._setOnCancel(new s(t)),i._captureStackTrace()),i._setAsyncGuaranteed(),i};r.prototype.delay=function(t){return h(t,this)},r.prototype.timeout=function(t,r){var n,o,t=new s(setTimeout(function(){var t,e,i;n.isPending()&&(t=n,e=o,i="string"!=typeof r?r instanceof Error?r:new c("operation timed out"):new c(r),l.markAsOriginatingFromRejection(i),t._attachExtraTrace(i),t._reject(i),null!=e&&e.cancel())},+t));return a.cancellation()?(o=this.then(),(n=o._then(e,i,void 0,t,void 0))._setOnCancel(t)):n=this._then(e,i,void 0,t,void 0),n}}},{"./util":36}],35:[function(a,t,e){t.exports=function(h,u,p,e,t,d){function l(t){setTimeout(function(){throw t},0)}function f(r,n){var o=0,a=r.length,s=new h(t);return function t(){if(a<=o)return s._fulfill();var e=r[o++],i=p(e);if(i!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&i._setDisposable(e._getDisposer()),(e=i)instanceof h&&e._isDisposable()){try{e=p(e._getDisposer().tryDispose(n),r.promise)}catch(t){return l(t)}if(e instanceof h)return e._then(t,l,null,null,null)}t()}(),s}function m(t,e,i){this._data=t,this._promise=e,this._context=i}function i(t,e,i){this.constructor$(t,e,i)}function g(t){return m.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function v(t){this.length=t,this.promise=null,this[t-1]=null}var y=a("./util"),r=a("./errors").TypeError,n=a("./util").inherits,b=y.errorObj,x=y.tryCatch,o={};m.prototype.data=function(){return this._data},m.prototype.promise=function(){return this._promise},m.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():o},m.prototype.tryDispose=function(t){var e=this.resource(),i=this._context;return void 0!==i&&i._pushContext(),t=e!==o?this.doDispose(e,t):null,void 0!==i&&i._popContext(),this._promise._unsetDisposable(),this._data=null,t},m.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},n(i,m),i.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},v.prototype._resultCancelled=function(){for(var t=this.length,e=0;e<t;++e){var i=this[e];i instanceof h&&i.cancel()}},h.using=function(){var t=arguments.length;if(t<2)return u("you must pass at least 2 arguments to Promise.using");var r=arguments[t-1];if("function"!=typeof r)return u("expecting a function but got "+y.classString(r));var e,n=!0;2===t&&Array.isArray(arguments[0])?(t=(e=arguments[0]).length,n=!1):(e=arguments,t--);for(var i=new v(t),o=0;o<t;++o){var a,s=e[o];m.isDisposer(s)?(s=(a=s).promise())._setDisposable(a):(a=p(s))instanceof h&&(s=a._then(g,null,null,{resources:i,index:o},void 0)),i[o]=s}for(t=Array(i.length),o=0;o<t.length;++o)t[o]=h.resolve(i[o]).reflect();var l=h.all(t).then(function(t){for(var e=0;e<t.length;++e){var i=t[e];if(i.isRejected())return b.e=i.error(),b;if(!i.isFulfilled())return void l.cancel();t[e]=i.value()}return c._pushContext(),r=x(r),t=n?r.apply(void 0,t):r(t),e=c._popContext(),d.checkForgottenReturns(t,e,"Promise.using",c),t}),c=l.lastly(function(){var t=new h.PromiseInspection(l);return f(i,t)});return(i.promise=c)._setOnCancel(i),c},h.prototype._setDisposable=function(t){this._bitField|=131072,this._disposer=t},h.prototype._isDisposable=function(){return 0<(131072&this._bitField)},h.prototype._getDisposer=function(){return this._disposer},h.prototype._unsetDisposable=function(){this._bitField&=-131073,this._disposer=void 0},h.prototype.disposer=function(t){if("function"==typeof t)return new i(t,this,e());throw new r}}},{"./errors":12,"./util":36}],36:[function(e,t,i){function r(){try{var t=h;return h=null,t.apply(this,arguments)}catch(t){return u.e=t,u}}function n(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function o(t,e,i){return n(t)||c.defineProperty(t,e,{value:i,configurable:!0,enumerable:!1,writable:!0}),t}function a(t){return null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function s(t){return a(t)&&c.propertyIsWritable(t,"stack")}function l(t){return{}.toString.call(t)}var c=e("./es5");e="undefined"==typeof navigator;var h,u={e:{}};i="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null;var p,d=function(){function s(t){for(var e=0;e<n.length;++e)if(n[e]===t)return 1}var n=[Array.prototype,Object.prototype,Function.prototype];if(c.isES5){var l=Object.getOwnPropertyNames;return function(t){for(var e,i=[],r=Object.create(null);null!=t&&!s(t);){try{e=l(t)}catch(t){break}for(var n=0;n<e.length;++n){var o,a=e[n];r[a]||(r[a]=!0,null!=(o=Object.getOwnPropertyDescriptor(t,a))&&null==o.get&&null==o.set&&i.push(a))}t=c.getPrototypeOf(t)}return i}}var o={}.hasOwnProperty;return function(t){if(s(t))return[];var e,i=[];t:for(e in t){if(!o.call(t,e))for(var r=0;r<n.length;++r)if(o.call(n[r],e))continue t;i.push(e)}return i}}(),f=/this\s*\.\s*\S+\s*=/,m=/^[a-z$_][a-z$_0-9]*$/i,g="stack"in Error()?function(t){return s(t)?t:Error(t+"")}:function(t){if(s(t))return t;try{throw Error(t+"")}catch(t){return t}},v=function(t){return c.isArray(t)?t:null};"undefined"!=typeof Symbol&&Symbol.iterator&&(p="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e=[],i=t[Symbol.iterator]();!(t=i.next()).done;)e.push(t.value);return e},v=function(t){return c.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?p(t):null});var y="undefined"!=typeof process&&"[object process]"===l(process).toLowerCase(),b="undefined"!=typeof process&&void 0!==process.env;(e={isClass:function(t){try{if("function"==typeof t){var e=c.names(t.prototype),i=c.isES5&&1<e.length,r=0<e.length&&!(1===e.length&&"constructor"===e[0]),n=f.test(t+"")&&0<c.names(t).length;if(i||r||n)return!0}return!1}catch(t){return!1}},isIdentifier:function(t){return m.test(t)},inheritedDataKeys:d,getDataPropertyOrDefault:function(t,e,i){return c.isES5?null!=(t=Object.getOwnPropertyDescriptor(t,e))?null==t.get&&null==t.set?t.value:i:void 0:{}.hasOwnProperty.call(t,e)?t[e]:void 0},thrower:function(t){throw t},isArray:c.isArray,asArray:v,notEnumerableProp:o,isPrimitive:n,isObject:function(t){return"function"==typeof t||"object"==typeof t&&null!==t},isError:a,canEvaluate:e,errorObj:u,tryCatch:function(t){return h=t,r},inherits:function(e,i){function t(){for(var t in this.constructor=e,(this.constructor$=i).prototype)r.call(i.prototype,t)&&"$"!==t.charAt(t.length-1)&&(this[t+"$"]=i.prototype[t])}var r={}.hasOwnProperty;return t.prototype=i.prototype,e.prototype=new t,e.prototype},withAppended:function(t,e){for(var i=t.length,r=Array(i+1),n=0;n<i;++n)r[n]=t[n];return r[n]=e,r},maybeWrapAsError:function(t){return n(t)?Error(t+""):t},toFastProperties:function(t){for(var e=8;e--;);return t},filledRange:function(t,e,i){for(var r=Array(t),n=0;n<t;++n)r[n]=e+n+i;return r},toString:function(t){return t+""},canAttachTrace:s,ensureErrorObject:g,originatesFromRejection:function(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)},markAsOriginatingFromRejection:function(t){try{o(t,"isOperational",!0)}catch(t){}},classString:l,copyDescriptors:function(t,e,i){for(var r=c.names(t),n=0;n<r.length;++n){var o=r[n];if(i(o))try{c.defineProperty(e,o,c.getDescriptor(t,o))}catch(t){}}},hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:y,hasEnvVariables:b,env:function(t){return b?process.env[t]:void 0},global:i,getNativePromise:function(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){}},domainBind:function(t,e){return t.bind(e)}}).isRecentNode=e.isNode&&(0===(i=process.versions.node.split(".").map(Number))[0]&&10<i[1]||0<i[0]),e.isNode&&e.toFastProperties(process);try{throw Error()}catch(t){e.lastLineError=t}t.exports=e},{"./es5":13}]},{},[4])(4)},"object"==typeof exports&&"undefined"!=typeof module?module.exports=_():mt.amd?mt("bluebird",[],_):("undefined"!=typeof window?M=window:"undefined"!=typeof global?M=global:"undefined"!=typeof self&&(M=self),M.Promise=_()),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise),mt("com/visioglobe/common/utils/Utils",["bluebird"],function(t){var n=0,h={isNumeric:function(t){var e=/-?\d+(\.{1}\d+)?(e{1}-?\d+)?/.exec(t);return null!==e&&e[0].length===(t+"").length},getURLParameters:function(t){t=void 0===t?window.location.search:t;var e,i=/[?|&]?([^=^&^#]+)=?([^&^#]+)?/g,r={};do{if(null!==(e=i.exec(t))){var n=decodeURIComponent(e[1]),o=void 0===e[2]||decodeURIComponent(e[2].replace(/\+/g," "));h.isNumeric(o)&&(o=parseFloat(o));for(var a,s=/([^\[^\]]+)((\[(^\[^\])\])*)/g,l=r,c=[];null!==(a=s.exec(n))&&void 0!==a[1]&&c.push(decodeURIComponent(a[1])),a;);for(n=0;n<c.length-1;n++)void 0===l[c[n]]&&(l[c[n]]={}),l=l[c[n]];l[c[c.length-1]]=o}}while(e);return r=void 0!==r.params64?JSON.parse(atob(r.params64)):r},toURLParameters:function(e){var n=function(e,i,r){switch(typeof e){case"object":Object.keys(e).forEach(function(t){n(e[t],i+"["+t+"]",r)});break;case"boolean":e&&r.push(i);break;default:r.push(i+"="+encodeURIComponent(e).replace(/%20/g,"+"))}},i=[];Object.keys(e).forEach(function(t){n(e[t],t,i)});var r="";return i.forEach(function(t,e,i){r+=t,e<i.length-1&&(r+="&")}),r},extendDeep:function(t){if("object"!=typeof t)return t;for(var e,i,r=1,n=arguments.length;r<n;r++)for(i in e=arguments[r])hasOwnProperty.call(e,i)&&(t[i]="object"==typeof e[i]&&e[i]?h.extendDeep({},e[i]):e[i]);return t},queryChildren:function(t,e){var i=t.id,r="#"+(t.id=i||"query_children_"+n++)+" > ";return e=r+(e+"").replace(",",","+r,"g"),r=t.parentNode.querySelectorAll(e),i||t.removeAttribute("id"),r},getElementWidth:function(t){return""!==t.style.width?parseInt(t.style.width,10):parseInt(getComputedStyle(t).width,10)-t.offsetLeft},getElementHeight:function(t){return""!==t.style.height?parseInt(t.style.height,10):parseInt(getComputedStyle(t).height,10)-t.offsetTop},getXDomainRequest:function(){var t=null;return window.XDomainRequest?t=new XDomainRequest:window.XMLHttpRequest?t=new XMLHttpRequest:console.log("Your browser lacks AJAX cross domain support"),t},request:function(n,o,a,s){return new t(function(t,e){var i=new XMLHttpRequest;void 0!==s.crossDomain&&s.crossDomain&&(i=h.getXDomainRequest()),void 0!==s.contentType&&s.contentType&&i.setRequestHeader("Content-Type",s.contentType),i.onload=function(){200<=i.status&&i.status<400||-1!==i.responseURL.indexOf("file:///")&&0===i.status?t({response:i.response,status:i.status,request:i}):e(Error(i.status))},i.onerror=function(){e(Error(i.status))},"function"==typeof s.progressCallBack&&(i.onprogress=function(t){s.progressCallBack(t)});var r=!0;void 0===s.async||s.async||(r=!1),null!==a&&"GET"===o?i.open(o,n+"?"+a,r):i.open(o,n,r),"POST"===o?i.send(a):i.send()})},now:function(){return Math.round((new Date).getTime()/1e3)},getCookie:function(t){return(t=document.cookie.match(RegExp("(?:^|;\\s*)"+t.replace(/([.*+?\^${}()|\[\]\/\\])/g,"\\$1")+"=([^;]*)")))?t[1]:null},setCookie:function(t,e,i){var r=new Date;r.setTime(r.getTime()+864e5*i),i="expires="+r.toUTCString(),document.cookie=t+"="+e+";"+i+";path=/"},sha1:function(t){function e(t,e){return t<<e|t>>>32-e}function i(t){for(var e="",i=7;0<=i;i--)e+=(t>>>4*i&15).toString(16);return e}for(var r,n,o,a,s,l=Array(80),c=1732584193,h=4023233417,u=2562383102,p=271733878,d=3285377520,f=(t=unescape(encodeURIComponent(t))).length,m=[],g=0;g<f-3;g+=4)r=t.charCodeAt(g)<<24|t.charCodeAt(g+1)<<16|t.charCodeAt(g+2)<<8|t.charCodeAt(g+3),m.push(r);switch(f%4){case 0:g=2147483648;break;case 1:g=t.charCodeAt(f-1)<<24|8388608;break;case 2:g=t.charCodeAt(f-2)<<24|t.charCodeAt(f-1)<<16|32768;break;case 3:g=t.charCodeAt(f-3)<<24|t.charCodeAt(f-2)<<16|t.charCodeAt(f-1)<<8|128}for(m.push(g);14!=m.length%16;)m.push(0);for(m.push(f>>>29),m.push(f<<3&4294967295),t=0;t<m.length;t+=16){for(g=0;g<16;g++)l[g]=m[t+g];for(g=16;g<=79;g++)l[g]=e(l[g-3]^l[g-8]^l[g-14]^l[g-16],1);for(r=c,f=h,n=u,o=p,a=d,g=0;g<=19;g++)s=e(r,5)+(f&n|~f&o)+a+l[g]+1518500249&4294967295,a=o,o=n,n=e(f,30),f=r,r=s;for(g=20;g<=39;g++)s=e(r,5)+(f^n^o)+a+l[g]+1859775393&4294967295,a=o,o=n,n=e(f,30),f=r,r=s;for(g=40;g<=59;g++)s=e(r,5)+(f&n|f&o|n&o)+a+l[g]+2400959708&4294967295,a=o,o=n,n=e(f,30),f=r,r=s;for(g=60;g<=79;g++)s=e(r,5)+(f^n^o)+a+l[g]+3395469782&4294967295,a=o,o=n,n=e(f,30),f=r,r=s;c=c+r&4294967295,h=h+f&4294967295,u=u+n&4294967295,p=p+o&4294967295,d=d+a&4294967295}return(s=i(c)+i(h)+i(u)+i(p)+i(d)).toLowerCase()},LZWCompress:function(t){for(var e,i,r={},n="",o=[],a=256,s=0;s<256;s+=1)r[String.fromCharCode(s)]=s;for(s=0;s<t.length;s+=1)e=t.charAt(s),n=r.hasOwnProperty(i=n+e)?i:(o.push(r[n]),r[i]=a++,String(e));return""!==n&&o.push(r[n]),o},LZWDecompress:function(t){for(var e,i,r=[],n="",o=256,a=0;a<256;a+=1)r[a]=String.fromCharCode(a);for(i=e=String.fromCharCode(t[0]),a=1;a<t.length;a+=1){if(r[n=t[a]])n=r[n];else{if(n!==o)return null;n=e+e.charAt(0)}i+=n,r[o++]=e+n.charAt(0),e=n}return i}};return h}),A=this,_=function(t){function e(){}function q(t,e){this.x=t||0,this.y=e||0}function Mt(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function s(t,e,i,r){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==r?r:1}function _t(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}function g(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function p(t,e,i,r,n,o,a,s,l,c){Object.defineProperty(this,"id",{value:oo++}),this.uuid=io.generateUUID(),this.name="",this.image=void 0!==t?t:p.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:p.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:1001,this.wrapT=void 0!==r?r:1001,this.magFilter=void 0!==n?n:1006,this.minFilter=void 0!==o?o:1008,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:1023,this.type=void 0!==s?s:1009,this.offset=new q(0,0),this.repeat=new q(1,1),this.center=new q(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new g,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:3e3,this.version=0,this.onUpdate=null}function At(t,e,i,r){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==r?r:1}function S(t,e,i){this.uuid=io.generateUUID(),this.width=t,this.height=e,this.scissor=new At(0,0,t,e),this.scissorTest=!1,this.viewport=new At(0,0,t,e),void 0===(i=i||{}).minFilter&&(i.minFilter=1006),this.texture=new p(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function r(t,e,i){S.call(this,t,e,i),this.activeMipMapLevel=this.activeCubeFace=0}function Et(t,e,i,r,n,o,a,s,l,c,h,u){p.call(this,null,o,a,s,l,c,r,n,h,u),this.image={data:t,width:e,height:i},this.magFilter=void 0!==l?l:1003,this.minFilter=void 0!==c?c:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1}function l(t,e,i,r,n,o,a,s,l,c){p.call(this,t=void 0!==t?t:[],void 0!==e?e:301,i,r,n,o,a,s,l,c),this.flipY=!1}function i(t,e,i){var r=t[0];if(r<=0||0<r)return t;var n=e*i,o=lo[n];if(void 0===o&&(o=new Float32Array(n),lo[n]=o),0!==e)for(r.toArray(o,0),r=1,n=0;r!==e;++r)t[r].toArray(o,n+=i);return o}function o(t,e){var i=co[e];void 0===i&&(i=new Int32Array(e),co[e]=i);for(var r=0;r!==e;++r)i[r]=t.allocTextureUnit();return i}function n(t,e){t.uniform1f(this.addr,e)}function a(t,e){t.uniform1i(this.addr,e)}function c(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function h(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function u(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function d(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function f(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):(uo.set(e.elements),t.uniformMatrix3fv(this.addr,!1,uo))}function m(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):(ho.set(e.elements),t.uniformMatrix4fv(this.addr,!1,ho))}function v(t,e,i){var r=i.allocTextureUnit();t.uniform1i(this.addr,r),i.setTexture2D(e||ao,r)}function y(t,e,i){var r=i.allocTextureUnit();t.uniform1i(this.addr,r),i.setTextureCube(e||so,r)}function b(t,e){t.uniform2iv(this.addr,e)}function x(t,e){t.uniform3iv(this.addr,e)}function w(t,e){t.uniform4iv(this.addr,e)}function M(t,e){t.uniform1fv(this.addr,e)}function _(t,e){t.uniform1iv(this.addr,e)}function A(t,e){t.uniform2fv(this.addr,i(e,this.size,2))}function E(t,e){t.uniform3fv(this.addr,i(e,this.size,3))}function P(t,e){t.uniform4fv(this.addr,i(e,this.size,4))}function T(t,e){t.uniformMatrix2fv(this.addr,!1,i(e,this.size,4))}function C(t,e){t.uniformMatrix3fv(this.addr,!1,i(e,this.size,9))}function O(t,e){t.uniformMatrix4fv(this.addr,!1,i(e,this.size,16))}function R(t,e,i){var r=e.length,n=o(i,r);for(t.uniform1iv(this.addr,n),t=0;t!==r;++t)i.setTexture2D(e[t]||ao,n[t])}function L(t,e,i){var r=e.length,n=o(i,r);for(t.uniform1iv(this.addr,n),t=0;t!==r;++t)i.setTextureCube(e[t]||so,n[t])}function I(t,e,i){this.id=t,this.addr=i,this.setValue=function(t){switch(t){case 5126:return n;case 35664:return c;case 35665:return h;case 35666:return u;case 35674:return d;case 35675:return f;case 35676:return m;case 35678:case 36198:return v;case 35680:return y;case 5124:case 35670:return a;case 35667:case 35671:return b;case 35668:case 35672:return x;case 35669:case 35673:return w}}(e.type)}function D(t,e,i){this.id=t,this.addr=i,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return M;case 35664:return A;case 35665:return E;case 35666:return P;case 35674:return T;case 35675:return C;case 35676:return O;case 35678:return R;case 35680:return L;case 5124:case 35670:return _;case 35667:case 35671:return b;case 35668:case 35672:return x;case 35669:case 35673:return w}}(e.type)}function F(t){this.id=t,this.seq=[],this.map={}}function St(t,e,i){this.seq=[],this.map={},this.renderer=i,i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(var r=0;r<i;++r){var n=t.getActiveUniform(e,r),o=t.getUniformLocation(e,n.name),a=this,s=n.name,l=s.length;for(po.lastIndex=0;;){var c=po.exec(s),h=po.lastIndex,u=c[1],p=c[3];if("]"===c[2]&&(u|=0),void 0===p||"["===p&&h+2===l){s=a,n=new(void 0===p?I:D)(u,n,o),s.seq.push(n),s.map[n.id]=n;break}void 0===(p=a.map[u])&&(p=new F(u),u=a,a=p,u.seq.push(a),u.map[a.id]=a),a=p}}}function j(t,e,i){return void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}function H(t,e,i,r,n,o,a,s,l){p.call(this,t,e,i,r,n,o,a,s,l),this.needsUpdate=!0}function Pt(p,d,f,m,g){var v,y,b,x,w,M,_,A,E,S,P,T,C,O,R,L,I,D;function F(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var j,N,k,z,U=new _t,V=new s,B=new _t;this.render=function(t,e,i){if(0!==t.length){var r,n;void 0===k&&(r=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),n=new Uint16Array([0,1,2,0,2,3]),j=d.createBuffer(),N=d.createBuffer(),d.bindBuffer(d.ARRAY_BUFFER,j),d.bufferData(d.ARRAY_BUFFER,r,d.STATIC_DRAW),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,N),d.bufferData(d.ELEMENT_ARRAY_BUFFER,n,d.STATIC_DRAW),r=d.createProgram(),n=d.createShader(d.VERTEX_SHADER),o=d.createShader(d.FRAGMENT_SHADER),d.shaderSource(n,["precision "+g.precision+" float;","#define SHADER_NAME SpriteMaterial\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 center;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float fogDepth;\nvoid main() {\n\tvUV = uvOffset + uv * uvScale;\n\tvec2 alignedPosition = ( position - center ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tvec4 mvPosition;\n\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\tfogDepth = - mvPosition.z;\n}"].join("\n")),d.shaderSource(o,["precision "+g.precision+" float;","#define SHADER_NAME SpriteMaterial\nuniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvarying float fogDepth;\nvoid main() {\n\tvec4 texture = texture2D( map, vUV );\n\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\n\tif ( gl_FragColor.a < alphaTest ) discard;\n\tif ( fogType > 0 ) {\n\t\tfloat fogFactor = 0.0;\n\t\tif ( fogType == 1 ) {\n\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t\t} else {\n\t\t\tconst float LOG2 = 1.442695;\n\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );\n\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n\t\t}\n\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\t}\n}"].join("\n")),d.compileShader(n),d.compileShader(o),d.attachShader(r,n),d.attachShader(r,o),d.linkProgram(r),k=r,I=d.getAttribLocation(k,"position"),D=d.getAttribLocation(k,"uv"),v=d.getUniformLocation(k,"uvOffset"),y=d.getUniformLocation(k,"uvScale"),b=d.getUniformLocation(k,"rotation"),x=d.getUniformLocation(k,"center"),w=d.getUniformLocation(k,"scale"),M=d.getUniformLocation(k,"color"),_=d.getUniformLocation(k,"map"),A=d.getUniformLocation(k,"opacity"),E=d.getUniformLocation(k,"modelViewMatrix"),S=d.getUniformLocation(k,"projectionMatrix"),P=d.getUniformLocation(k,"fogType"),T=d.getUniformLocation(k,"fogDensity"),C=d.getUniformLocation(k,"fogNear"),O=d.getUniformLocation(k,"fogFar"),R=d.getUniformLocation(k,"fogColor"),d.getUniformLocation(k,"fogDepth"),L=d.getUniformLocation(k,"alphaTest"),(r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=8,r.height=8,(n=r.getContext("2d")).fillStyle="white",n.fillRect(0,0,8,8),z=new H(r)),f.useProgram(k),f.initAttributes(),f.enableAttribute(I),f.enableAttribute(D),f.disableUnusedAttributes(),f.disable(d.CULL_FACE),f.enable(d.BLEND),d.bindBuffer(d.ARRAY_BUFFER,j),d.vertexAttribPointer(I,2,d.FLOAT,!1,16,0),d.vertexAttribPointer(D,2,d.FLOAT,!1,16,8),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,N),d.uniformMatrix4fv(S,!1,i.projectionMatrix.elements),f.activeTexture(d.TEXTURE0),d.uniform1i(_,0),n=r=0,(o=e.fog)?(d.uniform3f(R,o.color.r,o.color.g,o.color.b),o.isFog?(d.uniform1f(C,o.near),d.uniform1f(O,o.far),d.uniform1i(P,1),n=r=1):o.isFogExp2&&(d.uniform1f(T,o.density),d.uniform1i(P,2),n=r=2)):(d.uniform1i(P,0),n=r=0);for(var o=0,a=t.length;o<a;o++)(c=t[o]).modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,c.matrixWorld),c.z=-c.modelViewMatrix.elements[14];t.sort(F);for(var s=[],l=[],o=0,a=t.length;o<a;o++){var c,h,u=(c=t[o]).material;!1!==u.visible&&(c.onBeforeRender(p,e,i,void 0,u,void 0),d.uniform1f(L,u.alphaTest),d.uniformMatrix4fv(E,!1,c.modelViewMatrix.elements),c.matrixWorld.decompose(U,V,B),s[0]=B.x,s[1]=B.y,l[0]=c.center.x-.5,l[1]=c.center.y-.5,h=0,r!==(h=e.fog&&u.fog?n:h)&&(d.uniform1i(P,h),r=h),null!==u.map?(d.uniform2f(v,u.map.offset.x,u.map.offset.y),d.uniform2f(y,u.map.repeat.x,u.map.repeat.y)):(d.uniform2f(v,0,0),d.uniform2f(y,1,1)),d.uniform1f(A,u.opacity),d.uniform3f(M,u.color.r,u.color.g,u.color.b),d.uniform1f(b,u.rotation),d.uniform2fv(x,l),d.uniform2fv(w,s),f.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst,u.blendEquationAlpha,u.blendSrcAlpha,u.blendDstAlpha,u.premultipliedAlpha),f.buffers.depth.setTest(u.depthTest),f.buffers.depth.setMask(u.depthWrite),f.buffers.color.setMask(u.colorWrite),m.setTexture2D(u.map||z,0),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0),c.onAfterRender(p,e,i,void 0,u,void 0))}f.enable(d.CULL_FACE),f.reset()}}}function N(){Object.defineProperty(this,"id",{value:Zo++}),this.uuid=io.generateUUID(),this.name="",this.type="Material",this.lights=this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function k(t){N.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.setValues(t)}function z(t){N.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new _t,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.lights=this.fog=!1,this.setValues(t)}function U(t,e){this.min=void 0!==t?t:new _t(1/0,1/0,1/0),this.max=void 0!==e?e:new _t(-1/0,-1/0,-1/0)}function V(t,e){this.center=void 0!==t?t:new _t,this.radius=void 0!==e?e:0}function B(t,e){this.normal=void 0!==t?t:new _t(1,0,0),this.constant=void 0!==e?e:0}function Tt(t,e,i,r,n,o){this.planes=[void 0!==t?t:new B,void 0!==e?e:new B,void 0!==i?i:new B,void 0!==r?r:new B,void 0!==n?n:new B,void 0!==o?o:new B]}function Ct(p,d,t){function f(t,e,i,r,n,o){var a=t.geometry,s=null,s=c,l=t.customDepthMaterial;return i&&(s=h,l=t.customDistanceMaterial),s=l||(l=!1,e.morphTargets&&(a&&a.isBufferGeometry?l=a.morphAttributes&&a.morphAttributes.position&&0<a.morphAttributes.position.length:a&&a.isGeometry&&(l=a.morphTargets&&0<a.morphTargets.length)),t.isSkinnedMesh&&!1===e.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t),a=0,l&&(a|=1),(t=t.isSkinnedMesh&&e.skinning)&&(a|=2),s[a]),p.localClippingEnabled&&!0===e.clipShadows&&0!==e.clippingPlanes.length&&(l=s.uuid,t=e.uuid,void 0===(a=u[l])&&(u[l]=a={}),void 0===(l=a[t])&&(l=s.clone(),a[t]=l),s=l),s.visible=e.visible,s.wireframe=e.wireframe,s.side=null!=e.shadowSide?e.shadowSide:w[e.side],s.clipShadows=e.clipShadows,s.clippingPlanes=e.clippingPlanes,s.clipIntersection=e.clipIntersection,s.wireframeLinewidth=e.wireframeLinewidth,s.linewidth=e.linewidth,i&&s.isMeshDistanceMaterial&&(s.referencePosition.copy(r),s.nearDistance=n,s.farDistance=o),s}var m=new Tt,g=new Mt,v=new q,y=new q(t,t),b=new _t,x=new _t,c=Array(4),h=Array(4),u={},w={0:1,1:0,2:2},M=[new _t(1,0,0),new _t(-1,0,0),new _t(0,0,1),new _t(0,0,-1),new _t(0,1,0),new _t(0,-1,0)],_=[new _t(0,1,0),new _t(0,1,0),new _t(0,1,0),new _t(0,1,0),new _t(0,0,1),new _t(0,0,-1)],A=[new At,new At,new At,new At,new At,new At];for(t=0;4!==t;++t){var e=0!=(1&t),i=0!=(2&t),r=new k({depthPacking:3201,morphTargets:e,skinning:i});c[t]=r,e=new z({morphTargets:e,skinning:i}),h[t]=e}var E=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,e,i){if(!1!==E.enabled&&(!1!==E.autoUpdate||!1!==E.needsUpdate)&&0!==t.length){var r=p.state;r.disable(p.context.BLEND),r.buffers.color.setClear(1,1,1,1),r.buffers.depth.setTest(!0),r.setScissorTest(!1);for(var n=0,o=t.length;n<o;n++){var a=t[n],s=a.shadow,l=a&&a.isPointLight;if(void 0===s)console.warn("THREE.WebGLShadowMap:",a,"has no shadow.");else{var c,h,u=s.camera;for(v.copy(s.mapSize),v.min(y),l&&(c=v.x,h=v.y,A[0].set(2*c,h,c,h),A[1].set(0,h,c,h),A[2].set(3*c,h,c,h),A[3].set(c,h,c,h),A[4].set(3*c,0,c,h),A[5].set(c,0,c,h),v.x*=4,v.y*=2),null===s.map&&(s.map=new S(v.x,v.y,{minFilter:1003,magFilter:1003,format:1023}),s.map.texture.name=a.name+".shadowMap",u.updateProjectionMatrix()),s.isSpotLightShadow&&s.update(a),c=s.map,h=s.matrix,x.setFromMatrixPosition(a.matrixWorld),u.position.copy(x),l?(s=6,h.makeTranslation(-x.x,-x.y,-x.z)):(s=1,b.setFromMatrixPosition(a.target.matrixWorld),u.lookAt(b),u.updateMatrixWorld(),h.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),h.multiply(u.projectionMatrix),h.multiply(u.matrixWorldInverse)),p.setRenderTarget(c),p.clear(),a=0;a<s;a++)l&&(b.copy(u.position),b.add(M[a]),u.up.copy(_[a]),u.lookAt(b),u.updateMatrixWorld(),r.viewport(A[a])),g.multiplyMatrices(u.projectionMatrix,u.matrixWorldInverse),m.setFromMatrix(g),function t(e,i,r,n){if(!1!==e.visible){if(e.layers.test(i.layers)&&(e.isMesh||e.isLine||e.isPoints)&&e.castShadow&&(!e.frustumCulled||m.intersectsObject(e))){e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld);var o=d.update(e),a=e.material;if(Array.isArray(a))for(var s=o.groups,l=0,c=s.length;l<c;l++){var h=s[l],u=a[h.materialIndex];u&&u.visible&&(u=f(e,u,n,x,r.near,r.far),p.renderBufferDirect(r,null,o,u,e,h))}else a.visible&&(u=f(e,a,n,x,r.near,r.far),p.renderBufferDirect(r,null,o,u,e,null))}for(o=0,a=(e=e.children).length;o<a;o++)t(e[o],i,r,n)}}(e,i,u,l)}}E.needsUpdate=!1}}}function Ot(s){var l={};return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),l[t.uuid]},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var e=l[t.uuid];e&&(s.deleteBuffer(e.buffer),delete l[t.uuid])},update:function(t,e){t.isInterleavedBufferAttribute&&(t=t.data);var i,r,n,o,a=l[t.uuid];void 0===a?(a=t.uuid,r=(i=t).array,n=i.dynamic?s.DYNAMIC_DRAW:s.STATIC_DRAW,o=s.createBuffer(),s.bindBuffer(e,o),s.bufferData(e,r,n),i.onUploadCallback(),n=s.FLOAT,r instanceof Float32Array?n=s.FLOAT:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?n=s.UNSIGNED_SHORT:r instanceof Int16Array?n=s.SHORT:r instanceof Uint32Array?n=s.UNSIGNED_INT:r instanceof Int32Array?n=s.INT:r instanceof Int8Array?n=s.BYTE:r instanceof Uint8Array&&(n=s.UNSIGNED_BYTE),l[a]={buffer:o,type:n,bytesPerElement:r.BYTES_PER_ELEMENT,version:i.version}):a.version<t.version&&(r=(i=t).array,o=i.updateRange,s.bindBuffer(e,a.buffer),!1===i.dynamic?s.bufferData(e,r,s.STATIC_DRAW):-1===o.count?s.bufferSubData(e,0,r):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(s.bufferSubData(e,o.offset*r.BYTES_PER_ELEMENT,r.subarray(o.offset,o.offset+o.count)),o.count=-1),a.version=t.version)}}}function G(t,e,i,r){this._x=t||0,this._y=e||0,this._z=i||0,this._order=r||G.DefaultOrder}function W(){this.mask=1}function X(){Object.defineProperty(this,"id",{value:ba++}),this.uuid=io.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=X.DefaultUp.clone();var t=new _t,e=new G,i=new s,r=new _t(1,1,1);e.onChange(function(){i.setFromEuler(e,!1)}),i.onChange(function(){e.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new Mt},normalMatrix:{value:new g}}),this.matrix=new Mt,this.matrixWorld=new Mt,this.matrixAutoUpdate=X.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new W,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Y(){X.call(this),this.type="Camera",this.matrixWorldInverse=new Mt,this.projectionMatrix=new Mt}function K(t,e,i,r,n,o){Y.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=r,this.near=void 0!==n?n:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function J(t,e,i,r,n,o){this.a=t,this.b=e,this.c=i,this.normal=r&&r.isVector3?r:new _t,this.vertexNormals=Array.isArray(r)?r:[],this.color=n&&n.isColor?n:new j,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=void 0!==o?o:0}function Z(){Object.defineProperty(this,"id",{value:Sa+=2}),this.uuid=io.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function Q(t,e,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=io.generateUUID(),this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===i,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function $(t,e,i){Q.call(this,new Int8Array(t),e,i)}function tt(t,e,i){Q.call(this,new Uint8Array(t),e,i)}function et(t,e,i){Q.call(this,new Uint8ClampedArray(t),e,i)}function it(t,e,i){Q.call(this,new Int16Array(t),e,i)}function rt(t,e,i){Q.call(this,new Uint16Array(t),e,i)}function nt(t,e,i){Q.call(this,new Int32Array(t),e,i)}function ot(t,e,i){Q.call(this,new Uint32Array(t),e,i)}function at(t,e,i){Q.call(this,new Float32Array(t),e,i)}function st(t,e,i){Q.call(this,new Float64Array(t),e,i)}function lt(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function ct(t){if(0===t.length)return-1/0;for(var e=t[0],i=1,r=t.length;i<r;++i)t[i]>e&&(e=t[i]);return e}function ht(){Object.defineProperty(this,"id",{value:ws+=2}),this.uuid=io.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0}}function ut(t,e,i,r,n,o){Z.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:r,heightSegments:n,depthSegments:o},this.fromBufferGeometry(new pt(t,e,i,r,n,o)),this.mergeVertices()}function pt(t,e,i,r,n,o){function a(t,e,i,r,n,o,a,s,l,c,h){var u=o/l,p=a/c,d=o/2,f=a/2,m=s/2;a=l+1;for(var g=c+1,v=o=0,y=new _t,b=0;b<g;b++)for(var x=b*p-f,w=0;w<a;w++)y[t]=(w*u-d)*r,y[e]=x*n,y[i]=m,A.push(y.x,y.y,y.z),y[t]=0,y[e]=0,y[i]=0<s?1:-1,E.push(y.x,y.y,y.z),S.push(w/l),S.push(1-b/c),o+=1;for(b=0;b<c;b++)for(w=0;w<l;w++)t=P+w+a*(b+1),e=P+(w+1)+a*(b+1),i=P+(w+1)+a*b,_.push(P+w+a*b,t,i),_.push(t,e,i),v+=6;M.addGroup(T,v,h),T+=v,P+=o}ht.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:r,heightSegments:n,depthSegments:o};var M=this;t=t||1,e=e||1,i=i||1,r=Math.floor(r)||1,n=Math.floor(n)||1,o=Math.floor(o)||1;var _=[],A=[],E=[],S=[],P=0,T=0;a("z","y","x",-1,-1,i,e,t,o,n,0),a("z","y","x",1,-1,i,e,-t,o,n,1),a("x","z","y",1,1,t,i,e,r,o,2),a("x","z","y",1,-1,t,i,-e,r,o,3),a("x","y","z",1,-1,t,e,i,r,n,4),a("x","y","z",-1,-1,t,e,-i,r,n,5),this.setIndex(_),this.addAttribute("position",new at(A,3)),this.addAttribute("normal",new at(E,3)),this.addAttribute("uv",new at(S,2))}function dt(t,e,i,r){Z.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:r},this.fromBufferGeometry(new ft(t,e,i,r)),this.mergeVertices()}function ft(t,e,i,r){ht.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:r};var n=(t=t||1)/2,o=(e=e||1)/2,a=(i=Math.floor(i)||1)+1,s=(r=Math.floor(r)||1)+1,l=t/i,c=e/r,h=[],u=[],p=[],d=[];for(t=0;t<s;t++){var f=t*c-o;for(e=0;e<a;e++)u.push(e*l-n,-f,0),p.push(0,0,1),d.push(e/i),d.push(1-t/r)}for(t=0;t<r;t++)for(e=0;e<i;e++)o=e+1+a*(t+1),h.push(e+a*t,n=e+a*(t+1),s=e+1+a*t),h.push(n,o,s);this.setIndex(h),this.addAttribute("position",new at(u,3)),this.addAttribute("normal",new at(p,3)),this.addAttribute("uv",new at(d,2))}function mt(t){N.call(this),this.type="MeshBasicMaterial",this.color=new j(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.lights=this.morphTargets=this.skinning=!1,this.setValues(t)}function gt(t){N.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function vt(t,e){this.origin=void 0!==t?t:new _t,this.direction=void 0!==e?e:new _t}function yt(t,e){this.start=void 0!==t?t:new _t,this.end=void 0!==e?e:new _t}function bt(t,e,i){this.a=void 0!==t?t:new _t,this.b=void 0!==e?e:new _t,this.c=void 0!==i?i:new _t}function xt(t,e){X.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new ht,this.material=void 0!==e?e:new mt({color:16777215*Math.random()}),this.drawMode=0,this.updateMorphTargets()}function Rt(n,i,o,r){function a(t,e){i.buffers.color.setClear(t.r,t.g,t.b,e,r)}var s,l,c,h=new j(0),u=0;return{getClearColor:function(){return h},setClearColor:function(t,e){h.set(t),a(h,u=void 0!==e?e:1)},getClearAlpha:function(){return u},setClearAlpha:function(t){a(h,u=t)},render:function(t,e,i,r){null===(e=e.background)?a(h,u):e&&e.isColor&&(a(e,1),r=!0),(n.autoClear||r)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),e&&e.isCubeTexture?(void 0===c&&((c=new xt(new pt(1,1,1),new gt({uniforms:bo.cube.uniforms,vertexShader:bo.cube.vertexShader,fragmentShader:bo.cube.fragmentShader,side:1,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),c.geometry.removeAttribute("uv"),c.onBeforeRender=function(t,e,i){this.matrixWorld.copyPosition(i.matrixWorld)},o.update(c.geometry)),c.material.uniforms.tCube.value=e,t.push(c,c.geometry,c.material,0,null)):e&&e.isTexture&&(void 0===s&&(s=new K(-1,1,1,-1,0,1),l=new xt(new ft(2,2),new mt({depthTest:!1,depthWrite:!1,fog:!1})),o.update(l.geometry)),l.material.map=e,n.renderBufferDirect(s,null,l.geometry,l.material,l,null))}}}function wt(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Lt(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function It(){var a=[],s=0,l=[],c=[];return{opaque:l,transparent:c,init:function(){s=0,l.length=0,c.length=0},push:function(t,e,i,r,n){var o=a[s];void 0===o?(o={id:t.id,object:t,geometry:e,material:i,program:i.program,renderOrder:t.renderOrder,z:r,group:n},a[s]=o):(o.id=t.id,o.object=t,o.geometry=e,o.material=i,o.program=i.program,o.renderOrder=t.renderOrder,o.z=r,o.group=n),(!0===i.transparent?c:l).push(o),s++},sort:function(){1<l.length&&l.sort(wt),1<c.length&&c.sort(Lt)}}}function Dt(){var i={};return{get:function(t,e){t=t.id+","+e.id,e=i[t];return void 0===e&&(e=new It,i[t]=e),e},dispose:function(){i={}}}}function Ft(t,e){return Math.abs(e[1])-Math.abs(t[1])}function jt(c){var h={},u=new Float32Array(8);return{update:function(t,e,i,r){var n=t.morphTargetInfluences,o=n.length;if(void 0===(t=h[e.id])){t=[];for(var a=0;a<o;a++)t[a]=[a,0];h[e.id]=t}var s=i.morphTargets&&e.morphAttributes.position;for(i=i.morphNormals&&e.morphAttributes.normal,a=0;a<o;a++){var l=t[a];0!==l[1]&&(s&&e.removeAttribute("morphTarget"+a),i&&e.removeAttribute("morphNormal"+a))}for(a=0;a<o;a++)(l=t[a])[0]=a,l[1]=n[a];for(t.sort(Ft),a=0;a<8;a++)(l=t[a])&&(n=l[0],o=l[1])?(s&&e.addAttribute("morphTarget"+a,s[n]),i&&e.addAttribute("morphNormal"+a,i[n]),u[a]=o):u[a]=0;r.getUniforms().setValue(c,"morphTargetInfluences",u)}}}function Nt(n,o,a){var s,l,c;this.setMode=function(t){s=t},this.setIndex=function(t){l=t.type,c=t.bytesPerElement},this.render=function(t,e){n.drawElements(s,e,l,t*c),a.calls++,a.vertices+=e,s===n.TRIANGLES?a.faces+=e/3:s===n.POINTS&&(a.points+=e)},this.renderInstances=function(t,e,i){var r=o.get("ANGLE_instanced_arrays");null===r?console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(r.drawElementsInstancedANGLE(s,i,l,e*c,t.maxInstancedCount),a.calls++,a.vertices+=i*t.maxInstancedCount,s===n.TRIANGLES?a.faces+=t.maxInstancedCount*i/3:s===n.POINTS&&(a.points+=t.maxInstancedCount*i))}}function kt(o,a,s){var l;this.setMode=function(t){l=t},this.render=function(t,e){o.drawArrays(l,t,e),s.calls++,s.vertices+=e,l===o.TRIANGLES?s.faces+=e/3:l===o.POINTS&&(s.points+=e)},this.renderInstances=function(t,e,i){var r,n=a.get("ANGLE_instanced_arrays");null===n?console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):((r=t.attributes.position).isInterleavedBufferAttribute?(i=r.data.count,n.drawArraysInstancedANGLE(l,0,i,t.maxInstancedCount)):n.drawArraysInstancedANGLE(l,e,i,t.maxInstancedCount),s.calls++,s.vertices+=i*t.maxInstancedCount,l===o.TRIANGLES?s.faces+=t.maxInstancedCount*i/3:l===o.POINTS&&(s.points+=t.maxInstancedCount*i))}}function zt(l,c,r){function n(t){t=t.target;var e,i=o[t.id];for(e in null!==i.index&&c.remove(i.index),i.attributes)c.remove(i.attributes[e]);t.removeEventListener("dispose",n),delete o[t.id],(e=h[t.id])&&(c.remove(e),delete h[t.id]),(e=h[i.id])&&(c.remove(e),delete h[i.id]),r.geometries--,r.vertices-=i.attributes.position.count,t.faces&&(r.faces-=t.faces.length)}var o={},h={};return{get:function(t,e){var i=o[e.id];return i||(e.addEventListener("dispose",n),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new ht).setFromObject(t)),i=e._bufferGeometry),o[e.id]=i,r.geometries++,r.vertices+=i.attributes.position.count,e.faces&&(r.faces+=e.faces.length),i)},update:function(t){var e,i=t.index,r=t.attributes;for(e in null!==i&&c.update(i,l.ELEMENT_ARRAY_BUFFER),r)c.update(r[e],l.ARRAY_BUFFER);for(e in t=t.morphAttributes)for(var i=t[e],r=0,n=i.length;r<n;r++)c.update(i[r],l.ARRAY_BUFFER)},getWireframeAttribute:function(t){if(e=h[t.id])return e;var e=[],i=t.index,r=t.attributes;if(null!==i)for(var r=0,n=(i=i.array).length;r<n;r+=3){var o=i[r+0],a=i[r+1],s=i[r+2];e.push(o,a,a,s,s,o)}else for(i=r.position.array,r=0,n=i.length/3-1;r<n;r+=3)e.push(o=r+0,a=r+1,a,s=r+2,s,o);return e=new(65535<ct(e)?ot:rt)(e,1),c.update(e,l.ELEMENT_ARRAY_BUFFER),h[t.id]=e}}}function Ut(n,o){var a={};return{update:function(t){var e=o.frame,i=t.geometry,r=n.get(t,i);return a[r.id]!==e&&(i.isGeometry&&r.updateFromObject(t),n.update(r),a[r.id]=e),r},dispose:function(){a={}}}}function Vt(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),!1===t.getShaderParameter(r,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(r),function(t){t=t.split("\n");for(var e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(i)),r}function Bt(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+t)}}function Ht(t,e){e=Bt(e);return"vec4 "+t+"( vec4 value ) { return "+e[0]+"ToLinear"+e[1]+"; }"}function Gt(t){return""!==t}function Wt(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Xt(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function qt(t){return t.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(t,e){var i=yo[e];if(void 0===i)throw Error("Can not resolve #include <"+e+">");return qt(i)})}function Yt(t){return t.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,i,r){for(t="",e=parseInt(e);e<parseInt(i);e++)t+=r.replace(/\[ i \]/g,"[ "+e+" ]");return t})}function Kt(t,e,i,r,n,o){var a=t.context,s=r.defines,l=n.vertexShader,c=n.fragmentShader,h="SHADOWMAP_TYPE_BASIC";1===o.shadowMapType?h="SHADOWMAP_TYPE_PCF":2===o.shadowMapType&&(h="SHADOWMAP_TYPE_PCF_SOFT");var u="ENVMAP_TYPE_CUBE",p="ENVMAP_MODE_REFLECTION",d="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(r.envMap.mapping){case 301:case 302:u="ENVMAP_TYPE_CUBE";break;case 306:case 307:u="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:u="ENVMAP_TYPE_EQUIREC";break;case 305:u="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case 302:case 304:p="ENVMAP_MODE_REFRACTION"}switch(r.combine){case 0:d="ENVMAP_BLENDING_MULTIPLY";break;case 1:d="ENVMAP_BLENDING_MIX";break;case 2:d="ENVMAP_BLENDING_ADD"}}var f,m,g,v,y,b=0<t.gammaFactor?t.gammaFactor:1,m=(f=r.extensions,m=o,g=e,[(f=f||{}).derivatives||m.envMapCubeUV||m.bumpMap||m.normalMap||m.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(f.fragDepth||m.logarithmicDepthBuffer)&&g.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",f.drawBuffers&&g.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(f.shaderTextureLOD||m.envMap)&&g.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Gt).join("\n")),g=function(t){var e,i=[];for(e in t){var r=t[e];!1!==r&&i.push("#define "+e+" "+r)}return i.join("\n")}(s),x=a.createProgram();return r.isRawShaderMaterial?(0<(s=[g].filter(Gt).join("\n")).length&&(s+="\n"),0<(e=[m,g].filter(Gt).join("\n")).length&&(e+="\n")):(s=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+n.name,g,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+b,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+p:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Gt).join("\n"),e=[m,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+n.name,g,o.alphaTest?"#define ALPHATEST "+o.alphaTest:"","#define GAMMA_FACTOR "+b,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+u:"",o.envMap?"#define "+p:"",o.envMap?"#define "+d:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&e.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==o.toneMapping?"#define TONE_MAPPING":"",0!==o.toneMapping?yo.tonemapping_pars_fragment:"",0!==o.toneMapping?function(t,e){var i;switch(e){case 1:i="Linear";break;case 2:i="Reinhard";break;case 3:i="Uncharted2";break;case 4:i="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?yo.encodings_pars_fragment:"",o.mapEncoding?Ht("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?Ht("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?Ht("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?(g="linearToOutputTexel",b=Bt(b=o.outputEncoding),"vec4 "+g+"( vec4 value ) { return LinearTo"+b[0]+b[1]+"; }"):"",o.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Gt).join("\n")),l=Xt(Wt(qt(l),o),o),c=Xt(Wt(qt(c),o),o),l=Yt(l),c=e+Yt(c),l=Vt(a,a.VERTEX_SHADER,s+l),c=Vt(a,a.FRAGMENT_SHADER,c),a.attachShader(x,l),a.attachShader(x,c),void 0!==r.index0AttributeName?a.bindAttribLocation(x,0,r.index0AttributeName):!0===o.morphTargets&&a.bindAttribLocation(x,0,"position"),a.linkProgram(x),o=a.getProgramInfoLog(x).trim(),n=a.getShaderInfoLog(l).trim(),h=a.getShaderInfoLog(c).trim(),!(p=u=!0)===a.getProgramParameter(x,a.LINK_STATUS)?(u=!1,console.error("THREE.WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(x,a.VALIDATE_STATUS),"gl.getProgramInfoLog",o,n,h)):""!==o?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",o):""!==n&&""!==h||(p=!1),p&&(this.diagnostics={runnable:u,material:r,programLog:o,vertexShader:{log:n,prefix:s},fragmentShader:{log:h,prefix:e}}),a.deleteShader(l),a.deleteShader(c),this.getUniforms=function(){return v=void 0===v?new St(a,x,t):v},this.getAttributes=function(){if(void 0===y){for(var t={},e=a.getProgramParameter(x,a.ACTIVE_ATTRIBUTES),i=0;i<e;i++){var r=a.getActiveAttrib(x,i).name;t[r]=a.getAttribLocation(x,r)}y=t}return y},this.destroy=function(){a.deleteProgram(x),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Es++,this.code=i,this.usedTimes=1,this.program=x,this.vertexShader=l,this.fragmentShader=c,this}function Jt(u,l,p){function d(t,e){var i;return t?t.isTexture?i=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=t.texture.encoding):i=3e3,i=3e3===i&&e?3007:i}var c=[],f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},n="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering".split(" ");this.getParameters=function(t,e,i,r,n,o,a){var s,l,c=f[t.type];l=a.isSkinnedMesh?(l=a.skeleton.bones,p.floatVertexTextures?1024:(s=Math.min(Math.floor((p.maxVertexUniforms-20)/4),l.length))<l.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+l.length+" bones. This GPU supports "+s+"."),0):s):0,s=p.precision,null===t.precision||(s=p.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",s,"instead.");var h=u.getRenderTarget();return{shaderID:c,precision:s,supportsVertexTextures:p.vertexTextures,outputEncoding:d(h?h.texture:null,u.gammaOutput),map:!!t.map,mapEncoding:d(t.map,u.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:d(t.envMap,u.gammaInput),envMapCubeUV:!!t.envMap&&(306===t.envMap.mapping||307===t.envMap.mapping),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:d(t.emissiveMap,u.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexColors:t.vertexColors,fog:!!r,useFog:t.fog,fogExp:r&&r.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:p.logarithmicDepthBuffer,skinning:t.skinning&&0<l,maxBones:l,useVertexTexture:p.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:u.maxMorphTargets,maxMorphNormals:u.maxMorphNormals,numDirLights:e.directional.length,numPointLights:e.point.length,numSpotLights:e.spot.length,numRectAreaLights:e.rectArea.length,numHemiLights:e.hemi.length,numClippingPlanes:n,numClipIntersection:o,dithering:t.dithering,shadowMapEnabled:u.shadowMap.enabled&&a.receiveShadow&&0<i.length,shadowMapType:u.shadowMap.type,toneMapping:u.toneMapping,physicallyCorrectLights:u.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:2===t.side,flipSided:1===t.side,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,e){var i=[];if(e.shaderID?i.push(e.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)i.push(r),i.push(t.defines[r]);for(r=0;r<n.length;r++)i.push(e[n[r]]);return i.push(t.onBeforeCompile.toString()),i.push(u.gammaOutput),i.join()},this.acquireProgram=function(t,e,i,r){for(var n,o=0,a=c.length;o<a;o++){var s=c[o];if(s.code===r){++(n=s).usedTimes;break}}return void 0===n&&(n=new Kt(u,l,r,t,e,i),c.push(n)),n},this.releaseProgram=function(t){var e;0==--t.usedTimes&&(e=c.indexOf(t),c[e]=c[c.length-1],c.pop(),t.destroy())},this.programs=c}function Zt(f,r,m,g,v,y,b,h){function x(t,e){if(t.width>e||t.height>e){var i=e/Math.max(t.width,t.height),e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return e.width=Math.floor(t.width*i),e.height=Math.floor(t.height*i),e.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,e.width,e.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+e.width+"x"+e.height,t),e}return t}function w(t){return io.isPowerOfTwo(t.width)&&io.isPowerOfTwo(t.height)}function M(t,e){return t.generateMipmaps&&e&&1003!==t.minFilter&&1006!==t.minFilter}function n(t){return 1003===t||1004===t||1005===t?f.NEAREST:f.LINEAR}function _(t){(t=t.target).removeEventListener("dispose",_);t:{var e=g.get(t);if(t.image&&e.__image__webglTextureCube)f.deleteTexture(e.__image__webglTextureCube);else{if(void 0===e.__webglInit)break t;f.deleteTexture(e.__webglTexture)}g.remove(t)}t.isVideoTexture&&delete d[t.id],b.textures--,b.textureSz-=t.textureSz}function a(t){(t=t.target).removeEventListener("dispose",a);var e=g.get(t),i=g.get(t.texture);if(t){if(void 0!==i.__webglTexture&&f.deleteTexture(i.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLRenderTargetCube)for(i=0;i<6;i++)f.deleteFramebuffer(e.__webglFramebuffer[i]),e.__webglDepthbuffer&&f.deleteRenderbuffer(e.__webglDepthbuffer[i]);else f.deleteFramebuffer(e.__webglFramebuffer),e.__webglDepthbuffer&&f.deleteRenderbuffer(e.__webglDepthbuffer);g.remove(t.texture),g.remove(t)}b.textures--}function s(t,e){var i=g.get(t);if(t.isVideoTexture&&(n=t.id,o=h.frame,d[n]!==o&&(d[n]=o,t.update())),0<t.version&&i.__version!==t.version)if(void 0===(n=t.image))console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else{if(!1!==n.complete){void 0===i.__webglInit?(i.__webglInit=!0,t.addEventListener("dispose",_),i.__webglTexture=f.createTexture(),b.textures++):b.textureSz-=t.textureSz,t.textureSz=0,m.activeTexture(f.TEXTURE0+e),m.bindTexture(f.TEXTURE_2D,i.__webglTexture),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,t.flipY),f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),f.pixelStorei(f.UNPACK_ALIGNMENT,t.unpackAlignment);var r=x(t.image,v.maxTextureSize);(1001!==t.wrapS||1001!==t.wrapT||1003!==t.minFilter&&1006!==t.minFilter)&&!1===w(r)&&(r=(n=r)instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof ImageBitmap?((u=void 0===u?document.createElementNS("http://www.w3.org/1999/xhtml","canvas"):u).width=io.floorPowerOfTwo(n.width),u.height=io.floorPowerOfTwo(n.height),u.getContext("2d").drawImage(n,0,0,u.width,u.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+n.width+"x"+n.height+"). Resized to "+u.width+"x"+u.height,n),u):n);var n=w(r),o=y.convert(t.format),a=y.convert(t.type);A(f.TEXTURE_2D,t,n);var s=t.mipmaps;if(t.isDepthTexture){if(s=f.DEPTH_COMPONENT,1015===t.type){if(!p)throw Error("Float Depth Texture only supported in WebGL2.0");s=f.DEPTH_COMPONENT32F}else p&&(s=f.DEPTH_COMPONENT16);1026===t.format&&s===f.DEPTH_COMPONENT&&1012!==t.type&&1014!==t.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),t.type=1012,a=y.convert(t.type)),1027===t.format&&(s=f.DEPTH_STENCIL,1020!==t.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),t.type=1020,a=y.convert(t.type))),m.texImage2D(f.TEXTURE_2D,0,s,r.width,r.height,0,o,a,null)}else if(t.isDataTexture)if(0<s.length&&n){for(var l=0,c=s.length;l<c;l++)r=s[l],m.texImage2D(f.TEXTURE_2D,l,o,r.width,r.height,0,o,a,r.data);t.generateMipmaps=!1}else m.texImage2D(f.TEXTURE_2D,0,o,r.width,r.height,0,o,a,r.data);else if(t.isCompressedTexture)for(l=0,c=s.length;l<c;l++)r=s[l],1023!==t.format&&1022!==t.format?-1<m.getCompressedTextureFormats().indexOf(o)?m.compressedTexImage2D(f.TEXTURE_2D,l,o,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):m.texImage2D(f.TEXTURE_2D,l,o,r.width,r.height,0,o,a,r.data);else if(0<s.length&&n){for(l=0,c=s.length;l<c;l++)r=s[l],m.texImage2D(f.TEXTURE_2D,l,o,o,a,r),t.textureSz+=r.image.width*r.image.height*(1023===r.format?4:3);t.generateMipmaps=!1}else m.texImage2D(f.TEXTURE_2D,0,o,o,a,r),t.textureSz+=t.image.width*t.image.height*(1023===t.format?4:3);return M(t,n)&&f.generateMipmap(f.TEXTURE_2D),i.__version=t.version,t.onUpdate&&t.onUpdate(t),void(b.textureSz+=t.textureSz)}console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t)}m.activeTexture(f.TEXTURE0+e),m.bindTexture(f.TEXTURE_2D,i.__webglTexture)}function A(t,e,i){i?(f.texParameteri(t,f.TEXTURE_WRAP_S,y.convert(e.wrapS)),f.texParameteri(t,f.TEXTURE_WRAP_T,y.convert(e.wrapT)),f.texParameteri(t,f.TEXTURE_MAG_FILTER,y.convert(e.magFilter)),f.texParameteri(t,f.TEXTURE_MIN_FILTER,y.convert(e.minFilter))):(f.texParameteri(t,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(t,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),1001===e.wrapS&&1001===e.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",e),f.texParameteri(t,f.TEXTURE_MAG_FILTER,n(e.magFilter)),f.texParameteri(t,f.TEXTURE_MIN_FILTER,n(e.minFilter)),1003!==e.minFilter&&1006!==e.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",e)),!(i=r.get("EXT_texture_filter_anisotropic"))||1015===e.type&&null===r.get("OES_texture_float_linear")||1016===e.type&&null===r.get("OES_texture_half_float_linear")||!(1<e.anisotropy||g.get(e).__currentAnisotropy)||(f.texParameterf(t,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,v.getMaxAnisotropy())),g.get(e).__currentAnisotropy=e.anisotropy)}function l(t,e,i,r){var n=y.convert(e.texture.format),o=y.convert(e.texture.type);m.texImage2D(r,0,n,e.width,e.height,0,n,o,null),f.bindFramebuffer(f.FRAMEBUFFER,t),f.framebufferTexture2D(f.FRAMEBUFFER,i,r,g.get(e.texture).__webglTexture,0),f.bindFramebuffer(f.FRAMEBUFFER,null)}function c(t,e){f.bindRenderbuffer(f.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,e.width,e.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_STENCIL,e.width,e.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,t)):f.renderbufferStorage(f.RENDERBUFFER,f.RGBA4,e.width,e.height),f.bindRenderbuffer(f.RENDERBUFFER,null)}var u,p="undefined"!=typeof WebGL2RenderingContext&&f instanceof WebGL2RenderingContext,d={};this.setTexture2D=s,this.setTextureCube=function(t,e){var i=g.get(t);if(6===t.image.length)if(0<t.version&&i.__version!==t.version){i.__image__webglTextureCube||(t.addEventListener("dispose",_),i.__image__webglTextureCube=f.createTexture(),b.textures++,t.textureSz=0),m.activeTexture(f.TEXTURE0+e),m.bindTexture(f.TEXTURE_CUBE_MAP,i.__image__webglTextureCube),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var r=t&&t.isCompressedTexture,n=t.image[0]&&t.image[0].isDataTexture,o=[],a=0;a<6;a++)o[a]=r||n?n?t.image[a].image:t.image[a]:x(t.image[a],v.maxCubemapSize);var s=w(o[0]),l=y.convert(t.format),c=y.convert(t.type);for(A(f.TEXTURE_CUBE_MAP,t,s),a=0;a<6;a++)if(r)for(var h,u=o[a].mipmaps,p=0,d=u.length;p<d;p++)h=u[p],1023!==t.format&&1022!==t.format?-1<m.getCompressedTextureFormats().indexOf(l)?m.compressedTexImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+a,p,l,h.width,h.height,0,h.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):m.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+a,p,l,h.width,h.height,0,l,c,h.data),t.textureSz+=h.width*h.height*(1023===t.format?4:3);else n?m.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,l,o[a].width,o[a].height,0,l,c,o[a].data):m.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,l,l,c,o[a]),t.textureSz+=o[a].width*o[a].height*(1023===t.format?4:3);M(t,s)&&f.generateMipmap(f.TEXTURE_CUBE_MAP),i.__version=t.version,t.onUpdate&&t.onUpdate(t),b.textureSz+=t.textureSz}else m.activeTexture(f.TEXTURE0+e),m.bindTexture(f.TEXTURE_CUBE_MAP,i.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,e){m.activeTexture(f.TEXTURE0+e),m.bindTexture(f.TEXTURE_CUBE_MAP,g.get(t).__webglTexture)},this.setupRenderTarget=function(t){var e=g.get(t),i=g.get(t.texture);t.addEventListener("dispose",a),i.__webglTexture=f.createTexture(),b.textures++;var r=!0===t.isWebGLRenderTargetCube,n=w(t);if(r){e.__webglFramebuffer=[];for(var o=0;o<6;o++)e.__webglFramebuffer[o]=f.createFramebuffer()}else e.__webglFramebuffer=f.createFramebuffer();if(r){for(m.bindTexture(f.TEXTURE_CUBE_MAP,i.__webglTexture),A(f.TEXTURE_CUBE_MAP,t.texture,n),o=0;o<6;o++)l(e.__webglFramebuffer[o],t,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+o);M(t.texture,n)&&f.generateMipmap(f.TEXTURE_CUBE_MAP),m.bindTexture(f.TEXTURE_CUBE_MAP,null)}else m.bindTexture(f.TEXTURE_2D,i.__webglTexture),A(f.TEXTURE_2D,t.texture,n),l(e.__webglFramebuffer,t,f.COLOR_ATTACHMENT0,f.TEXTURE_2D),M(t.texture,n)&&f.generateMipmap(f.TEXTURE_2D),m.bindTexture(f.TEXTURE_2D,null);if(t.depthBuffer){if(e=g.get(t),i=!0===t.isWebGLRenderTargetCube,t.depthTexture){if(i)throw Error("target.depthTexture not supported in Cube render targets");if(t&&t.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");if(f.bindFramebuffer(f.FRAMEBUFFER,e.__webglFramebuffer),!t.depthTexture||!t.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(g.get(t.depthTexture).__webglTexture&&t.depthTexture.image.width===t.width&&t.depthTexture.image.height===t.height||(t.depthTexture.image.width=t.width,t.depthTexture.image.height=t.height,t.depthTexture.needsUpdate=!0),s(t.depthTexture,0),e=g.get(t.depthTexture).__webglTexture,1026===t.depthTexture.format)f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.TEXTURE_2D,e,0);else{if(1027!==t.depthTexture.format)throw Error("Unknown depthTexture format");f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.TEXTURE_2D,e,0)}}else if(i)for(e.__webglDepthbuffer=[],i=0;i<6;i++)f.bindFramebuffer(f.FRAMEBUFFER,e.__webglFramebuffer[i]),e.__webglDepthbuffer[i]=f.createRenderbuffer(),c(e.__webglDepthbuffer[i],t);else f.bindFramebuffer(f.FRAMEBUFFER,e.__webglFramebuffer),e.__webglDepthbuffer=f.createRenderbuffer(),c(e.__webglDepthbuffer,t);f.bindFramebuffer(f.FRAMEBUFFER,null)}},this.updateRenderTargetMipmap=function(t){var e=t.texture;M(e,w(t))&&(t=t.isWebGLRenderTargetCube?f.TEXTURE_CUBE_MAP:f.TEXTURE_2D,e=g.get(e).__webglTexture,m.bindTexture(t,e),f.generateMipmap(t),m.bindTexture(t,null))}}function Qt(){var r={};return{get:function(t){t=t.uuid;var e=r[t];return void 0===e&&(r[t]=e={}),e},remove:function(t){delete r[t.uuid]},update:function(t,e,i){r[t.uuid][e]=i},dispose:function(){r={}}}}function $t(h,i,l){function t(t,e,i){var r=new Uint8Array(4),n=h.createTexture();for(h.bindTexture(t,n),h.texParameteri(t,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(t,h.TEXTURE_MAG_FILTER,h.NEAREST),t=0;t<i;t++)h.texImage2D(e+t,0,h.RGBA,1,1,0,h.RGBA,h.UNSIGNED_BYTE,r);return n}function u(t){!0!==y[t]&&(h.enable(t),y[t]=!0)}function p(t){!1!==y[t]&&(h.disable(t),y[t]=!1)}function r(t,e,i,r,n,o,a,s){if((0!==t?u:p)(h.BLEND),5!==t){if(t!==w||s!==T)switch(t){case 2:s?(h.blendEquationSeparate(h.FUNC_ADD,h.FUNC_ADD),h.blendFuncSeparate(h.ONE,h.ONE,h.ONE,h.ONE)):(h.blendEquation(h.FUNC_ADD),h.blendFunc(h.SRC_ALPHA,h.ONE));break;case 3:s?(h.blendEquationSeparate(h.FUNC_ADD,h.FUNC_ADD),h.blendFuncSeparate(h.ZERO,h.ZERO,h.ONE_MINUS_SRC_COLOR,h.ONE_MINUS_SRC_ALPHA)):(h.blendEquation(h.FUNC_ADD),h.blendFunc(h.ZERO,h.ONE_MINUS_SRC_COLOR));break;case 4:s?(h.blendEquationSeparate(h.FUNC_ADD,h.FUNC_ADD),h.blendFuncSeparate(h.ZERO,h.SRC_COLOR,h.ZERO,h.SRC_ALPHA)):(h.blendEquation(h.FUNC_ADD),h.blendFunc(h.ZERO,h.SRC_COLOR));break;default:s?(h.blendEquationSeparate(h.FUNC_ADD,h.FUNC_ADD),h.blendFuncSeparate(h.ONE,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA)):(h.blendEquationSeparate(h.FUNC_ADD,h.FUNC_ADD),h.blendFuncSeparate(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA))}P=S=E=A=_=M=null}else n=n||e,o=o||i,a=a||r,e===M&&n===E||(h.blendEquationSeparate(l.convert(e),l.convert(n)),M=e,E=n),i===_&&r===A&&o===S&&a===P||(h.blendFuncSeparate(l.convert(i),l.convert(r),l.convert(o),l.convert(a)),_=i,A=r,S=o,P=a);w=t,T=s}function n(t){C!==t&&(t?h.frontFace(h.CW):h.frontFace(h.CCW),C=t)}function e(t){0!==t?(u(h.CULL_FACE),t!==O&&(1===t?h.cullFace(h.BACK):2===t?h.cullFace(h.FRONT):h.cullFace(h.FRONT_AND_BACK))):p(h.CULL_FACE),O=t}function o(t,e,i){t?(u(h.POLYGON_OFFSET_FILL),L===e&&I===i||(h.polygonOffset(e,i),L=e,I=i)):p(h.POLYGON_OFFSET_FILL)}function a(t){void 0===t&&(t=h.TEXTURE0+D-1),j!==t&&(h.activeTexture(t),j=t)}var s=new function(){var e=!1,o=new At,i=null,a=new At(0,0,0,0);return{setMask:function(t){i===t||e||(h.colorMask(t,t,t,t),i=t)},setLocked:function(t){e=t},setClear:function(t,e,i,r,n){!0===n&&(t*=r,e*=r,i*=r),o.set(t,e,i,r),!1===a.equals(o)&&(h.clearColor(t,e,i,r),a.copy(o))},reset:function(){e=!1,i=null,a.set(-1,0,0,0)}}},c=new function(){var e=!1,i=null,r=null,n=null;return{setTest:function(t){(t?u:p)(h.DEPTH_TEST)},setMask:function(t){i===t||e||(h.depthMask(t),i=t)},setFunc:function(t){if(r!==t){if(t)switch(t){case 0:h.depthFunc(h.NEVER);break;case 1:h.depthFunc(h.ALWAYS);break;case 2:h.depthFunc(h.LESS);break;case 3:h.depthFunc(h.LEQUAL);break;case 4:h.depthFunc(h.EQUAL);break;case 5:h.depthFunc(h.GEQUAL);break;case 6:h.depthFunc(h.GREATER);break;case 7:h.depthFunc(h.NOTEQUAL);break;default:h.depthFunc(h.LEQUAL)}else h.depthFunc(h.LEQUAL);r=t}},setLocked:function(t){e=t},setClear:function(t){n!==t&&(h.clearDepth(t),n=t)},reset:function(){e=!1,n=r=i=null}}},d=new function(){var e=!1,i=null,r=null,n=null,o=null,a=null,s=null,l=null,c=null;return{setTest:function(t){(t?u:p)(h.STENCIL_TEST)},setMask:function(t){i===t||e||(h.stencilMask(t),i=t)},setFunc:function(t,e,i){r===t&&n===e&&o===i||(h.stencilFunc(t,e,i),r=t,n=e,o=i)},setOp:function(t,e,i){a===t&&s===e&&l===i||(h.stencilOp(t,e,i),a=t,s=e,l=i)},setLocked:function(t){e=t},setClear:function(t){c!==t&&(h.clearStencil(t),c=t)},reset:function(){e=!1,c=l=s=a=o=n=r=i=null}}},f=h.getParameter(h.MAX_VERTEX_ATTRIBS),m=new Uint8Array(f),g=new Uint8Array(f),v=new Uint8Array(f),y={},b=null,x=null,w=null,M=null,_=null,A=null,E=null,S=null,P=null,T=!1,C=null,O=null,R=null,L=null,I=null,D=h.getParameter(h.MAX_COMBINED_TEXTURE_IMAGE_UNITS),F=!1,f=0;-1!==(f=h.getParameter(h.VERSION)).indexOf("WebGL")?(f=parseFloat(/^WebGL\ ([0-9])/.exec(f)[1]),F=1<=f):-1!==f.indexOf("OpenGL ES")&&(f=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(f)[1]),F=2<=f);var j=null,N={},k=new At,z=new At,U={};return U[h.TEXTURE_2D]=t(h.TEXTURE_2D,h.TEXTURE_2D,1),U[h.TEXTURE_CUBE_MAP]=t(h.TEXTURE_CUBE_MAP,h.TEXTURE_CUBE_MAP_POSITIVE_X,6),s.setClear(0,0,0,1),c.setClear(1),d.setClear(0),u(h.DEPTH_TEST),c.setFunc(3),n(!1),e(1),u(h.CULL_FACE),u(h.BLEND),r(1),{buffers:{color:s,depth:c,stencil:d},initAttributes:function(){for(var t=0,e=m.length;t<e;t++)m[t]=0},enableAttribute:function(t){m[t]=1,0===g[t]&&(h.enableVertexAttribArray(t),g[t]=1),0!==v[t]&&(i.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(t,0),v[t]=0)},enableAttributeAndDivisor:function(t,e){m[t]=1,0===g[t]&&(h.enableVertexAttribArray(t),g[t]=1),v[t]!==e&&(i.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(t,e),v[t]=e)},disableUnusedAttributes:function(){for(var t=0,e=g.length;t!==e;++t)g[t]!==m[t]&&(h.disableVertexAttribArray(t),g[t]=0)},enable:u,disable:p,getCompressedTextureFormats:function(){if(null===b&&(b=[],i.get("WEBGL_compressed_texture_pvrtc")||i.get("WEBGL_compressed_texture_s3tc")||i.get("WEBGL_compressed_texture_etc1")||i.get("WEBGL_compressed_texture_astc")))for(var t=h.getParameter(h.COMPRESSED_TEXTURE_FORMATS),e=0;e<t.length;e++)b.push(t[e]);return b},useProgram:function(t){return x!==t&&(h.useProgram(t),x=t,!0)},setBlending:r,setMaterial:function(t,e){(2===t.side?p:u)(h.CULL_FACE);var i=1===t.side;n(i=e?!i:i),!0===t.transparent?r(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):r(0),c.setFunc(t.depthFunc),c.setTest(t.depthTest),c.setMask(t.depthWrite),s.setMask(t.colorWrite),o(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:n,setCullFace:e,setLineWidth:function(t){t!==R&&(F&&h.lineWidth(t),R=t)},setPolygonOffset:o,setScissorTest:function(t){(t?u:p)(h.SCISSOR_TEST)},activeTexture:a,bindTexture:function(t,e){null===j&&a();var i=N[j];void 0===i&&(N[j]=i={type:void 0,texture:void 0}),i.type===t&&i.texture===e||(h.bindTexture(t,e||U[t]),i.type=t,i.texture=e)},compressedTexImage2D:function(){try{h.compressedTexImage2D.apply(h,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{h.texImage2D.apply(h,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===k.equals(t)&&(h.scissor(t.x,t.y,t.z,t.w),k.copy(t))},viewport:function(t){!1===z.equals(t)&&(h.viewport(t.x,t.y,t.z,t.w),z.copy(t))},reset:function(){for(var t=0;t<g.length;t++)1===g[t]&&(h.disableVertexAttribArray(t),g[t]=0);y={},j=b=null,N={},O=C=w=x=null,s.reset(),c.reset(),d.reset()}}}function te(e,i,t){function r(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision&&0<e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision&&0<e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision?"mediump":"lowp"}var n,o=void 0!==t.precision?t.precision:"highp";(a=r(o))!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a),t=!0===t.logarithmicDepthBuffer;var a=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),s=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),l=e.getParameter(e.MAX_TEXTURE_SIZE),c=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),h=e.getParameter(e.MAX_VERTEX_ATTRIBS),u=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),p=e.getParameter(e.MAX_VARYING_VECTORS),d=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),f=0<s,m=!!i.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==n)return n;var t=i.get("EXT_texture_filter_anisotropic");return n=null!==t?e.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:t,maxTextures:a,maxVertexTextures:s,maxTextureSize:l,maxCubemapSize:c,maxAttributes:h,maxVertexUniforms:u,maxVaryings:p,maxFragmentUniforms:d,vertexTextures:f,floatFragmentTextures:m,floatVertexTextures:f&&m}}function ee(t,e,i,r){Y.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function ie(t){ee.call(this),this.cameras=t||[]}function re(i){function t(){var t,e;null!==n&&n.isPresenting?(t=(e=n.getEyeParameters("left")).renderWidth,e=e.renderHeight,d=i.getPixelRatio(),p=i.getSize(),i.setDrawingBufferSize(2*t,e,1)):r.enabled&&i.setDrawingBufferSize(p.width,p.height,d)}var r=this,n=null,o=null,a=null,s=new Mt,l=new Mt;"undefined"!=typeof window&&"VRFrameData"in window&&(o=new window.VRFrameData);var c=new Mt,h=new ee;h.bounds=new At(0,0,.5,1),h.layers.enable(1);var u=new ee;u.bounds=new At(.5,0,.5,1),u.layers.enable(2);var p,d,f=new ie([h,u]);f.layers.enable(1),f.layers.enable(2),"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",t,!1),this.enabled=!1,this.userHeight=1.6,this.getDevice=function(){return n},this.setDevice=function(t){void 0!==t&&(n=t)},this.setPoseTarget=function(t){void 0!==t&&(a=t)},this.getCamera=function(t){if(null===n)return t;n.depthNear=t.near,n.depthFar=t.far,n.getFrameData(o);var e=o.pose,i=null!==a?a:t;return null!==e.position?i.position.fromArray(e.position):i.position.set(0,0,0),null!==e.orientation&&i.quaternion.fromArray(e.orientation),(e=n.stageParameters)?s.fromArray(e.sittingToStandingTransform):s.makeTranslation(0,r.userHeight,0),i.position.applyMatrix4(s),i.updateMatrixWorld(),!1===n.isPresenting?t:(h.near=t.near,u.near=t.near,h.far=t.far,u.far=t.far,f.matrixWorld.copy(t.matrixWorld),f.matrixWorldInverse.copy(t.matrixWorldInverse),h.matrixWorldInverse.fromArray(o.leftViewMatrix),u.matrixWorldInverse.fromArray(o.rightViewMatrix),l.getInverse(s),h.matrixWorldInverse.multiply(l),u.matrixWorldInverse.multiply(l),null!==(t=i.parent)&&(c.getInverse(t.matrixWorld),h.matrixWorldInverse.multiply(c),u.matrixWorldInverse.multiply(c)),h.matrixWorld.getInverse(h.matrixWorldInverse),u.matrixWorld.getInverse(u.matrixWorldInverse),h.projectionMatrix.fromArray(o.leftProjectionMatrix),u.projectionMatrix.fromArray(o.rightProjectionMatrix),f.projectionMatrix.copy(h.projectionMatrix),(t=n.getLayers()).length&&(null!==(t=t[0]).leftBounds&&4===t.leftBounds.length&&h.bounds.fromArray(t.leftBounds),null!==t.rightBounds&&4===t.rightBounds.length&&u.bounds.fromArray(t.rightBounds)),f)},this.getStandingMatrix=function(){return s},this.submitFrame=function(){n&&n.isPresenting&&n.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",t)}}function ne(i){var r={};return{get:function(t){if(void 0!==r[t])return r[t];var e;switch(t){case"WEBGL_depth_texture":e=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":e=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":e=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":e=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":e=i.getExtension("WEBGL_compressed_texture_etc1");break;default:e=i.getExtension(t)}return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),r[t]=e}}}function oe(){function l(){m.value!==h&&(m.value=h,m.needsUpdate=0<u),a.numPlanes=u,a.numIntersection=0}function c(t,e,i,r){var n=null!==t?t.length:0,o=null;if(0!==n){if(o=m.value,!0!==r||null===o)for(r=i+4*n,e=e.matrixWorldInverse,f.getNormalMatrix(e),(null===o||o.length<r)&&(o=new Float32Array(r)),r=0;r!==n;++r,i+=4)s.copy(t[r]).applyMatrix4(e,f),s.normal.toArray(o,i),o[i+3]=s.constant;m.value=o,m.needsUpdate=!0}return a.numPlanes=n,o}var a=this,h=null,u=0,p=!1,d=!1,s=new B,f=new g,m={value:null,needsUpdate:!1};this.uniform=m,this.numIntersection=this.numPlanes=0,this.init=function(t,e,i){var r=0!==t.length||e||0!==u||p;return p=e,h=c(t,i,0),u=t.length,r},this.beginShadows=function(){d=!0,c(null)},this.endShadows=function(){d=!1,l()},this.setState=function(t,e,i,r,n,o){if(!p||null===t||0===t.length||d&&!i)d?c(null):l();else{var a=4*(i=d?0:u),s=n.clippingState||null;for(m.value=s,s=c(t,r,a,o),t=0;t!==a;++t)s[t]=h[t];n.clippingState=s,this.numIntersection=e?this.numPlanes:0,this.numPlanes+=i}}}function ae(i,r){return{convert:function(t){var e;if(1e3===t)return i.REPEAT;if(1001===t)return i.CLAMP_TO_EDGE;if(1002===t)return i.MIRRORED_REPEAT;if(1003===t)return i.NEAREST;if(1004===t)return i.NEAREST_MIPMAP_NEAREST;if(1005===t)return i.NEAREST_MIPMAP_LINEAR;if(1006===t)return i.LINEAR;if(1007===t)return i.LINEAR_MIPMAP_NEAREST;if(1008===t)return i.LINEAR_MIPMAP_LINEAR;if(1009===t)return i.UNSIGNED_BYTE;if(1017===t)return i.UNSIGNED_SHORT_4_4_4_4;if(1018===t)return i.UNSIGNED_SHORT_5_5_5_1;if(1019===t)return i.UNSIGNED_SHORT_5_6_5;if(1010===t)return i.BYTE;if(1011===t)return i.SHORT;if(1012===t)return i.UNSIGNED_SHORT;if(1013===t)return i.INT;if(1014===t)return i.UNSIGNED_INT;if(1015===t)return i.FLOAT;if(1016===t&&null!==(e=r.get("OES_texture_half_float")))return e.HALF_FLOAT_OES;if(1021===t)return i.ALPHA;if(1022===t)return i.RGB;if(1023===t)return i.RGBA;if(1024===t)return i.LUMINANCE;if(1025===t)return i.LUMINANCE_ALPHA;if(1026===t)return i.DEPTH_COMPONENT;if(1027===t)return i.DEPTH_STENCIL;if(100===t)return i.FUNC_ADD;if(101===t)return i.FUNC_SUBTRACT;if(102===t)return i.FUNC_REVERSE_SUBTRACT;if(200===t)return i.ZERO;if(201===t)return i.ONE;if(202===t)return i.SRC_COLOR;if(203===t)return i.ONE_MINUS_SRC_COLOR;if(204===t)return i.SRC_ALPHA;if(205===t)return i.ONE_MINUS_SRC_ALPHA;if(206===t)return i.DST_ALPHA;if(207===t)return i.ONE_MINUS_DST_ALPHA;if(208===t)return i.DST_COLOR;if(209===t)return i.ONE_MINUS_DST_COLOR;if(210===t)return i.SRC_ALPHA_SATURATE;if((33776===t||33777===t||33778===t||33779===t)&&null!==(e=r.get("WEBGL_compressed_texture_s3tc"))){if(33776===t)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((35840===t||35841===t||35842===t||35843===t)&&null!==(e=r.get("WEBGL_compressed_texture_pvrtc"))){if(35840===t)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t&&null!==(e=r.get("WEBGL_compressed_texture_etc1")))return e.COMPRESSED_RGB_ETC1_WEBGL;if((37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t)&&null!==(e=r.get("WEBGL_compressed_texture_astc")))return t;if((103===t||104===t)&&null!==(e=r.get("EXT_blend_minmax"))){if(103===t)return e.MIN_EXT;if(104===t)return e.MAX_EXT}return 1020===t&&null!==(e=r.get("WEBGL_depth_texture"))?e.UNSIGNED_INT_24_8_WEBGL:0}}}function se(){var i={};return{get:function(t){if(void 0!==i[t.id])return i[t.id];var e;switch(t.type){case"DirectionalLight":e={direction:new _t,color:new j,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new q};break;case"SpotLight":e={position:new _t,direction:new _t,color:new j,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new q};break;case"PointLight":e={position:new _t,color:new j,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new q,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":e={direction:new _t,skyColor:new j,groundColor:new j};break;case"RectAreaLight":e={color:new j,position:new _t,halfWidth:new _t,halfHeight:new _t}}return i[t.id]=e}}}function le(){var b=new se,x={id:Gs++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},w=new _t,M=new Mt,_=new Mt;return{setup:function(t,e,i){var r=0,n=0,o=0,a=0,s=0,l=0,c=0,h=0;i=i.matrixWorldInverse;for(var u=0,p=t.length;u<p;u++){var d,f=t[u],m=f.color,g=f.intensity,v=f.distance,y=f.shadow&&f.shadow.map?f.shadow.map.texture:null;f.isAmbientLight?(r+=m.r*g,n+=m.g*g,o+=m.b*g):f.isDirectionalLight?((d=b.get(f)).color.copy(f.color).multiplyScalar(f.intensity),d.direction.setFromMatrixPosition(f.matrixWorld),w.setFromMatrixPosition(f.target.matrixWorld),d.direction.sub(w),d.direction.transformDirection(i),(d.shadow=f.castShadow)&&(m=f.shadow,d.shadowBias=m.bias,d.shadowRadius=m.radius,d.shadowMapSize=m.mapSize),x.directionalShadowMap[a]=y,x.directionalShadowMatrix[a]=f.shadow.matrix,x.directional[a]=d,a++):f.isSpotLight?((d=b.get(f)).position.setFromMatrixPosition(f.matrixWorld),d.position.applyMatrix4(i),d.color.copy(m).multiplyScalar(g),d.distance=v,d.direction.setFromMatrixPosition(f.matrixWorld),w.setFromMatrixPosition(f.target.matrixWorld),d.direction.sub(w),d.direction.transformDirection(i),d.coneCos=Math.cos(f.angle),d.penumbraCos=Math.cos(f.angle*(1-f.penumbra)),d.decay=0===f.distance?0:f.decay,(d.shadow=f.castShadow)&&(m=f.shadow,d.shadowBias=m.bias,d.shadowRadius=m.radius,d.shadowMapSize=m.mapSize),x.spotShadowMap[l]=y,x.spotShadowMatrix[l]=f.shadow.matrix,x.spot[l]=d,l++):f.isRectAreaLight?((d=b.get(f)).color.copy(m).multiplyScalar(g),d.position.setFromMatrixPosition(f.matrixWorld),d.position.applyMatrix4(i),_.identity(),M.copy(f.matrixWorld),M.premultiply(i),_.extractRotation(M),d.halfWidth.set(.5*f.width,0,0),d.halfHeight.set(0,.5*f.height,0),d.halfWidth.applyMatrix4(_),d.halfHeight.applyMatrix4(_),x.rectArea[c]=d,c++):f.isPointLight?((d=b.get(f)).position.setFromMatrixPosition(f.matrixWorld),d.position.applyMatrix4(i),d.color.copy(f.color).multiplyScalar(f.intensity),d.distance=f.distance,d.decay=0===f.distance?0:f.decay,(d.shadow=f.castShadow)&&(m=f.shadow,d.shadowBias=m.bias,d.shadowRadius=m.radius,d.shadowMapSize=m.mapSize,d.shadowCameraNear=m.camera.near,d.shadowCameraFar=m.camera.far),x.pointShadowMap[s]=y,x.pointShadowMatrix[s]=f.shadow.matrix,x.point[s]=d,s++):f.isHemisphereLight&&((d=b.get(f)).direction.setFromMatrixPosition(f.matrixWorld),d.direction.transformDirection(i),d.direction.normalize(),d.skyColor.copy(f.color).multiplyScalar(g),d.groundColor.copy(f.groundColor).multiplyScalar(g),x.hemi[h]=d,h++)}x.ambient[0]=r,x.ambient[1]=n,x.ambient[2]=o,x.directional.length=a,x.spot.length=l,x.rectArea.length=c,x.point.length=s,x.hemi.length=h,x.hash=x.id+","+a+","+s+","+l+","+c+","+h+","+e.length},state:x}}function ce(){var e=new le,i=[],r=[],n=[];return{init:function(){i.length=0,r.length=0,n.length=0},state:{lightsArray:i,shadowsArray:r,spritesArray:n,lights:e},setupLights:function(t){e.setup(i,r,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){r.push(t)},pushSprite:function(t){n.push(t)}}}function he(){var i={};return{get:function(t,e){t=t.id+","+e.id,e=i[t];return void 0===e&&(e=new ce,i[t]=e),e},dispose:function(){i={}}}}function ue(t){function e(){(S=new ne(E)).get("WEBGL_depth_texture"),S.get("OES_texture_float"),S.get("OES_texture_float_linear"),S.get("OES_texture_half_float"),S.get("OES_texture_half_float_linear"),S.get("OES_standard_derivatives"),S.get("OES_element_index_uint"),S.get("ANGLE_instanced_arrays"),B=new ae(E,S),P=new te(E,S,t),(T=new $t(E,S,B)).scissor(Q.copy(ot).multiplyScalar(rt)),T.viewport(Z.copy(nt).multiplyScalar(rt)),C=new Qt,O=new Zt(E,S,T,C,P,B,dt,ft),R=new Ot(E),L=new zt(E,R,dt),I=new Ut(L,ft),k=new jt(E),D=new Jt(H,S,P),F=new Dt,j=new he,N=new Rt(H,T,L,b),z=new kt(E,S,ft),U=new Nt(E,S,ft),V=new Pt(H,E,T,O,P),H.info.programs=D.programs,H.context=E,H.capabilities=P,H.extensions=S,H.properties=C,H.renderLists=F,H.state=T}function i(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),G=!0}function r(){console.log("THREE.WebGLRenderer: Context Restored."),G=!1,e()}function l(t){(t=t.target).removeEventListener("dispose",l),c(t),C.remove(t)}function c(t){var e=C.get(t).program;(t.program=void 0)!==e&&D.releaseProgram(e)}function n(){var t=mt.getDevice();(t&&t.isPresenting?t:window).requestAnimationFrame(o)}function o(t){!1!==xt&&(wt(t),n())}function a(t,e,i,r){for(var n=0,o=t.length;n<o;n++){var a=(c=t[n]).object,s=c.geometry,l=void 0===r?c.material:r,c=c.group;if(i.isArrayCamera)for(var h=(J=i).cameras,u=0,p=h.length;u<p;u++){var d,f=h[u];a.layers.test(f.layers)&&(d=f.bounds,T.viewport(Z.set(d.x*et,d.y*it,d.z*et,d.w*it).multiplyScalar(rt)),m(a,e,f,s,l,c))}else J=null,m(a,e,i,s,l,c)}}function m(t,e,i,r,n,o){var a,s,l;t.onBeforeRender(H,e,i,r,n,o),A=j.get(e,J||i),t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject?(a=t.isMesh&&t.matrixWorld.determinant()<0,T.setMaterial(n,a),a=_(i,e.fog,n,t),Y="",s=a,l=n,t.render(function(t){H.renderBufferImmediate(t,s,l)})):H.renderBufferDirect(i,e.fog,r,n,t,o),t.onAfterRender(H,e,i,r,n,o),A=j.get(e,J||i)}function d(t,e,i){var r=C.get(t),n=A.state.lights;i=D.getParameters(t,n.state,A.state.shadowsArray,e,lt.numPlanes,lt.numIntersection,i);var o=D.getProgramCode(t,i),a=r.program,s=!0;if(void 0===a)t.addEventListener("dispose",l);else if(a.code!==o)c(t);else{if(r.lightsHash!==n.state.hash)C.update(t,"lightsHash",n.state.hash);else if(void 0!==i.shaderID)return;s=!1}if(s&&(i.shaderID?(a=bo[i.shaderID],r.shader={name:t.type,uniforms:vo.clone(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}):r.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader},t.onBeforeCompile(r.shader),a=D.acquireProgram(t,r.shader,i,o),r.program=a,t.program=a),i=a.getAttributes(),t.morphTargets)for(o=t.numSupportedMorphTargets=0;o<H.maxMorphTargets;o++)0<=i["morphTarget"+o]&&t.numSupportedMorphTargets++;if(t.morphNormals)for(o=t.numSupportedMorphNormals=0;o<H.maxMorphNormals;o++)0<=i["morphNormal"+o]&&t.numSupportedMorphNormals++;i=r.shader.uniforms,(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=lt.numPlanes,r.numIntersection=lt.numIntersection,i.clippingPlanes=lt.uniform),r.fog=e,r.lightsHash=n.state.hash,t.lights&&(i.ambientLightColor.value=n.state.ambient,i.directionalLights.value=n.state.directional,i.spotLights.value=n.state.spot,i.rectAreaLights.value=n.state.rectArea,i.pointLights.value=n.state.point,i.hemisphereLights.value=n.state.hemi,i.directionalShadowMap.value=n.state.directionalShadowMap,i.directionalShadowMatrix.value=n.state.directionalShadowMatrix,i.spotShadowMap.value=n.state.spotShadowMap,i.spotShadowMatrix.value=n.state.spotShadowMatrix,i.pointShadowMap.value=n.state.pointShadowMap,i.pointShadowMatrix.value=n.state.pointShadowMatrix),t=r.program.getUniforms(),t=St.seqWithValue(t.seq,i),r.uniformsList=t}function _(t,e,i,r){tt=0;var n=C.get(i),o=A.state.lights;ct&&(ht||t!==K)&&lt.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,t,n,t===K&&i.id===q),!1!==i.needsUpdate||(void 0===n.program||i.fog&&n.fog!==e||i.lights&&n.lightsHash!==o.state.hash||void 0!==n.numClippingPlanes&&(n.numClippingPlanes!==lt.numPlanes||n.numIntersection!==lt.numIntersection))&&(i.needsUpdate=!0),i.needsUpdate&&(d(i,e,r),i.needsUpdate=!1);var a,s,l=!1,c=!1,h=!1,u=(o=n.program).getUniforms(),p=n.shader.uniforms;return T.useProgram(o.program)&&(h=c=l=!0,ft.programSwitch++),i.id!==q&&(q=i.id,c=!0),!l&&t===K||(u.setValue(E,"projectionMatrix",t.projectionMatrix),P.logarithmicDepthBuffer&&u.setValue(E,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),K!==(J||t)&&(K=J||t,h=c=!0),!(i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap)||void 0!==(l=u.map.cameraPosition)&&l.setValue(E,pt.setFromMatrixPosition(t.matrixWorld)),(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&u.setValue(E,"viewMatrix",t.matrixWorldInverse)),i.skinning&&(u.setOptional(E,r,"bindMatrix"),u.setOptional(E,r,"bindMatrixInverse"),t=r.skeleton)&&(l=t.bones,P.floatVertexTextures?(void 0===t.boneTexture&&(l=Math.sqrt(4*l.length),l=io.ceilPowerOfTwo(l),l=Math.max(l,4),(a=new Float32Array(l*l*4)).set(t.boneMatrices),(s=new Et(a,l,l,1023,1015)).needsUpdate=!0,t.boneMatrices=a,t.boneTexture=s,t.boneTextureSize=l),u.setValue(E,"boneTexture",t.boneTexture),u.setValue(E,"boneTextureSize",t.boneTextureSize)):u.setOptional(E,t,"boneMatrices")),c&&(u.setValue(E,"toneMappingExposure",H.toneMappingExposure),u.setValue(E,"toneMappingWhitePoint",H.toneMappingWhitePoint),i.lights&&(c=h,p.ambientLightColor.needsUpdate=c,p.directionalLights.needsUpdate=c,p.pointLights.needsUpdate=c,p.spotLights.needsUpdate=c,p.rectAreaLights.needsUpdate=c,p.hemisphereLights.needsUpdate=c),e&&i.fog&&(p.fogColor.value=e.color,e.isFog?(p.fogNear.value=e.near,p.fogFar.value=e.far):e.isFogExp2&&(p.fogDensity.value=e.density)),i.isMeshBasicMaterial?f(p,i):i.isMeshLambertMaterial?(f(p,i),i.emissiveMap&&(p.emissiveMap.value=i.emissiveMap)):i.isMeshPhongMaterial?(f(p,i),i.isMeshToonMaterial?(g(p,i),i.gradientMap&&(p.gradientMap.value=i.gradientMap)):g(p,i)):i.isMeshStandardMaterial?(f(p,i),i.isMeshPhysicalMaterial&&(p.clearCoat.value=i.clearCoat,p.clearCoatRoughness.value=i.clearCoatRoughness),p.roughness.value=i.roughness,p.metalness.value=i.metalness,i.roughnessMap&&(p.roughnessMap.value=i.roughnessMap),i.metalnessMap&&(p.metalnessMap.value=i.metalnessMap),i.emissiveMap&&(p.emissiveMap.value=i.emissiveMap),i.bumpMap&&(p.bumpMap.value=i.bumpMap,p.bumpScale.value=i.bumpScale),i.normalMap&&(p.normalMap.value=i.normalMap,p.normalScale.value.copy(i.normalScale)),i.displacementMap&&(p.displacementMap.value=i.displacementMap,p.displacementScale.value=i.displacementScale,p.displacementBias.value=i.displacementBias),i.envMap&&(p.envMapIntensity.value=i.envMapIntensity)):i.isMeshDepthMaterial?(f(p,i),i.displacementMap&&(p.displacementMap.value=i.displacementMap,p.displacementScale.value=i.displacementScale,p.displacementBias.value=i.displacementBias)):i.isMeshDistanceMaterial?(f(p,i),i.displacementMap&&(p.displacementMap.value=i.displacementMap,p.displacementScale.value=i.displacementScale,p.displacementBias.value=i.displacementBias),p.referencePosition.value.copy(i.referencePosition),p.nearDistance.value=i.nearDistance,p.farDistance.value=i.farDistance):i.isMeshNormalMaterial?(f(p,i),i.bumpMap&&(p.bumpMap.value=i.bumpMap,p.bumpScale.value=i.bumpScale),i.normalMap&&(p.normalMap.value=i.normalMap,p.normalScale.value.copy(i.normalScale)),i.displacementMap&&(p.displacementMap.value=i.displacementMap,p.displacementScale.value=i.displacementScale,p.displacementBias.value=i.displacementBias)):i.isLineBasicMaterial?(p.diffuse.value=i.color,p.opacity.value=i.opacity,i.isLineDashedMaterial&&(p.dashSize.value=i.dashSize,p.totalSize.value=i.dashSize+i.gapSize,p.scale.value=i.scale)):i.isPointsMaterial?(p.diffuse.value=i.color,p.opacity.value=i.opacity,p.size.value=i.size*rt,p.scale.value=.5*it,p.map.value=i.map,null!==i.map&&(!0===i.map.matrixAutoUpdate&&(e=i.map.offset,c=i.map.repeat,h=i.map.center,i.map.matrix.setUvTransform(e.x,e.y,c.x,c.y,i.map.rotation,h.x,h.y)),p.uvTransform.value.copy(i.map.matrix))):i.isShadowMaterial&&(p.color.value=i.color,p.opacity.value=i.opacity),void 0!==p.ltc_1&&(p.ltc_1.value=go.LTC_1),void 0!==p.ltc_2&&(p.ltc_2.value=go.LTC_2),St.upload(E,n.uniformsList,p,H)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(St.upload(E,n.uniformsList,p,H),i.uniformsNeedUpdate=!1),u.setValue(E,"modelViewMatrix",r.modelViewMatrix),u.setValue(E,"normalMatrix",r.normalMatrix),u.setValue(E,"modelMatrix",r.matrixWorld),o}function f(t,e){var i,r,n;t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap),void 0!==i&&(!0===(i=i.isWebGLRenderTarget?i.texture:i).matrixAutoUpdate&&(r=i.offset,n=i.repeat,e=i.center,i.matrix.setUvTransform(r.x,r.y,n.x,n.y,i.rotation,e.x,e.y)),t.uvTransform.value.copy(i.matrix))}function g(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}var s=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),h=void 0!==t.context?t.context:null,u=void 0!==t.alpha&&t.alpha,p=void 0===t.depth||t.depth,v=void 0===t.stencil||t.stencil,y=void 0!==t.antialias&&t.antialias,b=void 0===t.premultipliedAlpha||t.premultipliedAlpha,x=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,w=void 0!==t.powerPreference?t.powerPreference:"default",M=null,A=null;this.domElement=s,this.context=null,this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1,this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var E,S,P,T,C,O,R,L,I,D,F,j,N,k,z,U,V,B,H=this,G=!1,W=null,X=null,q=-1,Y="",K=null,J=null,Z=new At,Q=new At,$=null,tt=0,et=s.width,it=s.height,rt=1,nt=new At(0,0,et,it),ot=new At(0,0,et,it),at=!1,st=new Tt,lt=new oe,ct=!1,ht=!1,ut=new Mt,pt=new _t,dt={geometries:0,textures:0,vertices:0,faces:0,textureSz:0},ft={frame:0,calls:0,vertices:0,faces:0,points:0,programSwitch:0};this.info={render:ft,memory:dt,programs:null,autoReset:!0,reset:function(){ft.frame++,ft.calls=0,ft.vertices=0,ft.faces=0,ft.points=0,ft.programSwitch=0}};try{if(u={alpha:u,depth:p,stencil:v,antialias:y,premultipliedAlpha:b,preserveDrawingBuffer:x,powerPreference:w},s.addEventListener("webglcontextlost",i,!1),s.addEventListener("webglcontextrestored",r,!1),null===(E=h||s.getContext("webgl",u)||s.getContext("experimental-webgl",u))){if(null!==s.getContext("webgl"))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}void 0===E.getShaderPrecisionFormat&&(E.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){console.error("THREE.WebGLRenderer: "+t.message)}e();var mt=new re(H);this.vr=mt;var gt=new Ct(H,I,P.maxTextureSize);this.shadowMap=gt,this.getContext=function(){return E},this.getContextAttributes=function(){return E.getContextAttributes()},this.forceContextLoss=function(){var t=S.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=S.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return rt},this.setPixelRatio=function(t){void 0!==t&&(rt=t,this.setSize(et,it,!1))},this.getSize=function(){return{width:et,height:it}},this.setSize=function(t,e,i){var r=mt.getDevice();r&&r.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(et=t,it=e,s.width=t*rt,s.height=e*rt,!1!==i&&(s.style.width=t+"px",s.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(){return{width:et*rt,height:it*rt}},this.setDrawingBufferSize=function(t,e,i){et=t,it=e,rt=i,s.width=t*i,s.height=e*i,this.setViewport(0,0,t,e)},this.getCurrentViewport=function(){return Z},this.setViewport=function(t,e,i,r){nt.set(t,it-e-r,i,r),T.viewport(Z.copy(nt).multiplyScalar(rt))},this.setScissor=function(t,e,i,r){ot.set(t,it-e-r,i,r),T.scissor(Q.copy(ot).multiplyScalar(rt))},this.setScissorTest=function(t){T.setScissorTest(at=t)},this.getClearColor=function(){return N.getClearColor()},this.setClearColor=function(){N.setClearColor.apply(N,arguments)},this.getClearAlpha=function(){return N.getClearAlpha()},this.setClearAlpha=function(){N.setClearAlpha.apply(N,arguments)},this.clear=function(t,e,i){var r=0;void 0!==t&&!t||(r|=E.COLOR_BUFFER_BIT),void 0!==e&&!e||(r|=E.DEPTH_BUFFER_BIT),void 0!==i&&!i||(r|=E.STENCIL_BUFFER_BIT),E.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,i,r){this.setRenderTarget(t),this.clear(e,i,r)},this.dispose=function(){s.removeEventListener("webglcontextlost",i,!1),s.removeEventListener("webglcontextrestored",r,!1),F.dispose(),j.dispose(),C.dispose(),I.dispose(),mt.dispose(),xt=!1},this.renderBufferImmediate=function(t,e,i){T.initAttributes();var r=C.get(t);if(t.hasPositions&&!r.position&&(r.position=E.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=E.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=E.createBuffer()),t.hasColors&&!r.color&&(r.color=E.createBuffer()),e=e.getAttributes(),t.hasPositions&&(E.bindBuffer(E.ARRAY_BUFFER,r.position),E.bufferData(E.ARRAY_BUFFER,t.positionArray,E.DYNAMIC_DRAW),T.enableAttribute(e.position),E.vertexAttribPointer(e.position,3,E.FLOAT,!1,0,0)),t.hasNormals){if(E.bindBuffer(E.ARRAY_BUFFER,r.normal),!i.isMeshPhongMaterial&&!i.isMeshStandardMaterial&&!i.isMeshNormalMaterial&&!0===i.flatShading)for(var n=0,o=3*t.count;n<o;n+=9){var a=t.normalArray,s=(a[n+0]+a[n+3]+a[n+6])/3,l=(a[n+1]+a[n+4]+a[n+7])/3,c=(a[n+2]+a[n+5]+a[n+8])/3;a[n+0]=s,a[n+1]=l,a[n+2]=c,a[n+3]=s,a[n+4]=l,a[n+5]=c,a[n+6]=s,a[n+7]=l,a[n+8]=c}E.bufferData(E.ARRAY_BUFFER,t.normalArray,E.DYNAMIC_DRAW),T.enableAttribute(e.normal),E.vertexAttribPointer(e.normal,3,E.FLOAT,!1,0,0)}t.hasUvs&&i.map&&(E.bindBuffer(E.ARRAY_BUFFER,r.uv),E.bufferData(E.ARRAY_BUFFER,t.uvArray,E.DYNAMIC_DRAW),T.enableAttribute(e.uv),E.vertexAttribPointer(e.uv,2,E.FLOAT,!1,0,0)),t.hasColors&&0!==i.vertexColors&&(E.bindBuffer(E.ARRAY_BUFFER,r.color),E.bufferData(E.ARRAY_BUFFER,t.colorArray,E.DYNAMIC_DRAW),T.enableAttribute(e.color),E.vertexAttribPointer(e.color,3,E.FLOAT,!1,0,0)),T.disableUnusedAttributes(),E.drawArrays(E.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,i,r,n,o){var a=n.isMesh&&n.matrixWorld.determinant()<0;T.setMaterial(r,a);var s=_(t,e,r,n),l=!1;(t=i.id+"_"+s.id+"_"+(!0===r.wireframe))!==Y&&(Y=t,l=!0),n.morphTargetInfluences&&(k.update(n,i,r,s),l=!0);var c,a=i.index,h=i.attributes.position;if(e=1,!0===r.wireframe&&(a=L.getWireframeAttribute(i),e=2),t=z,null!==a&&(c=R.get(a),(t=U).setIndex(c)),l){if(l=void 0,i&&i.isInstancedBufferGeometry&&null===S.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===l&&(l=0),T.initAttributes();var u,p=i.attributes,s=s.getAttributes(),d=r.defaultAttributeValues;for(u in s){var f=s[u];if(0<=f)if(void 0!==(b=p[u])){var m,g,v,y,b,x=b.normalized,w=b.itemSize,M=R.get(b);void 0!==M&&(m=M.buffer,g=M.type,M=M.bytesPerElement,b.isInterleavedBufferAttribute?(y=(v=b.data).stride,b=b.offset,v&&v.isInstancedInterleavedBuffer?(T.enableAttributeAndDivisor(f,v.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=v.meshPerAttribute*v.count)):T.enableAttribute(f),E.bindBuffer(E.ARRAY_BUFFER,m),E.vertexAttribPointer(f,w,g,x,y*M,(l*y+b)*M)):(b.isInstancedBufferAttribute?(T.enableAttributeAndDivisor(f,b.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=b.meshPerAttribute*b.count)):T.enableAttribute(f),E.bindBuffer(E.ARRAY_BUFFER,m),E.vertexAttribPointer(f,w,g,x,0,l*w*M)))}else if(void 0!==d&&void 0!==(x=d[u]))switch(x.length){case 2:E.vertexAttrib2fv(f,x);break;case 3:E.vertexAttrib3fv(f,x);break;case 4:E.vertexAttrib4fv(f,x);break;default:E.vertexAttrib1fv(f,x)}}T.disableUnusedAttributes()}null!==a&&E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,c.buffer)}if(c=1/0,null!==a?c=a.count:void 0!==h&&(c=h.count),u=i.drawRange.start*e,a=i.drawRange.count*e,h=null!==o?o.start*e:0,e=null!==o?o.count*e:1/0,o=Math.max(u,h),e=Math.min(c,u+a,h+e)-1,0!==(e=Math.max(0,e-o+1))){if(n.isMesh)if(!0===r.wireframe)T.setLineWidth(r.wireframeLinewidth*(null===W?rt:1)),t.setMode(E.LINES);else switch(n.drawMode){case 0:t.setMode(E.TRIANGLES);break;case 1:t.setMode(E.TRIANGLE_STRIP);break;case 2:t.setMode(E.TRIANGLE_FAN)}else n.isLine?(r=r.linewidth,T.setLineWidth((r=void 0===r?1:r)*(null===W?rt:1)),n.isLineSegments?t.setMode(E.LINES):n.isLineLoop?t.setMode(E.LINE_LOOP):t.setMode(E.LINE_STRIP)):n.isPoints&&t.setMode(E.POINTS);i&&i.isInstancedBufferGeometry?0<i.maxInstancedCount&&t.renderInstances(i,o,e):t.render(o,e)}};var vt,yt,bt,xt=!(this.compile=function(i,t){(A=j.get(i,t)).init(),i.traverse(function(t){t.isLight&&(A.pushLight(t),t.castShadow&&A.pushShadow(t))}),A.setupLights(t),i.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var e=0;e<t.material.length;e++)d(t.material[e],i.fog,t);else d(t.material,i.fog,t)})}),wt=null;this.animate=function(t){null!==(wt=t)?xt||(n(),xt=!0):xt=!1},this.render=function(t,e,i,r){var n,o;e&&e.isCamera?G||(Y="",q=-1,!(K=null)===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),mt.enabled&&(e=mt.getCamera(e)),(A=j.get(t,e)).init(),t.onBeforeRender(H,t,e,i),ut.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),st.setFromMatrix(ut),ht=this.localClippingEnabled,ct=lt.init(this.clippingPlanes,ht,e),(M=F.get(t,e)).init(),function t(e,i,r){if(!1!==e.visible){if(e.layers.test(i.layers))if(e.isLight)A.pushLight(e),e.castShadow&&A.pushShadow(e);else if(e.isSprite)e.frustumCulled&&!st.intersectsSprite(e)||A.pushSprite(e);else if(e.isImmediateRenderObject)r&&pt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ut),M.push(e,null,e.material,pt.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||st.intersectsObject(e))){r&&pt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ut);var n=I.update(e),o=e.material;if(Array.isArray(o))for(var a=n.groups,s=0,l=a.length;s<l;s++){var c=a[s],h=o[c.materialIndex];h&&h.visible&&M.push(e,n,h,pt.z,c)}else o.visible&&M.push(e,n,o,pt.z,null)}for(s=0,l=(e=e.children).length;s<l;s++)t(e[s],i,r)}}(t,e,H.sortObjects),!0===H.sortObjects&&M.sort(),ct&&lt.beginShadows(),gt.render(A.state.shadowsArray,t,e),A.setupLights(e),ct&&lt.endShadows(),this.info.autoReset&&this.info.reset(),this.setRenderTarget(i=void 0===i?null:i),N.render(M,t,e,r),r=M.opaque,n=M.transparent,t.overrideMaterial?(o=t.overrideMaterial,r.length&&a(r,t,e,o),n.length&&a(n,t,e,o)):(r.length&&a(r,t,e),n.length&&a(n,t,e)),V.render(A.state.spritesArray,t,e),i&&O.updateRenderTargetMipmap(i),T.buffers.depth.setTest(!0),T.buffers.depth.setMask(!0),T.buffers.color.setMask(!0),T.setPolygonOffset(!1),t.onAfterRender(H,t,e),mt.enabled&&mt.submitFrame(),A=M=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=function(){var t=tt;return t>=P.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+P.maxTextures),tt+=1,t},this.setTexture2D=(vt=!1,function(t,e){t&&t.isWebGLRenderTarget&&(vt||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),vt=!0),t=t.texture),O.setTexture2D(t,e)}),this.setTexture=(yt=!1,function(t,e){yt||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),yt=!0),O.setTexture2D(t,e)}),this.setTextureCube=(bt=!1,function(t,e){t&&t.isWebGLRenderTargetCube&&(bt||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),bt=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?O.setTextureCube(t,e):O.setTextureCubeDynamic(t,e)}),this.getRenderTarget=function(){return W},this.setRenderTarget=function(t){(W=t)&&void 0===C.get(t).__webglFramebuffer&&O.setupRenderTarget(t);var e=null,i=!1;$=t?(e=C.get(t).__webglFramebuffer,t.isWebGLRenderTargetCube&&(e=e[t.activeCubeFace],i=!0),Z.copy(t.viewport),Q.copy(t.scissor),t.scissorTest):(Z.copy(nt).multiplyScalar(rt),Q.copy(ot).multiplyScalar(rt),at),X!==e&&(E.bindFramebuffer(E.FRAMEBUFFER,e),X=e),T.viewport(Z),T.scissor(Q),T.setScissorTest($),i&&(i=C.get(t.texture),E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,i.__webglTexture,t.activeMipMapLevel))},this.readRenderTargetPixels=function(t,e,i,r,n,o){if(t&&t.isWebGLRenderTarget){var a=C.get(t).__webglFramebuffer;if(a){var s=!1;a!==X&&(E.bindFramebuffer(E.FRAMEBUFFER,a),s=!0);try{var l=t.texture,c=l.format,h=l.type;1023!==c&&B.convert(c)!==E.getParameter(E.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===h||B.convert(h)===E.getParameter(E.IMPLEMENTATION_COLOR_READ_TYPE)||1015===h&&(S.get("OES_texture_float")||S.get("WEBGL_color_buffer_float"))||1016===h&&S.get("EXT_color_buffer_half_float")?E.checkFramebufferStatus(E.FRAMEBUFFER)===E.FRAMEBUFFER_COMPLETE?0<=e&&e<=t.width-r&&0<=i&&i<=t.height-n&&E.readPixels(e,i,r,n,B.convert(c),B.convert(h),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{s&&E.bindFramebuffer(E.FRAMEBUFFER,X)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,i){var r=e.image.width,n=e.image.height,o=B.convert(e.format);this.setTexture2D(e,0),E.copyTexImage2D(E.TEXTURE_2D,i||0,o,t.x,t.y,r,n,0)}}function pe(t,e){this.name="",this.color=new j(t),this.density=void 0!==e?e:25e-5}function de(t,e,i){this.name="",this.color=new j(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3}function fe(){X.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.background=null,this.autoUpdate=!0}function me(t){N.call(this),this.type="SpriteMaterial",this.color=new j(16777215),this.map=null,this.rotation=0,this.lights=this.fog=!1,this.setValues(t)}function ge(t){X.call(this),this.type="Sprite",this.material=void 0!==t?t:new me,this.center=new q(.5,.5)}function ve(){X.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function ye(t,e){if(this.bones=(t=t||[]).slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Mt)}}function be(){X.call(this),this.type="Bone"}function xe(t,e){xt.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Mt,this.bindMatrixInverse=new Mt;e=new ye(e=this.initBones());this.bind(e,this.matrixWorld),this.normalizeSkinWeights()}function we(t){N.call(this),this.type="LineBasicMaterial",this.color=new j(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.lights=!1,this.setValues(t)}function Me(t,e,i){if(1===i)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new _e(t,e);X.call(this),this.type="Line",this.geometry=void 0!==t?t:new ht,this.material=void 0!==e?e:new we({color:16777215*Math.random()})}function _e(t,e){Me.call(this,t,e),this.type="LineSegments"}function Ae(t,e){Me.call(this,t,e),this.type="LineLoop"}function Ee(t){N.call(this),this.type="PointsMaterial",this.color=new j(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function Se(t,e){X.call(this),this.type="Points",this.geometry=void 0!==t?t:new ht,this.material=void 0!==e?e:new Ee({color:16777215*Math.random()})}function Pe(){X.call(this),this.type="Group"}function Te(t,e,i,r,n,o,a,s,l){p.call(this,t,e,i,r,n,o,a,s,l),this.generateMipmaps=!1}function Ce(t,e,i,r,n,o,a,s,l,c,h,u){p.call(this,null,o,a,s,l,c,r,n,h,u),this.image={width:e,height:i},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function Oe(t,e,i,r,n,o,a,s,l,c){if(1026!==(c=void 0!==c?c:1026)&&1027!==c)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");p.call(this,null,r,n,o,a,s,c,i=void 0===(i=void 0===i&&1026===c?1012:i)&&1027===c?1020:i,l),this.image={width:t,height:e},this.magFilter=void 0!==a?a:1003,this.minFilter=void 0!==s?s:1003,this.generateMipmaps=this.flipY=!1}function Re(t){ht.call(this),this.type="WireframeGeometry";var e,i,r,n=[],o=[0,0],a={},s=["a","b","c"];if(t&&t.isGeometry){for(var l=t.faces,c=0,h=l.length;c<h;c++)for(var u=l[c],p=0;p<3;p++)i=u[s[p]],r=u[s[(p+1)%3]],o[0]=Math.min(i,r),o[1]=Math.max(i,r),void 0===a[i=o[0]+","+o[1]]&&(a[i]={index1:o[0],index2:o[1]});for(i in a)c=a[i],s=t.vertices[c.index1],n.push(s.x,s.y,s.z),s=t.vertices[c.index2],n.push(s.x,s.y,s.z)}else if(t&&t.isBufferGeometry){var d,s=new _t;if(null!==t.index){for(l=t.attributes.position,u=t.index,d=t.groups,e=(d=(t=0)===d.length?[{start:0,count:u.count,materialIndex:0}]:d).length;t<e;++t)for(p=(c=d[t]).start,h=c.count,h=(c=p)+h;c<h;c+=3)for(p=0;p<3;p++)i=u.getX(c+p),r=u.getX(c+(p+1)%3),o[0]=Math.min(i,r),o[1]=Math.max(i,r),void 0===a[i=o[0]+","+o[1]]&&(a[i]={index1:o[0],index2:o[1]});for(i in a)c=a[i],s.fromBufferAttribute(l,c.index1),n.push(s.x,s.y,s.z),s.fromBufferAttribute(l,c.index2),n.push(s.x,s.y,s.z)}else for(c=0,h=(l=t.attributes.position).count/3;c<h;c++)for(p=0;p<3;p++)s.fromBufferAttribute(l,a=3*c+p),n.push(s.x,s.y,s.z),s.fromBufferAttribute(l,a=3*c+(p+1)%3),n.push(s.x,s.y,s.z)}this.addAttribute("position",new at(n,3))}function Le(t,e,i){Z.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i},this.fromBufferGeometry(new Ie(t,e,i)),this.mergeVertices()}function Ie(t,e,i){ht.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:i};for(var r=[],n=[],o=[],a=[],s=new _t,l=new _t,c=new _t,h=new _t,u=new _t,p=e+1,d=0;d<=i;d++)for(var f=d/i,m=0;m<=e;m++){var g=m/e,l=t(g,f,l);n.push(l.x,l.y,l.z),0<=g-1e-5?(c=t(g-1e-5,f,c),h.subVectors(l,c)):(c=t(1e-5+g,f,c),h.subVectors(c,l)),0<=f-1e-5?(c=t(g,f-1e-5,c),u.subVectors(l,c)):(c=t(g,1e-5+f,c),u.subVectors(c,l)),s.crossVectors(h,u).normalize(),o.push(s.x,s.y,s.z),a.push(g,f)}for(d=0;d<i;d++)for(m=0;m<e;m++)s=(d+1)*p+m+1,r.push(d*p+m,t=d*p+m+1,l=(d+1)*p+m),r.push(t,s,l);this.setIndex(r),this.addAttribute("position",new at(n,3)),this.addAttribute("normal",new at(o,3)),this.addAttribute("uv",new at(a,2))}function De(t,e,i,r){Z.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:r},this.fromBufferGeometry(new Fe(t,e,i,r)),this.mergeVertices()}function Fe(i,m,t,e){function g(t){u.push(t.x,t.y,t.z)}function v(t,e){t*=3;e.x=i[0+t],e.y=i[1+t],e.z=i[2+t]}function h(t,e,i,r){r<0&&1===t.x&&(p[e]=t.x-1),0===i.x&&0===i.z&&(p[e]=r/2/Math.PI+.5)}ht.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:i,indices:m,radius:t,detail:e},t=t||1;var u=[],p=[];!function(t){for(var e=new _t,i=new _t,r=new _t,n=0;n<m.length;n+=3){v(m[n+0],e),v(m[n+1],i),v(m[n+2],r);for(var o=e,a=i,s=r,l=Math.pow(2,t),c=[],h=void 0,u=void 0,h=0;h<=l;h++){c[h]=[];for(var p=o.clone().lerp(s,h/l),d=a.clone().lerp(s,h/l),f=l-h,u=0;u<=f;u++)c[h][u]=0===u&&h===l?p:p.clone().lerp(d,u/f)}for(h=0;h<l;h++)for(u=0;u<2*(l-h)-1;u++)o=Math.floor(u/2),0==u%2?(g(c[h][o+1]),g(c[h+1][o]),g(c[h][o])):(g(c[h][o+1]),g(c[h+1][o+1]),g(c[h+1][o]))}}(e=e||0),function(t){for(var e=new _t,i=0;i<u.length;i+=3)e.x=u[i+0],e.y=u[i+1],e.z=u[i+2],e.normalize().multiplyScalar(t),u[i+0]=e.x,u[i+1]=e.y,u[i+2]=e.z}(t),function(){for(var t=new _t,e=0;e<u.length;e+=3){t.x=u[e+0],t.y=u[e+1],t.z=u[e+2];var i=Math.atan2(t.z,-t.x)/2/Math.PI+.5,r=Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5;p.push(i,1-r)}for(var t=new _t,e=new _t,i=new _t,r=new _t,n=new q,o=new q,a=new q,s=0,l=0;s<u.length;s+=9,l+=6){t.set(u[s+0],u[s+1],u[s+2]),e.set(u[s+3],u[s+4],u[s+5]),i.set(u[s+6],u[s+7],u[s+8]),n.set(p[l+0],p[l+1]),o.set(p[l+2],p[l+3]),a.set(p[l+4],p[l+5]),r.copy(t).add(e).add(i).divideScalar(3);var c=Math.atan2(r.z,-r.x);h(n,l+0,t,c),h(o,l+2,e,c),h(a,l+4,i,c)}for(t=0;t<p.length;t+=6)e=p[t+0],i=p[t+2],r=p[t+4],n=Math.max(e,i,r),o=Math.min(e,i,r),.9<n&&o<.1&&(e<.2&&(p[t+0]+=1),i<.2&&(p[t+2]+=1),r<.2&&(p[t+4]+=1))}(),this.addAttribute("position",new at(u,3)),this.addAttribute("normal",new at(u.slice(),3)),this.addAttribute("uv",new at(p,2)),0===e?this.computeVertexNormals():this.normalizeNormals()}function je(t,e){Z.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ne(t,e)),this.mergeVertices()}function Ne(t,e){Fe.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ke(t,e){Z.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ze(t,e)),this.mergeVertices()}function ze(t,e){Fe.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ue(t,e){Z.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ve(t,e)),this.mergeVertices()}function Ve(t,e){var i=(1+Math.sqrt(5))/2;Fe.call(this,[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Be(t,e){Z.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new He(t,e)),this.mergeVertices()}function He(t,e){var i=(1+Math.sqrt(5))/2,r=1/i;Fe.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ge(t,e,i,r,n,o){Z.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:i,radialSegments:r,closed:n},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new We(t,e,i,r,n),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function We(n,o,a,s,t){function e(t){p=n.getPointAt(t/o,p);var e=l.normals[t];for(t=l.binormals[t],c=0;c<=s;c++){var i=c/s*Math.PI*2,r=Math.sin(i),i=-Math.cos(i);u.x=i*e.x+r*t.x,u.y=i*e.y+r*t.y,u.z=i*e.z+r*t.z,u.normalize(),f.push(u.x,u.y,u.z),h.x=p.x+a*u.x,h.y=p.y+a*u.y,h.z=p.z+a*u.z,d.push(h.x,h.y,h.z)}}ht.call(this),this.type="TubeBufferGeometry",this.parameters={path:n,tubularSegments:o,radius:a,radialSegments:s,closed:t},o=o||64,a=a||1,s=s||8;var l=n.computeFrenetFrames(o,t=t||!1);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;for(var c,h=new _t,u=new _t,i=new q,p=new _t,d=[],f=[],r=[],m=[],g=0;g<o;g++)e(g);for(e(!1===t?o:0),g=0;g<=o;g++)for(c=0;c<=s;c++)i.x=g/o,i.y=c/s,r.push(i.x,i.y);!function(){for(c=1;c<=o;c++)for(g=1;g<=s;g++){var t=(s+1)*c+(g-1),e=(s+1)*c+g,i=(s+1)*(c-1)+g;m.push((s+1)*(c-1)+(g-1),t,i),m.push(t,e,i)}}(),this.setIndex(m),this.addAttribute("position",new at(d,3)),this.addAttribute("normal",new at(f,3)),this.addAttribute("uv",new at(r,2))}function Xe(t,e,i,r,n,o,a){Z.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:r,p:n,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new qe(t,e,i,r,n,o)),this.mergeVertices()}function qe(t,e,i,r,n,o){function a(t,e,i,r,n){var o=Math.cos(t),a=Math.sin(t);t*=i/e,e=Math.cos(t),n.x=r*(2+e)*.5*o,n.y=r*(2+e)*a*.5,n.z=r*Math.sin(t)*.5}ht.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:r,p:n,q:o},t=t||1,e=e||.4,i=Math.floor(i)||64,r=Math.floor(r)||8,n=n||2,o=o||3;for(var s,l=[],c=[],h=[],u=[],p=new _t,d=new _t,f=new _t,m=new _t,g=new _t,v=new _t,y=new _t,b=0;b<=i;++b)for(a(s=b/i*n*Math.PI*2,n,o,t,f),a(s+.01,n,o,t,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=r;++s){var x=s/r*Math.PI*2,w=-e*Math.cos(x),x=e*Math.sin(x);p.x=f.x+(w*y.x+x*g.x),p.y=f.y+(w*y.y+x*g.y),p.z=f.z+(w*y.z+x*g.z),c.push(p.x,p.y,p.z),d.subVectors(p,f).normalize(),h.push(d.x,d.y,d.z),u.push(b/i),u.push(s/r)}for(s=1;s<=i;s++)for(b=1;b<=r;b++)e=(r+1)*s+b,l.push((r+1)*(s-1)+(b-1),t=(r+1)*s+(b-1),n=(r+1)*(s-1)+b),l.push(t,e,n);this.setIndex(l),this.addAttribute("position",new at(c,3)),this.addAttribute("normal",new at(h,3)),this.addAttribute("uv",new at(u,2))}function Ye(t,e,i,r,n){Z.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:r,arc:n},this.fromBufferGeometry(new Ke(t,e,i,r,n)),this.mergeVertices()}function Ke(t,e,i,r,n){ht.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:r,arc:n},t=t||1,e=e||.4,i=Math.floor(i)||8,r=Math.floor(r)||6,n=n||2*Math.PI;for(var o,a=[],s=[],l=[],c=[],h=new _t,u=new _t,p=new _t,d=0;d<=i;d++)for(o=0;o<=r;o++){var f=o/r*n,m=d/i*Math.PI*2;u.x=(t+e*Math.cos(m))*Math.cos(f),u.y=(t+e*Math.cos(m))*Math.sin(f),u.z=e*Math.sin(m),s.push(u.x,u.y,u.z),h.x=t*Math.cos(f),h.y=t*Math.sin(f),p.subVectors(u,h).normalize(),l.push(p.x,p.y,p.z),c.push(o/r),c.push(d/i)}for(d=1;d<=i;d++)for(o=1;o<=r;o++)a.push((n=(r+1)*d+o)-1,t=(e=(r+1)*(d-1)+o)-1,n),a.push(t,e,n);this.setIndex(a),this.addAttribute("position",new at(s,3)),this.addAttribute("normal",new at(l,3)),this.addAttribute("uv",new at(c,2))}function Je(t,e,i,r,n){for(var o,a=0,s=e,l=i-r;s<i;s+=r)a+=(t[l]-t[s])*(t[s+1]+t[l+1]),l=s;if(n===0<a)for(n=e;n<i;n+=r)o=ai(n,t[n],t[n+1],o);else for(n=i-r;e<=n;n-=r)o=ai(n,t[n],t[n+1],o);return o&&ii(o,o.next)&&(si(o),o=o.next),o}function Ze(t,e){if(!t)return t;e=e||t;var i,r=t;do{if(i=!1,r.steiner||!ii(r,r.next)&&0!==ei(r.prev,r,r.next))r=r.next;else{if(si(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function Qe(t,e){return t.x-e.x}function $e(t,e,i,r,n){return 1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1)|(1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ti(t,e,i,r,n,o,a,s){return 0<=(n-a)*(e-s)-(t-a)*(o-s)&&0<=(t-a)*(r-s)-(i-a)*(e-s)&&0<=(i-a)*(o-s)-(n-a)*(r-s)}function ei(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function ii(t,e){return t.x===e.x&&t.y===e.y}function ri(t,e,i,r){return ii(t,e)&&ii(i,r)||ii(t,r)&&ii(i,e)||0<ei(t,e,i)!=0<ei(t,e,r)&&0<ei(i,r,t)!=0<ei(i,r,e)}function ni(t,e){return ei(t.prev,t,t.next)<0?0<=ei(t,e,t.next)&&0<=ei(t,t.prev,e):ei(t,e,t.prev)<0||ei(t,t.next,e)<0}function oi(t,e){var i=new li(t.i,t.x,t.y),r=new li(e.i,e.x,e.y),n=t.next,o=e.prev;return(t.next=e).prev=t,(i.next=n).prev=i,(r.next=i).prev=r,(o.next=r).prev=o,r}function ai(t,e,i,r){return t=new li(t,e,i),r?(t.next=r.next,(t.prev=r).next.prev=t,r.next=t):(t.prev=t).next=t,t}function si(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function li(t,e,i){this.i=t,this.x=e,this.y=i,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function ci(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function hi(t,e){for(var i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}function ui(t,e){Z.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new pi(t,e)),this.mergeVertices()}function pi(t,e){void 0!==t&&(ht.call(this),this.type="ExtrudeBufferGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeVertexNormals())}function di(t,e){Z.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new fi(t,e)),this.mergeVertices()}function fi(t,e){var i=(e=e||{}).font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Z;i=i.generateShapes(t,e.size,e.curveSegments),e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),pi.call(this,i,e),this.type="TextBufferGeometry"}function mi(t,e,i,r,n,o,a){Z.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:r,phiLength:n,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new gi(t,e,i,r,n,o,a)),this.mergeVertices()}function gi(t,e,i,r,n,o,a){ht.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:r,phiLength:n,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;for(var s=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),l=0,c=[],h=new _t,u=new _t,p=[],d=[],f=[],m=[],g=0;g<=i;g++){for(var v=[],y=g/i,b=0;b<=e;b++){var x=b/e;h.x=-t*Math.cos(r+x*n)*Math.sin(o+y*a),h.y=t*Math.cos(o+y*a),h.z=t*Math.sin(r+x*n)*Math.sin(o+y*a),d.push(h.x,h.y,h.z),u.set(h.x,h.y,h.z).normalize(),f.push(u.x,u.y,u.z),m.push(x,1-y),v.push(l++)}c.push(v)}for(g=0;g<i;g++)for(b=0;b<e;b++)t=c[g][b+1],r=c[g][b],n=c[g+1][b],a=c[g+1][b+1],(0!==g||0<o)&&p.push(t,r,a),(g!==i-1||s<Math.PI)&&p.push(r,n,a);this.setIndex(p),this.addAttribute("position",new at(d,3)),this.addAttribute("normal",new at(f,3)),this.addAttribute("uv",new at(m,2))}function vi(t,e,i,r,n,o){Z.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:r,thetaStart:n,thetaLength:o},this.fromBufferGeometry(new yi(t,e,i,r,n,o)),this.mergeVertices()}function yi(t,e,i,r,n,o){ht.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:r,thetaStart:n,thetaLength:o},t=t||.5,e=e||1,n=void 0!==n?n:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?Math.max(3,i):8;for(var a,s=[],l=[],c=[],h=[],u=t,p=(e-t)/(r=void 0!==r?Math.max(1,r):1),d=new _t,f=new q,m=0;m<=r;m++){for(a=0;a<=i;a++)t=n+a/i*o,d.x=u*Math.cos(t),d.y=u*Math.sin(t),l.push(d.x,d.y,d.z),c.push(0,0,1),f.x=(d.x/e+1)/2,f.y=(d.y/e+1)/2,h.push(f.x,f.y);u+=p}for(m=0;m<r;m++)for(e=m*(i+1),a=0;a<i;a++)o=(t=a+e)+i+2,s.push(t,n=t+i+1,u=t+1),s.push(n,o,u);this.setIndex(s),this.addAttribute("position",new at(l,3)),this.addAttribute("normal",new at(c,3)),this.addAttribute("uv",new at(h,2))}function bi(t,e,i,r){Z.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:r},this.fromBufferGeometry(new xi(t,e,i,r)),this.mergeVertices()}function xi(t,e,i,r){ht.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:r},e=Math.floor(e)||12,i=i||0,r=r||2*Math.PI,r=io.clamp(r,0,2*Math.PI);for(var n=[],o=[],a=[],s=1/e,l=new _t,c=new q,h=0;h<=e;h++){var u=i+h*s*r,p=Math.sin(u),d=Math.cos(u);for(u=0;u<=t.length-1;u++)l.x=t[u].x*p,l.y=t[u].y,l.z=t[u].x*d,o.push(l.x,l.y,l.z),c.x=h/e,c.y=u/(t.length-1),a.push(c.x,c.y)}for(h=0;h<e;h++)for(u=0;u<t.length-1;u++)s=(i=u+h*t.length)+t.length,l=i+t.length+1,n.push(i,s,c=i+1),n.push(s,l,c);if(this.setIndex(n),this.addAttribute("position",new at(o,3)),this.addAttribute("uv",new at(a,2)),this.computeVertexNormals(),r===2*Math.PI)for(r=this.attributes.normal.array,n=new _t,o=new _t,a=new _t,i=e*t.length*3,u=h=0;h<t.length;h++,u+=3)n.x=r[u+0],n.y=r[u+1],n.z=r[u+2],o.x=r[i+u+0],o.y=r[i+u+1],o.z=r[i+u+2],a.addVectors(n,o).normalize(),r[u+0]=r[i+u+0]=a.x,r[u+1]=r[i+u+1]=a.y,r[u+2]=r[i+u+2]=a.z}function wi(t,e){Z.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Mi(t,e)),this.mergeVertices()}function Mi(t,s){function e(t){var e,i,r=c.length/3,n=(t=t.extractPoints(s)).shape,o=t.holes;if(!1===Xs.isClockWise(n))for(n=n.reverse(),t=0,e=o.length;t<e;t++)i=o[t],!0===Xs.isClockWise(i)&&(o[t]=i.reverse());var a=Xs.triangulateShape(n,o);for(t=0,e=o.length;t<e;t++)i=o[t],n=n.concat(i);for(t=0,e=n.length;t<e;t++)i=n[t],c.push(i.x,i.y,0),h.push(0,0,1),u.push(i.x,i.y);for(t=0,e=a.length;t<e;t++)n=a[t],l.push(n[0]+r,n[1]+r,n[2]+r),p+=3}ht.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:s},s=s||12;var l=[],c=[],h=[],u=[],i=0,p=0;if(!1===Array.isArray(t))e(t);else for(var r=0;r<t.length;r++)e(t[r]),this.addGroup(i,p,r),i+=p,p=0;this.setIndex(l),this.addAttribute("position",new at(c,3)),this.addAttribute("normal",new at(h,3)),this.addAttribute("uv",new at(u,2))}function _i(t,e){if(e.shapes=[],Array.isArray(t))for(var i=0,r=t.length;i<r;i++)e.shapes.push(t[i].uuid);else e.shapes.push(t.uuid);return e}function Ai(t,e){ht.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e};var i,r,n=[],o=Math.cos(io.DEG2RAD*(void 0!==e?e:1)),a=[0,0],s={},l=["a","b","c"];t.isBufferGeometry?(c=new Z).fromBufferGeometry(t):c=t.clone(),c.mergeVertices(),c.computeFaceNormals();for(var c,h=c.vertices,u=0,p=(c=c.faces).length;u<p;u++)for(var d=c[u],f=0;f<3;f++)i=d[l[f]],r=d[l[(f+1)%3]],a[0]=Math.min(i,r),a[1]=Math.max(i,r),void 0===s[i=a[0]+","+a[1]]?s[i]={index1:a[0],index2:a[1],face1:u,face2:void 0}:s[i].face2=u;for(i in s)(void 0===(a=s[i]).face2||c[a.face1].normal.dot(c[a.face2].normal)<=o)&&(l=h[a.index1],n.push(l.x,l.y,l.z),l=h[a.index2],n.push(l.x,l.y,l.z));this.addAttribute("position",new at(n,3))}function Ei(t,e,i,r,n,o,a,s){Z.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:r,heightSegments:n,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Si(t,e,i,r,n,o,a,s)),this.mergeVertices()}function Si(p,d,f,m,g,t,v,y){function e(t){for(var e,i=new q,r=new _t,n=0,o=!0===t?p:d,a=!0===t?1:-1,s=A,l=1;l<=m;l++)w.push(0,S*a,0),M.push(0,a,0),_.push(.5,.5),A++;for(e=A,l=0;l<=m;l++){var c=l/m*y+v,h=Math.cos(c),c=Math.sin(c);r.x=o*c,r.y=S*a,r.z=o*h,w.push(r.x,r.y,r.z),M.push(0,a,0),i.x=.5*h+.5,i.y=.5*c*a+.5,_.push(i.x,i.y),A++}for(l=0;l<m;l++)i=s+l,r=e+l,!0===t?x.push(r,r+1,i):x.push(r+1,r,i),n+=3;b.addGroup(P,n,!0===t?1:2),P+=n}ht.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:p,radiusBottom:d,height:f,radialSegments:m,heightSegments:g,openEnded:t,thetaStart:v,thetaLength:y};var b=this;p=void 0!==p?p:1,d=void 0!==d?d:1,f=f||1,m=Math.floor(m)||8,g=Math.floor(g)||1,t=void 0!==t&&t,v=void 0!==v?v:0,y=void 0!==y?y:2*Math.PI;var x=[],w=[],M=[],_=[],A=0,E=[],S=f/2,P=0;!function(){for(var t=new _t,e=new _t,i=0,r=(d-p)/f,n=0;n<=g;n++){for(var o=[],a=n/g,s=a*(d-p)+p,l=0;l<=m;l++){var c=l/m,h=c*y+v,u=Math.sin(h),h=Math.cos(h);e.x=s*u,e.y=-a*f+S,e.z=s*h,w.push(e.x,e.y,e.z),t.set(u,r,h).normalize(),M.push(t.x,t.y,t.z),_.push(c,1-a),o.push(A++)}E.push(o)}for(l=0;l<m;l++)for(n=0;n<g;n++)t=E[n+1][l],e=E[n+1][l+1],r=E[n][l+1],x.push(E[n][l],t,r),x.push(t,e,r),i+=6;b.addGroup(P,i,0),P+=i}(),!1===t&&(0<p&&e(!0),0<d&&e(!1)),this.setIndex(x),this.addAttribute("position",new at(w,3)),this.addAttribute("normal",new at(M,3)),this.addAttribute("uv",new at(_,2))}function Pi(t,e,i,r,n,o,a){Ei.call(this,0,t,e,i,r,n,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:r,openEnded:n,thetaStart:o,thetaLength:a}}function Ti(t,e,i,r,n,o,a){Si.call(this,0,t,e,i,r,n,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:r,openEnded:n,thetaStart:o,thetaLength:a}}function Ci(t,e,i,r){Z.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:r},this.fromBufferGeometry(new Oi(t,e,i,r)),this.mergeVertices()}function Oi(t,e,i,r){ht.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI;var n,o,a=[],s=[],l=[],c=[],h=new _t,u=new q;for(s.push(0,0,0),l.push(0,0,1),c.push(.5,.5),o=0,n=3;o<=e;o++,n+=3){var p=i+o/e*r;h.x=t*Math.cos(p),h.y=t*Math.sin(p),s.push(h.x,h.y,h.z),l.push(0,0,1),u.x=(s[n]/t+1)/2,u.y=(s[n+1]/t+1)/2,c.push(u.x,u.y)}for(n=1;n<=e;n++)a.push(n,n+1,0);this.setIndex(a),this.addAttribute("position",new at(s,3)),this.addAttribute("normal",new at(l,3)),this.addAttribute("uv",new at(c,2))}function Ri(t){N.call(this),this.type="ShadowMaterial",this.color=new j(0),this.opacity=1,this.transparent=this.lights=!0,this.setValues(t)}function Li(t){gt.call(this,t),this.type="RawShaderMaterial"}function Ii(t){N.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new j(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new j(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new q(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Di(t){Ii.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoatRoughness=this.clearCoat=0,this.setValues(t)}function Fi(t){N.call(this),this.type="MeshPhongMaterial",this.color=new j(16777215),this.specular=new j(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new j(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new q(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function ji(t){Fi.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function Ni(t){N.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new q(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1,this.setValues(t)}function ki(t){N.call(this),this.type="MeshLambertMaterial",this.color=new j(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new j(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function zi(t){we.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function Ui(t,e,i){var r=this,n=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){a++,!1===n&&void 0!==r.onStart&&r.onStart(t,o,a),n=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(n=!1,void 0!==r.onLoad)&&r.onLoad()},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this}}function Vi(t){this.manager=void 0!==t?t:Js}function Bi(t){this.manager=void 0!==t?t:Js,this._parser=null}function Hi(t){this.manager=void 0!==t?t:Js,this._parser=null}function Gi(t){this.manager=void 0!==t?t:Js}function Wi(t){this.manager=void 0!==t?t:Js}function Xi(t){this.manager=void 0!==t?t:Js}function qi(){this.type="Curve",this.arcLengthDivisions=200}function Yi(t,e,i,r,n,o,a,s){qi.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=i||1,this.yRadius=r||1,this.aStartAngle=n||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Ki(t,e,i,r,n,o){Yi.call(this,t,e,i,i,r,n,o),this.type="ArcCurve"}function Ji(){var s=0,l=0,c=0,h=0;return{initCatmullRom:function(t,e,i,r,n){c=-3*(s=e)+3*i-2*(l=t=n*(i-t))-(r=n*(r-e)),h=2*e-2*i+t+r},initNonuniformCatmullRom:function(t,e,i,r,n,o,a){r=((i-e)/o-(r-e)/(o+a)+(r-i)/a)*o,c=-3*(s=e)+3*i-2*(l=o=t=((e-t)/n-(i-t)/(n+o)+(i-e)/o)*o)-r,h=2*e-2*i+o+r},calc:function(t){var e=t*t;return s+l*t+c*e+h*e*t}}}function Zi(t,e,i,r){qi.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=i||"centripetal",this.tension=r||.5}function Qi(t,e,i,r,n){var o=t*t;return(2*i-2*r+(e=.5*(r-e))+(n=.5*(n-i)))*t*o+(-3*i+3*r-2*e-n)*o+e*t+i}function $i(t,e,i,r){var n=1-t;return n*n*e+2*(1-t)*t*i+t*t*r}function tr(t,e,i,r,n){var o=1-t,a=1-t;return o*o*o*e+3*a*a*t*i+3*(1-t)*t*t*r+t*t*t*n}function er(t,e,i,r){qi.call(this),this.type="CubicBezierCurve",this.v0=t||new q,this.v1=e||new q,this.v2=i||new q,this.v3=r||new q}function ir(t,e,i,r){qi.call(this),this.type="CubicBezierCurve3",this.v0=t||new _t,this.v1=e||new _t,this.v2=i||new _t,this.v3=r||new _t}function rr(t,e){qi.call(this),this.type="LineCurve",this.v1=t||new q,this.v2=e||new q}function nr(t,e){qi.call(this),this.type="LineCurve3",this.v1=t||new _t,this.v2=e||new _t}function or(t,e,i){qi.call(this),this.type="QuadraticBezierCurve",this.v0=t||new q,this.v1=e||new q,this.v2=i||new q}function ar(t,e,i){qi.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new _t,this.v1=e||new _t,this.v2=i||new _t}function sr(t){qi.call(this),this.type="SplineCurve",this.points=t||[]}function lr(){qi.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function cr(t){lr.call(this),this.type="Path",this.currentPoint=new q,t&&this.setFromPoints(t)}function hr(t){cr.call(this,t),this.uuid=io.generateUUID(),this.type="Shape",this.holes=[]}function ur(t,e){X.call(this),this.type="Light",this.color=new j(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function pr(t,e,i){ur.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(X.DefaultUp),this.updateMatrix(),this.groundColor=new j(e)}function dr(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new q(512,512),this.map=null,this.matrix=new Mt}function fr(){dr.call(this,new ee(50,1,.5,500))}function mr(t,e,i,r,n,o){ur.call(this,t,e),this.type="SpotLight",this.position.copy(X.DefaultUp),this.updateMatrix(),this.target=new X,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==n?n:0,this.decay=void 0!==o?o:1,this.shadow=new fr}function gr(t,e,i,r){ur.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==r?r:1,this.shadow=new dr(new ee(90,1,.5,500))}function vr(){dr.call(this,new K(-5,5,5,-5,.5,500))}function yr(t,e){ur.call(this,t,e),this.type="DirectionalLight",this.position.copy(X.DefaultUp),this.updateMatrix(),this.target=new X,this.shadow=new vr}function br(t,e){ur.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function xr(t,e,i,r){ur.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==i?i:10,this.height=void 0!==r?r:10}function wr(t,e,i,r){Rr.call(this,t,e,i,r)}function Mr(t,e,i){Rr.call(this,t,e,i)}function _r(t,e,i,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(i),this.sampleValues=e,this.valueSize=i}function Ar(t,e,i,r){_r.call(this,t,e,i,r)}function Er(t,e,i,r){Rr.call(this,t,e,i,r)}function Sr(t,e,i,r){Rr.call(this,t,e,i,r)}function Pr(t,e,i,r){Rr.call(this,t,e,i,r)}function Tr(t,e,i,r){_r.call(this,t,e,i,r),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function Cr(t,e,i,r){_r.call(this,t,e,i,r)}function Or(t,e,i,r){_r.call(this,t,e,i,r)}function Rr(t,e,i,r){if(void 0===t)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=rl.convertArray(e,this.TimeBufferType),this.values=rl.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function Lr(t,e,i,r){Rr.call(this,t,e,i,r)}function Ir(t,e,i){this.name=t,this.tracks=i,this.duration=void 0!==e?e:-1,this.uuid=io.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Dr(t){this.manager=void 0!==t?t:Js,this.textures={}}function Fr(t){this.manager=void 0!==t?t:Js}function jr(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function Nr(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:Js,this.withCredentials=!1}function kr(t){this.manager=void 0!==t?t:Js,this.texturePath=""}function zr(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:Js,this.options=void 0}function Ur(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function Vr(t){this.type="Font",this.data=t}function Br(t){this.manager=void 0!==t?t:Js}function Hr(t){this.manager=void 0!==t?t:Js}function Gr(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ee,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ee,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Wr(t,e,i){X.call(this),this.type="CubeCamera";var n=new ee(90,1,t,e);n.up.set(0,-1,0),n.lookAt(new _t(1,0,0)),this.add(n);var o=new ee(90,1,t,e);o.up.set(0,-1,0),o.lookAt(new _t(-1,0,0)),this.add(o);var a=new ee(90,1,t,e);a.up.set(0,0,1),a.lookAt(new _t(0,1,0)),this.add(a);var s=new ee(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new _t(0,-1,0)),this.add(s);var l=new ee(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new _t(0,0,1)),this.add(l);var c=new ee(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new _t(0,0,-1)),this.add(c),this.renderTarget=new r(i,i,{format:1022,magFilter:1006,minFilter:1006}),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,r=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,i.activeCubeFace=0,t.render(e,n,i),i.activeCubeFace=1,t.render(e,o,i),i.activeCubeFace=2,t.render(e,a,i),i.activeCubeFace=3,t.render(e,s,i),i.activeCubeFace=4,t.render(e,l,i),i.texture.generateMipmaps=r,i.activeCubeFace=5,t.render(e,c,i),t.setRenderTarget(null)},this.clear=function(t,e,i,r){for(var n=this.renderTarget,o=0;o<6;o++)n.activeCubeFace=o,t.setRenderTarget(n),t.clear(e,i,r);t.setRenderTarget(null)}}function Xr(){X.call(this),this.type="AudioListener",this.context=uc.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function qr(t){X.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.offset=this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Yr(t){qr.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Kr(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Jr(t,e,i){switch(this.binding=t,this.valueSize=i,t=Float64Array,e){case"quaternion":e=this._slerp;break;case"string":case"bool":t=Array,e=this._select;break;default:e=this._lerp}this.buffer=new t(4*i),this._mixBufferRegion=e,this.referenceCount=this.useCount=this.cumulativeWeight=0}function Zr(t,e,i){i=i||Qr.parseTrackName(e),this._targetGroup=t,this._bindings=t.subscribe_(e,i)}function Qr(t,e,i){this.path=e,this.parsedPath=i||Qr.parseTrackName(e),this.node=Qr.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function $r(){this.uuid=io.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,i=arguments.length;e!==i;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function tn(t,e,i){this._mixer=t,this._clip=e,this._localRoot=i||null,e=(t=e.tracks).length,i=Array(e);for(var r={endingStart:2400,endingEnd:2400},n=0;n!==e;++n){var o=t[n].createInterpolant(null);(i[n]=o).settings=r}this._interpolantSettings=r,this._interpolants=i,this._propertyBindings=Array(e),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function en(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function rn(t,e){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=e),this.value=t}function nn(){ht.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function on(t,e,i,r){this.uuid=io.generateUUID(),this.data=t,this.itemSize=e,this.offset=i,this.normalized=!0===r}function an(t,e){this.uuid=io.generateUUID(),this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function sn(t,e,i){an.call(this,t,e),this.meshPerAttribute=i||1}function ln(t,e,i){Q.call(this,t,e),this.meshPerAttribute=i||1}function cn(t,e,i,r){this.ray=new vt(t,e),this.near=i||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function hn(t,e){return t.distance-e.distance}function un(t,e,i,r){if(!1!==t.visible&&(t.raycast(e,i),!0===r)){r=0;for(var n=(t=t.children).length;r<n;r++)un(t[r],e,i,!0)}}function pn(t){this.autoStart=void 0===t||t,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function dn(t,e,i){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==i?i:0,this}function fn(t,e,i){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==i?i:0,this}function mn(t,e){this.min=void 0!==t?t:new q(1/0,1/0),this.max=void 0!==e?e:new q(-1/0,-1/0)}function gn(t){X.call(this),this.material=t,this.render=function(){}}function vn(t,e,i,r){this.object=t,this.size=void 0!==e?e:1,t=void 0!==i?i:16711680,r=void 0!==r?r:1,e=0,(i=this.object.geometry)&&i.isGeometry?e=3*i.faces.length:i&&i.isBufferGeometry&&(e=i.attributes.normal.count),i=new ht,e=new at(6*e,3),i.addAttribute("position",e),_e.call(this,i,new we({color:t,linewidth:r})),this.matrixAutoUpdate=!1,this.update()}function yn(t,e){X.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var e=new ht,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,n=1;r<32;r++,n++){var o=r/32*Math.PI*2,a=n/32*Math.PI*2;i.push(Math.cos(o),Math.sin(o),1,Math.cos(a),Math.sin(a),1)}e.addAttribute("position",new at(i,3)),i=new we({fog:!1}),this.cone=new _e(e,i),this.add(this.cone),this.update()}function bn(t){for(var e=function t(e){var i=[];e&&e.isBone&&i.push(e);for(var r=0;r<e.children.length;r++)i.push.apply(i,t(e.children[r]));return i}(t),i=new ht,r=[],n=[],o=new j(0,0,1),a=new j(0,1,0),s=0;s<e.length;s++){var l=e[s];l.parent&&l.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),n.push(o.r,o.g,o.b),n.push(a.r,a.g,a.b))}i.addAttribute("position",new at(r,3)),i.addAttribute("color",new at(n,3)),r=new we({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0}),_e.call(this,i,r),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function xn(t,e,i){this.light=t,this.light.updateMatrixWorld(),this.color=i,t=new gi(e,4,2),e=new mt({wireframe:!0,fog:!1}),xt.call(this,t,e),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function wn(t,e){X.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;t=new we({fog:!1}),e=new ht;e.addAttribute("position",new Q(new Float32Array(15),3)),this.line=new Me(e,t),this.add(this.line),this.update()}function Mn(t,e,i){X.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,(t=new ze(e)).rotateY(.5*Math.PI),this.material=new mt({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=2),e=t.getAttribute("position"),e=new Float32Array(3*e.count),t.addAttribute("color",new Q(e,3)),this.add(new xt(t,this.material)),this.update()}function _n(t,e,i,r){t=t||10,e=e||10,i=new j(void 0!==i?i:4473924),r=new j(void 0!==r?r:8947848);var n=e/2,o=t/e,a=t/2;t=[];for(var s=[],l=0,c=0,h=-a;l<=e;l++,h+=o){t.push(-a,0,h,a,0,h),t.push(h,0,-a,h,0,a);var u=l===n?i:r;u.toArray(s,c),c+=3,u.toArray(s,c),c+=3,u.toArray(s,c),c+=3,u.toArray(s,c),c+=3}(e=new ht).addAttribute("position",new at(t,3)),e.addAttribute("color",new at(s,3)),i=new we({vertexColors:2}),_e.call(this,e,i)}function An(t,e,i,r,n,o){t=t||10,e=e||16,i=i||8,r=r||64,n=new j(void 0!==n?n:4473924),o=new j(void 0!==o?o:8947848);for(var a,s,l,c,h=[],u=[],p=0;p<=e;p++)s=p/e*2*Math.PI,a=Math.sin(s)*t,s=Math.cos(s)*t,h.push(0,0,0),h.push(a,0,s),u.push((c=1&p?n:o).r,c.g,c.b),u.push(c.r,c.g,c.b);for(p=0;p<=i;p++)for(c=1&p?n:o,l=t-t/i*p,e=0;e<r;e++)s=e/r*2*Math.PI,a=Math.sin(s)*l,s=Math.cos(s)*l,h.push(a,0,s),u.push(c.r,c.g,c.b),s=(e+1)/r*2*Math.PI,a=Math.sin(s)*l,s=Math.cos(s)*l,h.push(a,0,s),u.push(c.r,c.g,c.b);(t=new ht).addAttribute("position",new at(h,3)),t.addAttribute("color",new at(u,3)),h=new we({vertexColors:2}),_e.call(this,t,h)}function En(t,e,i,r){this.object=t,this.size=void 0!==e?e:1,t=void 0!==i?i:16776960,r=void 0!==r?r:1,e=0,(i=this.object.geometry)&&i.isGeometry?e=i.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),i=new ht,e=new at(6*e,3),i.addAttribute("position",e),_e.call(this,i,new we({color:t,linewidth:r})),this.matrixAutoUpdate=!1,this.update()}function Sn(t,e,i){X.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,void 0===e&&(e=1),(t=new ht).addAttribute("position",new at([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3)),e=new we({fog:!1}),this.lightPlane=new Me(t,e),this.add(this.lightPlane),(t=new ht).addAttribute("position",new at([0,0,0,0,0,1],3)),this.targetLine=new Me(t,e),this.add(this.targetLine),this.update()}function Pn(t){function e(t,e,i){r(t,i),r(e,i)}function r(t,e){o.push(0,0,0),a.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(o.length/3-1)}var i=new ht,n=new we({color:16777215,vertexColors:1}),o=[],a=[],s={},l=new j(16755200),c=new j(16711680),h=new j(43775),u=new j(16777215),p=new j(3355443);e("n1","n2",l),e("n2","n4",l),e("n4","n3",l),e("n3","n1",l),e("f1","f2",l),e("f2","f4",l),e("f4","f3",l),e("f3","f1",l),e("n1","f1",l),e("n2","f2",l),e("n3","f3",l),e("n4","f4",l),e("p","n1",c),e("p","n2",c),e("p","n3",c),e("p","n4",c),e("u1","u2",h),e("u2","u3",h),e("u3","u1",h),e("c","t",u),e("p","c",p),e("cn1","cn2",p),e("cn3","cn4",p),e("cf1","cf2",p),e("cf3","cf4",p),i.addAttribute("position",new at(o,3)),i.addAttribute("color",new at(a,3)),_e.call(this,i,n),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function Tn(t,e){this.object=t,void 0===e&&(e=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),t=new ht;t.setIndex(new Q(i,1)),t.addAttribute("position",new Q(r,3)),_e.call(this,t,new we({color:e})),this.matrixAutoUpdate=!1,this.update()}function Cn(t,e){this.type="Box3Helper",this.box=t;var i=void 0!==e?e:16776960,t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),e=new ht;e.setIndex(new Q(t,1)),e.addAttribute("position",new at([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),_e.call(this,e,new we({color:i})),this.geometry.computeBoundingSphere()}function On(t,e,i){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e,t=void 0!==i?i:16776960,(e=new ht).addAttribute("position",new at([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),e.computeBoundingSphere(),Me.call(this,e,new we({color:t})),(e=new ht).addAttribute("position",new at([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),e.computeBoundingSphere(),this.add(new xt(e,new mt({color:t,opacity:.2,transparent:!0,depthWrite:!1})))}function Rn(t,e,i,r,n,o){X.call(this),void 0===r&&(r=16776960),void 0===i&&(i=1),void 0===n&&(n=.2*i),void 0===o&&(o=.2*n),void 0===ac&&((ac=new ht).addAttribute("position",new at([0,0,0,0,1,0],3)),(sc=new Si(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new Me(ac,new we({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new xt(sc,new mt({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,n,o)}function Ln(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t];(t=new ht).addAttribute("position",new at(e,3)),t.addAttribute("color",new at([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),e=new we({vertexColors:2}),_e.call(this,t,e)}function In(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Zi.call(this,t),this.type="catmullrom",this.closed=!0}function Dn(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Zi.call(this,t),this.type="catmullrom"}function Fn(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Zi.call(this,t),this.type="catmullrom"}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:0<t?1:+t}),!1=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}),Object.assign(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)},removeEventListener:function(t,e){void 0!==this._listeners&&(void 0===(t=this._listeners[t])||-1!==(e=t.indexOf(e))&&t.splice(e,1))},dispatchEvent:function(t){if(void 0!==this._listeners&&void 0!==(e=this._listeners[t.type])){t.target=this;for(var e,i=0,r=(e=e.slice(0)).length;i<r;i++)e[i].call(this,t)}}});var jn,Nn,kn,zn,Un,Vn,Bn,Hn,Gn,Wn,Xn,qn,Yn,Kn,Jn,Zn,Qn,$n,to,eo,io={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var n=[],t=0;t<256;t++)n[t]=(t<16?"0":"")+t.toString(16).toUpperCase();return function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return n[255&t]+n[t>>8&255]+n[t>>16&255]+n[t>>24&255]+"-"+n[255&e]+n[e>>8&255]+"-"+n[e>>16&15|64]+n[e>>24&255]+"-"+n[63&i|128]+n[i>>8&255]+"-"+n[i>>16&255]+n[i>>24&255]+n[255&r]+n[r>>8&255]+n[r>>16&255]+n[r>>24&255]}}(),clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,r,n){return r+(t-e)*(n-r)/(i-e)},lerp:function(t,e,i){return(1-i)*t+i*e},smoothstep:function(t,e,i){return t<=e?0:i<=t?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:i<=t?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*io.DEG2RAD},radToDeg:function(t){return t*io.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};Object.defineProperties(q.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(q.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,i=this.y;return t=t.elements,this.x=t[0]*e+t[3]*i+t[6],this.y=t[1]*e+t[4]*i+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:(jn=new q,Nn=new q,function(t,e){return jn.set(t,t),Nn.set(e,e),this.clamp(jn,Nn)}),clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return e*e+(t=this.y-t.y)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var i=Math.cos(e),r=Math.sin(e),n=this.x-t.x,e=this.y-t.y;return this.x=n*i-e*r+t.x,this.y=n*r+e*i+t.y,this}}),Object.assign(Mt.prototype,{isMatrix4:!0,set:function(t,e,i,r,n,o,a,s,l,c,h,u,p,d,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=r,g[1]=n,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=h,g[14]=u,g[3]=p,g[7]=d,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Mt).fromArray(this.elements)},copy:function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},copyPosition:function(t){var e=this.elements;return t=t.elements,e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:(Gn=new _t,function(t){var e=this.elements,i=t.elements,r=1/Gn.setFromMatrixColumn(t,0).length(),n=1/Gn.setFromMatrixColumn(t,1).length();return t=1/Gn.setFromMatrixColumn(t,2).length(),e[0]=i[0]*r,e[1]=i[1]*r,e[2]=i[2]*r,e[4]=i[4]*n,e[5]=i[5]*n,e[6]=i[6]*n,e[8]=i[8]*t,e[9]=i[9]*t,e[10]=i[10]*t,this}),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e,i,r,n=this.elements,o=t.x,a=t.y,s=t.z,l=Math.cos(o),o=Math.sin(o),c=Math.cos(a),a=Math.sin(a),h=Math.cos(s),s=Math.sin(s);return"XYZ"===t.order?(t=l*h,e=l*s,i=o*h,r=o*s,n[0]=c*h,n[4]=-c*s,n[8]=a,n[1]=e+i*a,n[5]=t-r*a,n[9]=-o*c,n[2]=r-t*a,n[6]=i+e*a,n[10]=l*c):"YXZ"===t.order?(e=c*s,i=a*h,n[0]=(t=c*h)+(r=a*s)*o,n[4]=i*o-e,n[8]=l*a,n[1]=l*s,n[5]=l*h,n[9]=-o,n[2]=e*o-i,n[6]=r+t*o,n[10]=l*c):"ZXY"===t.order?(e=c*s,i=a*h,n[0]=(t=c*h)-(r=a*s)*o,n[4]=-l*s,n[8]=i+e*o,n[1]=e+i*o,n[5]=l*h,n[9]=r-t*o,n[2]=-l*a,n[6]=o,n[10]=l*c):"ZYX"===t.order?(t=l*h,e=l*s,i=o*h,r=o*s,n[0]=c*h,n[4]=i*a-e,n[8]=t*a+r,n[1]=c*s,n[5]=r*a+t,n[9]=e*a-i,n[2]=-a,n[6]=o*c,n[10]=l*c):"YZX"===t.order?(t=l*c,e=l*a,i=o*c,r=o*a,n[0]=c*h,n[4]=r-t*s,n[8]=i*s+e,n[1]=s,n[5]=l*h,n[9]=-o*h,n[2]=-a*h,n[6]=e*s+i,n[10]=t-r*s):"XZY"===t.order&&(t=l*c,e=l*a,i=o*c,r=o*a,n[0]=c*h,n[4]=-s,n[8]=a*h,n[1]=t*s+r,n[5]=l*h,n[9]=e*s-i,n[2]=i*s-e,n[6]=o*h,n[10]=r*s+t),n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,i=t._x,r=t._y,n=t._z,o=t._w,a=n+n;t=i*(c=i+i);var s=i*(h=r+r),i=i*a,l=r*h,r=r*a,c=o*c,h=o*h,o=o*a;return e[0]=1-(l+(n=n*a)),e[4]=s-o,e[8]=i+h,e[1]=s+o,e[5]=1-(t+n),e[9]=r-c,e[2]=i-h,e[6]=r+c,e[10]=1-(t+l),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:(Vn=new _t,Bn=new _t,Hn=new _t,function(t,e,i){var r=this.elements;return Hn.subVectors(t,e),0===Hn.lengthSq()&&(Hn.z=1),Hn.normalize(),Vn.crossVectors(i,Hn),0===Vn.lengthSq()&&(1===Math.abs(i.z)?Hn.x+=1e-4:Hn.z+=1e-4,Hn.normalize(),Vn.crossVectors(i,Hn)),Vn.normalize(),Bn.crossVectors(Hn,Vn),r[0]=Vn.x,r[4]=Bn.x,r[8]=Hn.x,r[1]=Vn.y,r[5]=Bn.y,r[9]=Hn.y,r[2]=Vn.z,r[6]=Bn.z,r[10]=Hn.z,this}),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,r=e.elements,n=this.elements,o=i[0],a=i[4],s=i[8],l=i[12],c=i[1],h=i[5],u=i[9],p=i[13],d=i[2],f=i[6],m=i[10],g=i[14],v=i[3],y=i[7],b=i[11],i=i[15],x=r[0],w=r[4],M=r[8],_=r[12],A=r[1],E=r[5],S=r[9],P=r[13],T=r[2],C=r[6],O=r[10],R=r[14],L=r[3],t=r[7],e=r[11],r=r[15];return n[0]=o*x+a*A+s*T+l*L,n[4]=o*w+a*E+s*C+l*t,n[8]=o*M+a*S+s*O+l*e,n[12]=o*_+a*P+s*R+l*r,n[1]=c*x+h*A+u*T+p*L,n[5]=c*w+h*E+u*C+p*t,n[9]=c*M+h*S+u*O+p*e,n[13]=c*_+h*P+u*R+p*r,n[2]=d*x+f*A+m*T+g*L,n[6]=d*w+f*E+m*C+g*t,n[10]=d*M+f*S+m*O+g*e,n[14]=d*_+f*P+m*R+g*r,n[3]=v*x+y*A+b*T+i*L,n[7]=v*w+y*E+b*C+i*t,n[11]=v*M+y*S+b*O+i*e,n[15]=v*_+y*P+b*R+i*r,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:(Un=new _t,function(t){for(var e=0,i=t.count;e<i;e++)Un.x=t.getX(e),Un.y=t.getY(e),Un.z=t.getZ(e),Un.applyMatrix4(this),t.setXYZ(e,Un.x,Un.y,Un.z);return t}),determinant:function(){var t=this.elements,e=t[0],i=t[4],r=t[8],n=t[12],o=t[1],a=t[5],s=t[9],l=t[13],c=t[2],h=t[6],u=t[10],p=t[14];return t[3]*(+n*s*h-r*l*h-n*a*u+i*l*u+r*a*p-i*s*p)+t[7]*(+e*s*p-e*l*u+n*o*u-r*o*p+r*l*c-n*s*c)+t[11]*(+e*l*h-e*a*p-n*o*h+i*o*p+n*a*c-i*l*c)+t[15]*(-r*a*c-e*s*h+e*a*u+r*o*h-i*o*u+i*s*c)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements,r=t.elements,n=r[0],o=r[1],a=r[2],s=r[3],l=r[4],c=r[5],h=r[6],u=r[7],p=r[8],d=r[9],f=r[10],m=r[11],g=r[12],v=r[13],y=r[14],b=d*y*u-v*f*u+v*h*m-c*y*m-d*h*(r=r[15])+c*f*r,x=g*f*u-p*y*u-g*h*m+l*y*m+p*h*r-l*f*r,w=p*v*u-g*d*u+g*c*m-l*v*m-p*c*r+l*d*r,M=g*d*h-p*v*h-g*c*f+l*v*f+p*c*y-l*d*y,t=n*b+o*x+a*w+s*M;if(0!=t)return i[0]=b*(t=1/t),i[1]=(v*f*s-d*y*s-v*a*m+o*y*m+d*a*r-o*f*r)*t,i[2]=(c*y*s-v*h*s+v*a*u-o*y*u-c*a*r+o*h*r)*t,i[3]=(d*h*s-c*f*s-d*a*u+o*f*u+c*a*m-o*h*m)*t,i[4]=x*t,i[5]=(p*y*s-g*f*s+g*a*m-n*y*m-p*a*r+n*f*r)*t,i[6]=(g*h*s-l*y*s-g*a*u+n*y*u+l*a*r-n*h*r)*t,i[7]=(l*f*s-p*h*s+p*a*u-n*f*u-l*a*m+n*h*m)*t,i[8]=w*t,i[9]=(g*d*s-p*v*s-g*o*m+n*v*m+p*o*r-n*d*r)*t,i[10]=(l*v*s-g*c*s+g*o*u-n*v*u-l*o*r+n*c*r)*t,i[11]=(p*c*s-l*d*s-p*o*u+n*d*u+l*o*m-n*c*m)*t,i[12]=M*t,i[13]=(p*v*a-g*d*a+g*o*f-n*v*f-p*o*y+n*d*y)*t,i[14]=(g*c*a-l*v*a-g*o*h+n*v*h+l*o*y-n*c*y)*t,i[15]=(l*d*a-p*c*a+p*o*h-n*d*h-l*o*f+n*c*f)*t,this;if(!0===e)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0"),this.identity()},scale:function(t){var e=this.elements,i=t.x,r=t.y;return t=t.z,e[0]*=i,e[4]*=r,e[8]*=t,e[1]*=i,e[5]*=r,e[9]*=t,e[2]*=i,e[6]*=r,e[10]*=t,e[3]*=i,e[7]*=r,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),r=Math.sin(e),n=1-i,o=t.x,a=t.y,s=t.z,e=n*o,t=n*a;return this.set(e*o+i,e*a-r*s,e*s+r*a,0,e*a+r*s,t*a+i,t*s-r*o,0,e*s-r*a,t*s+r*o,n*s*s+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,e,i){return this.set(1,e,i,0,t,1,i,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},decompose:(kn=new _t,zn=new Mt,function(t,e,i){var r=this.elements,n=kn.set(r[0],r[1],r[2]).length(),o=kn.set(r[4],r[5],r[6]).length(),a=kn.set(r[8],r[9],r[10]).length();this.determinant()<0&&(n=-n),t.x=r[12],t.y=r[13],t.z=r[14],zn.copy(this);var r=1/o,s=1/a;return zn.elements[0]*=t=1/n,zn.elements[1]*=t,zn.elements[2]*=t,zn.elements[4]*=r,zn.elements[5]*=r,zn.elements[6]*=r,zn.elements[8]*=s,zn.elements[9]*=s,zn.elements[10]*=s,e.setFromRotationMatrix(zn),i.x=n,i.y=o,i.z=a,this}),makePerspective:function(t,e,i,r,n,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements;return a[0]=2*n/(e-t),a[4]=0,a[8]=(e+t)/(e-t),a[12]=0,a[1]=0,a[5]=2*n/(i-r),a[9]=(i+r)/(i-r),a[13]=0,a[2]=0,a[6]=0,a[10]=-(o+n)/(o-n),a[14]=-2*o*n/(o-n),a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,i,r,n,o){var a=this.elements,s=1/(e-t),l=1/(i-r),c=1/(o-n);return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-(e+t)*s,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-(i+r)*l,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-(o+n)*c,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){var e=this.elements;t=t.elements;for(var i=0;i<16;i++)if(e[i]!==t[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<16;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){var i=this.elements;return(t=void 0===t?[]:t)[e=void 0===e?0:e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}),Object.assign(s,{slerp:function(t,e,i,r){return i.copy(t).slerp(e,r)},slerpFlat:function(t,e,i,r,n,o,a){var s=i[r+0],l=i[r+1],c=i[r+2];i=i[r+3],r=n[o+0];var h,u,p,d=n[o+1],f=n[o+2];i===(n=n[o+3])&&s===r&&l===d&&c===f||(o=1-a,u=0<=(h=s*r+l*d+c*f+i*n)?1:-1,(p=1-h*h)>Number.EPSILON&&(p=Math.sqrt(p),h=Math.atan2(p,h*u),o=Math.sin(o*h)/p,a=Math.sin(a*h)/p),s=s*o+r*(u*=a),l=l*o+d*u,c=c*o+f*u,i=i*o+n*u,o===1-a&&(s*=a=1/Math.sqrt(s*s+l*l+c*c+i*i),l*=a,c*=a,i*=a)),t[e]=s,t[e+1]=l,t[e+2]=c,t[e+3]=i}}),Object.defineProperties(s.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(s.prototype,{set:function(t,e,i,r){return this._x=t,this._y=e,this._z=i,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t._x,r=t._y,n=t._z,o=t.order,a=Math.cos,s=Math.sin,l=a(i/2),t=a(r/2),a=a(n/2),i=s(i/2),r=s(r/2),n=s(n/2);return"XYZ"===o?(this._x=i*t*a+l*r*n,this._y=l*r*a-i*t*n,this._z=l*t*n+i*r*a,this._w=l*t*a-i*r*n):"YXZ"===o?(this._x=i*t*a+l*r*n,this._y=l*r*a-i*t*n,this._z=l*t*n-i*r*a,this._w=l*t*a+i*r*n):"ZXY"===o?(this._x=i*t*a-l*r*n,this._y=l*r*a+i*t*n,this._z=l*t*n+i*r*a,this._w=l*t*a-i*r*n):"ZYX"===o?(this._x=i*t*a-l*r*n,this._y=l*r*a+i*t*n,this._z=l*t*n-i*r*a,this._w=l*t*a+i*r*n):"YZX"===o?(this._x=i*t*a+l*r*n,this._y=l*r*a+i*t*n,this._z=l*t*n-i*r*a,this._w=l*t*a-i*r*n):"XZY"===o&&(this._x=i*t*a-l*r*n,this._y=l*r*a-i*t*n,this._z=l*t*n+i*r*a,this._w=l*t*a+i*r*n),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,e=Math.sin(i);return this._x=t.x*e,this._y=t.y*e,this._z=t.z*e,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e=t.elements,i=e[0];t=e[4];var r=e[8],n=e[1],o=e[5],a=e[9],s=e[2],l=e[6],c=i+o+(e=e[10]);return 0<c?(i=.5/Math.sqrt(c+1),this._w=.25/i,this._x=(l-a)*i,this._y=(r-s)*i,this._z=(n-t)*i):o<i&&e<i?(i=2*Math.sqrt(1+i-o-e),this._w=(l-a)/i,this._x=.25*i,this._y=(t+n)/i,this._z=(r+s)/i):e<o?(i=2*Math.sqrt(1+o-i-e),this._w=(r-s)/i,this._x=(t+n)/i,this._y=.25*i,this._z=(a+l)/i):(i=2*Math.sqrt(1+e-i-o),this._w=(n-t)/i,this._x=(r+s)/i,this._y=(a+l)/i,this._z=.25*i),this.onChangeCallback(),this},setFromUnitVectors:(Xn=new _t,function(t,e){return void 0===Xn&&(Xn=new _t),(Wn=t.dot(e)+1)<1e-6?(Wn=0,Math.abs(t.x)>Math.abs(t.z)?Xn.set(-t.y,t.x,0):Xn.set(0,-t.z,t.y)):Xn.crossVectors(t,e),this._x=Xn.x,this._y=Xn.y,this._z=Xn.z,this._w=Wn,this.normalize()}),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(this._x*=t=1/t,this._y*=t,this._z*=t,this._w*=t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,r=t._y,n=t._z,o=t._w,a=e._x,s=e._y,t=e._z,e=e._w;return this._x=i*e+o*a+r*t-n*s,this._y=r*e+o*s+n*a-i*t,this._z=n*e+o*t+i*s-r*a,this._w=o*e-i*a-r*s-n*t,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,r=this._y,n=this._z,o=this._w;if((s=o*t._w+i*t._x+r*t._y+n*t._z)<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),1<=s)return this._w=o,this._x=i,this._y=r,this._z=n,this;var a=Math.sqrt(1-s*s);if(Math.abs(a)<.001)return this._w=.5*(o+this._w),this._x=.5*(i+this._x),this._y=.5*(r+this._y),this._z=.5*(n+this._z),this;var t=Math.atan2(a,s),s=Math.sin((1-e)*t)/a,a=Math.sin(e*t)/a;return this._w=o*s+this._w*a,this._x=i*s+this._x*a,this._y=r*s+this._y*a,this._z=n*s+this._z*a,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return this._x=t[e=void 0===e?0:e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(_t.prototype,{isVector3:!0,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:(to=new s,function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(to.setFromEuler(t))}),applyAxisAngle:($n=new s,function(t,e){return this.applyQuaternion($n.setFromAxisAngle(t,e))}),applyMatrix3:function(t){var e=this.x,i=this.y,r=this.z;return t=t.elements,this.x=t[0]*e+t[3]*i+t[6]*r,this.y=t[1]*e+t[4]*i+t[7]*r,this.z=t[2]*e+t[5]*i+t[8]*r,this},applyMatrix4:function(t){var e=this.x,i=this.y,r=this.z,n=1/((t=t.elements)[3]*e+t[7]*i+t[11]*r+t[15]);return this.x=(t[0]*e+t[4]*i+t[8]*r+t[12])*n,this.y=(t[1]*e+t[5]*i+t[9]*r+t[13])*n,this.z=(t[2]*e+t[6]*i+t[10]*r+t[14])*n,this},applyQuaternion:function(t){var e=this.x,i=this.y,r=this.z,n=t.x,o=t.y,a=t.z,s=(t=t.w)*e+o*r-a*i,l=t*i+a*e-n*r,c=t*r+n*i-o*e;return this.x=s*t+(e=-n*e-o*i-a*r)*-n+l*-a-c*-o,this.y=l*t+e*-o+c*-n-s*-a,this.z=c*t+e*-a+s*-o-l*-n,this},project:(Qn=new Mt,function(t){return Qn.multiplyMatrices(t.projectionMatrix,Qn.getInverse(t.matrixWorld)),this.applyMatrix4(Qn)}),unproject:(Zn=new Mt,function(t){return Zn.multiplyMatrices(t.matrixWorld,Zn.getInverse(t.projectionMatrix)),this.applyMatrix4(Zn)}),transformDirection:function(t){var e=this.x,i=this.y,r=this.z;return t=t.elements,this.x=t[0]*e+t[4]*i+t[8]*r,this.y=t[1]*e+t[5]*i+t[9]*r,this.z=t[2]*e+t[6]*i+t[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:(Kn=new _t,Jn=new _t,function(t,e){return Kn.set(t,t,t),Jn.set(e,e,e),this.clamp(Kn,Jn)}),clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var i=t.x,r=t.y,n=t.z,o=e.x,t=e.y,e=e.z;return this.x=r*e-n*t,this.y=n*o-i*e,this.z=i*t-r*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:(Yn=new _t,function(t){return Yn.copy(this).projectOnVector(t),this.sub(Yn)}),reflect:(qn=new _t,function(t){return this.sub(qn.copy(t).multiplyScalar(2*this.dot(t)))}),angleTo:function(t){return t=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq()),Math.acos(io.clamp(t,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i+(t=this.z-t.z)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=e,this.y=i,this.z=t,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(g.prototype,{isMatrix3:!0,set:function(t,e,i,r,n,o,a,s,l){var c=this.elements;return c[0]=t,c[1]=r,c[2]=a,c[3]=e,c[4]=n,c[5]=s,c[6]=i,c[7]=o,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:(eo=new _t,function(t){for(var e=0,i=t.count;e<i;e++)eo.x=t.getX(e),eo.y=t.getY(e),eo.z=t.getZ(e),eo.applyMatrix3(this),t.setXYZ(e,eo.x,eo.y,eo.z);return t}),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,r=e.elements,n=this.elements,o=i[0],a=i[3],s=i[6],l=i[1],c=i[4],h=i[7],u=i[2],p=i[5],i=i[8],d=r[0],f=r[3],m=r[6],g=r[1],v=r[4],y=r[7],t=r[2],e=r[5],r=r[8];return n[0]=o*d+a*g+s*t,n[3]=o*f+a*v+s*e,n[6]=o*m+a*y+s*r,n[1]=l*d+c*g+h*t,n[4]=l*f+c*v+h*e,n[7]=l*m+c*y+h*r,n[2]=u*d+p*g+i*t,n[5]=u*f+p*v+i*e,n[8]=u*m+p*y+i*r,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],r=t[2],n=t[3],o=t[4],a=t[5],s=t[6],l=t[7];return e*o*(t=t[8])-e*a*l-i*n*t+i*a*s+r*n*l-r*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var i=t.elements,r=this.elements,n=i[0],o=i[1],a=i[2],s=i[3],l=i[4],c=i[5],h=i[6],u=i[7],p=(i=i[8])*l-c*u,d=c*h-i*s,f=u*s-l*h,t=n*p+o*d+a*f;if(0!=t)return r[0]=p*(t=1/t),r[1]=(a*u-i*o)*t,r[2]=(c*o-a*l)*t,r[3]=d*t,r[4]=(i*n-a*h)*t,r[5]=(a*s-c*n)*t,r[6]=f*t,r[7]=(o*h-u*n)*t,r[8]=(l*n-o*s)*t,this;if(!0===e)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0"),this.identity()},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,i,r,n,o,a){var s=Math.cos(n);n=Math.sin(n),this.set(i*s,i*n,-i*(s*o+n*a)+o+t,-r*n,r*s,-r*(-n*o+s*a)+a+e,0,0,1)},scale:function(t,e){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=e,i[4]*=e,i[7]*=e,this},rotate:function(t){var e=Math.cos(t);t=Math.sin(t);var i=this.elements,r=i[0],n=i[3],o=i[6],a=i[1],s=i[4],l=i[7];return i[0]=e*r+t*a,i[3]=e*n+t*s,i[6]=e*o+t*l,i[1]=-t*r+e*a,i[4]=-t*n+e*s,i[7]=-t*o+e*l,this},translate:function(t,e){var i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=e*i[2],i[4]+=e*i[5],i[7]+=e*i[8],this},equals:function(t){var e=this.elements;t=t.elements;for(var i=0;i<9;i++)if(e[i]!==t[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<9;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){var i=this.elements;return(t=void 0===t?[]:t)[e=void 0===e?0:e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}});var ro,no,oo=0;p.DEFAULT_IMAGE=void 0,p.DEFAULT_MAPPING=300,p.prototype=Object.assign(Object.create(e.prototype),{constructor:p,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var i,r,n,o,a,s,l={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};return void 0!==this.image&&(void 0===(i=this.image).uuid&&(i.uuid=io.generateUUID()),e||void 0!==t.images[i.uuid]||(r=t.images,n=i.uuid,o=i.uuid,i instanceof HTMLCanvasElement?a=i:((a=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=i.width,a.height=i.height,s=a.getContext("2d"),i instanceof ImageData?s.putImageData(i,0,0):s.drawImage(i,0,0,i.width,i.height)),a=2048<a.width||2048<a.height?a.toDataURL("image/jpeg",.6):a.toDataURL("image/png"),r[n]={uuid:o,url:a}),l.image=i.uuid),e||(t.textures[this.uuid]=l),l},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300===this.mapping){if(t.applyMatrix3(this.matrix),t.x<0||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x-=Math.floor(t.x)}if(t.y<0||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y-=Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}}),Object.defineProperty(p.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(At.prototype,{isVector4:!0,set:function(t,e,i,r){return this.x=t,this.y=e,this.z=i,this.w=r,this},setScalar:function(t){return this.w=this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,i=this.y,r=this.z,n=this.w;return t=t.elements,this.x=t[0]*e+t[4]*i+t[8]*r+t[12]*n,this.y=t[1]*e+t[5]*i+t[9]*r+t[13]*n,this.z=t[2]*e+t[6]*i+t[10]*r+t[14]*n,this.w=t[3]*e+t[7]*i+t[11]*r+t[15]*n,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e=(t=t.elements)[0],i=t[4],r=t[8],n=t[1],o=t[5],a=t[9],s=t[2],l=t[6],c=t[10];return Math.abs(i-n)<.01&&Math.abs(r-s)<.01&&Math.abs(a-l)<.01?Math.abs(i+n)<.1&&Math.abs(r+s)<.1&&Math.abs(a+l)<.1&&Math.abs(e+o+c-3)<.1?this.set(1,0,0,0):(t=Math.PI,c=(c+1)/2,i=(i+n)/4,r=(r+s)/4,a=(a+l)/4,(o=(o+1)/2)<(e=(e+1)/2)&&c<e?i=e<.01?(l=0,s=.707106781):(s=i/(l=Math.sqrt(e)),r/l):c<o?i=o<.01?(s=0,l=.707106781):(l=i/(s=Math.sqrt(o)),a/s):c<.01?(s=l=.707106781,i=0):(l=r/(i=Math.sqrt(c)),s=a/i),this.set(l,s,i,t)):(t=Math.sqrt((l-a)*(l-a)+(r-s)*(r-s)+(n-i)*(n-i)),Math.abs(t)<.001&&(t=1),this.x=(l-a)/t,this.y=(r-s)/t,this.z=(n-i)/t,this.w=Math.acos((e+o+c-1)/2)),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return void 0===ro&&(ro=new At,no=new At),ro.set(t,t,t,t),no.set(e,e,e,e),this.clamp(ro,no)},clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),S.prototype=Object.assign(Object.create(e.prototype),{constructor:S,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),((r.prototype=Object.create(S.prototype)).constructor=r).prototype.isWebGLRenderTargetCube=!0,((Et.prototype=Object.create(p.prototype)).constructor=Et).prototype.isDataTexture=!0,((l.prototype=Object.create(p.prototype)).constructor=l).prototype.isCubeTexture=!0,Object.defineProperty(l.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var ao=new p,so=new l,lo=[],co=[],ho=new Float32Array(16),uo=new Float32Array(9);F.prototype.setValue=function(t,e){for(var i=this.seq,r=0,n=i.length;r!==n;++r){var o=i[r];o.setValue(t,e[o.id])}};var po=/([\w\d_]+)(\])?(\[|\.)?/g;St.prototype.setValue=function(t,e,i){void 0!==(e=this.map[e])&&e.setValue(t,i,this.renderer)},St.prototype.setOptional=function(t,e,i){void 0!==(e=e[i])&&this.setValue(t,i,e)},St.upload=function(t,e,i,r){for(var n=0,o=e.length;n!==o;++n){var a=e[n],s=i[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},St.seqWithValue=function(t,e){for(var i=[],r=0,n=t.length;r!==n;++r){var o=t[r];o.id in e&&i.push(o)}return i};var fo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function mo(t,e,i){return i<0&&(i+=1),1<i&&--i,i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}Object.assign(j.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.b=this.g=this.r=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(t,e,i){return t=io.euclideanModulo(t,1),e=io.clamp(e,0,1),i=io.clamp(i,0,1),0===e?this.r=this.g=this.b=i:(this.r=mo(i=2*i-(e=i<=.5?i*(1+e):i+e-i*e),e,t+1/3),this.g=mo(i,e,t),this.b=mo(i,e,t-1/3)),this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r=i[2];switch(i[1]){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,t(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,t(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r)){var r=parseFloat(i[1])/360,n=parseInt(i[2],10)/100,o=parseInt(i[3],10)/100;return t(i[5]),this.setHSL(r,n,o)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){if(3===(r=(i=i[1]).length))return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(6===r)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return e&&0<e.length&&(void 0!==(i=fo[e])?this.setHex(i):console.warn("THREE.Color: Unknown color "+e)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){e=0<(e=void 0===e?2:e)?1/e:1;return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},convertGammaToLinear:function(){var t=this.r,e=this.g,i=this.b;return this.r=t*t,this.g=e*e,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t=t||{h:0,s:0,l:0};var e,i=this.r,r=this.g,n=this.b,o=Math.max(i,r,n),a=((l=Math.min(i,r,n))+o)/2;if(l===o)l=e=0;else{var s=o-l,l=a<=.5?s/(o+l):s/(2-o-l);switch(o){case i:e=(r-n)/s+(r<n?6:0);break;case r:e=(n-i)/s+2;break;case n:e=(i-r)/s+4}e/=6}return t.h=e,t.s=l,t.l=a,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){var r=this.getHSL();return r.h+=t,r.s+=e,r.l+=i,this.setHSL(r.h,r.s,r.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return this.r=t[e=void 0===e?0:e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var go={common:{diffuse:{value:new j(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new g},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new q(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new j(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new j(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new g}}},vo={merge:function(t){for(var e={},i=0;i<t.length;i++){var r,n=this.clone(t[i]);for(r in n)e[r]=n[r]}return e},clone:function(t){var e,i={};for(e in t)for(var r in i[e]={},t[e]){var n=t[e][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture)?i[e][r]=n.clone():Array.isArray(n)?i[e][r]=n.slice():i[e][r]=n}return i}},yo={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},bo={basic:{uniforms:vo.merge([go.common,go.specularmap,go.envmap,go.aomap,go.lightmap,go.fog]),vertexShader:yo.meshbasic_vert,fragmentShader:yo.meshbasic_frag},lambert:{uniforms:vo.merge([go.common,go.specularmap,go.envmap,go.aomap,go.lightmap,go.emissivemap,go.fog,go.lights,{emissive:{value:new j(0)}}]),vertexShader:yo.meshlambert_vert,fragmentShader:yo.meshlambert_frag},phong:{uniforms:vo.merge([go.common,go.specularmap,go.envmap,go.aomap,go.lightmap,go.emissivemap,go.bumpmap,go.normalmap,go.displacementmap,go.gradientmap,go.fog,go.lights,{emissive:{value:new j(0)},specular:{value:new j(1118481)},shininess:{value:30}}]),vertexShader:yo.meshphong_vert,fragmentShader:yo.meshphong_frag},standard:{uniforms:vo.merge([go.common,go.envmap,go.aomap,go.lightmap,go.emissivemap,go.bumpmap,go.normalmap,go.displacementmap,go.roughnessmap,go.metalnessmap,go.fog,go.lights,{emissive:{value:new j(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:yo.meshphysical_vert,fragmentShader:yo.meshphysical_frag},points:{uniforms:vo.merge([go.points,go.fog]),vertexShader:yo.points_vert,fragmentShader:yo.points_frag},dashed:{uniforms:vo.merge([go.common,go.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:yo.linedashed_vert,fragmentShader:yo.linedashed_frag},depth:{uniforms:vo.merge([go.common,go.displacementmap]),vertexShader:yo.depth_vert,fragmentShader:yo.depth_frag},normal:{uniforms:vo.merge([go.common,go.bumpmap,go.normalmap,go.displacementmap,{opacity:{value:1}}]),vertexShader:yo.normal_vert,fragmentShader:yo.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:yo.cube_vert,fragmentShader:yo.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:yo.equirect_vert,fragmentShader:yo.equirect_frag},distanceRGBA:{uniforms:vo.merge([go.common,go.displacementmap,{referencePosition:{value:new _t},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:yo.distanceRGBA_vert,fragmentShader:yo.distanceRGBA_frag},shadow:{uniforms:vo.merge([go.lights,go.fog,{color:{value:new j(0)},opacity:{value:1}}]),vertexShader:yo.shadow_vert,fragmentShader:yo.shadow_frag}};bo.physical={uniforms:vo.merge([bo.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:yo.meshphysical_vert,fragmentShader:yo.meshphysical_frag},(H.prototype=Object.create(p.prototype)).constructor=H;var xo,wo,Mo,_o,Ao,Eo,So,Po,To,Co,Oo,Ro,Lo,Io,Do,Fo,jo,No,ko,zo,Uo,Vo,Bo,Ho,Go,Wo,Xo,qo,Yo,Ko,Jo,Zo=0;function Qo(t){for(var e=0,i=t.length-3;e<=i;e+=3){Co.fromArray(t,e);var r=Ro.x*Math.abs(Co.x)+Ro.y*Math.abs(Co.y)+Ro.z*Math.abs(Co.z),n=_o.dot(Co),o=Ao.dot(Co),a=Eo.dot(Co);if(Math.max(-Math.max(n,o,a),Math.min(n,o,a))>r)return!1}return!0}function $o(t){var e=t.geometry;if(void 0!==e)if(e.isGeometry)for(e=e.vertices,Fo=0,jo=e.length;Fo<jo;Fo++)No.copy(e[Fo]),No.applyMatrix4(t.matrixWorld),Do.expandByPoint(No);else if(e.isBufferGeometry&&void 0!==(e=e.attributes.position))for(Fo=0,jo=e.count;Fo<jo;Fo++)No.fromBufferAttribute(e,Fo).applyMatrix4(t.matrixWorld),Do.expandByPoint(No)}N.prototype=Object.assign(Object.create(e.prototype),{constructor:N,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var i,r=t[e];void 0===r?console.warn("THREE.Material: '"+e+"' parameter is undefined."):"shading"===e?(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r):void 0===(i=this[e])?console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[e]="overdraw"===e?Number(r):r}},toJSON:function(t){function e(t){var e,i=[];for(e in t){var r=t[e];delete r.metadata,i.push(r)}return i}var i=void 0===t||"string"==typeof t;i&&(t={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearCoat&&(r.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(r.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),0!==this.side&&(r.side=this.side),0!==this.vertexColors&&(r.vertexColors=this.vertexColors),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,0!==this.rotation&&(r.rotation=this.rotation),1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),0<this.alphaTest&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),1<this.wireframeLinewidth&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),i&&(i=e(t.textures),t=e(t.images),0<i.length&&(r.textures=i),0<t.length&&(r.images=t)),r},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,i=null;if(null!==e)for(var r=e.length,i=Array(r),n=0;n!==r;++n)i[n]=e[n].clone();return this.clippingPlanes=i,this.shadowSide=t.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),((k.prototype=Object.create(N.prototype)).constructor=k).prototype.isMeshDepthMaterial=!0,k.prototype.copy=function(t){return N.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},((z.prototype=Object.create(N.prototype)).constructor=z).prototype.isMeshDistanceMaterial=!0,z.prototype.copy=function(t){return N.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},Object.assign(U.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,i=1/0,r=1/0,n=-1/0,o=-1/0,a=-1/0,s=0,l=t.length;s<l;s+=3){var c=t[s],h=t[s+1],u=t[s+2];c<e&&(e=c),h<i&&(i=h),u<r&&(r=u),n<c&&(n=c),o<h&&(o=h),a<u&&(a=u)}return this.min.set(e,i,r),this.max.set(n,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,i=1/0,r=1/0,n=-1/0,o=-1/0,a=-1/0,s=0,l=t.count;s<l;s++){var c=t.getX(s),h=t.getY(s),u=t.getZ(s);c<e&&(e=c),h<i&&(i=h),u<r&&(r=u),n<c&&(n=c),o<h&&(o=h),a<u&&(a=u)}return this.min.set(e,i,r),this.max.set(n,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:(ko=new _t,function(t,e){e=ko.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(e),this.max.copy(t).add(e),this}),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return t=t||new _t,this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t=t||new _t,this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:(No=new _t,function(t){return Do=this,t.updateMatrixWorld(!0),t.traverse($o),this}),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new _t).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:(Io=new _t,function(t){return this.clampPoint(t.center,Io),Io.distanceToSquared(t.center)<=t.radius*t.radius}),intersectsPlane:function(t){var e,i=0<t.normal.x?(e=t.normal.x*this.min.x,t.normal.x*this.max.x):(e=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=t.constant&&i>=t.constant},intersectsTriangle:(_o=new _t,Ao=new _t,Eo=new _t,So=new _t,Po=new _t,To=new _t,Co=new _t,Oo=new _t,Ro=new _t,Lo=new _t,function(t){return!this.isEmpty()&&(this.getCenter(Oo),Ro.subVectors(this.max,Oo),_o.subVectors(t.a,Oo),Ao.subVectors(t.b,Oo),Eo.subVectors(t.c,Oo),So.subVectors(Ao,_o),Po.subVectors(Eo,Ao),To.subVectors(_o,Eo),!!Qo(t=[0,-So.z,So.y,0,-Po.z,Po.y,0,-To.z,To.y,So.z,0,-So.x,Po.z,0,-Po.x,To.z,0,-To.x,-So.y,So.x,0,-Po.y,Po.x,0,-To.y,To.x,0])&&(!!Qo(t=[1,0,0,0,1,0,0,0,1])&&(Lo.crossVectors(So,Po),Qo(t=[Lo.x,Lo.y,Lo.z]))))}),clampPoint:function(t,e){return(e||new _t).copy(t).clamp(this.min,this.max)},distanceToPoint:(Mo=new _t,function(t){return Mo.copy(t).clamp(this.min,this.max).sub(t).length()}),getBoundingSphere:(wo=new _t,function(t){return t=t||new V,this.getCenter(t.center),t.radius=.5*this.getSize(wo).length(),t}),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:(xo=[new _t,new _t,new _t,new _t,new _t,new _t,new _t,new _t],function(t){return this.isEmpty()||(xo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),xo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),xo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),xo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),xo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),xo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),xo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),xo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(xo)),this}),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(V.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:(zo=new U,function(t,e){var i=this.center;void 0!==e?i.copy(e):zo.setFromPoints(t).getCenter(i);for(var r=0,n=0,o=t.length;n<o;n++)r=Math.max(r,i.distanceToSquared(t[n]));return this.radius=Math.sqrt(r),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var i=this.center.distanceToSquared(t),e=e||new _t;return e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return(t=t||new U).set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(B.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,r){return this.normal.set(t,e,i),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:(Ho=new _t,Go=new _t,function(t,e,i){return e=Ho.subVectors(i,e).cross(Go.subVectors(t,e)).normalize(),this.setFromNormalAndCoplanarPoint(e,t),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return(e||new _t).copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:(Bo=new _t,function(t,e){var i=e||new _t,r=t.delta(Bo),e=this.normal.dot(r);return 0!==e?(e=-(t.start.dot(this.normal)+this.constant)/e)<0||1<e?void 0:i.copy(r).multiplyScalar(e).add(t.start):0===this.distanceToPoint(t.start)?i.copy(t.start):void 0}),intersectsLine:function(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),e<0&&0<t||t<0&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return(t||new _t).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:(Uo=new _t,Vo=new g,function(t,e){e=e||Vo.getNormalMatrix(t),t=this.coplanarPoint(Uo).applyMatrix4(t),e=this.normal.applyMatrix3(e).normalize();return this.constant=-t.dot(e),this}),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(Tt.prototype,{set:function(t,e,i,r,n,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(i),a[3].copy(r),a[4].copy(n),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,i=0;i<6;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes;t=(g=t.elements)[0];var i=g[1],r=g[2],n=g[3],o=g[4],a=g[5],s=g[6],l=g[7],c=g[8],h=g[9],u=g[10],p=g[11],d=g[12],f=g[13],m=g[14],g=g[15];return e[0].setComponents(n-t,l-o,p-c,g-d).normalize(),e[1].setComponents(n+t,l+o,p+c,g+d).normalize(),e[2].setComponents(n+i,l+a,p+h,g+f).normalize(),e[3].setComponents(n-i,l-a,p-h,g-f).normalize(),e[4].setComponents(n-r,l-s,p-u,g-m).normalize(),e[5].setComponents(n+r,l+s,p+u,g+m).normalize(),this},intersectsObject:(Yo=new V,function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Yo.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Yo)}),intersectsSprite:(qo=new V,function(t){return qo.center.set(0,0,0),qo.radius=.7071067811865476,qo.applyMatrix4(t.matrixWorld),this.intersectsSphere(qo)}),intersectsSphere:function(t){var e=this.planes,i=t.center;t=-t.radius;for(var r=0;r<6;r++)if(e[r].distanceToPoint(i)<t)return!1;return!0},intersectsBox:(Wo=new _t,Xo=new _t,function(t){for(var e=this.planes,i=0;i<6;i++){var r=e[i];Wo.x=(0<r.normal.x?t.min:t.max).x,Xo.x=(0<r.normal.x?t.max:t.min).x,Wo.y=(0<r.normal.y?t.min:t.max).y,Xo.y=(0<r.normal.y?t.max:t.min).y,Wo.z=(0<r.normal.z?t.min:t.max).z,Xo.z=(0<r.normal.z?t.max:t.min).z;var n=r.distanceToPoint(Wo),r=r.distanceToPoint(Xo);if(n<0&&r<0)return!1}return!0}),containsPoint:function(t){for(var e=this.planes,i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}}),G.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),G.DefaultOrder="XYZ",Object.defineProperties(G.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(G.prototype,{isEuler:!0,set:function(t,e,i,r){return this._x=t,this._y=e,this._z=i,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var r=io.clamp;t=(u=t.elements)[0];var n=u[4],o=u[8],a=u[1],s=u[5],l=u[9],c=u[2],h=u[6],u=u[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(-l,u),this._z=Math.atan2(-n,t)):(this._x=Math.atan2(h,s),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(o,u),this._z=Math.atan2(a,s)):(this._y=Math.atan2(-c,t),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(h,-1,1)),Math.abs(h)<.99999?(this._y=Math.atan2(-c,u),this._z=Math.atan2(-n,s)):(this._y=0,this._z=Math.atan2(a,t))):"ZYX"===e?(this._y=Math.asin(-r(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(h,u),this._z=Math.atan2(a,t)):(this._x=0,this._z=Math.atan2(-n,s))):"YZX"===e?(this._z=Math.asin(r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(-l,s),this._y=Math.atan2(-c,t)):(this._x=0,this._y=Math.atan2(o,u))):"XZY"===e?(this._z=Math.asin(-r(n,-1,1)),Math.abs(n)<.99999?(this._x=Math.atan2(h,s),this._y=Math.atan2(o,t)):(this._x=Math.atan2(-l,u),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:(Jo=new Mt,function(t,e,i){return Jo.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Jo,e,i)}),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:(Ko=new s,function(t){return Ko.setFromEuler(this),this.setFromQuaternion(Ko,t)}),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new _t(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(W.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask=this.mask|1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}});var ta,ea,ia,ra,na,oa,aa,sa,la,ca,ha,ua,pa,da,fa,ma,ga,va,ya,ba=0;X.DefaultUp=new _t(0,1,0),X.DefaultMatrixAutoUpdate=!0,X.prototype=Object.assign(Object.create(e.prototype),{constructor:X,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:(va=new s,function(t,e){return va.setFromAxisAngle(t,e),this.quaternion.multiply(va),this}),rotateOnWorldAxis:(ga=new s,function(t,e){return ga.setFromAxisAngle(t,e),this.quaternion.premultiply(ga),this}),rotateX:(ma=new _t(1,0,0),function(t){return this.rotateOnAxis(ma,t)}),rotateY:(fa=new _t(0,1,0),function(t){return this.rotateOnAxis(fa,t)}),rotateZ:(da=new _t(0,0,1),function(t){return this.rotateOnAxis(da,t)}),translateOnAxis:(pa=new _t,function(t,e){return pa.copy(t).applyQuaternion(this.quaternion),this.position.add(pa.multiplyScalar(e)),this}),translateX:(ua=new _t(1,0,0),function(t){return this.translateOnAxis(ua,t)}),translateY:(ha=new _t(0,1,0),function(t){return this.translateOnAxis(ha,t)}),translateZ:(ca=new _t(0,0,1),function(t){return this.translateOnAxis(ca,t)}),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:(la=new Mt,function(t){return t.applyMatrix4(la.getInverse(this.matrixWorld))}),lookAt:(aa=new Mt,sa=new _t,function(t,e,i){t.isVector3?sa.copy(t):sa.set(t,e,i),this.isCamera?aa.lookAt(this.position,sa,this.up):aa.lookAt(sa,this.position,this.up),this.quaternion.setFromRotationMatrix(aa)}),add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",t):t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this},remove:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}return-1!==(e=this.children.indexOf(t))&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(e,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,r=this.children.length;i<r;i++){var n=this.children[i].getObjectByProperty(t,e);if(void 0!==n)return n}},getWorldPosition:function(t){return t=t||new _t,this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(na=new _t,oa=new _t,function(t){return t=t||new s,this.updateMatrixWorld(!0),this.matrixWorld.decompose(na,t,oa),t}),getWorldRotation:(ra=new s,function(t){return t=t||new G,this.getWorldQuaternion(ra),t.setFromQuaternion(ra,this.rotation.order,!1)}),getWorldScale:(ea=new _t,ia=new s,function(t){return t=t||new _t,this.updateMatrixWorld(!0),this.matrixWorld.decompose(ea,ia,t),t}),getWorldDirection:(ta=new s,function(t){return t=t||new _t,this.getWorldQuaternion(ta),t.set(0,0,1).applyQuaternion(ta)}),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,r=e.length;i<r;i++)e[i].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,i=0,r=e.length;i<r;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var e=this.children,i=0,r=e.length;i<r;i++)e[i].updateMatrixWorld(t)},toJSON:function(i){function t(t,e){return void 0===t[e.uuid]&&(t[e.uuid]=e.toJSON(i)),e.uuid}function e(t){var e,i=[];for(e in t){var r=t[e];delete r.metadata,i.push(r)}return i}var r=void 0===i||"string"==typeof i,n={};r&&(i={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var o,a,s={};if((s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),"{}"!==JSON.stringify(this.userData)&&(s.userData=this.userData),s.matrix=this.matrix.toArray(),void 0!==this.geometry)&&(s.geometry=t(i.geometries,this.geometry),void 0!==(a=this.geometry.parameters)&&void 0!==a.shapes))if(a=a.shapes,Array.isArray(a))for(var l=0,c=a.length;l<c;l++)t(i.shapes,a[l]);else t(i.shapes,a);if(void 0!==this.material)if(Array.isArray(this.material)){for(a=[],l=0,c=this.material.length;l<c;l++)a.push(t(i.materials,this.material[l]));s.material=a}else s.material=t(i.materials,this.material);if(0<this.children.length)for(s.children=[],l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(i).object);return r&&(r=e(i.geometries),l=e(i.materials),c=e(i.textures),o=e(i.images),a=e(i.shapes),0<r.length&&(n.geometries=r),0<l.length&&(n.materials=l),0<c.length&&(n.textures=c),0<o.length&&(n.images=o),0<a.length&&(n.shapes=a)),n.object=s,n},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var i=0;i<t.children.length;i++)this.add(t.children[i].clone());return this}}),Y.prototype=Object.assign(Object.create(X.prototype),{constructor:Y,isCamera:!0,copy:function(t,e){return X.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:(ya=new s,function(t){return t=t||new _t,this.getWorldQuaternion(ya),t.set(0,0,-1).applyQuaternion(ya)}),updateMatrixWorld:function(t){X.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),K.prototype=Object.assign(Object.create(Y.prototype),{constructor:K,isOrthographicCamera:!0,copy:function(t,e){return Y.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,i,r,n,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=r,this.view.width=n,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,o=r-e,r=r+e,e=n+i,i=n-i;null!==this.view&&this.view.enabled&&(r=this.zoom/(this.view.width/this.view.fullWidth),i=this.zoom/(this.view.height/this.view.fullHeight),t=(this.right-this.left)/this.view.width,n=(this.top-this.bottom)/this.view.height,r=(o+=this.view.offsetX/r*t)+this.view.width/r*t,i=(e-=this.view.offsetY/i*n)-this.view.height/i*n),this.projectionMatrix.makeOrthographic(o,r,e,i,this.near,this.far)},toJSON:function(t){return(t=X.prototype.toJSON.call(this,t)).object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Object.assign(J.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var xa,wa,Ma,_a,Aa,Ea,Sa=0;Z.prototype=Object.assign(Object.create(e.prototype),{constructor:Z,isGeometry:!0,applyMatrix:function(t){for(var e=(new g).getNormalMatrix(t),i=0,r=this.vertices.length;i<r;i++)this.vertices[i].applyMatrix4(t);for(i=0,r=this.faces.length;i<r;i++){(t=this.faces[i]).normal.applyMatrix3(e).normalize();for(var n=0,o=t.vertexNormals.length;n<o;n++)t.vertexNormals[n].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:(Ea=new Mt,function(t){return Ea.makeRotationX(t),this.applyMatrix(Ea),this}),rotateY:(Aa=new Mt,function(t){return Aa.makeRotationY(t),this.applyMatrix(Aa),this}),rotateZ:(_a=new Mt,function(t){return _a.makeRotationZ(t),this.applyMatrix(_a),this}),translate:(Ma=new Mt,function(t,e,i){return Ma.makeTranslation(t,e,i),this.applyMatrix(Ma),this}),scale:(wa=new Mt,function(t,e,i){return wa.makeScale(t,e,i),this.applyMatrix(wa),this}),lookAt:(xa=new X,function(t){xa.lookAt(t),xa.updateMatrix(),this.applyMatrix(xa.matrix)}),fromBufferGeometry:function(t){function e(t,e,i,r){r=new J(t,e,i,void 0!==a?[h[t].clone(),h[e].clone(),h[i].clone()]:[],void 0!==s?[n.colors[t].clone(),n.colors[e].clone(),n.colors[i].clone()]:[],r),n.faces.push(r),void 0!==l&&n.faceVertexUvs[0].push([u[t].clone(),u[e].clone(),u[i].clone()]),void 0!==c&&n.faceVertexUvs[1].push([p[t].clone(),p[e].clone(),p[i].clone()])}var n=this,i=null!==t.index?t.index.array:void 0,r=t.attributes,o=r.position.array,a=void 0!==r.normal?r.normal.array:void 0,s=void 0!==r.color?r.color.array:void 0,l=void 0!==r.uv?r.uv.array:void 0,c=void 0!==r.uv2?r.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var h=[],u=[],p=[],d=r=0;r<o.length;r+=3,d+=2)n.vertices.push(new _t(o[r],o[r+1],o[r+2])),void 0!==a&&h.push(new _t(a[r],a[r+1],a[r+2])),void 0!==s&&n.colors.push(new j(s[r],s[r+1],s[r+2])),void 0!==l&&u.push(new q(l[d],l[d+1])),void 0!==c&&p.push(new q(c[d],c[d+1]));var f=t.groups;if(0<f.length)for(r=0;r<f.length;r++)for(var d=m=(o=f[r]).start,m=m+o.count;d<m;d+=3)void 0!==i?e(i[d],i[d+1],i[d+2],o.materialIndex):e(d,d+1,d+2,o.materialIndex);else if(void 0!==i)for(r=0;r<i.length;r+=3)e(i[r],i[r+1],i[r+2]);else for(r=0;r<o.length/3;r+=3)e(r,r+1,r+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=0===(e=this.boundingSphere.radius)?1:1/e,i=new Mt;return i.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var t=new _t,e=new _t,i=0,r=this.faces.length;i<r;i++){var n=this.faces[i],o=this.vertices[n.a],a=this.vertices[n.b];t.subVectors(this.vertices[n.c],a),e.subVectors(o,a),t.cross(e),t.normalize(),n.normal.copy(t)}},computeVertexNormals:function(t){var e,i,r;for(void 0===t&&(t=!0),r=Array(this.vertices.length),e=0,i=this.vertices.length;e<i;e++)r[e]=new _t;if(t){var n,o,a,s=new _t,l=new _t;for(t=0,e=this.faces.length;t<e;t++)i=this.faces[t],n=this.vertices[i.a],o=this.vertices[i.b],a=this.vertices[i.c],s.subVectors(a,o),l.subVectors(n,o),s.cross(l),r[i.a].add(s),r[i.b].add(s),r[i.c].add(s)}else for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++)r[(i=this.faces[t]).a].add(i.normal),r[i.b].add(i.normal),r[i.c].add(i.normal);for(e=0,i=this.vertices.length;e<i;e++)r[e].normalize();for(t=0,e=this.faces.length;t<e;t++)3===(n=(i=this.faces[t]).vertexNormals).length?(n[0].copy(r[i.a]),n[1].copy(r[i.b]),n[2].copy(r[i.c])):(n[0]=r[i.a].clone(),n[1]=r[i.b].clone(),n[2]=r[i.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var i,r=(i=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(i.normal),r[1].copy(i.normal),r[2].copy(i.normal)):(r[0]=i.normal.clone(),r[1]=i.normal.clone(),r[2]=i.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e;for(s=0,l=this.faces.length;s<l;s++)for((o=this.faces[s]).__originalFaceNormal?o.__originalFaceNormal.copy(o.normal):o.__originalFaceNormal=o.normal.clone(),o.__originalVertexNormals||(o.__originalVertexNormals=[]),t=0,e=o.vertexNormals.length;t<e;t++)o.__originalVertexNormals[t]?o.__originalVertexNormals[t].copy(o.vertexNormals[t]):o.__originalVertexNormals[t]=o.vertexNormals[t].clone();var i=new Z;for(i.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];for(var r,n,o=this.morphNormals[t].faceNormals,a=this.morphNormals[t].vertexNormals,s=0,l=this.faces.length;s<l;s++)r=new _t,n={a:new _t,b:new _t,c:new _t},o.push(r),a.push(n)}for(a=this.morphNormals[t],i.vertices=this.morphTargets[t].vertices,i.computeFaceNormals(),i.computeVertexNormals(),s=0,l=this.faces.length;s<l;s++)o=this.faces[s],r=a.faceNormals[s],n=a.vertexNormals[s],r.copy(o.normal),n.a.copy(o.vertexNormals[0]),n.b.copy(o.vertexNormals[1]),n.c.copy(o.vertexNormals[2])}for(s=0,l=this.faces.length;s<l;s++)(o=this.faces[s]).normal=o.__originalFaceNormal,o.vertexNormals=o.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new U),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new V),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if(t&&t.isGeometry){var r,n=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,l=t.faces,c=this.faceVertexUvs[0],h=t.faceVertexUvs[0],u=this.colors,p=t.colors;void 0===i&&(i=0),void 0!==e&&(r=(new g).getNormalMatrix(e)),t=0;for(var d=a.length;t<d;t++){var f=a[t].clone();void 0!==e&&f.applyMatrix4(e),o.push(f)}for(t=0,d=p.length;t<d;t++)u.push(p[t].clone());for(t=0,d=l.length;t<d;t++){var m=(a=l[t]).vertexNormals,p=a.vertexColors;for((u=new J(a.a+n,a.b+n,a.c+n)).normal.copy(a.normal),void 0!==r&&u.normal.applyMatrix3(r).normalize(),e=0,o=m.length;e<o;e++)f=m[e].clone(),void 0!==r&&f.applyMatrix3(r).normalize(),u.vertexNormals.push(f);for(u.color.copy(a.color),e=0,o=p.length;e<o;e++)f=p[e],u.vertexColors.push(f.clone());u.materialIndex=a.materialIndex+i,s.push(u)}for(t=0,d=h.length;t<d;t++)if(r=[],void 0!==(i=h[t])){for(e=0,o=i.length;e<o;e++)r.push(i[e].clone());c.push(r)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){for(var t,e={},i=[],r=[],n=Math.pow(10,4),o=0,a=this.vertices.length;o<a;o++)t=this.vertices[o],void 0===e[t=Math.round(t.x*n)+"_"+Math.round(t.y*n)+"_"+Math.round(t.z*n)]?(e[t]=o,i.push(this.vertices[o]),r[o]=i.length-1):r[o]=r[e[t]];for(e=[],o=0,a=this.faces.length;o<a;o++)for((n=this.faces[o]).a=r[n.a],n.b=r[n.b],n.c=r[n.c],n=[n.a,n.b,n.c],t=0;t<3;t++)if(n[t]===n[(t+1)%3]){e.push(o);break}for(o=e.length-1;0<=o;o--)for(n=e[o],this.faces.splice(n,1),r=0,a=this.faceVertexUvs.length;r<a;r++)this.faceVertexUvs[r].splice(n,1);return o=this.vertices.length-i.length,this.vertices=i,o},setFromPoints:function(t){this.vertices=[];for(var e=0,i=t.length;e<i;e++){var r=t[e];this.vertices.push(new _t(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,i=0;i<e;i++)t[i]._id=i;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var r,n,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];for(o&&o.length===e&&(r=[]),a&&a.length===e&&(n=[]),i=0;i<e;i++){var s=t[i]._id;r&&r.push(o[s]),n&&n.push(a[s])}r&&(this.faceVertexUvs[0]=r),n&&(this.faceVertexUvs[1]=n)},toJSON:function(){function t(t,e,i){return i?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==l[e]||(l[e]=s.length/3,s.push(t.x,t.y,t.z)),l[e]}function i(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==h[e]||(h[e]=c.length,c.push(t.getHex())),h[e]}function r(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]||(p[e]=u.length/2,u.push(t.x,t.y)),p[e]}var n={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),void 0!==this.parameters){var o=this.parameters;for(d in o)void 0!==o[d]&&(n[d]=o[d]);return n}for(o=[],d=0;d<this.vertices.length;d++){var a=this.vertices[d];o.push(a.x,a.y,a.z)}for(var a=[],s=[],l={},c=[],h={},u=[],p={},d=0;d<this.faces.length;d++){var f=this.faces[d],m=void 0!==this.faceVertexUvs[0][d],g=0<f.normal.length(),v=0<f.vertexNormals.length,y=1!==f.color.r||1!==f.color.g||1!==f.color.b,b=0<f.vertexColors.length,x=t(2,3,m),x=t(x,4,g),x=t(x,5,v),x=t(x,6,y),x=t(x,7,b);a.push(x),a.push(f.a,f.b,f.c),a.push(f.materialIndex),m&&(m=this.faceVertexUvs[0][d],a.push(r(m[0]),r(m[1]),r(m[2]))),g&&a.push(e(f.normal)),v&&(g=f.vertexNormals,a.push(e(g[0]),e(g[1]),e(g[2]))),y&&a.push(i(f.color)),b&&(f=f.vertexColors,a.push(i(f[0]),i(f[1]),i(f[2])))}return n.data={},n.data.vertices=o,n.data.normals=s,0<c.length&&(n.data.colors=c),0<u.length&&(n.data.uvs=[u]),n.data.faces=a,n},clone:function(){return(new Z).copy(this)},copy:function(t){var e,i,r,n;for(this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name,e=0,i=(r=t.vertices).length;e<i;e++)this.vertices.push(r[e].clone());for(e=0,i=(r=t.colors).length;e<i;e++)this.colors.push(r[e].clone());for(e=0,i=(r=t.faces).length;e<i;e++)this.faces.push(r[e].clone());for(e=0,i=t.faceVertexUvs.length;e<i;e++){var o=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,n=o.length;r<n;r++){for(var a=o[r],s=[],l=0,c=a.length;l<c;l++)s.push(a[l].clone());this.faceVertexUvs[e].push(s)}}for(e=0,i=(l=t.morphTargets).length;e<i;e++){if((c={}).name=l[e].name,void 0!==l[e].vertices)for(c.vertices=[],r=0,n=l[e].vertices.length;r<n;r++)c.vertices.push(l[e].vertices[r].clone());if(void 0!==l[e].normals)for(c.normals=[],r=0,n=l[e].normals.length;r<n;r++)c.normals.push(l[e].normals[r].clone());this.morphTargets.push(c)}for(e=0,i=(l=t.morphNormals).length;e<i;e++){if(c={},void 0!==l[e].vertexNormals)for(c.vertexNormals=[],r=0,n=l[e].vertexNormals.length;r<n;r++)o=l[e].vertexNormals[r],(a={}).a=o.a.clone(),a.b=o.b.clone(),a.c=o.c.clone(),c.vertexNormals.push(a);if(void 0!==l[e].faceNormals)for(c.faceNormals=[],r=0,n=l[e].faceNormals.length;r<n;r++)c.faceNormals.push(l[e].faceNormals[r].clone());this.morphNormals.push(c)}for(e=0,i=(r=t.skinWeights).length;e<i;e++)this.skinWeights.push(r[e].clone());for(e=0,i=(r=t.skinIndices).length;e<i;e++)this.skinIndices.push(r[e].clone());for(e=0,i=(r=t.lineDistances).length;e<i;e++)this.lineDistances.push(r[e]);return null!==(e=t.boundingBox)&&(this.boundingBox=e.clone()),null!==(e=t.boundingSphere)&&(this.boundingSphere=e.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Q.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Q.prototype,{isBufferAttribute:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var r=0,n=this.itemSize;r<n;r++)this.array[t+r]=e.array[i+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new j),e[i++]=o.r,e[i++]=o.g,e[i++]=o.b}return this},copyIndicesArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var o=t[r];e[i++]=o.a,e[i++]=o.b,e[i++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new q),e[i++]=o.x,e[i++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new _t),e[i++]=o.x,e[i++]=o.y,e[i++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new At),e[i++]=o.x,e[i++]=o.y,e[i++]=o.z,e[i++]=o.w}return this},set:function(t,e){return this.array.set(t,e=void 0===e?0:e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this},setXYZW:function(t,e,i,r,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this.array[t+3]=n,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),($.prototype=Object.create(Q.prototype)).constructor=$,(tt.prototype=Object.create(Q.prototype)).constructor=tt,(et.prototype=Object.create(Q.prototype)).constructor=et,(it.prototype=Object.create(Q.prototype)).constructor=it,rt.prototype=Object.create(Q.prototype),rt.prototype.constructor=rt,(nt.prototype=Object.create(Q.prototype)).constructor=nt,ot.prototype=Object.create(Q.prototype),ot.prototype.constructor=ot,(at.prototype=Object.create(Q.prototype)).constructor=at,(st.prototype=Object.create(Q.prototype)).constructor=st,Object.assign(lt.prototype,{computeGroups:function(t){var e,i=[],r=void 0;t=t.faces;for(var n=0;n<t.length;n++){var o=t[n];o.materialIndex!==r&&(r=o.materialIndex,void 0!==e&&(e.count=3*n-e.start,i.push(e)),e={start:3*n,materialIndex:r})}void 0!==e&&(e.count=3*n-e.start,i.push(e)),this.groups=i},fromGeometry:function(t){var e=t.faces,i=t.vertices,r=t.faceVertexUvs,n=r[0]&&0<r[0].length,o=r[1]&&0<r[1].length,a=t.morphTargets,s=a.length;if(0<s){for(var l=[],c=0;c<s;c++)l[c]=[];this.morphTargets.position=l}var h,u=t.morphNormals,p=u.length;if(0<p){for(h=[],c=0;c<p;c++)h[c]=[];this.morphTargets.normal=h}for(var d=t.skinIndices,f=t.skinWeights,m=d.length===i.length,g=f.length===i.length,c=0;c<e.length;c++){var v=e[c];this.vertices.push(i[v.a],i[v.b],i[v.c]);var y=v.vertexNormals;for(3===y.length?this.normals.push(y[0],y[1],y[2]):(y=v.normal,this.normals.push(y,y,y)),3===(y=v.vertexColors).length?this.colors.push(y[0],y[1],y[2]):(y=v.color,this.colors.push(y,y,y)),!0===n&&(void 0!==(y=r[0][c])?this.uvs.push(y[0],y[1],y[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new q,new q,new q))),!0===o&&(void 0!==(y=r[1][c])?this.uvs2.push(y[0],y[1],y[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new q,new q,new q))),y=0;y<s;y++){var b=a[y].vertices;l[y].push(b[v.a],b[v.b],b[v.c])}for(y=0;y<p;y++)b=u[y].vertexNormals[c],h[y].push(b.a,b.b,b.c);m&&this.skinIndices.push(d[v.a],d[v.b],d[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var Pa,Ta,Ca,Oa,Ra,La,Ia,Da,Fa,ja,Na,ka,za,Ua,Va,Ba,Ha,Ga,Wa,Xa,qa,Ya,Ka,Ja,Za,Qa,$a,ts,es,is,rs,ns,os,as,ss,ls,cs,hs,us,ps,ds,fs,ms,gs,vs,ys,bs,xs,ws=1;function Ms(t,e,i,r,n,o,a){return bt.barycoordFromPoint(t,e,i,r,ys),n.multiplyScalar(ys.x),o.multiplyScalar(ys.y),a.multiplyScalar(ys.z),n.add(o).add(a),n.clone()}function _s(t,e,i,r,n,o,a,s){return null===(1===e.side?r.intersectTriangle(a,o,n,!0,s):r.intersectTriangle(n,o,a,2!==e.side,s))?null:(xs.copy(s),xs.applyMatrix4(t.matrixWorld),(e=i.ray.origin.distanceTo(xs))<i.near||e>i.far?null:{distance:e,point:xs.clone(),object:t})}function As(t,e,i,r,n,o,a,s){return cs.fromBufferAttribute(r,o),hs.fromBufferAttribute(r,a),us.fromBufferAttribute(r,s),(t=_s(t,t.material,e,i,cs,hs,us,bs))&&(n&&(ms.fromBufferAttribute(n,o),gs.fromBufferAttribute(n,a),vs.fromBufferAttribute(n,s),t.uv=Ms(bs,cs,hs,us,ms,gs,vs)),t.face=new J(o,a,s,bt.normal(cs,hs,us)),t.faceIndex=o),t}ht.prototype=Object.assign(Object.create(e.prototype),{constructor:ht,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<ct(t)?ot:rt)(t,1):this.index=t},addAttribute:function(t,e,i){if(e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute){if("index"!==t)return this.attributes[t]=e,this;console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e)}else console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(t,new Q(e,i))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;return void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0),void 0!==(e=this.attributes.normal)&&((new g).getNormalMatrix(t).applyToBufferAttribute(e),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:(Fa=new Mt,function(t){return Fa.makeRotationX(t),this.applyMatrix(Fa),this}),rotateY:(Da=new Mt,function(t){return Da.makeRotationY(t),this.applyMatrix(Da),this}),rotateZ:(Ia=new Mt,function(t){return Ia.makeRotationZ(t),this.applyMatrix(Ia),this}),translate:(La=new Mt,function(t,e,i){return La.makeTranslation(t,e,i),this.applyMatrix(La),this}),scale:(Ra=new Mt,function(t,e,i){return Ra.makeScale(t,e,i),this.applyMatrix(Ra),this}),lookAt:(Oa=new X,function(t){Oa.lookAt(t),Oa.updateMatrix(),this.applyMatrix(Oa.matrix)}),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e,i=t.geometry;return t.isPoints||t.isLine?(t=new at(3*i.vertices.length,3),e=new at(3*i.colors.length,3),this.addAttribute("position",t.copyVector3sArray(i.vertices)),this.addAttribute("color",e.copyColorsArray(i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length&&(t=new at(i.lineDistances.length,1),this.addAttribute("lineDistance",t.copyArray(i.lineDistances))),null!==i.boundingSphere&&(this.boundingSphere=i.boundingSphere.clone()),null!==i.boundingBox&&(this.boundingBox=i.boundingBox.clone())):t.isMesh&&i&&i.isGeometry&&this.fromGeometry(i),this},setFromPoints:function(t){for(var e=[],i=0,r=t.length;i<r;i++){var n=t[i];e.push(n.x,n.y,n.z||0)}return this.addAttribute("position",new at(e,3)),this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var i=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(i=void 0,e.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(e);i.verticesNeedUpdate=e.verticesNeedUpdate,i.normalsNeedUpdate=e.normalsNeedUpdate,i.colorsNeedUpdate=e.colorsNeedUpdate,i.uvsNeedUpdate=e.uvsNeedUpdate,i.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=i}return!0===e.verticesNeedUpdate&&(void 0!==(i=this.attributes.position)&&(i.copyVector3sArray(e.vertices),i.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(void 0!==(i=this.attributes.normal)&&(i.copyVector3sArray(e.normals),i.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(void 0!==(i=this.attributes.color)&&(i.copyColorsArray(e.colors),i.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(void 0!==(i=this.attributes.uv)&&(i.copyVector2sArray(e.uvs),i.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(void 0!==(i=this.attributes.lineDistance)&&(i.copyArray(e.lineDistances),i.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new lt).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e,i=new Float32Array(3*t.vertices.length);for(e in this.addAttribute("position",new Q(i,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(i=new Float32Array(3*t.normals.length),this.addAttribute("normal",new Q(i,3).copyVector3sArray(t.normals))),0<t.colors.length&&(i=new Float32Array(3*t.colors.length),this.addAttribute("color",new Q(i,3).copyColorsArray(t.colors))),0<t.uvs.length&&(i=new Float32Array(2*t.uvs.length),this.addAttribute("uv",new Q(i,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(i=new Float32Array(2*t.uvs2.length),this.addAttribute("uv2",new Q(i,2).copyVector2sArray(t.uvs2))),0<t.indices.length&&(i=new(65535<ct(t.indices)?Uint32Array:Uint16Array)(3*t.indices.length),this.setIndex(new Q(i,1).copyIndicesArray(t.indices))),this.groups=t.groups,t.morphTargets){for(var i=[],r=t.morphTargets[e],n=0,o=r.length;n<o;n++){var a=r[n],s=new at(3*a.length,3);i.push(s.copyVector3sArray(a))}this.morphAttributes[e]=i}return 0<t.skinIndices.length&&(e=new at(4*t.skinIndices.length,4),this.addAttribute("skinIndex",e.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(e=new at(4*t.skinWeights.length,4),this.addAttribute("skinWeight",e.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new U);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:(Ta=new U,Ca=new _t,function(){null===this.boundingSphere&&(this.boundingSphere=new V);var t=this.attributes.position;if(t){var e=this.boundingSphere.center;Ta.setFromBufferAttribute(t),Ta.getCenter(e);for(var i=0,r=0,n=t.count;r<n;r++)Ca.x=t.getX(r),Ca.y=t.getY(r),Ca.z=t.getZ(r),i=Math.max(i,e.distanceToSquared(Ca));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,i=this.groups;if(e.position){var r=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new Q(new Float32Array(r.length),3));else for(var n=0,o=(c=e.normal.array).length;n<o;n++)c[n]=0;var a,s,l,c=e.normal.array,h=new _t,u=new _t,p=new _t,d=new _t,f=new _t;if(t){t=t.array,0===i.length&&this.addGroup(0,t.length);for(var m=0,g=i.length;m<g;++m)for(o=(n=i[m]).start,a=n.count,n=o,o+=a;n<o;n+=3)a=3*t[n+0],s=3*t[n+1],l=3*t[n+2],h.fromArray(r,a),u.fromArray(r,s),p.fromArray(r,l),d.subVectors(p,u),f.subVectors(h,u),d.cross(f),c[a]+=d.x,c[1+a]+=d.y,c[2+a]+=d.z,c[s]+=d.x,c[1+s]+=d.y,c[2+s]+=d.z,c[l]+=d.x,c[1+l]+=d.y,c[2+l]+=d.z}else for(n=0,o=r.length;n<o;n+=9)h.fromArray(r,n),u.fromArray(r,n+3),p.fromArray(r,n+6),d.subVectors(p,u),f.subVectors(h,u),d.cross(f),c[n]=d.x,c[n+1]=d.y,c[n+2]=d.z,c[n+3]=d.x,c[n+4]=d.y,c[n+5]=d.z,c[n+6]=d.x,c[n+7]=d.y,c[n+8]=d.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0);var i,r=this.attributes;for(i in r)if(void 0!==t.attributes[i])for(var n=r[i].array,o=t.attributes[i],a=o.array,s=0,o=o.itemSize*e;s<a.length;s++,o++)n[o]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:(Pa=new _t,function(){for(var t=this.attributes.normal,e=0,i=t.count;e<i;e++)Pa.x=t.getX(e),Pa.y=t.getY(e),Pa.z=t.getZ(e),Pa.normalize(),t.setXYZ(e,Pa.x,Pa.y,Pa.z)}),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t,e=new ht,i=this.index.array,r=this.attributes;for(t in r){for(var n=(o=r[t]).array,o=o.itemSize,a=new n.constructor(i.length*o),s=0,l=0,c=0,h=i.length;c<h;c++)for(var s=i[c]*o,u=0;u<o;u++)a[l++]=n[s++];e.addAttribute(t,new Q(a,o))}return e},toJSON:function(){var t,e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){for(t in n=this.parameters)void 0!==n[t]&&(e[t]=n[t]);return e}e.data={attributes:{}};var i=this.index;for(t in null!==i&&(n=Array.prototype.slice.call(i.array),e.data.index={type:i.array.constructor.name,array:n}),i=this.attributes){var r=i[t],n=Array.prototype.slice.call(r.array);e.data.attributes[t]={itemSize:r.itemSize,type:r.array.constructor.name,array:n,normalized:r.normalized}}return 0<(t=this.groups).length&&(e.data.groups=JSON.parse(JSON.stringify(t))),null!==(t=this.boundingSphere)&&(e.data.boundingSphere={center:t.center.toArray(),radius:t.radius}),e},clone:function(){return(new ht).copy(this)},copy:function(t){for(var e in this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=t.name,null!==(o=t.index)&&this.setIndex(o.clone()),o=t.attributes)this.addAttribute(e,o[e].clone());var i=t.morphAttributes;for(e in i){for(var r=[],n=i[e],o=0,a=n.length;o<a;o++)r.push(n[o].clone());this.morphAttributes[e]=r}for(o=0,a=(e=t.groups).length;o<a;o++)i=e[o],this.addGroup(i.start,i.count,i.materialIndex);return null!==(e=t.boundingBox)&&(this.boundingBox=e.clone()),null!==(e=t.boundingSphere)&&(this.boundingSphere=e.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(ut.prototype=Object.create(Z.prototype)).constructor=ut,(pt.prototype=Object.create(ht.prototype)).constructor=pt,(dt.prototype=Object.create(Z.prototype)).constructor=dt,(ft.prototype=Object.create(ht.prototype)).constructor=ft,((mt.prototype=Object.create(N.prototype)).constructor=mt).prototype.isMeshBasicMaterial=!0,mt.prototype.copy=function(t){return N.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},((gt.prototype=Object.create(N.prototype)).constructor=gt).prototype.isShaderMaterial=!0,gt.prototype.copy=function(t){return N.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=vo.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},gt.prototype.toJSON=function(t){return(t=N.prototype.toJSON.call(this,t)).uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Object.assign(vt.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new _t).copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:(Xa=new _t,function(t){return this.origin.copy(this.at(t,Xa)),this}),closestPointToPoint:function(t,e){e=e||new _t;e.subVectors(t,this.origin);t=e.dot(this.direction);return t<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:(Wa=new _t,function(t){var e=Wa.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Wa.copy(this.direction).multiplyScalar(e).add(this.origin),Wa.distanceToSquared(t))}),distanceSqToSegment:(Ba=new _t,Ha=new _t,Ga=new _t,function(t,e,i,r){Ba.copy(t).add(e).multiplyScalar(.5),Ha.copy(e).sub(t).normalize(),Ga.copy(this.origin).sub(Ba);var n,o=.5*t.distanceTo(e),a=-this.direction.dot(Ha),s=Ga.dot(this.direction),l=-Ga.dot(Ha),c=Ga.lengthSq(),h=Math.abs(1-a*a),a=0<h?(e=a*s-l,n=o*h,0<=(t=a*l-s)?-n<=e?e<=n?(t*=o=1/h)*(t+a*(e*=o)+2*s)+e*(a*t+e+2*l)+c:(e=o,-(t=Math.max(0,-(a*e+s)))*t+e*(e+2*l)+c):(e=-o,-(t=Math.max(0,-(a*e+s)))*t+e*(e+2*l)+c):e<=-n?-(t=Math.max(0,-(-a*o+s)))*t+(e=0<t?-o:Math.min(Math.max(-o,-l),o))*(e+2*l)+c:e<=n?(t=0,(e=Math.min(Math.max(-o,-l),o))*(e+2*l)+c):-(t=Math.max(0,-(a*o+s)))*t+(e=0<t?o:Math.min(Math.max(-o,-l),o))*(e+2*l)+c):(e=0<a?-o:o,-(t=Math.max(0,-(a*e+s)))*t+e*(e+2*l)+c);return i&&i.copy(this.direction).multiplyScalar(t).add(this.origin),r&&r.copy(Ha).multiplyScalar(e).add(Ba),a}),intersectSphere:(Va=new _t,function(t,e){Va.subVectors(t.center,this.origin);var i=Va.dot(this.direction),r=Va.dot(Va)-i*i,t=t.radius*t.radius;return t<r?null:(r=i-(t=Math.sqrt(t-r)),i+=t,r<0&&i<0?null:r<0?this.at(i,e):this.at(r,e))}),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/e)?t:null},intersectPlane:function(t,e){t=this.distanceToPlane(t);return null===t?null:this.at(t,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var i,r,n=1/this.direction.x,o=1/this.direction.y,a=1/this.direction.z,s=this.origin;return 0<=n?(i=(t.min.x-s.x)*n,n*=t.max.x-s.x):(i=(t.max.x-s.x)*n,n*=t.min.x-s.x),0<=o?(r=(t.min.y-s.y)*o,o*=t.max.y-s.y):(r=(t.max.y-s.y)*o,o*=t.min.y-s.y),o<i||n<r?null:((i<r||i!=i)&&(i=r),(o<n||n!=n)&&(n=o),0<=a?(r=(t.min.z-s.z)*a,a*=t.max.z-s.z):(r=(t.max.z-s.z)*a,a*=t.min.z-s.z),a<i||n<r?null:((i<r||i!=i)&&(i=r),(n=a<n||n!=n?a:n)<0?null:this.at(0<=i?i:n,e)))},intersectsBox:(Ua=new _t,function(t){return null!==this.intersectBox(t,Ua)}),intersectTriangle:(ja=new _t,Na=new _t,ka=new _t,za=new _t,function(t,e,i,r,n){if(Na.subVectors(e,t),ka.subVectors(i,t),za.crossVectors(Na,ka),0<(e=this.direction.dot(za))){if(r)return null;r=1}else{if(!(e<0))return null;r=-1,e=-e}return ja.subVectors(this.origin,t),(t=r*this.direction.dot(ka.crossVectors(ja,ka)))<0||(i=r*this.direction.dot(Na.cross(ja)))<0||e<t+i||(t=-r*ja.dot(za))<0?null:this.at(t/e,n)}),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(yt.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return(t||new _t).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new _t).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){e=e||new _t;return this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:(qa=new _t,Ya=new _t,function(t,e){qa.subVectors(t,this.start),Ya.subVectors(this.end,this.start);t=Ya.dot(Ya),t=Ya.dot(qa)/t;return t=e?io.clamp(t,0,1):t}),closestPointToPoint:function(t,e,i){return t=this.closestPointToPointParameter(t,e),i=i||new _t,this.delta(i).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Object.assign(bt,{normal:($a=new _t,function(t,e,i,r){return(r=r||new _t).subVectors(i,e),$a.subVectors(t,e),r.cross($a),0<(t=r.lengthSq())?r.multiplyScalar(1/Math.sqrt(t)):r.set(0,0,0)}),barycoordFromPoint:(Ja=new _t,Za=new _t,Qa=new _t,function(t,e,i,r,n){Ja.subVectors(r,e),Za.subVectors(i,e),Qa.subVectors(t,e),t=Ja.dot(Ja),e=Ja.dot(Za),i=Ja.dot(Qa);var o=Za.dot(Za);r=Za.dot(Qa);var a=t*o-e*e;return n=n||new _t,0==a?n.set(-2,-1,-1):n.set(1-(o=(o*i-e*r)*(a=1/a))-(t=(t*r-e*i)*a),t,o)}),containsPoint:(Ka=new _t,function(t,e,i,r){return 0<=(t=bt.barycoordFromPoint(t,e,i,r,Ka)).x&&0<=t.y&&t.x+t.y<=1})}),Object.assign(bt.prototype,{set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,r){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:(ns=new _t,os=new _t,function(){return ns.subVectors(this.c,this.b),os.subVectors(this.a,this.b),.5*ns.cross(os).length()}),midpoint:function(t){return(t||new _t).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return bt.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new B).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return bt.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return bt.containsPoint(t,this.a,this.b,this.c)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:(ts=new B,es=[new yt,new yt,new yt],is=new _t,rs=new _t,function(t,e){var i=e||new _t,r=1/0;if(ts.setFromCoplanarPoints(this.a,this.b,this.c),ts.projectPoint(t,is),!0===this.containsPoint(is))i.copy(is);else{es[0].set(this.a,this.b),es[1].set(this.b,this.c),es[2].set(this.c,this.a);for(var n=0;n<es.length;n++){es[n].closestPointToPoint(is,!0,rs);var o=is.distanceToSquared(rs);o<r&&(r=o,i.copy(rs))}}return i}),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),xt.prototype=Object.assign(Object.create(X.prototype),{constructor:xt,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return X.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,i=this.geometry;if(i.isBufferGeometry){if(i=i.morphAttributes,0<(t=Object.keys(i)).length){var r=i[t[0]];if(void 0!==r)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},i=0,t=r.length;i<t;i++)e=r[i].name||String(i),this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=i}}else if(void 0!==(r=i.morphTargets)&&0<r.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},i=0,t=r.length;i<t;i++)e=r[i].name||String(i),this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=i},raycast:(as=new Mt,ss=new vt,ls=new V,cs=new _t,hs=new _t,us=new _t,ps=new _t,ds=new _t,fs=new _t,ms=new q,gs=new q,vs=new q,ys=new _t,bs=new _t,xs=new _t,function(t,e){var i=this.geometry,r=this.material,n=this.matrixWorld;if(void 0!==r&&(null===i.boundingSphere&&i.computeBoundingSphere(),ls.copy(i.boundingSphere),ls.applyMatrix4(n),!1!==t.ray.intersectsSphere(ls)&&(as.getInverse(n),ss.copy(t.ray).applyMatrix4(as),null===i.boundingBox||!1!==ss.intersectsBox(i.boundingBox))))if(i.isBufferGeometry){var o,r=i.index,a=i.attributes.position,n=i.attributes.uv;if(null!==r)for(c=0,h=r.count;c<h;c+=3)i=r.getX(c),l=r.getX(c+1),o=r.getX(c+2),(d=As(this,t,ss,a,n,i,l,o))&&(d.faceIndex=Math.floor(c/3),e.push(d));else if(void 0!==a)for(c=0,h=a.count;c<h;c+=3)(d=As(this,t,ss,a,n,i=c,l=c+1,o=c+2))&&(d.index=i,e.push(d))}else if(i.isGeometry){var s,l,n=Array.isArray(r),c=i.vertices,h=i.faces;0<(l=i.faceVertexUvs[0]).length&&(a=l);for(var u=0,p=h.length;u<p;u++){var d,f=h[u];if(void 0!==(d=n?r[f.materialIndex]:r)){if(l=c[f.a],o=c[f.b],s=c[f.c],!0===d.morphTargets){var m=i.morphTargets,g=this.morphTargetInfluences;cs.set(0,0,0),hs.set(0,0,0),us.set(0,0,0);for(var v=0,y=m.length;v<y;v++){var b,x=g[v];0!==x&&(b=m[v].vertices,cs.addScaledVector(ps.subVectors(b[f.a],l),x),hs.addScaledVector(ds.subVectors(b[f.b],o),x),us.addScaledVector(fs.subVectors(b[f.c],s),x))}cs.add(l),hs.add(o),us.add(s),l=cs,o=hs,s=us}(d=_s(this,d,t,ss,l,o,s,bs))&&(a&&a[u]&&(m=a[u],ms.copy(m[0]),gs.copy(m[1]),vs.copy(m[2]),d.uv=Ms(bs,l,o,s,ms,gs,vs)),d.face=f,d.faceIndex=u,e.push(d))}}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Es=0;ee.prototype=Object.assign(Object.create(Y.prototype),{constructor:ee,isPerspectiveCamera:!0,copy:function(t,e){return Y.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*io.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*io.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*io.RAD2DEG*Math.atan(Math.tan(.5*io.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,i,r,n,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=r,this.view.width=n,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,e,i=this.near,r=i*Math.tan(.5*io.DEG2RAD*this.fov)/this.zoom,n=2*r,o=this.aspect*n,a=-.5*o,s=this.view;null!==this.view&&this.view.enabled&&(t=s.fullWidth,e=s.fullHeight,a+=s.offsetX*o/t,r-=s.offsetY*n/e,o=s.width/t*o,n=s.height/e*n),0!==(s=this.filmOffset)&&(a+=i*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+o,r,r-n,i,this.far)},toJSON:function(t){return(t=X.prototype.toJSON.call(this,t)).object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),ie.prototype=Object.assign(Object.create(ee.prototype),{constructor:ie,isArrayCamera:!0});var Ss,Ps,Ts,Cs,Os,Rs,Ls,Is,Ds,Fs,js,Ns,ks,zs,Us,Vs,Bs,Hs,Gs=0;pe.prototype.isFogExp2=!0,pe.prototype.clone=function(){return new pe(this.color.getHex(),this.density)},pe.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},de.prototype.isFog=!0,de.prototype.clone=function(){return new de(this.color.getHex(),this.near,this.far)},de.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},fe.prototype=Object.assign(Object.create(X.prototype),{constructor:fe,copy:function(t,e){return X.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=X.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}),((me.prototype=Object.create(N.prototype)).constructor=me).prototype.isSpriteMaterial=!0,me.prototype.copy=function(t){return N.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},ge.prototype=Object.assign(Object.create(X.prototype),{constructor:ge,isSprite:!0,raycast:(Ss=new _t,Ps=new _t,Ts=new _t,function(t,e){Ps.setFromMatrixPosition(this.matrixWorld),t.ray.closestPointToPoint(Ps,Ss),Ts.setFromMatrixScale(this.matrixWorld);var i=Ts.x*Ts.y/4;Ps.distanceToSquared(Ss)>i||((i=t.ray.origin.distanceTo(Ss))<t.near||i>t.far||e.push({distance:i,point:Ss.clone(),face:null,object:this}))}),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return X.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}}),ve.prototype=Object.assign(Object.create(X.prototype),{constructor:ve,copy:function(t){X.prototype.copy.call(this,t,!1);for(var e=0,i=(t=t.levels).length;e<i;e++){var r=t[e];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=this.levels,r=0;r<i.length&&!(e<i[r].distance);r++);i.splice(r,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,i=1,r=e.length;i<r&&!(t<e[i].distance);i++);return e[i-1].object},raycast:(Rs=new _t,function(t,e){Rs.setFromMatrixPosition(this.matrixWorld);var i=t.ray.origin.distanceTo(Rs);this.getObjectForDistance(i).raycast(t,e)}),update:(Cs=new _t,Os=new _t,function(t){var e=this.levels;if(1<e.length){Cs.setFromMatrixPosition(t.matrixWorld),Os.setFromMatrixPosition(this.matrixWorld),t=Cs.distanceTo(Os),e[0].object.visible=!0;for(var i=1,r=e.length;i<r&&t>=e[i].distance;i++)e[i-1].object.visible=!1,e[i].object.visible=!0;for(;i<r;i++)e[i].object.visible=!1}}),toJSON:function(t){(t=X.prototype.toJSON.call(this,t)).object.levels=[];for(var e=this.levels,i=0,r=e.length;i<r;i++){var n=e[i];t.object.levels.push({object:n.object.uuid,distance:n.distance})}return t}}),Object.assign(ye.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var i=new Mt;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},pose:function(){for(var t,e=0,i=this.bones.length;e<i;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,i=this.bones.length;e<i;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:(Ls=new Mt,Is=new Mt,function(){for(var t=this.bones,e=this.boneInverses,i=this.boneMatrices,r=this.boneTexture,n=0,o=t.length;n<o;n++)Ls.multiplyMatrices(t[n]?t[n].matrixWorld:Is,e[n]),Ls.toArray(i,16*n);void 0!==r&&(r.needsUpdate=!0)}),clone:function(){return new ye(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,i=this.bones.length;e<i;e++){var r=this.bones[e];if(r.name===t)return r}}}),be.prototype=Object.assign(Object.create(X.prototype),{constructor:be,isBone:!0}),xe.prototype=Object.assign(Object.create(xt.prototype),{constructor:xe,isSkinnedMesh:!0,initBones:function(){var t,e,i,r,n=[];if(this.geometry&&void 0!==this.geometry.bones){for(i=0,r=this.geometry.bones.length;i<r;i++)e=this.geometry.bones[i],t=new be,n.push(t),t.name=e.name,t.position.fromArray(e.pos),t.quaternion.fromArray(e.rotq),void 0!==e.scl&&t.scale.fromArray(e.scl);for(i=0,r=this.geometry.bones.length;i<r;i++)(-1!==(e=this.geometry.bones[i]).parent&&null!==e.parent&&void 0!==n[e.parent]?n[e.parent]:this).add(n[i])}return this.updateMatrixWorld(!0),n},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var t;if(this.geometry&&this.geometry.isGeometry)for(r=0;r<this.geometry.skinWeights.length;r++)1/0!==(t=1/(e=this.geometry.skinWeights[r]).manhattanLength())?e.multiplyScalar(t):e.set(1,0,0,0);else if(this.geometry&&this.geometry.isBufferGeometry)for(var e=new At,i=this.geometry.attributes.skinWeight,r=0;r<i.count;r++)e.x=i.getX(r),e.y=i.getY(r),e.z=i.getZ(r),e.w=i.getW(r),1/0!==(t=1/e.manhattanLength())?e.multiplyScalar(t):e.set(1,0,0,0),i.setXYZW(r,e.x,e.y,e.z,e.w)},updateMatrixWorld:function(t){xt.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),((we.prototype=Object.create(N.prototype)).constructor=we).prototype.isLineBasicMaterial=!0,we.prototype.copy=function(t){return N.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},Me.prototype=Object.assign(Object.create(X.prototype),{constructor:Me,isLine:!0,computeLineDistances:(Ns=new _t,ks=new _t,function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,i=[0],r=1,n=e.count;r<n;r++)Ns.fromBufferAttribute(e,r-1),ks.fromBufferAttribute(e,r),i[r]=i[r-1],i[r]+=Ns.distanceTo(ks);t.addAttribute("lineDistance",new THREE.Float32BufferAttribute(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(e=t.vertices,(i=t.lineDistances)[0]=0,r=1,n=e.length;r<n;r++)i[r]=i[r-1],i[r]+=e[r-1].distanceTo(e[r]);return this}),raycast:(Ds=new Mt,Fs=new vt,js=new V,function(t,e){var i=(i=t.linePrecision)*i,r=this.geometry,n=this.matrixWorld;if(null===r.boundingSphere&&r.computeBoundingSphere(),js.copy(r.boundingSphere),js.applyMatrix4(n),!1!==t.ray.intersectsSphere(js)){Ds.getInverse(n),Fs.copy(t.ray).applyMatrix4(Ds);var o=new _t,a=new _t,n=new _t,s=new _t,l=this&&this.isLineSegments?2:1;if(r.isBufferGeometry){var c=r.index,h=r.attributes.position.array;if(null!==c)for(var r=0,u=(c=c.array).length-1;r<u;r+=l){var p=c[r+1];o.fromArray(h,3*c[r]),a.fromArray(h,3*p),i<(p=Fs.distanceSqToSegment(o,a,s,n))||(s.applyMatrix4(this.matrixWorld),(p=t.ray.origin.distanceTo(s))<t.near||p>t.far||e.push({distance:p,point:n.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this}))}else for(r=0,u=h.length/3-1;r<u;r+=l)o.fromArray(h,3*r),a.fromArray(h,3*r+3),i<(p=Fs.distanceSqToSegment(o,a,s,n))||(s.applyMatrix4(this.matrixWorld),(p=t.ray.origin.distanceTo(s))<t.near||p>t.far||e.push({distance:p,point:n.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this}))}else if(r.isGeometry)for(a=(o=r.vertices).length,r=0;r<a-1;r+=l)i<(p=Fs.distanceSqToSegment(o[r],o[r+1],s,n))||(s.applyMatrix4(this.matrixWorld),(p=t.ray.origin.distanceTo(s))<t.near||p>t.far||e.push({distance:p,point:n.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this}))}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),_e.prototype=Object.assign(Object.create(Me.prototype),{constructor:_e,isLineSegments:!0,computeLineDistances:(zs=new _t,Us=new _t,function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,i=[],r=0,n=e.count;r<n;r+=2)zs.fromBufferAttribute(e,r),Us.fromBufferAttribute(e,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+zs.distanceTo(Us);t.addAttribute("lineDistance",new THREE.Float32BufferAttribute(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(e=t.vertices,i=t.lineDistances,r=0,n=e.length;r<n;r+=2)zs.copy(e[r]),Us.copy(e[r+1]),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+zs.distanceTo(Us);return this})}),Ae.prototype=Object.assign(Object.create(Me.prototype),{constructor:Ae,isLineLoop:!0}),((Ee.prototype=Object.create(N.prototype)).constructor=Ee).prototype.isPointsMaterial=!0,Ee.prototype.copy=function(t){return N.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},Se.prototype=Object.assign(Object.create(X.prototype),{constructor:Se,isPoints:!0,raycast:(Vs=new Mt,Bs=new vt,Hs=new V,function(n,o){function t(t,e){var i,r=Bs.distanceSqToPoint(t);r<l&&((i=Bs.closestPointToPoint(t)).applyMatrix4(s),(t=n.ray.origin.distanceTo(i))<n.near||t>n.far||o.push({distance:t,distanceToRay:Math.sqrt(r),point:i.clone(),index:e,face:null,object:a}))}var a=this,e=this.geometry,s=this.matrixWorld,i=n.params.Points.threshold;if(null===e.boundingSphere&&e.computeBoundingSphere(),Hs.copy(e.boundingSphere),Hs.applyMatrix4(s),Hs.radius+=i,!1!==n.ray.intersectsSphere(Hs)){Vs.getInverse(s),Bs.copy(n.ray).applyMatrix4(Vs);var l=(i=i/((this.scale.x+this.scale.y+this.scale.z)/3))*i,i=new _t;if(e.isBufferGeometry){var r=e.index,e=e.attributes.position.array;if(null!==r)for(var c=r.array,r=0,h=c.length;r<h;r++){var u=c[r];i.fromArray(e,3*u),t(i,u)}else for(r=0,c=e.length/3;r<c;r++)i.fromArray(e,3*r),t(i,r)}else for(r=0,c=(i=e.vertices).length;r<c;r++)t(i[r],r)}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Pe.prototype=Object.assign(Object.create(X.prototype),{constructor:Pe,isGroup:!0}),Te.prototype=Object.assign(Object.create(p.prototype),{constructor:Te,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),((Ce.prototype=Object.create(p.prototype)).constructor=Ce).prototype.isCompressedTexture=!0,((Oe.prototype=Object.create(p.prototype)).constructor=Oe).prototype.isDepthTexture=!0,(Re.prototype=Object.create(ht.prototype)).constructor=Re,(Le.prototype=Object.create(Z.prototype)).constructor=Le,(Ie.prototype=Object.create(ht.prototype)).constructor=Ie,(De.prototype=Object.create(Z.prototype)).constructor=De,(Fe.prototype=Object.create(ht.prototype)).constructor=Fe,(je.prototype=Object.create(Z.prototype)).constructor=je,(Ne.prototype=Object.create(Fe.prototype)).constructor=Ne,(ke.prototype=Object.create(Z.prototype)).constructor=ke,(ze.prototype=Object.create(Fe.prototype)).constructor=ze,(Ue.prototype=Object.create(Z.prototype)).constructor=Ue,(Ve.prototype=Object.create(Fe.prototype)).constructor=Ve,(Be.prototype=Object.create(Z.prototype)).constructor=Be,(He.prototype=Object.create(Fe.prototype)).constructor=He,(Ge.prototype=Object.create(Z.prototype)).constructor=Ge,(We.prototype=Object.create(ht.prototype)).constructor=We,(Xe.prototype=Object.create(Z.prototype)).constructor=Xe,(qe.prototype=Object.create(ht.prototype)).constructor=qe,(Ye.prototype=Object.create(Z.prototype)).constructor=Ye,(Ke.prototype=Object.create(ht.prototype)).constructor=Ke;var Ws=function(t,e,i){i=i||2;var r,n,o,a=(u=e&&e.length)?e[0]*i:t.length,s=Je(t,0,a,i,!0),l=[];if(!s)return l;if(u){for(var c,h=i,u=[],p=0,d=e.length;p<d;p++)(c=Je(t,c=e[p]*h,p<d-1?e[p+1]*h:t.length,h,!1))===c.next&&(c.steiner=!0),u.push(function(t){for(var e=t,i=t;e.x<i.x&&(i=e),(e=e.next)!==t;);return i}(c));for(u.sort(Qe),p=0;p<u.length;p++)(h=function(t,e){var i,r=e,n=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y)if((l=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y))<=n&&a<l){if((a=l)===n){if(o===r.y)return r;if(o===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}while((r=r.next)!==e);if(!i)return null;if(n===a)return i.prev;for(var s,l=i,c=i.x,h=i.y,u=1/0,r=i.next;r!==l;)n>=r.x&&r.x>=c&&n!==r.x&&ti(o<h?n:a,o,c,h,o<h?a:n,o,r.x,r.y)&&(((s=Math.abs(o-r.y)/(n-r.x))<u||s===u&&r.x>i.x)&&ni(r,t)&&(i=r,u=s)),r=r.next;return i}(e=u[p],h=s))&&Ze(e=oi(h,e),e.next),s=Ze(s,s.next)}if(t.length>80*i){for(r=o=t[0],n=u=t[1],h=i;h<a;h+=i)(p=t[h])<r&&(r=p),(e=t[h+1])<n&&(n=e),o<p&&(o=p),u<e&&(u=e);o=0!==(o=Math.max(o-r,u-n))?1/o:0}return function t(e,i,r,n,o,a,s){if(e){if(!s&&a){for(var l=u=e;null===l.z&&(l.z=$e(l.x,l.y,n,o,a)),l.prevZ=l.prev,(l=l.nextZ=l.next)!==u;);l.prevZ.nextZ=null,l.prevZ=null;var c,h,u=l,p=1;do{for(l=u,h=u=null,d=0;l;){for(d++,c=l,y=f=0;y<p&&(f++,c=c.nextZ);y++);for(b=p;0<f||0<b&&c;)0!==f&&(0===b||!c||l.z<=c.z)?(l=(y=l).nextZ,f--):(c=(y=c).nextZ,b--),h?h.nextZ=y:u=y,y.prevZ=h,h=y;l=c}}while(h.nextZ=null,p*=2,1<d)}for(u=e;e.prev!==e.next;){if(l=e.prev,c=e.next,a)t:{b=n;var d,f,m=o;if(0<=ei(d=(h=e).prev,f=h,p=h.next))h=!1;else{for(var g=(d.x>f.x?d.x>p.x?d:p:f.x>p.x?f:p).x,v=(d.y>f.y?d.y>p.y?d:p:f.y>p.y?f:p).y,y=$e((d.x<f.x?d.x<p.x?d:p:f.x<p.x?f:p).x,(d.y<f.y?d.y<p.y?d:p:f.y<p.y?f:p).y,b,m,a),b=$e(g,v,b,m,a),m=h.nextZ;m&&m.z<=b;){if(m!==h.prev&&m!==h.next&&ti(d.x,d.y,f.x,f.y,p.x,p.y,m.x,m.y)&&0<=ei(m.prev,m,m.next)){h=!1;break t}m=m.nextZ}for(m=h.prevZ;m&&m.z>=y;){if(m!==h.prev&&m!==h.next&&ti(d.x,d.y,f.x,f.y,p.x,p.y,m.x,m.y)&&0<=ei(m.prev,m,m.next)){h=!1;break t}m=m.prevZ}h=!0}}else t:if(h=e,d=h.prev,f=h,p=h.next,0<=ei(d,f,p))h=!1;else{for(y=h.next.next;y!==h.prev;){if(ti(d.x,d.y,f.x,f.y,p.x,p.y,y.x,y.y)&&0<=ei(y.prev,y,y.next)){h=!1;break t}y=y.next}h=!0}if(h)i.push(l.i/r),i.push(e.i/r),i.push(c.i/r),si(e),u=e=c.next;else if((e=c)===u){if(s){if(1===s){for(s=i,u=r,l=e;!ii(c=l.prev,h=l.next.next)&&ri(c,l,l.next,h)&&ni(c,h)&&ni(h,c)&&(s.push(c.i/u),s.push(l.i/u),s.push(h.i/u),si(l),si(l.next),l=e=h),(l=l.next)!==e;);t(e=l,i,r,n,o,a,2)}else if(2===s)t:{s=e;do{for(u=s.next.next;u!==s.prev;){if(l=s.i!==u.i){if(c=u,h=void 0,h=(l=s).next.i!==c.i&&l.prev.i!==c.i){h=void 0;e:{h=l;do{if(h.i!==l.i&&h.next.i!==l.i&&h.i!==c.i&&h.next.i!==c.i&&ri(h,h.next,l,c)){h=!0;break e}}while((h=h.next)!==l);h=!1}h=!h}if(d=void 0,d=h&&ni(l,c)&&ni(c,l))for(d=!1,f=((h=l).x+c.x)/2,c=(l.y+c.y)/2;h.y>c!=h.next.y>c&&h.next.y!==h.y&&f<(h.next.x-h.x)*(c-h.y)/(h.next.y-h.y)+h.x&&(d=!d),(h=h.next)!==l;);l=d}if(l){e=oi(s,u),s=Ze(s,s.next),e=Ze(e,e.next),t(s,i,r,n,o,a),t(e,i,r,n,o,a);break t}u=u.next}}while((s=s.next)!==e)}}else t(Ze(e),i,r,n,o,a,1);break}}}}(s,l,i,r,n,o),l},Xs={area:function(t){for(var e=t.length,i=0,r=e-1,n=0;n<e;r=n++)i+=t[r].x*t[n].y-t[n].x*t[r].y;return.5*i},isClockWise:function(t){return Xs.area(t)<0},triangulateShape:function(t,e){var i=[],r=[],n=[];ci(t),hi(i,t);var o=t.length;e.forEach(ci);for(var a=0;a<e.length;a++)r.push(o),o+=e[a].length,hi(i,e[a]);for(i=Ws(i,r),a=0;a<i.length;a+=3)n.push(i.slice(a,a+3));return n}};(ui.prototype=Object.create(Z.prototype)).constructor=ui,((pi.prototype=Object.create(ht.prototype)).constructor=pi).prototype.getArrays=function(){var t=(t=this.getAttribute("position"))?Array.prototype.slice.call(t.array):[],e=(e=this.getAttribute("uv"))?Array.prototype.slice.call(e.array):[],i=this.index;return{position:t,uv:e,index:i=i?Array.prototype.slice.call(i.array):[]}},pi.prototype.addShapeList=function(t,e){var i=t.length;e.arrays=this.getArrays();for(var r=0;r<i;r++)this.addShape(t[r],e);this.setIndex(e.arrays.index),this.addAttribute("position",new at(e.arrays.position,3)),this.addAttribute("uv",new at(e.arrays.uv,2))},pi.prototype.addShape=function(t,i){function e(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}function r(t,e,i){var r=t.x-e.x,n=t.y-e.y,o=i.x-t.x,a=i.y-t.y,s=r*r+n*n;if(Math.abs(r*a-n*o)>Number.EPSILON){var l=Math.sqrt(s),c=Math.sqrt(o*o+a*a),s=e.x-n/l;if(e=e.y+r/l,(n=(o=s+r*(a=((i.x-a/c-s)*a-(i.y+o/c-e)*o)/(r*a-n*o))-t.x)*o+(r=e+n*a-t.y)*r)<=2)return new q(o,r);n=Math.sqrt(n/2)}else t=!1,r>Number.EPSILON?o>Number.EPSILON&&(t=!0):r<-Number.EPSILON?o<-Number.EPSILON&&(t=!0):Math.sign(n)===Math.sign(a)&&(t=!0),n=t?(o=-n,Math.sqrt(s)):(o=r,r=n,Math.sqrt(s/2));return new q(o/n,r/n)}function n(t,e){var i,r;for(U=t.length;0<=--U;){(r=(i=U)-1)<0&&(r=t.length-1);for(var n=0,o=A+2*w,n=0;n<o;n++){var a=k*n,s=e+r+a,l=e+r+(c=k*(n+1)),c=e+i+c;h(e+i+a),h(s),h(c),h(s),h(l),h(c),a=f.length/3,u((a=P.generateSideWallUV(C,f,a-6,a-3,a-2,a-1))[0]),u(a[1]),u(a[3]),u(a[1]),u(a[2]),u(a[3])}}}function o(t,e,i){v.push(t),v.push(e),v.push(i)}function a(t,e,i){h(t),h(e),h(i),t=f.length/3,u((t=P.generateTopUV(C,f,t-3,t-2,t-1))[0]),u(t[1]),u(t[2])}function h(t){m.push(f.length/3),f.push(v[3*t+0]),f.push(v[3*t+1]),f.push(v[3*t+2])}function u(t){g.push(t.x),g.push(t.y)}var s,l,c,p,d,f=(y=i.arrays||this.getArrays()).position,m=y.index,g=y.uv,v=[],y=void 0!==i.amount?i.amount:100,b=void 0!==i.bevelThickness?i.bevelThickness:6,x=void 0!==i.bevelSize?i.bevelSize:b-2,w=void 0!==i.bevelSegments?i.bevelSegments:3,M=void 0===i.bevelEnabled||i.bevelEnabled,_=void 0!==i.curveSegments?i.curveSegments:12,A=void 0!==i.steps?i.steps:1,E=i.extrudePath,S=!1,P=void 0!==i.UVGenerator?i.UVGenerator:ui.WorldUVGenerator;E&&(s=E.getSpacedPoints(A),M=!(S=!0),l=void 0!==i.frames?i.frames:E.computeFrenetFrames(A,!1),c=new _t,p=new _t,d=new _t),M||(x=b=w=0);var T,C=this,_=(E=t.extractPoints(_)).shape,O=E.holes;if(!Xs.isClockWise(_))for(_=_.reverse(),I=0,D=O.length;I<D;I++)T=O[I],Xs.isClockWise(T)&&(O[I]=T.reverse());for(var R=Xs.triangulateShape(_,O),L=_,I=0,D=O.length;I<D;I++)T=O[I],_=_.concat(T);for(var F,j,N,k=_.length,z=R.length,E=[],U=0,V=L.length,B=V-1,H=U+1;U<V;U++,B++,H++)E[U]=r(L[U],L[B=B===V?0:B],L[H=H===V?0:H]);var G,W=[],X=E.concat();for(I=0,D=O.length;I<D;I++){for(T=O[I],G=[],U=0,B=(V=T.length)-1,H=U+1;U<V;U++,B++,H++)B===V&&(B=0),H===V&&(H=0),G[U]=r(T[U],T[B],T[H]);W.push(G),X=X.concat(G)}for(B=0;B<w;B++){for(V=B/w,F=b*Math.cos(V*Math.PI/2),H=x*Math.sin(V*Math.PI/2),U=0,V=L.length;U<V;U++)o((j=e(L[U],E[U],H)).x,j.y,-F);for(I=0,D=O.length;I<D;I++)for(T=O[I],G=W[I],U=0,V=T.length;U<V;U++)o((j=e(T[U],G[U],H)).x,j.y,-F)}for(H=x,U=0;U<k;U++)j=M?e(_[U],X[U],H):_[U],S?(p.copy(l.normals[0]).multiplyScalar(j.x),c.copy(l.binormals[0]).multiplyScalar(j.y),d.copy(s[0]).add(p).add(c),o(d.x,d.y,d.z)):o(j.x,j.y,0);for(V=1;V<=A;V++)for(U=0;U<k;U++)j=M?e(_[U],X[U],H):_[U],S?(p.copy(l.normals[V]).multiplyScalar(j.x),c.copy(l.binormals[V]).multiplyScalar(j.y),d.copy(s[V]).add(p).add(c),o(d.x,d.y,d.z)):o(j.x,j.y,y/A*V);for(B=w-1;0<=B;B--){for(V=B/w,F=b*Math.cos(V*Math.PI/2),H=x*Math.sin(V*Math.PI/2),U=0,V=L.length;U<V;U++)o((j=e(L[U],E[U],H)).x,j.y,y+F);for(I=0,D=O.length;I<D;I++)for(T=O[I],G=W[I],U=0,V=T.length;U<V;U++)j=e(T[U],G[U],H),S?o(j.x,j.y+s[A-1].y,s[A-1].x+F):o(j.x,j.y,y+F)}!function(){var t=f.length/3;if(M){var e=0*k;for(U=0;U<z;U++)a((N=R[U])[2]+e,N[1]+e,N[0]+e);for(e=A+2*w,e*=k,U=0;U<z;U++)a((N=R[U])[0]+e,N[1]+e,N[2]+e)}else{for(U=0;U<z;U++)a((N=R[U])[2],N[1],N[0]);for(U=0;U<z;U++)a((N=R[U])[0]+k*A,N[1]+k*A,N[2]+k*A)}C.addGroup(t,f.length/3-t,void 0!==i.material?i.material:0)}(),function(){var t=f.length/3,e=0;for(n(L,e),e+=L.length,I=0,D=O.length;I<D;I++)n(T=O[I],e),e+=T.length;C.addGroup(t,f.length/3-t,void 0!==i.extrudeMaterial?i.extrudeMaterial:1)}(),i.arrays||(this.setIndex(m),this.addAttribute("position",new at(f,3)),this.addAttribute("uv",new at(g,2)))},ui.WorldUVGenerator={generateTopUV:function(t,e,i,r,n){t=e[3*r],r=e[3*r+1];var o=e[3*n];return n=e[3*n+1],[new q(e[3*i],e[3*i+1]),new q(t,r),new q(o,n)]},generateSideWallUV:function(t,e,i,r,n,o){t=e[3*i];var a=e[3*i+1];i=e[3*i+2];var s=e[3*r],l=e[3*r+1];r=e[3*r+2];var c=e[3*n],h=e[3*n+1];n=e[3*n+2];var u=e[3*o],p=e[3*o+1];return e=e[3*o+2],Math.abs(a-l)<.01?[new q(t,1-i),new q(s,1-r),new q(c,1-n),new q(u,1-e)]:[new q(a,1-i),new q(l,1-r),new q(h,1-n),new q(p,1-e)]}},(di.prototype=Object.create(Z.prototype)).constructor=di,(fi.prototype=Object.create(pi.prototype)).constructor=fi,(mi.prototype=Object.create(Z.prototype)).constructor=mi,(gi.prototype=Object.create(ht.prototype)).constructor=gi,(vi.prototype=Object.create(Z.prototype)).constructor=vi,(yi.prototype=Object.create(ht.prototype)).constructor=yi,(bi.prototype=Object.create(Z.prototype)).constructor=bi,(xi.prototype=Object.create(ht.prototype)).constructor=xi,((wi.prototype=Object.create(Z.prototype)).constructor=wi).prototype.toJSON=function(){var t=Z.prototype.toJSON.call(this);return _i(this.parameters.shapes,t)},((Mi.prototype=Object.create(ht.prototype)).constructor=Mi).prototype.toJSON=function(){var t=ht.prototype.toJSON.call(this);return _i(this.parameters.shapes,t)},(Ai.prototype=Object.create(ht.prototype)).constructor=Ai,(Ei.prototype=Object.create(Z.prototype)).constructor=Ei,(Si.prototype=Object.create(ht.prototype)).constructor=Si,(Pi.prototype=Object.create(Ei.prototype)).constructor=Pi,(Ti.prototype=Object.create(Si.prototype)).constructor=Ti,(Ci.prototype=Object.create(Z.prototype)).constructor=Ci,(Oi.prototype=Object.create(ht.prototype)).constructor=Oi;var qs=Object.freeze({WireframeGeometry:Re,ParametricGeometry:Le,ParametricBufferGeometry:Ie,TetrahedronGeometry:je,TetrahedronBufferGeometry:Ne,OctahedronGeometry:ke,OctahedronBufferGeometry:ze,IcosahedronGeometry:Ue,IcosahedronBufferGeometry:Ve,DodecahedronGeometry:Be,DodecahedronBufferGeometry:He,PolyhedronGeometry:De,PolyhedronBufferGeometry:Fe,TubeGeometry:Ge,TubeBufferGeometry:We,TorusKnotGeometry:Xe,TorusKnotBufferGeometry:qe,TorusGeometry:Ye,TorusBufferGeometry:Ke,TextGeometry:di,TextBufferGeometry:fi,SphereGeometry:mi,SphereBufferGeometry:gi,RingGeometry:vi,RingBufferGeometry:yi,PlaneGeometry:dt,PlaneBufferGeometry:ft,LatheGeometry:bi,LatheBufferGeometry:xi,ShapeGeometry:wi,ShapeBufferGeometry:Mi,ExtrudeGeometry:ui,ExtrudeBufferGeometry:pi,EdgesGeometry:Ai,ConeGeometry:Pi,ConeBufferGeometry:Ti,CylinderGeometry:Ei,CylinderBufferGeometry:Si,CircleGeometry:Ci,CircleBufferGeometry:Oi,BoxGeometry:ut,BoxBufferGeometry:pt});((Ri.prototype=Object.create(N.prototype)).constructor=Ri).prototype.isShadowMaterial=!0,((Li.prototype=Object.create(gt.prototype)).constructor=Li).prototype.isRawShaderMaterial=!0,((Ii.prototype=Object.create(N.prototype)).constructor=Ii).prototype.isMeshStandardMaterial=!0,Ii.prototype.copy=function(t){return N.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Di.prototype=Object.create(Ii.prototype)).constructor=Di).prototype.isMeshPhysicalMaterial=!0,Di.prototype.copy=function(t){return Ii.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},((Fi.prototype=Object.create(N.prototype)).constructor=Fi).prototype.isMeshPhongMaterial=!0,Fi.prototype.copy=function(t){return N.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((ji.prototype=Object.create(Fi.prototype)).constructor=ji).prototype.isMeshToonMaterial=!0,ji.prototype.copy=function(t){return Fi.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},((Ni.prototype=Object.create(N.prototype)).constructor=Ni).prototype.isMeshNormalMaterial=!0,Ni.prototype.copy=function(t){return N.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((ki.prototype=Object.create(N.prototype)).constructor=ki).prototype.isMeshLambertMaterial=!0,ki.prototype.copy=function(t){return N.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((zi.prototype=Object.create(we.prototype)).constructor=zi).prototype.isLineDashedMaterial=!0,zi.prototype.copy=function(t){return we.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Ys=Object.freeze({ShadowMaterial:Ri,SpriteMaterial:me,RawShaderMaterial:Li,ShaderMaterial:gt,PointsMaterial:Ee,MeshPhysicalMaterial:Di,MeshStandardMaterial:Ii,MeshPhongMaterial:Fi,MeshToonMaterial:ji,MeshNormalMaterial:Ni,MeshLambertMaterial:ki,MeshDepthMaterial:k,MeshDistanceMaterial:z,MeshBasicMaterial:mt,LineDashedMaterial:zi,LineBasicMaterial:we,Material:N}),Ks={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},Js=new Ui,Zs={};Object.assign(Vi.prototype,{load:function(a,t,e,i){void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);var s=this,r=Ks.get(a);if(void 0!==r)return s.manager.itemStart(a),setTimeout(function(){t&&t(r),s.manager.itemEnd(a)},0),r;if(void 0===Zs[a]){if(o=a.match(/^data:(.*?)(;base64)?,(.*)$/)){e=o[1];var n=!!o[2],o=o[3],o=window.decodeURIComponent(o);n&&(o=window.atob(o));try{var l,c=(this.responseType||"").toLowerCase();switch(c){case"arraybuffer":case"blob":for(var h=new Uint8Array(o.length),n=0;n<o.length;n++)h[n]=o.charCodeAt(n);l="blob"===c?new Blob([h.buffer],{type:e}):h.buffer;break;case"document":l=(new DOMParser).parseFromString(o,e);break;case"json":l=JSON.parse(o);break;default:l=o}window.setTimeout(function(){t&&t(l),s.manager.itemEnd(a)},0)}catch(t){window.setTimeout(function(){i&&i(t),s.manager.itemEnd(a),s.manager.itemError(a)},0)}}else{Zs[a]=[],Zs[a].push({onLoad:t,onProgress:e,onError:i});var u=new XMLHttpRequest;for(n in u.open("GET",a,!0),u.addEventListener("load",function(t){var e=this.response;Ks.add(a,e);var i=Zs[a];if(delete Zs[a],200===this.status){for(var r=0,n=i.length;r<n;r++){var o=i[r];o.onLoad&&o.onLoad(e)}s.manager.itemEnd(a)}else if(0===this.status){for(console.warn("THREE.FileLoader: HTTP Status 0 received."),r=0,n=i.length;r<n;r++)(o=i[r]).onLoad&&o.onLoad(e);s.manager.itemEnd(a)}else{for(r=0,n=i.length;r<n;r++)(o=i[r]).onError&&o.onError(t);s.manager.itemEnd(a),s.manager.itemError(a)}},!1),u.addEventListener("progress",function(t){for(var e=Zs[a],i=0,r=e.length;i<r;i++){var n=e[i];n.onProgress&&n.onProgress(t)}},!1),u.addEventListener("error",function(t){var e=Zs[a];delete Zs[a];for(var i=0,r=e.length;i<r;i++){var n=e[i];n.onError&&n.onError(t)}s.manager.itemEnd(a),s.manager.itemError(a)},!1),void 0!==this.responseType&&(u.responseType=this.responseType),void 0!==this.withCredentials&&(u.withCredentials=this.withCredentials),u.overrideMimeType&&u.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)u.setRequestHeader(n,this.requestHeader[n]);u.send(null)}return s.manager.itemStart(a),u}Zs[a].push({onLoad:t,onProgress:e,onError:i})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(Bi.prototype,{load:function(t,n,i,r){var o=this,a=[],s=new Ce;s.image=a;var l=new Vi(this.manager);if(l.setPath(this.path),l.setResponseType("arraybuffer"),Array.isArray(t))for(var c=0,e=0,h=t.length;e<h;++e)!function(e){l.load(t[e],function(t){t=o._parser(t,!0),a[e]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(c+=1)&&(1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,n&&n(s))},i,r)}(e);else l.load(t,function(t){if((t=o._parser(t,!0)).isCubemap)for(var e=t.mipmaps.length/t.mipmapCount,i=0;i<e;i++){a[i]={mipmaps:[]};for(var r=0;r<t.mipmapCount;r++)a[i].mipmaps.push(t.mipmaps[i*t.mipmapCount+r]),a[i].format=t.format,a[i].width=t.width,a[i].height=t.height}else s.image.width=t.width,s.image.height=t.height,s.mipmaps=t.mipmaps;1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,n&&n(s)},i,r);return s},setPath:function(t){return this.path=t,this}}),Object.assign(Hi.prototype,{load:function(t,e,i,r){var n=this,o=new Et,a=new Vi(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){(t=n._parser(t))&&(void 0!==t.image?o.image=t.image:void 0!==t.data&&(o.image.width=t.width,o.image.height=t.height,o.image.data=t.data),o.wrapS=void 0!==t.wrapS?t.wrapS:1001,o.wrapT=void 0!==t.wrapT?t.wrapT:1001,o.magFilter=void 0!==t.magFilter?t.magFilter:1006,o.minFilter=void 0!==t.minFilter?t.minFilter:1008,o.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(o.format=t.format),void 0!==t.type&&(o.type=t.type),void 0!==t.mipmaps&&(o.mipmaps=t.mipmaps),1===t.mipmapCount&&(o.minFilter=1006),o.needsUpdate=!0,e&&e(o,t))},i,r),o}}),Object.assign(Gi.prototype,{crossOrigin:"Anonymous",load:function(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var n=this,o=Ks.get(e);return void 0!==o?(n.manager.itemStart(e),setTimeout(function(){t&&t(o),n.manager.itemEnd(e)},0),o):((i=document.createElementNS("http://www.w3.org/1999/xhtml","img")).addEventListener("load",function(){Ks.add(e,this),t&&t(this),n.manager.itemEnd(e)},!1),i.addEventListener("error",function(t){r&&r(t),n.manager.itemEnd(e),n.manager.itemError(e)},!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(i.crossOrigin=this.crossOrigin),n.manager.itemStart(e),i.src=e,i)},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Wi.prototype,{crossOrigin:"Anonymous",load:function(t,i,e,r){var n=new l,o=new Gi(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;for(e=0;e<t.length;++e)!function(e){o.load(t[e],function(t){n.images[e]=t,6===++a&&(n.needsUpdate=!0,i&&i(n))},void 0,r)}(e);return n},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Xi.prototype,{crossOrigin:"Anonymous",load:function(e,i,t,r){var n=new p,o=new Gi(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(t){n.image=t,t=0<e.search(/\.(jpg|jpeg)$/)||0===e.search(/^data\:image\/jpeg/),n.format=t?1022:1023,n.needsUpdate=!0,void 0!==i&&i(n)},t,r),n},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(qi.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){t=this.getUtoTmapping(t);return this.getPoint(t,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,r=[],n=this.getPoint(0),o=0;for(r.push(0),i=1;i<=t;i++)o+=(e=this.getPoint(i/t)).distanceTo(n),r.push(o),n=e;return this.cacheArcLengths=r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){for(var i,r=this.getLengths(),n=0,o=r.length,a=e||t*r[o-1],s=0,l=o-1;s<=l;)if((i=r[n=Math.floor(s+(l-s)/2)]-a)<0)s=n+1;else{if(!(0<i)){l=n;break}l=n-1}return r[n=l]===a?n/(o-1):(n+(a-(s=r[n]))/(r[n+1]-s))/(o-1)},getTangent:function(t){var e=t-1e-4;return 1<(t+=1e-4)&&(t=1),e=this.getPoint(e=e<0?0:e),this.getPoint(t).clone().sub(e).normalize()},getTangentAt:function(t){return t=this.getUtoTmapping(t),this.getTangent(t)},computeFrenetFrames:function(t,e){for(var i=new _t,r=[],n=[],o=[],a=new _t,s=new Mt,l=0;l<=t;l++)r[l]=this.getTangentAt(c=l/t),r[l].normalize();n[0]=new _t,o[0]=new _t,l=Number.MAX_VALUE;var c=Math.abs(r[0].x),h=Math.abs(r[0].y),u=Math.abs(r[0].z);for(c<=l&&(l=c,i.set(1,0,0)),h<=l&&(l=h,i.set(0,1,0)),u<=l&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),n[0].crossVectors(r[0],a),o[0].crossVectors(r[0],n[0]),l=1;l<=t;l++)n[l]=n[l-1].clone(),o[l]=o[l-1].clone(),a.crossVectors(r[l-1],r[l]),a.length()>Number.EPSILON&&(a.normalize(),i=Math.acos(io.clamp(r[l-1].dot(r[l]),-1,1)),n[l].applyMatrix4(s.makeRotationAxis(a,i))),o[l].crossVectors(r[l],n[l]);if(!0===e)for(i=Math.acos(io.clamp(n[0].dot(n[t]),-1,1)),i/=t,0<r[0].dot(a.crossVectors(n[0],n[t]))&&(i=-i),l=1;l<=t;l++)n[l].applyMatrix4(s.makeRotationAxis(r[l],i*l)),o[l].crossVectors(r[l],n[l]);return{tangents:r,normals:n,binormals:o}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),((Yi.prototype=Object.create(qi.prototype)).constructor=Yi).prototype.isEllipseCurve=!0,Yi.prototype.getPoint=function(t,e){for(var i=e||new q,r=2*Math.PI,n=this.aEndAngle-this.aStartAngle,o=Math.abs(n)<Number.EPSILON;n<0;)n+=r;for(;r<n;)n-=r;n<Number.EPSILON&&(n=o?0:r),!0!==this.aClockwise||o||(n=n===r?-r:n-r);n=this.aStartAngle+t*n,r=this.aX+this.xRadius*Math.cos(n),e=this.aY+this.yRadius*Math.sin(n);return 0!==this.aRotation&&(n=Math.cos(this.aRotation),o=Math.sin(this.aRotation),r=(t=r-this.aX)*n-(e-=this.aY)*o+this.aX,e=t*o+e*n+this.aY),i.set(r,e)},Yi.prototype.copy=function(t){return qi.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Yi.prototype.toJSON=function(){var t=qi.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Yi.prototype.fromJSON=function(t){return qi.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},((Ki.prototype=Object.create(Yi.prototype)).constructor=Ki).prototype.isArcCurve=!0;var Qs=new _t,$s=new Ji,tl=new Ji,el=new Ji;((Zi.prototype=Object.create(qi.prototype)).constructor=Zi).prototype.isCatmullRomCurve3=!0,Zi.prototype.getPoint=function(t,e){var i,r,n=e||new _t,o=this.points,a=o.length,s=(a-(this.closed?0:1))*t,l=Math.floor(s),s=s-l;return this.closed?l+=0<l?0:(Math.floor(Math.abs(l)/o.length)+1)*o.length:0===s&&l===a-1&&(l=a-2,s=1),i=this.closed||0<l?o[(l-1)%a]:(Qs.subVectors(o[0],o[1]).add(o[0]),Qs),r=o[l%a],e=o[(l+1)%a],o=this.closed||l+2<a?o[(l+2)%a]:(Qs.subVectors(o[a-1],o[a-2]).add(o[a-1]),Qs),"centripetal"===this.curveType||"chordal"===this.curveType?(t="chordal"===this.curveType?.5:.25,a=Math.pow(i.distanceToSquared(r),t),(l=Math.pow(r.distanceToSquared(e),t))<1e-4&&(l=1),a<1e-4&&(a=l),(t=Math.pow(e.distanceToSquared(o),t))<1e-4&&(t=l),$s.initNonuniformCatmullRom(i.x,r.x,e.x,o.x,a,l,t),tl.initNonuniformCatmullRom(i.y,r.y,e.y,o.y,a,l,t),el.initNonuniformCatmullRom(i.z,r.z,e.z,o.z,a,l,t)):"catmullrom"===this.curveType&&($s.initCatmullRom(i.x,r.x,e.x,o.x,this.tension),tl.initCatmullRom(i.y,r.y,e.y,o.y,this.tension),el.initCatmullRom(i.z,r.z,e.z,o.z,this.tension)),n.set($s.calc(s),tl.calc(s),el.calc(s)),n},Zi.prototype.copy=function(t){qi.prototype.copy.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Zi.prototype.toJSON=function(){var t=qi.prototype.toJSON.call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Zi.prototype.fromJSON=function(t){qi.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var r=t.points[e];this.points.push((new _t).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},((er.prototype=Object.create(qi.prototype)).constructor=er).prototype.isCubicBezierCurve=!0,er.prototype.getPoint=function(t,e){var i=e||new q,r=this.v0,n=this.v1,o=this.v2,e=this.v3;return i.set(tr(t,r.x,n.x,o.x,e.x),tr(t,r.y,n.y,o.y,e.y)),i},er.prototype.copy=function(t){return qi.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},er.prototype.toJSON=function(){var t=qi.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},er.prototype.fromJSON=function(t){return qi.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},((ir.prototype=Object.create(qi.prototype)).constructor=ir).prototype.isCubicBezierCurve3=!0,ir.prototype.getPoint=function(t,e){var i=e||new _t,r=this.v0,n=this.v1,o=this.v2,e=this.v3;return i.set(tr(t,r.x,n.x,o.x,e.x),tr(t,r.y,n.y,o.y,e.y),tr(t,r.z,n.z,o.z,e.z)),i},ir.prototype.copy=function(t){return qi.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ir.prototype.toJSON=function(){var t=qi.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ir.prototype.fromJSON=function(t){return qi.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},((rr.prototype=Object.create(qi.prototype)).constructor=rr).prototype.isLineCurve=!0,rr.prototype.getPoint=function(t,e){e=e||new q;return 1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},rr.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},rr.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},rr.prototype.copy=function(t){return qi.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},rr.prototype.toJSON=function(){var t=qi.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},rr.prototype.fromJSON=function(t){return qi.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((nr.prototype=Object.create(qi.prototype)).constructor=nr).prototype.isLineCurve3=!0,nr.prototype.getPoint=function(t,e){e=e||new _t;return 1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},nr.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},nr.prototype.copy=function(t){return qi.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},nr.prototype.toJSON=function(){var t=qi.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},nr.prototype.fromJSON=function(t){return qi.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((or.prototype=Object.create(qi.prototype)).constructor=or).prototype.isQuadraticBezierCurve=!0,or.prototype.getPoint=function(t,e){var i=e||new q,r=this.v0,n=this.v1,e=this.v2;return i.set($i(t,r.x,n.x,e.x),$i(t,r.y,n.y,e.y)),i},or.prototype.copy=function(t){return qi.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},or.prototype.toJSON=function(){var t=qi.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},or.prototype.fromJSON=function(t){return qi.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((ar.prototype=Object.create(qi.prototype)).constructor=ar).prototype.isQuadraticBezierCurve3=!0,ar.prototype.getPoint=function(t,e){var i=e||new _t,r=this.v0,n=this.v1,e=this.v2;return i.set($i(t,r.x,n.x,e.x),$i(t,r.y,n.y,e.y),$i(t,r.z,n.z,e.z)),i},ar.prototype.copy=function(t){return qi.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ar.prototype.toJSON=function(){var t=qi.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ar.prototype.fromJSON=function(t){return qi.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((sr.prototype=Object.create(qi.prototype)).constructor=sr).prototype.isSplineCurve=!0,sr.prototype.getPoint=function(t,e){var i=e||new q,r=((a=this.points).length-1)*t,n=Math.floor(r),o=a[0===n?n:n-1],e=a[n],t=a[n>a.length-2?a.length-1:n+1],a=a[n>a.length-3?a.length-1:n+2];return i.set(Qi(r=r-n,o.x,e.x,t.x,a.x),Qi(r,o.y,e.y,t.y,a.y)),i},sr.prototype.copy=function(t){qi.prototype.copy.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++)this.points.push(t.points[e].clone());return this},sr.prototype.toJSON=function(){var t=qi.prototype.toJSON.call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++)t.points.push(this.points[e].toArray());return t},sr.prototype.fromJSON=function(t){qi.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var r=t.points[e];this.points.push((new q).fromArray(r))}return this};var il=Object.freeze({ArcCurve:Ki,CatmullRomCurve3:Zi,CubicBezierCurve:er,CubicBezierCurve3:ir,EllipseCurve:Yi,LineCurve:rr,LineCurve3:nr,QuadraticBezierCurve:or,QuadraticBezierCurve3:ar,SplineCurve:sr});lr.prototype=Object.assign(Object.create(qi.prototype),{constructor:lr,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new rr(e,t))},getPoint:function(t){var e=t*this.getLength(),i=this.getCurveLengths();for(t=0;t<i.length;){if(i[t]>=e)return e=i[t]-e,i=(t=this.curves[t]).getLength(),t.getPointAt(0===i?0:1-e/i);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0,r=this.curves.length;i<r;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,i=[],r=0,n=this.curves;r<n.length;r++)for(var o=(o=n[r]).getPoints(o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t),a=0;a<o.length;a++){var s=o[a];e&&e.equals(s)||(i.push(s),e=s)}return this.autoClose&&1<i.length&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(t){qi.prototype.copy.call(this,t),this.curves=[];for(var e=0,i=t.curves.length;e<i;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this},toJSON:function(){var t=qi.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,i=this.curves.length;e<i;e++)t.curves.push(this.curves[e].toJSON());return t},fromJSON:function(t){qi.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,i=t.curves.length;e<i;e++){var r=t.curves[e];this.curves.push((new il[r.type]).fromJSON(r))}return this}}),cr.prototype=Object.assign(Object.create(lr.prototype),{constructor:cr,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var i=new rr(this.currentPoint.clone(),new q(t,e));this.curves.push(i),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,i,r){t=new or(this.currentPoint.clone(),new q(t,e),new q(i,r)),this.curves.push(t),this.currentPoint.set(i,r)},bezierCurveTo:function(t,e,i,r,n,o){t=new er(this.currentPoint.clone(),new q(t,e),new q(i,r),new q(n,o)),this.curves.push(t),this.currentPoint.set(n,o)},splineThru:function(t){var e=new sr(e=[this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,i,r,n,o){this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,i,r,n,o)},absarc:function(t,e,i,r,n,o){this.absellipse(t,e,i,i,r,n,o)},ellipse:function(t,e,i,r,n,o,a,s){this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,i,r,n,o,a,s)},absellipse:function(t,e,i,r,n,o,a,s){t=new Yi(t,e,i,r,n,o,a,s),0<this.curves.length&&((e=t.getPoint(0)).equals(this.currentPoint)||this.lineTo(e.x,e.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t)},copy:function(t){return lr.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=lr.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return lr.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),hr.prototype=Object.assign(Object.create(cr.prototype),{constructor:hr,getPointsHoles:function(t){for(var e=[],i=0,r=this.holes.length;i<r;i++)e[i]=this.holes[i].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){cr.prototype.copy.call(this,t),this.holes=[];for(var e=0,i=t.holes.length;e<i;e++)this.holes.push(t.holes[e].clone());return this},toJSON:function(){var t=cr.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,i=this.holes.length;e<i;e++)t.holes.push(this.holes[e].toJSON());return t},fromJSON:function(t){cr.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,i=t.holes.length;e<i;e++){var r=t.holes[e];this.holes.push((new cr).fromJSON(r))}return this}}),ur.prototype=Object.assign(Object.create(X.prototype),{constructor:ur,isLight:!0,copy:function(t){return X.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return(t=X.prototype.toJSON.call(this,t)).object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),pr.prototype=Object.assign(Object.create(ur.prototype),{constructor:pr,isHemisphereLight:!0,copy:function(t){return ur.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(dr.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),fr.prototype=Object.assign(Object.create(dr.prototype),{constructor:fr,isSpotLightShadow:!0,update:function(t){var e=this.camera,i=2*io.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height;t=t.distance||e.far,i===e.fov&&r===e.aspect&&t===e.far||(e.fov=i,e.aspect=r,e.far=t,e.updateProjectionMatrix())}}),mr.prototype=Object.assign(Object.create(ur.prototype),{constructor:mr,isSpotLight:!0,copy:function(t){return ur.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),gr.prototype=Object.assign(Object.create(ur.prototype),{constructor:gr,isPointLight:!0,copy:function(t){return ur.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),vr.prototype=Object.assign(Object.create(dr.prototype),{constructor:vr}),yr.prototype=Object.assign(Object.create(ur.prototype),{constructor:yr,isDirectionalLight:!0,copy:function(t){return ur.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),br.prototype=Object.assign(Object.create(ur.prototype),{constructor:br,isAmbientLight:!0}),xr.prototype=Object.assign(Object.create(ur.prototype),{constructor:xr,isRectAreaLight:!0,copy:function(t){return ur.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){return(t=ur.prototype.toJSON.call(this,t)).object.width=this.width,t.object.height=this.height,t}}),wr.prototype=Object.assign(Object.create(Rr.prototype),{constructor:wr,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Mr.prototype=Object.assign(Object.create(Rr.prototype),{constructor:Mr,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(_r.prototype,{evaluate:function(t){var e=this.parameterPositions,i=this._cachedIndex,r=e[i],n=e[i-1];t:{e:{i:{r:if(!(t<r)){for(var o=i+2;;){if(void 0===r){if(t<n)break r;return this._cachedIndex=i=e.length,this.afterEnd_(i-1,t,n)}if(i===o)break;if(n=r,t<(r=e[++i]))break e}r=e.length;break i}if(n<=t)break t;for(t<(o=e[1])&&(i=2,n=o),o=i-2;;){if(void 0===n)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(i===o)break;if(r=n,(n=e[--i-1])<=t)break e}r=i,i=0}for(;i<r;)t<e[n=i+r>>>1]?r=n:i=n+1;if(r=e[i],void 0===(n=e[i-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return this._cachedIndex=i=e.length,this.afterEnd_(i-1,n,t)}this._cachedIndex=i,this.intervalChanged_(i,n,r)}return this.interpolate_(i,n,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var e=this.resultBuffer,i=this.sampleValues,r=this.valueSize;t*=r;for(var n=0;n!==r;++n)e[n]=i[t+n];return e},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(_r.prototype,{beforeStart_:_r.prototype.copySampleValue_,afterEnd_:_r.prototype.copySampleValue_}),Ar.prototype=Object.assign(Object.create(_r.prototype),{constructor:Ar,interpolate_:function(t,e,i,r){var n=this.resultBuffer,o=this.sampleValues,a=this.valueSize;for(e=(i-e)/(r-e),i=(t*=a)+a;t!==i;t+=4)s.slerpFlat(n,0,o,t-a,o,t,e);return n}}),Er.prototype=Object.assign(Object.create(Rr.prototype),{constructor:Er,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new Ar(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Sr.prototype=Object.assign(Object.create(Rr.prototype),{constructor:Sr,ValueTypeName:"color"}),Pr.prototype=Object.assign(Object.create(Rr.prototype),{constructor:Pr,ValueTypeName:"number"}),Tr.prototype=Object.assign(Object.create(_r.prototype),{constructor:Tr,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,i){var r=this.parameterPositions,n=t-2,o=t+1,a=r[n],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:n=t,a=2*e-i;break;case 2402:a=e+r[n=r.length-2]-r[n+1];break;default:n=t,a=i}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=t,s=2*i-e;break;case 2402:s=i+r[o=1]-r[0];break;default:o=t-1,s=e}r=this.valueSize,this._weightPrev=(t=.5*(i-e))/(e-a),this._weightNext=t/(s-i),this._offsetPrev=n*r,this._offsetNext=o*r},interpolate_:function(t,e,i,r){var n=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(t*=a)-a,l=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,u=this._weightNext,p=(i-e)/(r-e);for(e=-h*(r=(i=p*p)*p)+2*h*i-h*p,h=(1+h)*r+(-1.5-2*h)*i+(-.5+h)*p+1,p=(-1-u)*r+(1.5+u)*i+.5*p,u=u*r-u*i,i=0;i!==a;++i)n[i]=e*o[l+i]+h*o[s+i]+p*o[t+i]+u*o[c+i];return n}}),Cr.prototype=Object.assign(Object.create(_r.prototype),{constructor:Cr,interpolate_:function(t,e,i,r){var n=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(t*=a)-a;for(i=1-(e=(i-e)/(r-e)),r=0;r!==a;++r)n[r]=o[s+r]*i+o[t+r]*e;return n}}),Or.prototype=Object.assign(Object.create(_r.prototype),{constructor:Or,interpolate_:function(t){return this.copySampleValue_(t-1)}});var rl={arraySlice:function(t,e,i){return rl.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==i?i:t.length)):t.slice(e,i)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(i){for(var t=i.length,e=Array(t),r=0;r!==t;++r)e[r]=r;return e.sort(function(t,e){return i[t]-i[e]}),e},sortedArray:function(t,e,i){for(var r=t.length,n=new t.constructor(r),o=0,a=0;a!==r;++o)for(var s=i[o]*e,l=0;l!==e;++l)n[a++]=t[s+l];return n},flattenJSON:function(t,e,i,r){for(var n=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[n++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))for(;void 0!==(a=o[r])&&(e.push(o.time),i.push.apply(i,a)),void 0!==(o=t[n++]););else if(void 0!==a.toArray)for(;void 0!==(a=o[r])&&(e.push(o.time),a.toArray(i,i.length)),void 0!==(o=t[n++]););else for(;void 0!==(a=o[r])&&(e.push(o.time),i.push(a)),void 0!==(o=t[n++]););}}};Object.assign(Rr,{parse:function(t){if(void 0===t.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var e,i,r=Rr._getTrackTypeForValueTypeName(t.type);return void 0===t.times&&(rl.flattenJSON(t.keys,e=[],i=[],"value"),t.times=e,t.values=i),void 0!==r.parse?r.parse(t):new r(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,i=t.constructor;return void 0!==i.toJSON?i=i.toJSON(t):(i={name:t.name,times:rl.convertArray(t.times,Array),values:rl.convertArray(t.values,Array)},(e=t.getInterpolation())!==t.DefaultInterpolation&&(i.interpolation=e)),i.type=t.ValueTypeName,i},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Pr;case"vector":case"vector2":case"vector3":case"vector4":return Lr;case"color":return Sr;case"quaternion":return Er;case"bool":case"boolean":return Mr;case"string":return wr}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}}),Object.assign(Rr.prototype,{constructor:Rr,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new Or(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Cr(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Tr(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){if(e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw Error(e);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",e)}else this.createInterpolant=e},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,i=0,r=e.length;i!==r;++i)e[i]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,i=0,r=e.length;i!==r;++i)e[i]*=t;return this},trim:function(t,e){for(var i=this.times,r=i.length,n=0,o=r-1;n!==r&&i[n]<t;)++n;for(;-1!==o&&i[o]>e;)--o;return++o,0===n&&o===r||(o<=n&&(n=(o=Math.max(o,1))-1),r=this.getValueSize(),this.times=rl.arraySlice(i,n,o),this.values=rl.arraySlice(this.values,n*r,o*r)),this},validate:function(){var t=!0;0!=(i=this.getValueSize())-Math.floor(i)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var e=this.times,i=this.values,r=e.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var n=null,o=0;o!==r;o++){var a=e[o];if("number"==typeof a&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,a),t=!1;break}if(null!==n&&a<n){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,a,n),t=!1;break}n=a}if(void 0!==i&&rl.isTypedArray(i))for(o=0,e=i.length;o!==e;++o)if(r=i[o],isNaN(r)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,r),t=!1;break}return t},optimize:function(){for(var t=this.times,e=this.values,i=this.getValueSize(),r=2302===this.getInterpolation(),n=1,o=t.length-1,a=1;a<o;++a){var s=!1;if((u=t[a])!==t[a+1]&&(1!==a||u!==u[0]))if(r)s=!0;else for(var l=a*i,c=l-i,h=l+i,u=0;u!==i;++u){var p=e[l+u];if(p!==e[c+u]||p!==e[h+u]){s=!0;break}}if(s){if(a!==n)for(t[n]=t[a],s=a*i,l=n*i,u=0;u!==i;++u)e[l+u]=e[s+u];++n}}if(0<o){for(t[n]=t[o],s=o*i,l=n*i,u=0;u!==i;++u)e[l+u]=e[s+u];++n}return n!==t.length&&(this.times=rl.arraySlice(t,0,n),this.values=rl.arraySlice(e,0,n*i)),this}}),Lr.prototype=Object.assign(Object.create(Rr.prototype),{constructor:Lr,ValueTypeName:"vector"}),Object.assign(Ir,{parse:function(t){for(var e=[],i=t.tracks,r=1/(t.fps||1),n=0,o=i.length;n!==o;++n)e.push(Rr.parse(i[n]).scale(r));return new Ir(t.name,t.duration,e)},toJSON:function(t){var e=[],i=t.tracks;t={name:t.name,duration:t.duration,tracks:e};for(var r=0,n=i.length;r!==n;++r)e.push(Rr.toJSON(i[r]));return t},CreateFromMorphTargetSequence:function(t,e,i,r){for(var n=e.length,o=[],a=0;a<n;a++){var s=[];(c=[]).push((a+n-1)%n,a,(a+1)%n),s.push(0,1,0);var l=rl.getKeyframeOrder(c),c=rl.sortedArray(c,1,l),s=rl.sortedArray(s,1,l);r||0!==c[0]||(c.push(n),s.push(s[0])),o.push(new Pr(".morphTargetInfluences["+e[a].name+"]",c,s).scale(1/i))}return new Ir(t,-1,o)},findByName:function(t,e){var i=t;Array.isArray(t)||(i=t.geometry&&t.geometry.animations||t.animations);for(var r=0;r<i.length;r++)if(i[r].name===e)return i[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,i){for(var r={},n=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s,l=t[o],c=l.name.match(n);c&&1<c.length&&((c=r[s=c[1]])||(r[s]=c=[]),c.push(l))}for(s in t=[],r)t.push(Ir.CreateFromMorphTargetSequence(s,r[s],e,i));return t},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;function i(t,e,i,r,n){var o;0!==i.length&&(rl.flattenJSON(i,o=[],i=[],r),0!==o.length&&n.push(new t(e,o,i)))}for(var r=[],n=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],l=0;l<s.length;l++){var c=s[l].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var h,o={},u=0;u<c.length;u++)if(c[u].morphTargets)for(var p=0;p<c[u].morphTargets.length;p++)o[c[u].morphTargets[p]]=-1;for(h in o){for(var d=[],f=[],p=0;p!==c[u].morphTargets.length;++p){var m=c[u];d.push(m.time),f.push(m.morphTarget===h?1:0)}r.push(new Pr(".morphTargetInfluence["+h+"]",d,f))}o=o.length*(a||1)}else i(Lr,(u=".bones["+e[l].name+"]")+".position",c,"pos",r),i(Er,u+".quaternion",c,"rot",r),i(Lr,u+".scale",c,"scl",r)}return 0===r.length?null:new Ir(n,o,r)}}),Object.assign(Ir.prototype,{resetDuration:function(){for(var t=0,e=0,i=this.tracks.length;e!==i;++e)var r=this.tracks[e],t=Math.max(t,r.times[r.times.length-1]);this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}}),Object.assign(Dr.prototype,{load:function(t,e,i,r){var n=this;new Vi(n.manager).load(t,function(t){e(n.parse(JSON.parse(t)))},i,r)},setTextures:function(t){this.textures=t},parse:function(t){function e(t){return void 0===r[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),r[t]}var i,r=this.textures,n=new Ys[t.type];return void 0!==t.uuid&&(n.uuid=t.uuid),void 0!==t.name&&(n.name=t.name),void 0!==t.color&&n.color.setHex(t.color),void 0!==t.roughness&&(n.roughness=t.roughness),void 0!==t.metalness&&(n.metalness=t.metalness),void 0!==t.emissive&&n.emissive.setHex(t.emissive),void 0!==t.specular&&n.specular.setHex(t.specular),void 0!==t.shininess&&(n.shininess=t.shininess),void 0!==t.clearCoat&&(n.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(n.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(n.uniforms=t.uniforms),void 0!==t.vertexShader&&(n.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(n.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(n.vertexColors=t.vertexColors),void 0!==t.fog&&(n.fog=t.fog),void 0!==t.flatShading&&(n.flatShading=t.flatShading),void 0!==t.blending&&(n.blending=t.blending),void 0!==t.side&&(n.side=t.side),void 0!==t.opacity&&(n.opacity=t.opacity),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.alphaTest&&(n.alphaTest=t.alphaTest),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(n.colorWrite=t.colorWrite),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(n.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(n.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(n.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(n.rotation=t.rotation),1!==t.linewidth&&(n.linewidth=t.linewidth),void 0!==t.dashSize&&(n.dashSize=t.dashSize),void 0!==t.gapSize&&(n.gapSize=t.gapSize),void 0!==t.scale&&(n.scale=t.scale),void 0!==t.skinning&&(n.skinning=t.skinning),void 0!==t.morphTargets&&(n.morphTargets=t.morphTargets),void 0!==t.dithering&&(n.dithering=t.dithering),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.shading&&(n.flatShading=1===t.shading),void 0!==t.size&&(n.size=t.size),void 0!==t.sizeAttenuation&&(n.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(n.map=e(t.map)),void 0!==t.alphaMap&&(n.alphaMap=e(t.alphaMap),n.transparent=!0),void 0!==t.bumpMap&&(n.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(n.bumpScale=t.bumpScale),void 0!==t.normalMap&&(n.normalMap=e(t.normalMap)),void 0!==t.normalScale&&(i=t.normalScale,!1===Array.isArray(i)&&(i=[i,i]),n.normalScale=(new q).fromArray(i)),void 0!==t.displacementMap&&(n.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(n.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(n.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(n.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(n.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(n.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(n.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(n.specularMap=e(t.specularMap)),void 0!==t.envMap&&(n.envMap=e(t.envMap)),void 0!==t.reflectivity&&(n.reflectivity=t.reflectivity),void 0!==t.lightMap&&(n.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(n.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(n.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(n.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(n.gradientMap=e(t.gradientMap)),n}}),Object.assign(Fr.prototype,{load:function(t,e,i,r){var n=this;new Vi(n.manager).load(t,function(t){e(n.parse(JSON.parse(t)))},i,r)},parse:function(t){var e=new ht;void 0!==(o=t.data.index)&&(o=new ll[o.type](o.array),e.setIndex(new Q(o,1)));var i,r=t.data.attributes;for(i in r){var n=r[i],o=new ll[n.type](n.array);e.addAttribute(i,new Q(o,n.itemSize,n.normalized))}if(void 0!==(i=t.data.groups||t.data.drawcalls||t.data.offsets))for(o=0,r=i.length;o!==r;++o)n=i[o],e.addGroup(n.start,n.count,n.materialIndex);return void 0!==(t=t.data.boundingSphere)&&(i=new _t,void 0!==t.center&&i.fromArray(t.center),e.boundingSphere=new V(i,t.radius)),e}});var nl,ol,al,sl,ll={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};jr.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,i=0,r=e.length;i<r;i+=2){var n=e[i+1];if(e[i].test(t))return n}return null}},Object.assign(jr.prototype,{crossOrigin:void 0,initMaterials:function(t,e,i){for(var r=[],n=0;n<t.length;++n)r[n]=this.createMaterial(t[n],e,i);return r},createMaterial:(nl={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},ol=new j,al=new Xi,sl=new Dr,function(t,a,s){function e(t,e,i,r,n){var o=jr.Handlers.get(t=a+t);return t=null!==o?o.load(t):(al.setCrossOrigin(s),al.load(t)),void 0!==e&&(t.repeat.fromArray(e),1!==e[0]&&(t.wrapS=1e3),1!==e[1]&&(t.wrapT=1e3)),void 0!==i&&t.offset.fromArray(i),void 0!==r&&("repeat"===r[0]&&(t.wrapS=1e3),"mirror"===r[0]&&(t.wrapS=1002),"repeat"===r[1]&&(t.wrapT=1e3),"mirror"===r[1]&&(t.wrapT=1002)),void 0!==n&&(t.anisotropy=n),e=io.generateUUID(),l[e]=t,e}var i,l={},r={uuid:io.generateUUID(),type:"MeshLambertMaterial"};for(i in t){var n=t[i];switch(i){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":r.name=n;break;case"blending":r.blending=nl[n];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",i,"is no longer supported.");break;case"colorDiffuse":r.color=ol.fromArray(n).getHex();break;case"colorSpecular":r.specular=ol.fromArray(n).getHex();break;case"colorEmissive":r.emissive=ol.fromArray(n).getHex();break;case"specularCoef":r.shininess=n;break;case"shading":"basic"===n.toLowerCase()&&(r.type="MeshBasicMaterial"),"phong"===n.toLowerCase()&&(r.type="MeshPhongMaterial"),"standard"===n.toLowerCase()&&(r.type="MeshStandardMaterial");break;case"mapDiffuse":r.map=e(n,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":r.emissiveMap=e(n,t.mapEmissiveRepeat,t.mapEmissiveOffset,t.mapEmissiveWrap,t.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":r.lightMap=e(n,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":r.aoMap=e(n,t.mapAORepeat,t.mapAOOffset,t.mapAOWrap,t.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":r.bumpMap=e(n,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy);break;case"mapBumpScale":r.bumpScale=n;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":r.normalMap=e(n,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy);break;case"mapNormalFactor":r.normalScale=[n,n];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":r.specularMap=e(n,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":r.metalnessMap=e(n,t.mapMetalnessRepeat,t.mapMetalnessOffset,t.mapMetalnessWrap,t.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":r.roughnessMap=e(n,t.mapRoughnessRepeat,t.mapRoughnessOffset,t.mapRoughnessWrap,t.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":r.alphaMap=e(n,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":r.side=1;break;case"doubleSided":r.side=2;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),r.opacity=n;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":r[i]=n;break;case"vertexColors":!0===n&&(r.vertexColors=2),"face"===n&&(r.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",i,n)}}return"MeshBasicMaterial"===r.type&&delete r.emissive,"MeshPhongMaterial"!==r.type&&delete r.specular,r.opacity<1&&(r.transparent=!0),sl.setTextures(l),sl.parse(r)})});var cl={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",i=0,r=t.length;i<r;i++)e+=String.fromCharCode(t[i]);return decodeURIComponent(escape(e))},extractUrlBase:function(t){return 1===(t=t.split("/")).length?"./":(t.pop(),t.join("/")+"/")}};Object.assign(Nr.prototype,{load:function(i,r,t,e){var n=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:cl.extractUrlBase(i),a=new Vi(this.manager);a.setWithCredentials(this.withCredentials),a.load(i,function(t){var e=(t=JSON.parse(t)).metadata;if(void 0!==e&&void 0!==(e=e.type)){if("object"===e.toLowerCase())return void console.error("THREE.JSONLoader: "+i+" should be loaded with THREE.ObjectLoader instead.");if("scene"===e.toLowerCase())return void console.error("THREE.JSONLoader: "+i+" should be loaded with THREE.SceneLoader instead.")}t=n.parse(t,o),r(t.geometry,t.materials)},t,e)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){(t=void 0!==t.data?t.data:t).scale=void 0!==t.scale?1/t.scale:1;var i,r,n,o,a,s,l,c,h,u,p,d,f=new Z,m=t,g=m.faces,v=m.vertices,y=m.normals,b=m.colors,x=m.scale,w=0;if(void 0!==m.uvs){for(i=0;i<m.uvs.length;i++)m.uvs[i].length&&w++;for(i=0;i<w;i++)f.faceVertexUvs[i]=[]}for(o=0,a=v.length;o<a;)(i=new _t).x=v[o++]*x,i.y=v[o++]*x,i.z=v[o++]*x,f.vertices.push(i);for(o=0,a=g.length;o<a;)if(c=1&(v=g[o++]),n=2&v,i=8&v,s=16&v,h=32&v,x=64&v,v&=128,c){if((c=new J).a=g[o],c.b=g[o+1],c.c=g[o+3],(u=new J).a=g[o+1],u.b=g[o+2],u.c=g[o+3],o+=4,n&&(n=g[o++],c.materialIndex=n,u.materialIndex=n),n=f.faces.length,i)for(i=0;i<w;i++)for(p=m.uvs[i],f.faceVertexUvs[i][n]=[],f.faceVertexUvs[i][n+1]=[],r=0;r<4;r++)d=new q(d=p[2*(l=g[o++])],l=p[2*l+1]),2!==r&&f.faceVertexUvs[i][n].push(d),0!==r&&f.faceVertexUvs[i][n+1].push(d);if(s&&(s=3*g[o++],c.normal.set(y[s++],y[s++],y[s]),u.normal.copy(c.normal)),h)for(i=0;i<4;i++)s=3*g[o++],h=new _t(y[s++],y[s++],y[s]),2!==i&&c.vertexNormals.push(h),0!==i&&u.vertexNormals.push(h);if(x&&(x=b[x=g[o++]],c.color.setHex(x),u.color.setHex(x)),v)for(i=0;i<4;i++)x=b[x=g[o++]],2!==i&&c.vertexColors.push(new j(x)),0!==i&&u.vertexColors.push(new j(x));f.faces.push(c),f.faces.push(u)}else{if((c=new J).a=g[o++],c.b=g[o++],c.c=g[o++],n&&(n=g[o++],c.materialIndex=n),n=f.faces.length,i)for(i=0;i<w;i++)for(p=m.uvs[i],f.faceVertexUvs[i][n]=[],r=0;r<3;r++)d=new q(d=p[2*(l=g[o++])],l=p[2*l+1]),f.faceVertexUvs[i][n].push(d);if(s&&(s=3*g[o++],c.normal.set(y[s++],y[s++],y[s])),h)for(i=0;i<3;i++)s=3*g[o++],h=new _t(y[s++],y[s++],y[s]),c.vertexNormals.push(h);if(x&&(x=g[o++],c.color.setHex(b[x])),v)for(i=0;i<3;i++)x=g[o++],c.vertexColors.push(new j(b[x]));f.faces.push(c)}if(o=void 0!==(m=t).influencesPerVertex?m.influencesPerVertex:2,m.skinWeights)for(a=0,g=m.skinWeights.length;a<g;a+=o)f.skinWeights.push(new At(m.skinWeights[a],1<o?m.skinWeights[a+1]:0,2<o?m.skinWeights[a+2]:0,3<o?m.skinWeights[a+3]:0));if(m.skinIndices)for(a=0,g=m.skinIndices.length;a<g;a+=o)f.skinIndices.push(new At(m.skinIndices[a],1<o?m.skinIndices[a+1]:0,2<o?m.skinIndices[a+2]:0,3<o?m.skinIndices[a+3]:0));if(f.bones=m.bones,f.bones&&0<f.bones.length&&(f.skinWeights.length!==f.skinIndices.length||f.skinIndices.length!==f.vertices.length)&&console.warn("When skinning, number of vertices ("+f.vertices.length+"), skinIndices ("+f.skinIndices.length+"), and skinWeights ("+f.skinWeights.length+") should match."),g=(a=t).scale,void 0!==a.morphTargets)for(m=0,o=a.morphTargets.length;m<o;m++)for(f.morphTargets[m]={},f.morphTargets[m].name=a.morphTargets[m].name,f.morphTargets[m].vertices=[],y=f.morphTargets[m].vertices,w=0,v=(b=a.morphTargets[m].vertices).length;w<v;w+=3)(x=new _t).x=b[w]*g,x.y=b[w+1]*g,x.z=b[w+2]*g,y.push(x);if(void 0!==a.morphColors&&0<a.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),g=f.faces,a=a.morphColors[0].colors,m=0,o=g.length;m<o;m++)g[m].color.fromArray(a,3*m);for(m=[],o=[],void 0!==(a=t).animation&&o.push(a.animation),void 0!==a.animations&&(a.animations.length?o=o.concat(a.animations):o.push(a.animations)),a=0;a<o.length;a++)(g=Ir.parseAnimation(o[a],f.bones))&&m.push(g);return f.morphTargets&&(o=Ir.CreateClipsFromMorphTargetSequences(f.morphTargets,10),m=m.concat(o)),0<m.length&&(f.animations=m),f.computeFaceNormals(),f.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:f}:{geometry:f,materials:m=jr.prototype.initMaterials(t.materials,e,this.crossOrigin)}}}),Object.assign(kr.prototype,{load:function(i,r,t,n){""===this.texturePath&&(this.texturePath=i.substring(0,i.lastIndexOf("/")+1));var o=this;new Vi(o.manager).load(i,function(t){var e=null;try{e=JSON.parse(t)}catch(t){return void 0!==n&&n(t),void console.error("THREE:ObjectLoader: Can't parse "+i+".",t.message)}void 0===(t=e.metadata)||void 0===t.type||"geometry"===t.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+i+". Use THREE.JSONLoader instead."):o.parse(e,r)},t,n)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var i=this.parseShape(t.shapes),i=this.parseGeometries(t.geometries,i),r=this.parseImages(t.images,function(){void 0!==e&&e(n)}),r=this.parseTextures(t.textures,r),r=this.parseMaterials(t.materials,r),n=this.parseObject(t.object,i,r);return t.animations&&(n.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===e||e(n),n},parseShape:function(t){var e={};if(void 0!==t)for(var i=0,r=t.length;i<r;i++){var n=(new hr).fromJSON(t[i]);e[n.uuid]=n}return e},parseGeometries:function(t,e){var i={};if(void 0!==t)for(var r=new Nr,n=new Fr,o=0,a=t.length;o<a;o++){var s,l=t[o];switch(l.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new qs[l.type](l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new qs[l.type](l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new qs[l.type](l.radius,l.segments,l.thetaStart,l.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new qs[l.type](l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new qs[l.type](l.radius,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new qs[l.type](l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new qs[l.type](l.radius,l.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new qs[l.type](l.innerRadius,l.outerRadius,l.thetaSegments,l.phiSegments,l.thetaStart,l.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new qs[l.type](l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new qs[l.type](l.radius,l.tube,l.tubularSegments,l.radialSegments,l.p,l.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new qs[l.type](l.points,l.segments,l.phiStart,l.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new qs[l.type](l.vertices,l.indices,l.radius,l.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(s=[],o=0,a=l.shapes.length;o<a;o++)s.push(e[l.shapes[o]]);s=new qs[l.type](s,l.curveSegments);break;case"BufferGeometry":s=n.parse(l);break;case"Geometry":s=r.parse(l,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+l.type+'"');continue}s.uuid=l.uuid,void 0!==l.name&&(s.name=l.name),i[l.uuid]=s}return i},parseMaterials:function(t,e){var i={};if(void 0!==t){var r=new Dr;r.setTextures(e);for(var n=0,o=t.length;n<o;n++){var a=t[n];if("MultiMaterial"===a.type){for(var s=[],l=0;l<a.materials.length;l++)s.push(r.parse(a.materials[l]));i[a.uuid]=s}else i[a.uuid]=r.parse(a)}}return i},parseAnimations:function(t){for(var e=[],i=0;i<t.length;i++){var r=Ir.parse(t[i]);e.push(r)}return e},parseImages:function(t,e){var i=this,r={};if(void 0!==t&&0<t.length){var n=new Gi(o=new Ui(e));n.setCrossOrigin(this.crossOrigin);for(var o=0,a=t.length;o<a;o++){var s=t[o],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s.url)?s.url:i.texturePath+s.url;r[s.uuid]=function(t){return i.manager.itemStart(t),n.load(t,function(){i.manager.itemEnd(t)},void 0,function(){i.manager.itemEnd(t),i.manager.itemError(t)})}(l)}}return r},parseTextures:function(t,e){function i(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var n=0,o=t.length;n<o;n++){var a=t[n];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new p(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=i(a.mapping,hl)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.center&&s.center.fromArray(a.center),void 0!==a.rotation&&(s.rotation=a.rotation),void 0!==a.wrap&&(s.wrapS=i(a.wrap[0],ul),s.wrapT=i(a.wrap[1],ul)),void 0!==a.minFilter&&(s.minFilter=i(a.minFilter,pl)),void 0!==a.magFilter&&(s.magFilter=i(a.magFilter,pl)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),r[a.uuid]=s}return r},parseObject:function(t,e,o){function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function r(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],i=0,r=t.length;i<r;i++){var n=t[i];void 0===o[n]&&console.warn("THREE.ObjectLoader: Undefined material",n),e.push(o[n])}return e}return void 0===o[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),o[t]}}switch(t.type){case"Scene":n=new fe,void 0!==t.background&&Number.isInteger(t.background)&&(n.background=new j(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?n.fog=new de(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(n.fog=new pe(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":n=new ee(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(n.focus=t.focus),void 0!==t.zoom&&(n.zoom=t.zoom),void 0!==t.filmGauge&&(n.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(n.filmOffset=t.filmOffset),void 0!==t.view&&(n.view=Object.assign({},t.view));break;case"OrthographicCamera":n=new K(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":n=new br(t.color,t.intensity);break;case"DirectionalLight":n=new yr(t.color,t.intensity);break;case"PointLight":n=new gr(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":n=new xr(t.color,t.intensity,t.width,t.height);break;case"SpotLight":n=new mr(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":n=new pr(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var n=i(t.geometry),a=r(t.material);n=new(n.bones&&0<n.bones.length?xe:xt)(n,a);break;case"LOD":n=new ve;break;case"Line":n=new Me(i(t.geometry),r(t.material),t.mode);break;case"LineLoop":n=new Ae(i(t.geometry),r(t.material));break;case"LineSegments":n=new _e(i(t.geometry),r(t.material));break;case"PointCloud":case"Points":n=new Se(i(t.geometry),r(t.material));break;case"Sprite":n=new ge(r(t.material));break;case"Group":n=new Pe;break;default:n=new X}if(n.uuid=t.uuid,void 0!==t.name&&(n.name=t.name),void 0!==t.matrix?(n.matrix.fromArray(t.matrix),n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==t.position&&n.position.fromArray(t.position),void 0!==t.rotation&&n.rotation.fromArray(t.rotation),void 0!==t.quaternion&&n.quaternion.fromArray(t.quaternion),void 0!==t.scale&&n.scale.fromArray(t.scale)),void 0!==t.castShadow&&(n.castShadow=t.castShadow),void 0!==t.receiveShadow&&(n.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(n.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(n.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&n.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(n.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.children)for(var a=t.children,s=0;s<a.length;s++)n.add(this.parseObject(a[s],e,o));if("LOD"===t.type)for(t=t.levels,a=0;a<t.length;a++){var s=t[a],l=n.getObjectByProperty("uuid",s.object);void 0!==l&&n.addLevel(l,s.distance)}return n}});var hl={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},ul={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},pl={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};zr.prototype={constructor:zr,setOptions:function(t){return this.options=t,this},load:function(e,i,t,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e);var n=this,o=Ks.get(e);if(void 0!==o)return n.manager.itemStart(e),setTimeout(function(){i&&i(o),n.manager.itemEnd(e)},0),o;fetch(e).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,n.options)}).then(function(t){Ks.add(e,t),i&&i(t),n.manager.itemEnd(e)}).catch(function(t){r&&r(t),n.manager.itemEnd(e),n.manager.itemError(e)})},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},Object.assign(Ur.prototype,{moveTo:function(t,e){this.currentPath=new cr,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,i,r){this.currentPath.quadraticCurveTo(t,e,i,r)},bezierCurveTo:function(t,e,i,r,n,o){this.currentPath.bezierCurveTo(t,e,i,r,n,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function i(t){for(var e=[],i=0,r=t.length;i<r;i++){var n=t[i],o=new hr;o.curves=n.curves,e.push(o)}return e}var r=Xs.isClockWise,n=this.subPaths;if(0===n.length)return[];if(!0===e)return i(n);var o,a,s=[];if(1===n.length)return a=n[0],(h=new hr).curves=a.curves,s.push(h),s;var l,c=!r(n[0].getPoints()),c=t?!c:c,h=[],u=[],p=[],d=0;u[d]=void 0,p[d]=[];for(var f=0,m=n.length;f<m;f++)o=r(l=(a=n[f]).getPoints()),(o=t?!o:o)?(!c&&u[d]&&d++,u[d]={s:new hr,p:l},u[d].s.curves=a.curves,c&&d++,p[d]=[]):p[d].push({h:a,p:l[0]});if(!u[0])return i(n);if(1<u.length){for(f=!1,a=[],r=0,n=u.length;r<n;r++)h[r]=[];for(r=0,n=u.length;r<n;r++)for(o=p[r],c=0;c<o.length;c++){for(d=o[c],l=!0,m=0;m<u.length;m++)!function(t,e){for(var i=e.length,r=!1,n=i-1,o=0;o<i;n=o++){var a=e[n],s=e[o],l=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(a=e[o],l=-l,s=e[n],c=-c),!(t.y<a.y||t.y>s.y))if(t.y===a.y){if(t.x===a.x)return 1}else{if(0===(n=c*(t.x-a.x)-l*(t.y-a.y)))return 1;n<0||(r=!r)}}else if(t.y===a.y&&(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x))return 1}return r}(d.p,u[m].p)||(r!==m&&a.push({froms:r,tos:m,hole:c}),l?(l=!1,h[m].push(d)):f=!0);l&&h[r].push(d)}0<a.length&&(f||(p=h))}for(f=0,r=u.length;f<r;f++)for(h=u[f].s,s.push(h),n=0,o=(a=p[f]).length;n<o;n++)h.holes.push(a[n].h);return s}}),Object.assign(Vr.prototype,{isFont:!0,generateShapes:function(t,e,i){i=[];var r=e=void 0===e?100:e;e=this.data;var n=String(t).split(""),r=r/e.resolution,o=(e.boundingBox.yMax-e.boundingBox.yMin+e.underlineThickness)*r;t=[];for(var a=0,s=0,l=0;l<n.length;l++){var c=n[l];if("\n"===c)a=0,s-=o;else{var h=r,u=a,p=s;if(c=e.glyphs[c]||e.glyphs["?"]){var d,f,m=new Ur,g=void 0,v=void 0,y=v=g=void 0,b=void 0;if(c.o)for(var x=c._cachedOutline||(c._cachedOutline=c.o.split(" ")),w=0,M=x.length;w<M;)switch(x[w++]){case"m":g=x[w++]*h+u,v=x[w++]*h+p,m.moveTo(g,v);break;case"l":g=x[w++]*h+u,v=x[w++]*h+p,m.lineTo(g,v);break;case"q":g=x[w++]*h+u,v=x[w++]*h+p,y=x[w++]*h+u,b=x[w++]*h+p,m.quadraticCurveTo(y,b,g,v);break;case"b":g=x[w++]*h+u,v=x[w++]*h+p,y=x[w++]*h+u,b=x[w++]*h+p,d=x[w++]*h+u,f=x[w++]*h+p,m.bezierCurveTo(y,b,d,f,g,v)}h={offsetX:c.ha*h,path:m}}else h=void 0;a+=h.offsetX,t.push(h.path)}}for(e=0,n=t.length;e<n;e++)Array.prototype.push.apply(i,t[e].toShapes());return i}}),Object.assign(Br.prototype,{load:function(t,r,e,i){var n=this,o=new Vi(this.manager);o.setPath(this.path),o.load(t,function(e){var i;try{i=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(e.substring(65,e.length-2))}e=n.parse(i),r&&r(e)},e,i)},parse:function(t){return new Vr(t)},setPath:function(t){return this.path=t,this}});var dl,fl,ml,gl,vl,yl,bl,xl,wl,Ml,_l,Al,El,Sl,Pl,Tl,Cl,Ol,Rl,Ll,Il,Dl,Fl,jl,Nl,kl,zl,Ul,Vl,Bl,Hl,Gl,Wl,Xl,ql,Yl,Kl,Jl,Zl,Ql,$l,tc,ec,ic,rc,nc,oc,ac,sc,lc,cc,hc,uc={getContext:function(){return dl=void 0===dl?new(window.AudioContext||window.webkitAudioContext):dl},setContext:function(t){dl=t}};function pc(t,e,i,r){if(rc.set(e,i,r).unproject(nc),void 0!==(t=ic[t]))for(e=ec.getAttribute("position"),i=0,r=t.length;i<r;i++)e.setXYZ(t[i],rc.x,rc.y,rc.z)}Object.assign(Hr.prototype,{load:function(t,e,i,r){var n=new Vi(this.manager);n.setResponseType("arraybuffer"),n.load(t,function(t){uc.getContext().decodeAudioData(t,function(t){e(t)})},i,r)}}),Object.assign(Gr.prototype,{update:(Ml=new Mt,_l=new Mt,function(t){var e,i,r,n,o;fl===this&&ml===t.focus&&gl===t.fov&&vl===t.aspect*this.aspect&&yl===t.near&&bl===t.far&&xl===t.zoom&&wl===this.eyeSep||(fl=this,ml=t.focus,gl=t.fov,vl=t.aspect*this.aspect,yl=t.near,bl=t.far,xl=t.zoom,e=t.projectionMatrix.clone(),i=(wl=this.eyeSep/2)*yl/ml,r=yl*Math.tan(io.DEG2RAD*gl*.5)/xl,_l.elements[12]=-wl,Ml.elements[12]=wl,n=-r*vl+i,o=r*vl+i,e.elements[0]=2*yl/(o-n),e.elements[8]=(o+n)/(o-n),this.cameraL.projectionMatrix.copy(e),n=-r*vl-i,o=r*vl-i,e.elements[0]=2*yl/(o-n),e.elements[8]=(o+n)/(o-n),this.cameraR.projectionMatrix.copy(e)),this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(_l),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Ml)})}),(Wr.prototype=Object.create(X.prototype)).constructor=Wr,Xr.prototype=Object.assign(Object.create(X.prototype),{constructor:Xr,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:(Al=new _t,El=new s,Sl=new _t,Pl=new _t,function(t){X.prototype.updateMatrixWorld.call(this,t),t=this.context.listener;var e=this.up;this.matrixWorld.decompose(Al,El,Sl),Pl.set(0,0,-1).applyQuaternion(El),t.positionX?(t.positionX.setValueAtTime(Al.x,this.context.currentTime),t.positionY.setValueAtTime(Al.y,this.context.currentTime),t.positionZ.setValueAtTime(Al.z,this.context.currentTime),t.forwardX.setValueAtTime(Pl.x,this.context.currentTime),t.forwardY.setValueAtTime(Pl.y,this.context.currentTime),t.forwardZ.setValueAtTime(Pl.z,this.context.currentTime),t.upX.setValueAtTime(e.x,this.context.currentTime),t.upY.setValueAtTime(e.y,this.context.currentTime),t.upZ.setValueAtTime(e.z,this.context.currentTime)):(t.setPosition(Al.x,Al.y,Al.z),t.setOrientation(Pl.x,Pl.y,Pl.z,e.x,e.y,e.z))})}),qr.prototype=Object.assign(Object.create(X.prototype),{constructor:qr,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t=t||[],!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),Yr.prototype=Object.assign(Object.create(qr.prototype),{constructor:Yr,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:(Tl=new _t,function(t){X.prototype.updateMatrixWorld.call(this,t),Tl.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(Tl.x,Tl.y,Tl.z)})}),Object.assign(Kr.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),i=0;i<e.length;i++)t+=e[i];return t/e.length}}),Object.assign(Jr.prototype,{accumulate:function(t,e){var i=this.buffer,r=this.valueSize,n=t*r+r,o=this.cumulativeWeight;if(0===o){for(o=0;o!==r;++o)i[n+o]=i[o];o=e}else this._mixBufferRegion(i,n,0,e/(o+=e),r);this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,i=this.buffer;t=t*e+e;var r=this.cumulativeWeight,n=this.binding;this.cumulativeWeight=0,r<1&&this._mixBufferRegion(i,t,3*e,1-r,e);for(var r=e,o=e+e;r!==o;++r)if(i[r]!==i[r+e]){n.setValue(i,t);break}},saveOriginalState:function(){var t=this.buffer,e=this.valueSize,i=3*e;this.binding.getValue(t,i);for(var r=e;r!==i;++r)t[r]=t[i+r%e];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(t,e,i,r,n){if(.5<=r)for(r=0;r!==n;++r)t[e+r]=t[i+r]},_slerp:function(t,e,i,r){s.slerpFlat(t,e,t,e,t,i,r)},_lerp:function(t,e,i,r,n){for(var o=1-r,a=0;a!==n;++a){var s=e+a;t[s]=t[s]*o+t[i+a]*r}}}),Object.assign(Zr.prototype,{getValue:function(t,e){this.bind();var i=this._bindings[this._targetGroup.nCachedObjects_];void 0!==i&&i.getValue(t,e)},setValue:function(t,e){for(var i=this._bindings,r=this._targetGroup.nCachedObjects_,n=i.length;r!==n;++r)i[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}}),Object.assign(Qr,{Composite:Zr,create:function(t,e,i){return new(t&&t.isAnimationObjectGroup?Qr.Composite:Qr)(t,e,i)},sanitizeNodeName:(Fl=/[\[\]\.:\/]/g,function(t){return t.replace(/\s/g,"_").replace(Fl,"")}),parseTrackName:(Cl="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Ol=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Cl=/(WCOD+)?/.source.replace("WCOD",Cl),Rl=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Ll=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Il=new RegExp("^"+Ol+Cl+Rl+Ll+"$"),Dl=["material","materials","bones"],function(t){var e=Il.exec(t);if(!e)throw Error("PropertyBinding: Cannot parse trackName: "+t);var i,r=(e={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]}).nodeName&&e.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r&&(i=e.nodeName.substring(r+1),-1!==Dl.indexOf(i)&&(e.nodeName=e.nodeName.substring(0,r),e.objectName=i)),null===e.propertyName||0===e.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+t);return e}),findNode:function(t,r){if(!r||""===r||"root"===r||"."===r||-1===r||r===t.name||r===t.uuid)return t;if(t.skeleton){var e=t.skeleton.getBoneByName(r);if(void 0!==e)return e}if(t.children){var n=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.name===r||i.uuid===r||(i=n(i.children)))return i}return null};if(e=n(t.children))return e}return null}}),Object.assign(Qr.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)t[e++]=i[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=t[e++]},function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,i=e.objectName,r=e.propertyName,n=e.propertyIndex;if(t||(this.node=t=Qr.findNode(this.rootNode,e.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(i){var o=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(t=t.skeleton.bones,i=0;i<t.length;i++)if(t[i].name===o){o=i;break}break;default:if(void 0===t[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[i]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}if(void 0===(o=t[r]))console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+r+" but it wasn't found.",t);else{if(e=this.Versioning.None,void 0!==t.needsUpdate?(e=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(e=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t),i=this.BindingType.Direct,void 0!==n){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(i=0;i<this.node.geometry.morphAttributes.position.length;i++)if(t.geometry.morphAttributes.position[i].name===n){n=i;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(i=0;i<this.node.geometry.morphTargets.length;i++)if(t.geometry.morphTargets[i].name===n){n=i;break}}}i=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=n}else void 0!==o.fromArray&&void 0!==o.toArray?(i=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(i=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[i],this.setValue=this.SetterByBindingTypeAndVersioning[i][e]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Qr.prototype,{_getValue_unbound:Qr.prototype.getValue,_setValue_unbound:Qr.prototype.setValue}),Object.assign($r.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,r=this._indicesByUUID,n=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,l=void 0,c=0,h=arguments.length;c!==h;++c){var u=arguments[c],p=r[d=u.uuid];if(void 0===p){p=e++,r[d]=p,t.push(u);for(var d=0,f=s;d!==f;++d)a[d].push(new Qr(u,n[d],o[d]))}else if(p<i){var l=t[p],m=--i;for(t[r[(f=t[m]).uuid]=p]=f,t[r[d]=m]=u,d=0,f=s;d!==f;++d){var g=a[d],v=g[p];g[p]=g[m],void 0===v&&(v=new Qr(u,n[d],o[d])),g[m]=v}}else t[p]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,i=this._indicesByUUID,r=this._bindings,n=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],l=s.uuid,c=i[l];if(void 0!==c&&e<=c){var h=e++;for(t[i[(u=t[h]).uuid]=c]=u,t[i[l]=h]=s,s=0,l=n;s!==l;++s){var u,p=(u=r[s])[c];u[c]=u[h],u[h]=p}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,r=this._indicesByUUID,n=this._bindings,o=n.length,a=0,s=arguments.length;a!==s;++a){var l=r[c=arguments[a].uuid];if(void 0!==l)if(delete r[c],l<i){var c,h=t[c=--i],u=--e,p=t[u];for(t[r[h.uuid]=l]=h,t[r[p.uuid]=c]=p,t.pop(),h=0,p=o;h!==p;++h){var d=n[h],f=d[u];d[l]=d[c],d[c]=f,d.pop()}}else for(t[r[(p=t[u=--e]).uuid]=l]=p,t.pop(),h=0,p=o;h!==p;++h)(d=n[h])[l]=d[u],d.pop()}this.nCachedObjects_=i},subscribe_:function(t,e){var i=this._bindingsIndicesByPath,r=i[t],n=this._bindings;if(void 0!==r)return n[r];var o=this._paths,a=this._parsedPaths,s=this._objects,l=this.nCachedObjects_,c=Array(s.length),r=n.length;for(i[t]=r,o.push(t),a.push(e),n.push(c),i=l,r=s.length;i!==r;++i)c[i]=new Qr(s[i],t,e);return c},unsubscribe_:function(t){var e,i,r,n,o,a=this._bindingsIndicesByPath,s=a[t];void 0!==s&&(e=this._paths,i=this._parsedPaths,o=(r=this._bindings)[n=r.length-1],r[a[t[n]]=s]=o,r.pop(),i[s]=i[n],i.pop(),e[s]=e[n],e.pop())}}),Object.assign(tn.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,i){var r,n;return t.fadeOut(e),this.fadeIn(e),i&&(n=(i=this._clip.duration)/(r=t._clip.duration),t.warp(1,r/i,e),this.warp(n,1,e)),this},crossFadeTo:function(t,e,i){return t.crossFadeFrom(this,e,i)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,i){var r=this._mixer,n=r.time,o=this._timeScaleInterpolant,a=this.timeScale;return null===o&&(this._timeScaleInterpolant=o=r._lendControlInterpolant()),r=o.parameterPositions,o=o.sampleValues,r[0]=n,r[1]=n+i,o[0]=t/a,o[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,i,r){if(this.enabled){if(null!==(n=this._startTime)){if((e=(t-n)*i)<0||0===i)return;this._startTime=null,e*=i}if(e*=this._updateTimeScale(t),i=this._updateTime(e),0<(t=this._updateWeight(t))){e=this._interpolants;for(var n=this._propertyBindings,o=0,a=e.length;o!==a;++o)e[o].evaluate(i),n[o].accumulate(r,t)}}else this._updateWeight(t)},_updateWeight:function(t){var e,i,r=0;return this.enabled&&(r=this.weight,null!==(e=this._weightInterpolant)&&(r*=i=e.evaluate(t)[0],t>e.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1)))),this._effectiveWeight=r},_updateTimeScale:function(t){var e,i=0;return this.paused||(i=this.timeScale,null!==(e=this._timeScaleInterpolant)&&(i*=e.evaluate(t)[0],t>e.parameterPositions[1]&&(this.stopWarping(),0===i?this.paused=!0:this.timeScale=i))),this._effectiveTimeScale=i},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var i=this._clip.duration,r=this.loop,n=this._loopCount;if(2200===r)t:{if(-1===n&&(this._loopCount=0,this._setEndings(!0,!0,!1)),i<=e)e=i;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}else{var o,a,r=2202===r;if(-1===n&&(0<=t?this._setEndings(!(n=0),0===this.repetitions,r):this._setEndings(0===this.repetitions,!0,r)),(i<=e||e<0)&&(e-=i*(o=Math.floor(e/i)),n+=Math.abs(o),(a=this.repetitions-n)<0?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=0<t?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(0==a?this._setEndings(t=t<0,!t,r):this._setEndings(!1,!1,r),this._loopCount=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o}))),r&&1==(1&n))return i-(this.time=e)}return this.time=e},_setEndings:function(t,e,i){var r=this._interpolantSettings;i?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,i){var r=this._mixer,n=r.time,o=this._weightInterpolant;return null===o&&(this._weightInterpolant=o=r._lendControlInterpolant()),r=o.parameterPositions,o=o.sampleValues,r[0]=n,o[0]=e,r[1]=n+t,o[1]=i,this}}),en.prototype=Object.assign(Object.create(e.prototype),{constructor:en,_bindAction:function(t,e){var i=t._localRoot||this._root,r=t._clip.tracks,n=r.length,o=t._propertyBindings,a=t._interpolants,s=i.uuid,l=this._bindingsByRootAndName,c=l[s];for(void 0===c&&(l[s]=c={}),l=0;l!==n;++l){var h=r[l],u=h.name,p=c[u];if(void 0===p){if(void 0!==(p=o[l])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,u));continue}++(p=new Jr(Qr.create(i,u,e&&e._propertyBindings[l].binding.parsedPath),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(p,s,u)}o[l]=p,a[l].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){var e,i,r;for(null===t._cacheIndex&&(e=(t._localRoot||this._root).uuid,i=t._clip.uuid,r=this._actionsByClip[i],this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,i,e)),i=0,r=(e=t._propertyBindings).length;i!==r;++i){var n=e[i];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,i=0,r=e.length;i!==r;++i){var n=e[i];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return null!==(t=t._cacheIndex)&&t<this._nActiveActions},_addInactiveAction:function(t,e,i){var r=this._actions,n=this._actionsByClip,o=n[e];void 0===o?(o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,n[e]=o):(e=o.knownActions,t._byClipCacheIndex=e.length,e.push(t)),t._cacheIndex=r.length,r.push(t),o.actionByRoot[i]=t},_removeInactiveAction:function(t){var e=(r=this._actions)[r.length-1],i=t._cacheIndex;r[e._cacheIndex=i]=e,r.pop(),t._cacheIndex=null;var r=t._clip.uuid,n=(i=(e=this._actionsByClip)[r]).knownActions,o=n[n.length-1],a=t._byClipCacheIndex;n[o._byClipCacheIndex=a]=o,n.pop(),t._byClipCacheIndex=null,delete i.actionByRoot[(t._localRoot||this._root).uuid],0===n.length&&delete e[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=0,i=(t=t._propertyBindings).length;e!==i;++e){var r=t[e];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(t){var e=this._actions,i=t._cacheIndex,r=this._nActiveActions++,n=e[r];e[t._cacheIndex=r]=t,e[n._cacheIndex=i]=n},_takeBackAction:function(t){var e=this._actions,i=t._cacheIndex,r=--this._nActiveActions,n=e[r];e[t._cacheIndex=r]=t,e[n._cacheIndex=i]=n},_addInactiveBinding:function(t,e,i){var r=this._bindingsByRootAndName,n=r[e],o=this._bindings;void 0===n&&(r[e]=n={}),(n[i]=t)._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,i=(r=t.binding).rootNode.uuid,r=r.path,n=this._bindingsByRootAndName,o=n[i],a=e[e.length-1];t=t._cacheIndex,e[a._cacheIndex=t]=a,e.pop(),delete o[r];t:{for(var s in o)break t;delete n[i]}},_lendBinding:function(t){var e=this._bindings,i=t._cacheIndex,r=this._nActiveBindings++,n=e[r];e[t._cacheIndex=r]=t,e[n._cacheIndex=i]=n},_takeBackBinding:function(t){var e=this._bindings,i=t._cacheIndex,r=--this._nActiveBindings,n=e[r];e[t._cacheIndex=r]=t,e[n._cacheIndex=i]=n},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return void 0===i&&(t[(i=new Cr(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e]=i),i},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,i=t.__cacheIndex,r=--this._nActiveControlInterpolants,n=e[r];e[t.__cacheIndex=r]=t,e[n.__cacheIndex=i]=n},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var i=(n=e||this._root).uuid,r="string"==typeof t?Ir.findByName(n,t):t,n=null!==r?r.uuid:t,o=this._actionsByClip[n],t=null;if(void 0!==o){if(void 0!==(t=o.actionByRoot[i]))return t;t=o.knownActions[0],null===r&&(r=t._clip)}return null===r?null:(r=new tn(this,r,e),this._bindAction(r,t),this._addInactiveAction(r,n,i),r)},existingAction:function(t,e){var e=(i=e||this._root).uuid,i="string"==typeof t?Ir.findByName(i,t):t;return void 0!==(i=this._actionsByClip[i?i.uuid:t])&&i.actionByRoot[e]||null},stopAllAction:function(){for(var t=this._actions,e=this._nActiveActions,i=this._bindings,r=this._nActiveBindings,n=this._nActiveBindings=this._nActiveActions=0;n!==e;++n)t[n].reset();for(n=0;n!==r;++n)i[n].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,i=this._nActiveActions,r=this.time+=t,n=Math.sign(t),o=this._accuIndex^=1,a=0;a!==i;++a)e[a]._update(r,t,n,o);for(t=this._bindings,e=this._nActiveBindings,a=0;a!==e;++a)t[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions;t=t.uuid;var i=this._actionsByClip;if(void 0!==(r=i[t])){for(var r,n=0,o=(r=r.knownActions).length;n!==o;++n){var a=r[n];this._deactivateAction(a);var s=a._cacheIndex,l=e[e.length-1];a._cacheIndex=null,a._byClipCacheIndex=null,e[l._cacheIndex=s]=l,e.pop(),this._removeInactiveBindingsForAction(a)}delete i[t]}},uncacheRoot:function(t){t=t.uuid;var e,i=this._actionsByClip;for(e in i){var r=i[e].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}if(void 0!==(e=this._bindingsByRootAndName[t]))for(var n in e)t=e[n],t.restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,e){e=this.existingAction(t,e);null!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}}),rn.prototype.clone=function(){return new rn(void 0===this.value.clone?this.value:this.value.clone())},nn.prototype=Object.assign(Object.create(ht.prototype),{constructor:nn,isInstancedBufferGeometry:!0,copy:function(t){return ht.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(on.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(on.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=r,this},setXYZW:function(t,e,i,r,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=r,this.data.array[t+3]=n,this}}),Object.defineProperty(an.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(an.prototype,{isInterleavedBuffer:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(var r=0,n=this.stride;r<n;r++)this.array[t+r]=e.array[i+r];return this},set:function(t,e){return this.array.set(t,e=void 0===e?0:e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),sn.prototype=Object.assign(Object.create(an.prototype),{constructor:sn,isInstancedInterleavedBuffer:!0,copy:function(t){return an.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),ln.prototype=Object.assign(Object.create(Q.prototype),{constructor:ln,isInstancedBufferAttribute:!0,copy:function(t){return Q.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(cn.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var i=[];return un(t,this,i,e),i.sort(hn),i},intersectObjects:function(t,e){var i=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var r=0,n=t.length;r<n;r++)un(t[r],this,i,e);return i.sort(hn),i}}),Object.assign(pn.prototype,{start:function(){this.oldTime=this.startTime=("undefined"==typeof performance?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t,e=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(e=((t=("undefined"==typeof performance?Date:performance).now())-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e),e)}}),Object.assign(dn.prototype,{set:function(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(io.clamp(t.y/this.radius,-1,1))),this}}),Object.assign(fn.prototype,{set:function(t,e,i){return this.radius=t,this.theta=e,this.y=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}),Object.assign(mn.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:(Nl=new q,function(t,e){e=Nl.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(e),this.max.copy(t).add(e),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return t=t||new q,this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t=t||new q,this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new q).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new q).copy(t).clamp(this.min,this.max)},distanceToPoint:(jl=new q,function(t){return jl.copy(t).clamp(this.min,this.max).sub(t).length()}),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),((gn.prototype=Object.create(X.prototype)).constructor=gn).prototype.isImmediateRenderObject=!0,((vn.prototype=Object.create(_e.prototype)).constructor=vn).prototype.update=(kl=new _t,zl=new _t,Ul=new g,function(){var t=["a","b","c"];this.object.updateMatrixWorld(!0),Ul.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,i=this.geometry.attributes.position,r=this.object.geometry;if(r&&r.isGeometry)for(var n=r.vertices,o=r.faces,a=r=0,s=o.length;a<s;a++)for(var l=o[a],c=0,h=l.vertexNormals.length;c<h;c++){var u=l.vertexNormals[c];kl.copy(n[l[t[c]]]).applyMatrix4(e),zl.copy(u).applyMatrix3(Ul).normalize().multiplyScalar(this.size).add(kl),i.setXYZ(r,kl.x,kl.y,kl.z),r+=1,i.setXYZ(r,zl.x,zl.y,zl.z),r+=1}else if(r&&r.isBufferGeometry)for(t=r.attributes.position,n=r.attributes.normal,c=r=0,h=t.count;c<h;c++)kl.set(t.getX(c),t.getY(c),t.getZ(c)).applyMatrix4(e),zl.set(n.getX(c),n.getY(c),n.getZ(c)),zl.applyMatrix3(Ul).normalize().multiplyScalar(this.size).add(kl),i.setXYZ(r,kl.x,kl.y,kl.z),i.setXYZ(r+=1,zl.x,zl.y,zl.z),r+=1;i.needsUpdate=!0}),((yn.prototype=Object.create(X.prototype)).constructor=yn).prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},yn.prototype.update=(Vl=new _t,Bl=new _t,function(){this.light.updateMatrixWorld();var t=this.light.distance||1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Vl.setFromMatrixPosition(this.light.matrixWorld),Bl.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Bl.sub(Vl)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}),((bn.prototype=Object.create(_e.prototype)).constructor=bn).prototype.updateMatrixWorld=(Hl=new _t,Gl=new Mt,Wl=new Mt,function(t){var e=this.bones,i=this.geometry,r=i.getAttribute("position");Wl.getInverse(this.root.matrixWorld);for(var n=0,o=0;n<e.length;n++){var a=e[n];a.parent&&a.parent.isBone&&(Gl.multiplyMatrices(Wl,a.matrixWorld),Hl.setFromMatrixPosition(Gl),r.setXYZ(o,Hl.x,Hl.y,Hl.z),Gl.multiplyMatrices(Wl,a.parent.matrixWorld),Hl.setFromMatrixPosition(Gl),r.setXYZ(o+1,Hl.x,Hl.y,Hl.z),o+=2)}i.getAttribute("position").needsUpdate=!0,X.prototype.updateMatrixWorld.call(this,t)}),((xn.prototype=Object.create(xt.prototype)).constructor=xn).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},xn.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},((wn.prototype=Object.create(X.prototype)).constructor=wn).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},wn.prototype.update=function(){var t=.5*this.light.width,e=.5*this.light.height,i=this.line.geometry.attributes.position,r=i.array;r[0]=t,r[1]=-e,r[2]=0,r[3]=t,r[4]=e,r[5]=0,r[6]=-t,r[7]=e,r[8]=0,r[9]=-t,r[10]=-e,r[11]=0,r[12]=t,r[13]=-e,r[14]=0,i.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},((Mn.prototype=Object.create(X.prototype)).constructor=Mn).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Mn.prototype.update=(Xl=new _t,ql=new j,Yl=new j,function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");ql.copy(this.light.color),Yl.copy(this.light.groundColor);for(var i=0,r=e.count;i<r;i++){var n=i<r/2?ql:Yl;e.setXYZ(i,n.r,n.g,n.b)}e.needsUpdate=!0}t.lookAt(Xl.setFromMatrixPosition(this.light.matrixWorld).negate())}),(_n.prototype=Object.create(_e.prototype)).constructor=_n,(An.prototype=Object.create(_e.prototype)).constructor=An,((En.prototype=Object.create(_e.prototype)).constructor=En).prototype.update=(Kl=new _t,Jl=new _t,Zl=new g,function(){this.object.updateMatrixWorld(!0),Zl.getNormalMatrix(this.object.matrixWorld);for(var t=this.object.matrixWorld,e=this.geometry.attributes.position,i=this.object.geometry,r=i.vertices,n=0,o=0,a=(i=i.faces).length;o<a;o++){var s=i[o],l=s.normal;Kl.copy(r[s.a]).add(r[s.b]).add(r[s.c]).divideScalar(3).applyMatrix4(t),Jl.copy(l).applyMatrix3(Zl).normalize().multiplyScalar(this.size).add(Kl),e.setXYZ(n,Kl.x,Kl.y,Kl.z),n+=1,e.setXYZ(n,Jl.x,Jl.y,Jl.z),n+=1}e.needsUpdate=!0}),((Sn.prototype=Object.create(X.prototype)).constructor=Sn).prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Sn.prototype.update=(Ql=new _t,$l=new _t,tc=new _t,function(){Ql.setFromMatrixPosition(this.light.matrixWorld),$l.setFromMatrixPosition(this.light.target.matrixWorld),tc.subVectors($l,Ql),this.lightPlane.lookAt(tc),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(tc),this.targetLine.scale.z=tc.length()}),((Pn.prototype=Object.create(_e.prototype)).constructor=Pn).prototype.update=(rc=new _t,nc=new Y,function(){ec=this.geometry,ic=this.pointMap,nc.projectionMatrix.copy(this.camera.projectionMatrix),pc("c",0,0,-1),pc("t",0,0,1),pc("n1",-1,-1,-1),pc("n2",1,-1,-1),pc("n3",-1,1,-1),pc("n4",1,1,-1),pc("f1",-1,-1,1),pc("f2",1,-1,1),pc("f3",-1,1,1),pc("f4",1,1,1),pc("u1",.7,1.1,-1),pc("u2",-.7,1.1,-1),pc("u3",0,2,-1),pc("cf1",-1,0,1),pc("cf2",1,0,1),pc("cf3",0,-1,1),pc("cf4",0,1,1),pc("cn1",-1,0,-1),pc("cn2",1,0,-1),pc("cn3",0,-1,-1),pc("cn4",0,1,-1),ec.getAttribute("position").needsUpdate=!0}),((Tn.prototype=Object.create(_e.prototype)).constructor=Tn).prototype.update=(oc=new U,function(t){var e,i,r;void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&oc.setFromObject(this.object),oc.isEmpty()||(t=oc.min,e=oc.max,(r=(i=this.geometry.attributes.position).array)[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=t.x,r[4]=e.y,r[5]=e.z,r[6]=t.x,r[7]=t.y,r[8]=e.z,r[9]=e.x,r[10]=t.y,r[11]=e.z,r[12]=e.x,r[13]=e.y,r[14]=t.z,r[15]=t.x,r[16]=e.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=e.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere())}),Tn.prototype.setFromObject=function(t){return this.object=t,this.update(),this},((Cn.prototype=Object.create(_e.prototype)).constructor=Cn).prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),X.prototype.updateMatrixWorld.call(this,t))},((On.prototype=Object.create(Me.prototype)).constructor=On).prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.lookAt(this.plane.normal),X.prototype.updateMatrixWorld.call(this,t)},((Rn.prototype=Object.create(X.prototype)).constructor=Rn).prototype.setDirection=(cc=new _t,function(t){.99999<t.y?this.quaternion.set(0,0,0,1):t.y<-.99999?this.quaternion.set(1,0,0,0):(cc.set(t.z,0,-t.x).normalize(),lc=Math.acos(t.y),this.quaternion.setFromAxisAngle(cc,lc))}),Rn.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},Rn.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},(Ln.prototype=Object.create(_e.prototype)).constructor=Ln,qi.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(qi.prototype),(t.prototype.constructor=t).prototype.getPoint=e,t},Object.assign(lr.prototype,{createPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new Z,i=0,r=t.length;i<r;i++){var n=t[i];e.vertices.push(new _t(n.x,n.y,n.z||0))}return e}}),Object.assign(cr.prototype,{fromPoints:function(t){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),In.prototype=Object.create(Zi.prototype),Dn.prototype=Object.create(Zi.prototype),Fn.prototype=Object.create(Zi.prototype),Object.assign(Fn.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),_n.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},bn.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(jr.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),cl.extractUrlBase(t)}}),Object.assign(mn.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(U.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),yt.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(io,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),io.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),io.ceilPowerOfTwo(t)}}),Object.assign(g.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Mt.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return void 0===hc&&(hc=new _t),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),hc.setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,i,r,n,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,i,n,o)}}),B.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},s.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(vt.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(hr.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ui(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new wi(this,t)}}),Object.assign(q.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(_t.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(At.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Z.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(X.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties(X.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(ve.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(ye.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(qi.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),ee.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(ur.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Q.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(ht.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(ht.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(rn.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(N.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new j}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}}}),Object.defineProperties(Fi.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(gt.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(ue.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(ue.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Ct.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(S.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(re.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),qr.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new Hr).load(t,function(t){e.setBuffer(t)}),this},Kr.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Wr.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},t.WebGLRenderTargetCube=r,t.WebGLRenderTarget=S,t.WebGLRenderer=ue,t.ShaderLib=bo,t.UniformsLib=go,t.UniformsUtils=vo,t.ShaderChunk=yo,t.FogExp2=pe,t.Fog=de,t.Scene=fe,t.Sprite=ge,t.LOD=ve,t.SkinnedMesh=xe,t.Skeleton=ye,t.Bone=be,t.Mesh=xt,t.LineSegments=_e,t.LineLoop=Ae,t.Line=Me,t.Points=Se,t.Group=Pe,t.VideoTexture=Te,t.DataTexture=Et,t.CompressedTexture=Ce,t.CubeTexture=l,t.CanvasTexture=H,t.DepthTexture=Oe,t.Texture=p,t.CompressedTextureLoader=Bi,t.DataTextureLoader=Hi,t.CubeTextureLoader=Wi,t.TextureLoader=Xi,t.ObjectLoader=kr,t.MaterialLoader=Dr,t.BufferGeometryLoader=Fr,t.DefaultLoadingManager=Js,t.LoadingManager=Ui,t.JSONLoader=Nr,t.ImageLoader=Gi,t.ImageBitmapLoader=zr,t.FontLoader=Br,t.FileLoader=Vi,t.Loader=jr,t.LoaderUtils=cl,t.Cache=Ks,t.AudioLoader=Hr,t.SpotLightShadow=fr,t.SpotLight=mr,t.PointLight=gr,t.RectAreaLight=xr,t.HemisphereLight=pr,t.DirectionalLightShadow=vr,t.DirectionalLight=yr,t.AmbientLight=br,t.LightShadow=dr,t.Light=ur,t.StereoCamera=Gr,t.PerspectiveCamera=ee,t.OrthographicCamera=K,t.CubeCamera=Wr,t.ArrayCamera=ie,t.Camera=Y,t.AudioListener=Xr,t.PositionalAudio=Yr,t.AudioContext=uc,t.AudioAnalyser=Kr,t.Audio=qr,t.VectorKeyframeTrack=Lr,t.StringKeyframeTrack=wr,t.QuaternionKeyframeTrack=Er,t.NumberKeyframeTrack=Pr,t.ColorKeyframeTrack=Sr,t.BooleanKeyframeTrack=Mr,t.PropertyMixer=Jr,t.PropertyBinding=Qr,t.KeyframeTrack=Rr,t.AnimationUtils=rl,t.AnimationObjectGroup=$r,t.AnimationMixer=en,t.AnimationClip=Ir,t.Uniform=rn,t.InstancedBufferGeometry=nn,t.BufferGeometry=ht,t.Geometry=Z,t.InterleavedBufferAttribute=on,t.InstancedInterleavedBuffer=sn,t.InterleavedBuffer=an,t.InstancedBufferAttribute=ln,t.Face3=J,t.Object3D=X,t.Raycaster=cn,t.Layers=W,t.EventDispatcher=e,t.Clock=pn,t.QuaternionLinearInterpolant=Ar,t.LinearInterpolant=Cr,t.DiscreteInterpolant=Or,t.CubicInterpolant=Tr,t.Interpolant=_r,t.Triangle=bt,t.Math=io,t.Spherical=dn,t.Cylindrical=fn,t.Plane=B,t.Frustum=Tt,t.Sphere=V,t.Ray=vt,t.Matrix4=Mt,t.Matrix3=g,t.Box3=U,t.Box2=mn,t.Line3=yt,t.Euler=G,t.Vector4=At,t.Vector3=_t,t.Vector2=q,t.Quaternion=s,t.Color=j,t.ImmediateRenderObject=gn,t.VertexNormalsHelper=vn,t.SpotLightHelper=yn,t.SkeletonHelper=bn,t.PointLightHelper=xn,t.RectAreaLightHelper=wn,t.HemisphereLightHelper=Mn,t.GridHelper=_n,t.PolarGridHelper=An,t.FaceNormalsHelper=En,t.DirectionalLightHelper=Sn,t.CameraHelper=Pn,t.BoxHelper=Tn,t.Box3Helper=Cn,t.PlaneHelper=On,t.ArrowHelper=Rn,t.AxesHelper=Ln,t.Shape=hr,t.Path=cr,t.ShapePath=Ur,t.Font=Vr,t.CurvePath=lr,t.Curve=qi,t.ShapeUtils=Xs,t.WebGLUtils=ae,t.WireframeGeometry=Re,t.ParametricGeometry=Le,t.ParametricBufferGeometry=Ie,t.TetrahedronGeometry=je,t.TetrahedronBufferGeometry=Ne,t.OctahedronGeometry=ke,t.OctahedronBufferGeometry=ze,t.IcosahedronGeometry=Ue,t.IcosahedronBufferGeometry=Ve,t.DodecahedronGeometry=Be,t.DodecahedronBufferGeometry=He,t.PolyhedronGeometry=De,t.PolyhedronBufferGeometry=Fe,t.TubeGeometry=Ge,t.TubeBufferGeometry=We,t.TorusKnotGeometry=Xe,t.TorusKnotBufferGeometry=qe,t.TorusGeometry=Ye,t.TorusBufferGeometry=Ke,t.TextGeometry=di,t.TextBufferGeometry=fi,t.SphereGeometry=mi,t.SphereBufferGeometry=gi,t.RingGeometry=vi,t.RingBufferGeometry=yi,t.PlaneGeometry=dt,t.PlaneBufferGeometry=ft,t.LatheGeometry=bi,t.LatheBufferGeometry=xi,t.ShapeGeometry=wi,t.ShapeBufferGeometry=Mi,t.ExtrudeGeometry=ui,t.ExtrudeBufferGeometry=pi,t.EdgesGeometry=Ai,t.ConeGeometry=Pi,t.ConeBufferGeometry=Ti,t.CylinderGeometry=Ei,t.CylinderBufferGeometry=Si,t.CircleGeometry=Ci,t.CircleBufferGeometry=Oi,t.BoxGeometry=ut,t.BoxBufferGeometry=pt,t.ShadowMaterial=Ri,t.SpriteMaterial=me,t.RawShaderMaterial=Li,t.ShaderMaterial=gt,t.PointsMaterial=Ee,t.MeshPhysicalMaterial=Di,t.MeshStandardMaterial=Ii,t.MeshPhongMaterial=Fi,t.MeshToonMaterial=ji,t.MeshNormalMaterial=Ni,t.MeshLambertMaterial=ki,t.MeshDepthMaterial=k,t.MeshDistanceMaterial=z,t.MeshBasicMaterial=mt,t.LineDashedMaterial=zi,t.LineBasicMaterial=we,t.Material=N,t.Float64BufferAttribute=st,t.Float32BufferAttribute=at,t.Uint32BufferAttribute=ot,t.Int32BufferAttribute=nt,t.Uint16BufferAttribute=rt,t.Int16BufferAttribute=it,t.Uint8ClampedBufferAttribute=et,t.Uint8BufferAttribute=tt,t.Int8BufferAttribute=$,t.BufferAttribute=Q,t.ArcCurve=Ki,t.CatmullRomCurve3=Zi,t.CubicBezierCurve=er,t.CubicBezierCurve3=ir,t.EllipseCurve=Yi,t.LineCurve=rr,t.LineCurve3=nr,t.QuadraticBezierCurve=or,t.QuadraticBezierCurve3=ar,t.SplineCurve=sr,t.REVISION="90",t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},t.CullFaceNone=0,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.FrontFaceDirectionCW=0,t.FrontFaceDirectionCCW=1,t.BasicShadowMap=0,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.FrontSide=0,t.BackSide=1,t.DoubleSide=2,t.FlatShading=1,t.SmoothShading=2,t.NoColors=0,t.FaceColors=1,t.VertexColors=2,t.NoBlending=0,t.NormalBlending=1,t.AdditiveBlending=2,t.SubtractiveBlending=3,t.MultiplyBlending=4,t.CustomBlending=5,t.AddEquation=100,t.SubtractEquation=101,t.ReverseSubtractEquation=102,t.MinEquation=103,t.MaxEquation=104,t.ZeroFactor=200,t.OneFactor=201,t.SrcColorFactor=202,t.OneMinusSrcColorFactor=203,t.SrcAlphaFactor=204,t.OneMinusSrcAlphaFactor=205,t.DstAlphaFactor=206,t.OneMinusDstAlphaFactor=207,t.DstColorFactor=208,t.OneMinusDstColorFactor=209,t.SrcAlphaSaturateFactor=210,t.NeverDepth=0,t.AlwaysDepth=1,t.LessDepth=2,t.LessEqualDepth=3,t.EqualDepth=4,t.GreaterEqualDepth=5,t.GreaterDepth=6,t.NotEqualDepth=7,t.MultiplyOperation=0,t.MixOperation=1,t.AddOperation=2,t.NoToneMapping=0,t.LinearToneMapping=1,t.ReinhardToneMapping=2,t.Uncharted2ToneMapping=3,t.CineonToneMapping=4,t.UVMapping=300,t.CubeReflectionMapping=301,t.CubeRefractionMapping=302,t.EquirectangularReflectionMapping=303,t.EquirectangularRefractionMapping=304,t.SphericalReflectionMapping=305,t.CubeUVReflectionMapping=306,t.CubeUVRefractionMapping=307,t.RepeatWrapping=1e3,t.ClampToEdgeWrapping=1001,t.MirroredRepeatWrapping=1002,t.NearestFilter=1003,t.NearestMipMapNearestFilter=1004,t.NearestMipMapLinearFilter=1005,t.LinearFilter=1006,t.LinearMipMapNearestFilter=1007,t.LinearMipMapLinearFilter=1008,t.UnsignedByteType=1009,t.ByteType=1010,t.ShortType=1011,t.UnsignedShortType=1012,t.IntType=1013,t.UnsignedIntType=1014,t.FloatType=1015,t.HalfFloatType=1016,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedInt248Type=1020,t.AlphaFormat=1021,t.RGBFormat=1022,t.RGBAFormat=1023,t.LuminanceFormat=1024,t.LuminanceAlphaFormat=1025,t.RGBEFormat=1023,t.DepthFormat=1026,t.DepthStencilFormat=1027,t.RGB_S3TC_DXT1_Format=33776,t.RGBA_S3TC_DXT1_Format=33777,t.RGBA_S3TC_DXT3_Format=33778,t.RGBA_S3TC_DXT5_Format=33779,t.RGB_PVRTC_4BPPV1_Format=35840,t.RGB_PVRTC_2BPPV1_Format=35841,t.RGBA_PVRTC_4BPPV1_Format=35842,t.RGBA_PVRTC_2BPPV1_Format=35843,t.RGB_ETC1_Format=36196,t.RGBA_ASTC_4x4_Format=37808,t.RGBA_ASTC_5x4_Format=37809,t.RGBA_ASTC_5x5_Format=37810,t.RGBA_ASTC_6x5_Format=37811,t.RGBA_ASTC_6x6_Format=37812,t.RGBA_ASTC_8x5_Format=37813,t.RGBA_ASTC_8x6_Format=37814,t.RGBA_ASTC_8x8_Format=37815,t.RGBA_ASTC_10x5_Format=37816,t.RGBA_ASTC_10x6_Format=37817,t.RGBA_ASTC_10x8_Format=37818,t.RGBA_ASTC_10x10_Format=37819,t.RGBA_ASTC_12x10_Format=37820,t.RGBA_ASTC_12x12_Format=37821,t.LoopOnce=2200,t.LoopRepeat=2201,t.LoopPingPong=2202,t.InterpolateDiscrete=2300,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.ZeroCurvatureEnding=2400,t.ZeroSlopeEnding=2401,t.WrapAroundEnding=2402,t.TrianglesDrawMode=0,t.TriangleStripDrawMode=1,t.TriangleFanDrawMode=2,t.LinearEncoding=3e3,t.sRGBEncoding=3001,t.GammaEncoding=3007,t.RGBEEncoding=3002,t.LogLuvEncoding=3003,t.RGBM7Encoding=3004,t.RGBM16Encoding=3005,t.RGBDEncoding=3006,t.BasicDepthPacking=3200,t.RGBADepthPacking=3201,t.CubeGeometry=ut,t.Face4=function(t,e,i,r,n,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new J(t,e,i,n,o,a)},t.LineStrip=0,t.LinePieces=1,t.MeshFaceMaterial=function(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t},t.MultiMaterial=function(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,(t.materials=t).clone=function(){return t.slice()},t},t.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Se(t,e)},t.Particle=function(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new ge(t)},t.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Se(t,e)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ee(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ee(t)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ee(t)},t.Vertex=function(t,e,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new _t(t,e,i)},t.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new Q(t,e).setDynamic(!0)},t.Int8Attribute=function(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new $(t,e)},t.Uint8Attribute=function(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new tt(t,e)},t.Uint8ClampedAttribute=function(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new et(t,e)},t.Int16Attribute=function(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new it(t,e)},t.Uint16Attribute=function(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new rt(t,e)},t.Int32Attribute=function(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new nt(t,e)},t.Uint32Attribute=function(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new ot(t,e)},t.Float32Attribute=function(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new at(t,e)},t.Float64Attribute=function(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new st(t,e)},t.ClosedSplineCurve3=In,t.SplineCurve3=Dn,t.Spline=Fn,t.AxisHelper=function(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Ln(t)},t.BoundingBoxHelper=function(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Tn(t,e)},t.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new _e(new Ai(t.geometry),new we({color:void 0!==e?e:16777215}))},t.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new _e(new Re(t.geometry),new we({color:void 0!==e?e:16777215}))},t.XHRLoader=function(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Vi(t)},t.BinaryTextureLoader=function(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Hi(t)},t.GeometryUtils={merge:function(t,e,i){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,i)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},t.ImageUtils={crossOrigin:void 0,loadTexture:function(t,e,i,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var n=new Xi;return n.setCrossOrigin(this.crossOrigin),t=n.load(t,i,void 0,r),e&&(t.mapping=e),t},loadTextureCube:function(t,e,i,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var n=new Wi;return n.setCrossOrigin(this.crossOrigin),t=n.load(t,i,void 0,r),e&&(t.mapping=e),t},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},t.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},t.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}},t.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?_(exports):mt.amd?mt("three",["exports"],_):_(A.THREE={}),mt("com/visioglobe/web/helpers/CachedTexture",["three"],function(a){return function(t,e,i,r){var n,o;return void 0===i&&(i=!0),void 0===t.textures[e]?(o={loaded:!1,postFunctions:[],debugURL:e},t.textures[e]=o,r&&o.postFunctions.push(r),i||((n=new a.Texture).vg={nbRefs:1},o.pending=[n]),t.loaderStatistics.textures++,o.texture=t.textureLoader.load(e,function(e){t.loaderStatistics.textures--,i||Object.keys(o.pending).forEach(function(t){o.pending[t].image=e.image,o.pending[t].needsUpdate=!0}),o.loaded=!0,Object.keys(o.postFunctions).forEach(function(t){o.postFunctions[t](o)}),o.postFunctions=null,t.requestRedraw()},void 0,function(){t.loaderStatistics.textures--}),o.texture.needsUpdate=!0,i&&((n=o.texture).vg={nbRefs:1})):(o=t.textures[e],i||((n=new a.Texture).vg={nbRefs:1}),i?((n=o.texture).vg.nbRefs++,r&&(o.loaded?(r(o),r=null):o.postFunctions.push(r))):o.loaded?(n.image=o.texture.image,n.needsUpdate=!0):o.pending.push(n)),n}}),mt("com/visioglobe/web/Camera",["com/visioglobe/web/helpers/MathUtils","bluebird","three"],function(e,d,f){function t(t){return t<0&&(t+=360*(-t/360+1|0)),t%360}return function(h){var u=!1,p=!1;d.config({cancellation:!0}),Object.defineProperty(this,"pitch",{get:function(){return h.manipulator.orientation.x*e.RAD2DEG},set:function(t){t=f.Math.clamp(t*e.DEG2RAD,h.manipulator.rotationXMin,h.manipulator.rotationXMax),h.manipulator.orientation.x!=t&&(h.manipulator.orientation.x=t,h.manipulator.update())}}),Object.defineProperty(this,"minPitch",{get:function(){return h.manipulator.rotationXMin*e.RAD2DEG},set:function(t){h.manipulator.rotationXMin=t*e.DEG2RAD,t=f.Math.clamp(h.manipulator.orientation.x,h.manipulator.rotationXMin,h.manipulator.rotationXMax),h.manipulator.orientation.x!=t&&(h.manipulator.orientation.x=t,h.manipulator.update())}}),Object.defineProperty(this,"maxPitch",{get:function(){return h.manipulator.rotationXMax*e.RAD2DEG},set:function(t){h.manipulator.rotationXMax=t*e.DEG2RAD,t=f.Math.clamp(h.manipulator.orientation.x,h.manipulator.rotationXMin,h.manipulator.rotationXMax),h.manipulator.orientation.x!=t&&(h.manipulator.orientation.x=t,h.manipulator.update())}}),Object.defineProperty(this,"minRadius",{get:function(){return h.manipulator.minRadius},set:function(t){h.manipulator.minRadius=t,h.manipulator.update()}}),Object.defineProperty(this,"maxRadius",{get:function(){return h.manipulator.maxRadius},set:function(t){h.manipulator.maxRadius=t,h.manipulator.update()}}),Object.defineProperty(this,"position",{get:function(){return{x:h.manipulator.target.x,y:h.manipulator.target.y,radius:h.manipulator.radius}},set:function(t){var e;!1!==t&&(e=!1,h.manipulator.target.x==t.x&&h.manipulator.target.y==t.y||(h.manipulator.target.x=t.x,h.manipulator.target.y=t.y,e=!0),void 0!==t.radius&&h.manipulator.radius!=t.radius&&(h.manipulator.radius=t.radius,e=!0),e&&(h.manipulator.update(),h.manipulator.track&&void 0!==h.statistics&&h.statistics.logStat("position",{id:"camera",position:t})))}}),Object.defineProperty(this,"track",{get:function(){return h.manipulator.track},set:function(t){h.manipulator.track=t}}),Object.defineProperty(this,"rotation",{get:function(){return t(h.manipulator.orientation.z*e.RAD2DEG+90)},set:function(t){t=(t-90)*e.DEG2RAD,h.manipulator.orientation.z!=t&&(h.manipulator.orientation.z=t,h.manipulator.update())}}),Object.defineProperty(this,"heading",{get:function(){return t((h.cameraNorthRotation||0)-this.rotation)},set:function(t){this.rotation=(h.cameraNorthRotation||0)-t}}),Object.defineProperty(this,"pitchManipulatorEnabled",{get:function(){return h.manipulator.pitchManipulatorEnabled},set:function(t){h.manipulator.pitchManipulatorEnabled=!!t}}),Object.defineProperty(this,"rotationManipulatorEnabled",{get:function(){return h.manipulator.rotationManipulatorEnabled},set:function(t){h.manipulator.rotationManipulatorEnabled=!!t}}),Object.defineProperty(this,"zoomManipulatorEnabled",{get:function(){return h.manipulator.zoomManipulatorEnabled},set:function(t){h.manipulator.zoomManipulatorEnabled=!!t}}),Object.defineProperty(this,"panManipulatorEnabled",{get:function(){return h.manipulator.panManipulatorEnabled},set:function(t){h.manipulator.panManipulatorEnabled=!!t}}),this.getBoundary=function(){return h.manipulator.boundary},this.setBoundary=function(t){t&&3<t.length&&(h.manipulator.boundary=t,h.manipulator.update())},this.setManipulator=function(t){switch(t){case"map":case"trackball":case"none":h.manipulatorTypeName=t}},this.getManipulator=function(){return h.manipulatorTypeName},this.setCustomPreManipulatorListener=function(t){h.customPreManipulatorListener="function"==typeof t&&t},this.getCustomPreManipulatorListener=function(){return h.customPreManipulatorListener},this.setCustomPostManipulatorListener=function(t){h.customPostManipulatorListener="function"==typeof t&&t},this.getCustomPostManipulatorListener=function(){return h.customPostManipulatorListener},this.removeCustomPreManipulatorListener=function(){h.customPreManipulatorListener=!1},this.removeCustomPostManipulatorListener=function(){h.customPostManipulatorListener=!1},this.goTo=function(t,e){!1!==p&&p.isPending()&&(clearTimeout(-1),p.cancel());var i=500;if(e&&void 0!==e.animationDuration&&((i=e.animationDuration)<0&&(i=0)),void 0===t||"string"==typeof t&&!1===(t=h.getPlace(t)))return d.reject();var r,n,o,a,s,l,c=new f.Vector3,e=h.manipulator.radius;if("object"==typeof t&&"object"==typeof t.vg&&"object"==typeof t.vg.position&&void 0!==t.vg.position.x&&void 0!==t.vg.position.y&&void 0!==t.vg.radius)e=t.vg.radius,c.x=t.vg.position.x,c.y=t.vg.position.y;else{if("object"!=typeof t||void 0===t.x||void 0===t.y)return d.reject();c.x=t.x,c.y=t.y,void 0!==t.radius&&(e=t.radius)}return!1!==u&&(u.stop(),u=!1),p=0===i?(this.position={x:c.x,y:c.y,radius:e},d.delay(0)):(r=h.manipulator.radius,n=h.manipulator.target.x,o=h.manipulator.target.y,a=Math.max(h.manipulator.minRadius,e),s=c.x,l=c.y,new d(function(t,e){u=h.animateValue(0,1,{duration:i,easing:"linear",step:function(t){h.publicCamera.position={x:n+t*(s-n),y:o+t*(l-o),radius:r+t*(a-r)}},complete:function(){u=!1,h.publicCamera.position={x:s,y:l,radius:a},t()}})}))}}}),mt("com/visioglobe/web/helpers/ExtrudeGeometry",["com/visioglobe/web/helpers/MathUtils","three"],function(J,Z){function t(t,e){Z.Geometry.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new i(t,e)),this.mergeVertices()}(t.prototype=Object.create(Z.ExtrudeGeometry.prototype)).constructor=t;var i=function(t,e){Z.ExtrudeBufferGeometry.call(this,t,e)};return i.prototype=Object.create(Z.ExtrudeBufferGeometry.prototype),(i.prototype.constructor=i).prototype.addShape=function(t,i){function e(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}function r(t,e,i){var r=1,r=t.x-e.x,n=t.y-e.y,o=i.x-t.x,a=i.y-t.y,s=r*r+n*n;if(Math.abs(r*a-n*o)>Number.EPSILON){var l=Math.sqrt(s),c=Math.sqrt(o*o+a*a),s=e.x-n/l;if(e=e.y+r/l,(r=(i=s+r*(o=((i.x-a/c-s)*a-(i.y+o/c-e)*o)/(r*a-n*o))-t.x)*i+(t=e+n*o-t.y)*t)<=2)return new Z.Vector2(i,t);r=Math.sqrt(r/2)}else t=!1,r>Number.EPSILON?o>Number.EPSILON&&(t=!0):r<-Number.EPSILON?o<-Number.EPSILON&&(t=!0):J.sign(n)===J.sign(a)&&(t=!0),r=t?(i=-n,t=r,Math.sqrt(s)):(i=r,t=n,Math.sqrt(s/2));return new Z.Vector2(i/r,t/r)}function n(t,e){var i,r;for(H=t.length;0<=--H;){(r=(i=H)-1)<0&&(r=t.length-1);for(var n=0,o=A+2*w,n=0;n<o;n++){var a=V*n,s=e+r+a,l=e+r+(c=V*(n+1)),c=e+i+c;h(e+i+a),h(s),h(c),h(s),h(l),h(c),a=f.length/3,u((a=O.generateSideWallUV(L,f,a-6,a-3,a-2,a-1))[0]),u(a[1]),u(a[3]),u(a[1]),u(a[2]),u(a[3])}}}function o(t,e,i){v.push(t),v.push(e),v.push(i)}function a(t,e,i){h(t),h(e),h(i),t=f.length/3,u((t=O.generateTopUV(L,f,t-3,t-2,t-1))[0]),u(t[1]),u(t[2])}function h(t){m.push(f.length/3),f.push(v[3*t+0]),f.push(v[3*t+1]),f.push(v[3*t+2])}function u(t){g.push(t.x),g.push(t.y)}var s,l,c,p,d,f=(y=i.arrays||this.getArrays()).position,m=y.index,g=y.uv,v=[],y=void 0!==i.amount?i.amount:100,b=void 0!==i.bevelThickness?i.bevelThickness:6,x=void 0!==i.bevelSize?i.bevelSize:b-2,w=void 0!==i.bevelSegments?i.bevelSegments:3,M=void 0===i.bevelEnabled||i.bevelEnabled,_=void 0!==i.curveSegments?i.curveSegments:12,A=void 0!==i.steps?i.steps:1,E=i.extrudePath,S=!1,P=void 0===i.generateTop||i.generateTop,T=void 0===i.generateBottom||i.generateBottom,C=void 0===i.generateSides||i.generateSides,O=void 0!==i.UVGenerator?i.UVGenerator:Z.ExtrudeGeometry.WorldUVGenerator;E&&(s=E.getSpacedPoints(A),M=!(S=!0),l=void 0!==i.frames?i.frames:E.computeFrenetFrames(A,!1),c=new Z.Vector3,p=new Z.Vector3,d=new Z.Vector3),M||(x=b=w=0);var R,L=this,_=(E=t.extractPoints(_)).shape,I=E.holes;if(E=!Z.ShapeUtils.isClockWise(_)){for(_=_.reverse(),j=0,N=I.length;j<N;j++)R=I[j],Z.ShapeUtils.isClockWise(R)&&(I[j]=R.reverse());E=!1}for(var D=Z.ShapeUtils.triangulateShape(_,I),F=_,j=0,N=I.length;j<N;j++)R=I[j],_=_.concat(R);for(var k,z,U,V=_.length,B=D.length,E=[],H=0,G=F.length,W=G-1,X=H+1;H<G;H++,W++,X++)E[H]=r(F[H],F[W=W===G?0:W],F[X=X===G?0:X]);var q,Y=[],K=E.concat();for(j=0,N=I.length;j<N;j++){for(R=I[j],q=[],H=0,W=(G=R.length)-1,X=H+1;H<G;H++,W++,X++)W===G&&(W=0),X===G&&(X=0),q[H]=r(R[H],R[W],R[X]);Y.push(q),K=K.concat(q)}for(W=0;W<w;W++){for(G=W/w,k=b*Math.cos(G*Math.PI/2),X=x*Math.sin(G*Math.PI/2),H=0,G=F.length;H<G;H++)o((z=e(F[H],E[H],X)).x,z.y,-k);for(j=0,N=I.length;j<N;j++)for(R=I[j],q=Y[j],H=0,G=R.length;H<G;H++)o((z=e(R[H],q[H],X)).x,z.y,-k)}for(X=x,H=0;H<V;H++)z=M?e(_[H],K[H],X):_[H],S?(p.copy(l.normals[0]).multiplyScalar(z.x),c.copy(l.binormals[0]).multiplyScalar(z.y),d.copy(s[0]).add(p).add(c),o(d.x,d.y,d.z)):o(z.x,z.y,0);for(G=1;G<=A;G++)for(H=0;H<V;H++)z=M?e(_[H],K[H],X):_[H],S?(p.copy(l.normals[G]).multiplyScalar(z.x),c.copy(l.binormals[G]).multiplyScalar(z.y),d.copy(s[G]).add(p).add(c),o(d.x,d.y,d.z)):o(z.x,z.y,y/A*G);for(W=w-1;0<=W;W--){for(G=W/w,k=b*Math.cos(G*Math.PI/2),X=x*Math.sin(G*Math.PI/2),H=0,G=F.length;H<G;H++)o((z=e(F[H],E[H],X)).x,z.y,y+k);for(j=0,N=I.length;j<N;j++)for(R=I[j],q=Y[j],H=0,G=R.length;H<G;H++)z=e(R[H],q[H],X),S?o(z.x,z.y+s[A-1].y,s[A-1].x+k):o(z.x,z.y,y+k)}!function(){var t=f.length/3;if(M){var e=0*V;if(T)for(H=0;H<B;H++)a((U=D[H])[2]+e,U[1]+e,U[0]+e);if(e=A+2*w,e*=V,P)for(H=0;H<B;H++)a((U=D[H])[0]+e,U[1]+e,U[2]+e)}else{if(T)for(H=0;H<B;H++)a((U=D[H])[2],U[1],U[0]);if(P)for(H=0;H<B;H++)a((U=D[H])[0]+V*A,U[1]+V*A,U[2]+V*A)}L.addGroup(t,f.length/3-t,void 0!==i.material?i.material:0)}(),C&&function(){var t=f.length/3,e=0;for(n(F,e),e+=F.length,j=0,N=I.length;j<N;j++)n(R=I[j],e),e+=R.length;L.addGroup(t,f.length/3-t,void 0!==i.extrudeMaterial?i.extrudeMaterial:1)}(),i.arrays||(this.setIndex(m),this.addAttribute("position",new Float32BufferAttribute(f,3)),this.addAttribute("uv",new Float32BufferAttribute(i.arrays.uv,2)))},t}),mt("com/visioglobe/common/PublicInterface",[],function(){function t(){}return t.create=function(t,i,r,n,o){t=t||{},r=r||[],n=n||[],o=o||[],Object.keys(r).forEach(function(t){var e=r[t];void 0!==i[e]&&Object.defineProperty(this,e,{get:function(){return i[e]},set:function(t){i[e]=t}})},t),Object.keys(n).forEach(function(t){var e=n[t];void 0!==i[e]&&Object.defineProperty(this,e,{get:function(){return i[e]}})},t),Object.keys(o).forEach(function(t){var e=o[t];void 0!==i[e]&&(this[e]=function(){return i[e].apply(i,arguments)})},t)},t}),mt("com/visioglobe/web/LOD",["com/visioglobe/common/PublicInterface","three"],function(e,r){function t(t){e.create(this,t,n,o,a)}function i(t,e,i){this.index=i,this.mapviewer=t,this.node=new r.Object3D,this.node.visible=!1,this.node.matrixAutoUpdate=!1,this.contentNode=new r.Object3D,this.contentNode.matrixAutoUpdate=!1,this.floor=e,this.pickables=[],this.cameraUpdatableObjects=[],this.pathObjects=[],this.animatedObjects=[],this.rampObjects=[],this.groundObjects=[],this.layers={},this.publicLOD=this.active=!1,this.node.add(this.contentNode),e.node.add(this.node)}var n=[],o=[],a=["setEnabled","isEnabled"];return(i.prototype.constructor=i).prototype.getPublicLOD=function(){return this.publicLOD=this.publicLOD||new t(this)},i.prototype.setContentEnabled=function(t){this.contentNode.visible!=t&&(this.contentNode.visible=t,this.mapviewer.requestRedraw())},i.prototype.isContentEnabled=function(){return this.contentNode.visible},i.prototype.setEnabled=function(t){this.node.visible!=t&&(this.node.visible=t,this.setActive(t),this.mapviewer.requestRedraw())},i.prototype.isEnabled=function(){return this.node.visible},i.prototype.getOrCreateLayer=function(t){var e;return void 0===this.layers[t]&&((e=new r.Object3D).matrixAutoUpdate=!1,this.layers[t]=e,this.node.add(e)),this.layers[t]},i.prototype.setActive=function(t){this.active===t||t&&!1===this.floor.isEnabled()||(t?this.mapviewer.addActiveLOD(this):this.mapviewer.removeActiveLOD(this),this.active=t,this.mapviewer.mustUpdateCameraObjects=!0,this.mapviewer.requestRedraw())},i.prototype.isActive=function(){return this.active},i}),mt("com/visioglobe/web/Floor",["com/visioglobe/common/PublicInterface","com/visioglobe/web/LOD","com/visioglobe/web/helpers/MathUtils","three"],function(e,i,r,n){function t(t){e.create(this,t,a,s,l)}function o(t,e){this.name=e,this.lods=[],this.node=new n.Object3D,this.node.visible=!1,this.node.matrixAutoUpdate=!1,this.mapviewer=t,this.floorContentLOD=new i(t,this,-1),this.floorContentLOD.setEnabled(!0),this.positionUpdatableLinks=[],this.publicLODs=this.publicFloor=!1,this.autoUpdateLOD=!0,this.setContentEnabled(!0)}var a=[],s=["name","index","heightMin","heightMax"],l="setEnabled isEnabled setContentEnabled isContentEnabled getPosition setPosition getLODs setAutoUpdateLOD isAutoUpdateLOD fadeIn fadeOut".split(" ");return(o.prototype.constructor=o).prototype.getPublicFloor=function(){return this.publicFloor=this.publicFloor||new t(this)},o.prototype.getLODs=function(){if(!this.publicLODs){this.publicLODs=[];for(var t=0,e=this.lods.length;t<e;t++)this.publicLODs.push(this.lods[t].getPublicLOD())}return this.publicLODs},o.prototype.createLOD=function(t){var e=new i(this.mapviewer,this,t,this.name);return this.lods[t]=e},o.prototype.getLOD=function(t){for(var e=null,i=0;i<this.lods.length;++i){var r=this.lods[i];if(void 0!==r&&r.index===t){e=r;break}}return e},o.prototype.info=function(){var t=this.node.position;console.log("=============="),console.log("Floor "+this.name+" visible "+this.node.visible+" content "+this.floorContentLOD.node.visible+" pos("+t.x+","+t.y+","+t.z+")");for(var t=0,e=this.lods.length;t<e;++t){var i=this.lods[t].node.position;console.log("  LOD  "+t+" visible "+this.lods[t].node.visible+" pos ("+i.x+","+i.y+","+i.z+")")}console.log("this.positionUpdatableLinks.length: "+this.positionUpdatableLinks.length)},o.prototype.fadeOut=function(t){var e=this;return this.mapviewer.animateValue(0,1,{duration:t,step:function(t){e.setOpacity(1-r.easeOut(t))}})},o.prototype.fadeIn=function(t){var e=this;return this.mapviewer.animateValue(0,1,{duration:t,step:function(t){e.setOpacity(r.easeIn(t))},complete:function(){e.setContentEnabled(!0)}})},o.prototype.setOpacity=function(r,t){0<r?this.setEnabled(!0):this.setEnabled(!1),0<r&&r<1?(this.node.traverse(function(i){void 0!==i.material&&(Array.isArray(i.material)?(void 0===i.originalMaterials&&(i.originalMaterials=[],i.material.forEach(function(t,e){i.originalMaterials[e]=t,i.material[e]=i.originalMaterials[e].clone()})),i.material.forEach(function(t,e){t.opacity=r*i.originalMaterials[e].opacity,t.transparent=!0})):i.material instanceof n.MeshBasicMaterial?(void 0===i.originalMaterial&&(i.originalMaterial=i.material,i.material=i.originalMaterial.clone()),i.material.opacity=r*i.originalMaterial.opacity,i.material.transparent=!0):i.material instanceof n.ShaderMaterial&&(void 0===i.material.originalOpacity&&(i.material.originalOpacity=i.material.uniforms.opacity.value),i.material.uniforms.opacity.value=r*i.material.originalOpacity))}),this.floorContentLOD.node.traverse(function(t){void 0===t.originalRenderOrder&&(t.originalRenderOrder=t.renderOrder),t.renderOrder=1})):(this.node.traverse(function(i){void 0!==i.material&&(Array.isArray(i.material)?void 0!==i.originalMaterials&&i.material.forEach(function(t,e){i.material[e]=i.originalMaterials[e].clone()}):i.material instanceof n.MeshBasicMaterial?void 0!==i.originalMaterial&&(i.material=i.originalMaterial.clone()):i.material instanceof n.ShaderMaterial&&void 0!==i.material.originalOpacity&&(i.material.uniforms.opacity.value=i.material.originalOpacity))}),this.floorContentLOD.node.traverse(function(t){t.renderOrder=t.originalRenderOrder})),this.mapviewer.requestRedraw()},o.prototype.setEnabled=function(t){if(this.node.visible!==t){this.node.visible=t,this.floorContentLOD.isEnabled()&&this.floorContentLOD.setActive(t);for(var e=0;e<this.lods.length;++e){var i=this.lods[e];i.isEnabled()&&i.setActive(t)}this.mapviewer.requestRedraw()}},o.prototype.isEnabled=function(){return this.node.visible},o.prototype.setContentEnabled=function(t){this.floorContentLOD.setContentEnabled(t);for(var e=0;e<this.lods.length;++e)this.lods[e].setContentEnabled(t)},o.prototype.isContentEnabled=function(){return this.floorContentLOD.isContentEnabled()},o.prototype.getPosition=function(){var t=this.node.position;return{x:t.x,y:t.y,z:t.z}},o.prototype.setPosition=function(t){var e=this.node.position;if(e.x!=t.x||e.y!=t.y||e.z!=t.z){for(t.z=t.z||0,this.node.position.copy(t),t=0,e=this.positionUpdatableLinks.length;t<e;t++){var i,r,n=this.positionUpdatableLinks[t],o=!1;n.linkOptions.startFloor!==this&&n.linkOptions.endFloor!==this||(o=n.linkOptions.endPoint,i=n.linkOptions.startFloor.getPosition(),o={x:(r=n.linkOptions.endFloor.getPosition()).x-i.x+o.x,y:r.y-i.y+o.y,z:r.z-i.z+o.z}),o&&n.updateEndPoints(!1,o)}this.mapviewer.mustUpdateCameraObjects=!0,this.node.updateMatrix(),this.node.updateMatrixWorld(!0),this.mapviewer.requestRedraw()}},o.prototype.removeLink=function(t){for(var e=0,i=this.positionUpdatableLinks.length;e<i;e++)if(this.positionUpdatableLinks[e]===t)return this.positionUpdatableLinks.splice(e,1),!0;return!1},o.prototype.addLink=function(t){this.positionUpdatableLinks.push(t)},o.prototype.isAutoUpdateLOD=function(){return this.autoUpdateLOD},o.prototype.setAutoUpdateLOD=function(t){(this.autoUpdateLOD=t)&&(this.mapviewer.mustUpdateCameraObjects=!0,this.mapviewer.requestRedraw())},o}),mt("com/visioglobe/web/Path",["com/visioglobe/common/PublicInterface","three"],function(t,s){function l(e){t.create(this,e,i,r,n),Object.defineProperty(this,"visible",{get:function(){return e.getVisible()},set:function(t){e.setVisible(t)}})}function c(t){l.apply(this,[t])}var i=[],r=[],n="show hide remove getLength getInterpolatedPosition setInterpolatedStartEnd getVisible options updateEndPoints".split(" ");return function(r,i,n,o,t,a,e){(this.mesh=t).traverse(function(t){t.visible=i.visible}),t=null,this.lod=e,this.pathGeometry=a,this.spline=n,this.meshParent=this.mesh.parent,this.previousRight=new s.Vector3,this.publicLink=this.publicPath=!1,this.getPublicPath=function(){return this.publicPath=this.publicPath||new l(this)},this.getPublicLink=function(){return this.publicLink=this.publicLink||new c(this)},this.setVisible=function(e){this.mesh&&i&&i.visible!==e&&(0!==i.speed&&(e?r.incrementUpdatableObjects():r.decrementUpdatableObjects()),i.visible=e,this.mesh.traverse(function(t){t.visible=e}),r.requestRedraw())},this.getVisible=function(){return i&&i.visible},this.show=function(){this.setVisible(!0)},this.hide=function(){this.setVisible(!1)},this.remove=function(){var t;this.mesh&&(void 0!==(t=this.mesh).parent&&(t.parent.remove(t),i.visible&&0!==i.speed&&r.decrementUpdatableObjects(),r.requestRedraw()),this.linkOptions&&(r.removeLink(this),this.linkOptions.startFloor.removeLink(this),this.linkOptions.endFloor.removeLink(this)),this.mesh&&(this.mesh.geometry.dispose(),this.mesh=null),r.removePath(this))},this.getLength=function(){return o},this.getInterpolatedPosition=function(t){return!!n&&(t<0?t=0:1<t&&(t=1),{x:(t=n.getPoint(t)).x,y:t.y,z:t.z})},this.setInterpolatedStartEnd=function(t,e){(t=t||0)<0?t=0:1<t&&(t=1),(e=void 0===e?1:e)<0?e=0:1<e&&(e=1),i.interpolationStart=t,i.interpolationEnd=e,a.interpolationStart=t,a.interpolationEnd=e,a.recalculate(),this.mesh=r.recreateAndUpdateMeshFromPathGeometry(a.getGeometry(),this.mesh,i.visible),this.isCameraFacing&&this.updateCamerafacing(!0)},this.updateEndPoints=function(t,e){if(this.mesh){var i=this.mesh.vg&&this.mesh.vg.path||{};if(i.points&&2!=i.points.length)return!1;if(i.points[0]=t||n.getPoint(0),i.points[1]=e||n.getPoint(1),i.points[0].x===i.points[1].x&&i.points[0].y===i.points[1].y&&i.points[0].z===i.points[1].z)return void 0!==this.mesh.parent&&this.mesh.parent.remove(this.mesh),!1;(n=new s.CurvePath).add(new s.LineCurve3(new s.Vector3(i.points[0].x,i.points[0].y,i.points[0].z),new s.Vector3(i.points[1].x,i.points[1].y,i.points[1].z))),o=n.getLength(),a.updatePath(n),void 0===this.mesh.parent&&(this.meshParent.add(this.mesh),this.mesh.updateMatrixWorld());e=i.repeat;i.repeat<0&&i.url&&(e*=-o/i.thickness,this.mesh.material.map.repeat.x=e),this.mesh=r.recreateAndUpdateMeshFromPathGeometry(a.getGeometry(),this.mesh,i.visible),this.isCameraFacing&&this.updateCamerafacing(!0)}},this.setLinkOptions=function(t){this.isCameraFacing=t.cameraFacing||!1,this.linkOptions=t,this.linkOptions.startFloor.addLink(this),this.linkOptions.endFloor.addLink(this)},this.updateCamerafacing=function(t){var e={x:r.camera.matrix.elements[0],y:r.camera.matrix.elements[1],z:r.camera.matrix.elements[2]};if(!this.previousRight.equals(e)||t){if(this.previousRight.copy(e),(t=this.mesh.vg&&this.mesh.vg.path||{}).points&&2!=t.points.length)return!1;var i=t.points[1].z<t.points[0].z;a.recalculate({binormal:e}),this.mesh=r.recreateAndUpdateMeshFromPathGeometry(a.getGeometry(),this.mesh,t.visible),this.mesh.material.side=i?s.FrontSide:s.BackSide}},this.options=function(t,e){return void 0===t?i:void 0===e?"interpolationTextureLikeWindow"===t?a.interpolationTextureLikeWindow:i[t]:void("speed"===t?this.mesh.vg&&this.mesh.vg.path&&void 0!==this.mesh.vg.path.speed&&(0!==this.mesh.vg.path.speed&&r.decrementUpdatableObjects(),i.speed=e,0!=(this.mesh.vg.path.speed=e)&&i.visible&&r.incrementUpdatableObjects()):"interpolationTextureLikeWindow"===t?a.interpolationTextureLikeWindow!=e&&(a.interpolationTextureLikeWindow=e,i.interpolationTextureLikeWindow=e,this.setInterpolatedStartEnd(i.interpolationStart,i.interpolationEnd)):"interpolationStart"!==t&&"interpolationEnd"!==t||("interpolationStart"===t?i.interpolationStart=e:"interpolationEnd"===t&&(i.interpolationEnd=e),this.setInterpolatedStartEnd(i.interpolationStart,i.interpolationEnd)))}}}),mt("com/visioglobe/web/helpers/PathGeometry",["three"],function(b){function t(t,e){this.segments=e.segments||64,this.radius=e.radius||1,this.segmentsRadius=e.segmentsRadius||8,this.closed=e.closed||!1,this.interpolationStart=e.interpolationStart||0,this.interpolationEnd=e.interpolationEnd||1,this.interpolationTextureLikeWindow=void 0===e.interpolationTextureLikeWindow||e.interpolationTextureLikeWindow,this.zOffset=e.zOffset||0,e.debug&&(this.debug=new b.Object3D),this.updatePath(t)}return t.prototype.updatePath=function(t){this.path=t,this.frames=t.computeFrenetFrames(this.segments,this.closed),this.recalculate()},t.prototype.recalculate=function(t){t=t||{},this.geometry=new b.Geometry,this.grid=[];var e,i,r,n,o,a,s,l=(u=this.frames).tangents,c=u.normals,h=u.binormals,u=1/this.segments,p=t.binormal;(t=0)!=this.interpolationStart&&(t=Math.floor(this.interpolationStart/u));var d=this.segments-1;1==this.interpolationEnd||(v=this.interpolationEnd/u)===(d=Math.floor(v))&&d--;for(var f=1/(this.segmentsRadius-1),m=this.path,g=this.zOffset,v=t,y=d+2;v<y;v++)for(e=v*u,v===t&&0!=this.interpolationStart&&(e=this.interpolationStart),v===d+1&&1!=this.interpolationEnd&&(e=this.interpolationEnd),this.grid[v]=[],o=m.getPointAt(e),i=c[v],r=p||h[v],this.debug&&(e=l[v],this.debug.add(new b.ArrowHelper(e,o,this.radius,255)),this.debug.add(new b.ArrowHelper(i,o,this.radius,16711680)),this.debug.add(new b.ArrowHelper(r,o,this.radius,65280))),e=0,i=this.segmentsRadius;e<i;e++)n=e*f-.5,n*=this.radius,this.grid[v][e]=this.geometry.vertices.push(new b.Vector3(o.x+n*r.x,o.y+n*r.y,o.z+n*r.z+g))-1;for(f=this.interpolationTextureLikeWindow?0:this.interpolationStart,m=1/(this.segmentsRadius-1),v=t,y=d+1;v<y;v++)for(l=this.closed?(v+1)%this.segments:v+1,r=(g=v*u-f)+u,v===t&&0!=this.interpolationStart&&(g=this.interpolationStart-f),v===d&&1!=this.interpolationEnd&&(r=this.interpolationEnd-f),e=0;e<this.segmentsRadius-1;e++)o=(e+1)%this.segmentsRadius,c=this.grid[v][e],h=this.grid[l][e],p=this.grid[l][o],o=this.grid[v][o],s=(n=e*m)+m,i=new b.Vector2(g,n),n=new b.Vector2(r,n),a=new b.Vector2(r,s),s=new b.Vector2(g,s),this.geometry.faces.push(new b.Face3(c,h,o)),this.geometry.faceVertexUvs[0].push([i,n,s]),this.geometry.faces.push(new b.Face3(h,p,o)),this.geometry.faceVertexUvs[0].push([n.clone(),a,s.clone()]);this.geometry.computeFaceNormals(),this.geometry.computeVertexNormals()},(t.prototype.constructor=t).prototype.getGeometry=function(){return this.geometry},t}),mt("com/visioglobe/web/Place",["three"],function(u){var p={};return function(i,l,t,e){void 0!==t&&(void 0===i.places[t]?i.places[t]=this:console.log("ERROR: Should have one place per ID: "+t)),this.vg={id:t,floor:null,originalColor:null,position:null,radius:null};var c=new u.Vector3,h=new u.Box3;Object.keys(l).forEach(function(t){var e,i=l[t];for(e in this.vg)if("id"!==e)if(null===this.vg[e]&&"radius"===e){if(i.geometry.boundingBox)i.geometry.boundingBox.getSize(c);else{if(h.makeEmpty(),i.geometry instanceof u.Geometry){var r=i.geometry.vertices,n=i.geometry.faces;t=i.vg.faces_offset;for(var o=i.vg.faces_offset+i.vg.nb_faces,a=n.length;t<a&&t<o;t++){var s=n[t];h.expandByPoint(r[s.a]),h.expandByPoint(r[s.b]),h.expandByPoint(r[s.c])}}else if(i.geometry instanceof u.BufferGeometry)for(r=i.geometry.getAttribute("position"),t=i.vg.faces_offset,o=i.vg.faces_offset+i.vg.nb_faces;t<o;t++)for(a=n=3*t;a<n+3;a++)s=new u.Vector3(r.getX(a),r.getY(a),r.getZ(a)),h.expandByPoint(s);h.getSize(c)}this.vg[e]=2*c.length()}else null===this.vg[e]?this.vg[e]=i.vg[e]:this.vg[e]===i.vg[e]||-1!==["position","radius","originalColor"].indexOf(e)||p[e]||(console.log("ERROR: Several element with same ID but different "+e+" are present"),p[e]=!0)},this),this.setColor=function(e){return Object.keys(l).forEach(function(t){i.setShapeColor(l[t],e)}),i.requestRedraw(),!0},this.resetColor=function(){return Object.keys(l).forEach(function(t){i.setShapeColor(l[t],l[t].vg.originalColor)}),i.requestRedraw(),!0}}}),mt("com/visioglobe/web/poi/PublicPOI",[],function(){function e(t){this.proxy=t,this.count=e.counter++,this.vg={poi:!0}}return e.counter=0,(e.prototype.constructor=e).prototype.show=function(){return this.proxy.setVisible(!0)},e.prototype.hide=function(){return this.proxy.setVisible(!1)},e.prototype.remove=function(){return this.proxy.remove.apply(this.proxy,arguments)},e.prototype.options=function(){return this.proxy.options.apply(this.proxy,arguments)},Object.defineProperty(e.prototype,"visible",{get:function(){return this.proxy.getVisible()},set:function(t){this.proxy.setVisible(t)}}),Object.defineProperty(e.prototype,"opacity",{get:function(){return this.proxy.getOpacity()},set:function(t){this.proxy.setOpacity(t)}}),e}),mt("com/visioglobe/web/poi/POIProxy",["com/visioglobe/common/PublicInterface"],function(e){function r(t){this.publicPOI=null,this.count=r.counter++,e.create(this,t,i,n,o)}var i=[],n=[],o="getVisible setVisible getOpacity setOpacity remove options".split(" "),a="text url model selector textTextureHeight family color position alignment scale zoomScaleFactor zoomScaleFast iconScale angle heading floor lod visible opacity id visibilityRampStartVisible visibilityRampFullyVisible visibilityRampStartInvisible visibilityRampFullyInvisible clickable fixed width height overlay flip face2d image onObjectMouseOver onObjectMouseOut onObjectMouseUp multiline track animationNames".split(" ");return r.isPublicParameter=function(t){return-1!==a.indexOf(t)},r.getPublicParameters=function(e){var i={};return Object.keys(e).map(function(t){r.isPublicParameter(t)&&(i[t]=e[t])}),i},r.counter=1e3,r.prototype.constructor=r}),mt("com/visioglobe/web/helpers/Billboard",["three"],function(r){r.Billboard=function(t,e){this.mapviewer=e,this.constraints=void 0!==t.constraints?t.constraints:[r.Billboard.CAMERA_FACING,r.Billboard.FIXED,r.Billboard.CAMERA_FACING],void 0!==t.face2d&&!0===t.face2d&&(this.constraints=[r.Billboard.FIXED,r.Billboard.FIXED,r.Billboard.CAMERA_FACING]),this.face2d=this.constraints[0]==r.Billboard.FIXED&&this.constraints[1]==r.Billboard.FIXED&&this.constraints[2]==r.Billboard.CAMERA_FACING,this.lastCameraOrientationZ=!1,r.Object3D.call(this)},r.Billboard.CAMERA_FACING=0,r.Billboard.FIXED_MODULO_PI=1,r.Billboard.FIXED=2,r.Billboard.prototype=new r.Object3D,r.Billboard.prototype.constructor=r.Billboard;var n=new r.Matrix4,o=new r.Matrix4,a=new r.Matrix4;return r.Billboard.prototype.updateMatrix=function(){if(this.face2d){if(!this._dirty&&!1!==this.lastCameraOrientationZ&&this.mapviewer.manipulator.orientation.z==this.lastCameraOrientationZ)return;if(this.lastCameraOrientationZ=this.mapviewer.manipulator.orientation.z,this.mapviewer.manipulator.cachedMatrixOrientationZ===this.mapviewer.manipulator.orientation.z)return this.matrix.copy(this.mapviewer.manipulator.cachedMatrixForOrientation),this.matrix.setPosition(this.position),void(this.matrixWorldNeedsUpdate=!0)}if(this.mapviewer.camera.vg){var t=this.mapviewer.camera.vg.cameraComponents;this.rotation.set(0,0,0);for(var e=this.rotation.toArray(),i=0;i<3;++i)switch(this.constraints[i]===r.Billboard.CAMERA_FACING&&(e[i]=t[i]),i){case 0:o.makeRotationX(-e[0]);break;case 1:a.makeRotationY(e[1]);break;case 2:n.makeRotationZ(-e[2])}this.rotation.fromArray(e),this.matrix.identity(),this.matrix.multiply(n),this.matrix.multiply(o),this.matrix.multiply(a),this.face2d&&(this.mapviewer.manipulator.cachedMatrixOrientationZ=this.mapviewer.manipulator.orientation.z,this.mapviewer.manipulator.cachedMatrixForOrientation=this.matrix.clone()),this.matrix.setPosition(this.position),this.matrixWorldNeedsUpdate=!0,this._dirty=!1}},r.Billboard}),mt("underscoretiny",[],function(){var s={isObject:function(t){var e=typeof t;return"function"==e||"object"==e&&!!t},indexOf:function(t,e){if(null==t)return-1;for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1},has:function(t,e){return null!=t&&Object.prototype.hasOwnProperty.call(t,e)},keys:function(t){if(!s.isObject(t))return[];if(Object.keys)return Object.keys(t);var e,i=[];for(e in t)s.has(t,e)&&i.push(e);return i},extend:function(t){if(!s.isObject(t))return t;for(var e,i,r=1,n=arguments.length;r<n;r++)for(i in e=arguments[r])hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},each:function(t,e){if(null==t)return t;if((n=t.length)===+n)for(r=0;r<n;r++)e(t[r],r,t);else for(var i=s.keys(t),r=0,n=i.length;r<n;r++)e(t[i[r]],i[r],t);return t},filter:function(t,r){var n=[];return null==t||s.each(t,function(t,e,i){r(t,e,i)&&n.push(t)}),n},isMatch:function(t,e){var i=s.keys(e),r=i.length;if(null==t)return!r;for(var n=Object(t),o=0;o<r;o++){var a=i[o];if(e[a]!==n[a]||!(a in n))return!1}return!0}};return s}),mt("com/visioglobe/web/poi/POI","com/visioglobe/web/poi/POIProxy com/visioglobe/web/helpers/CachedTexture com/visioglobe/web/helpers/Billboard com/visioglobe/common/utils/Utils three underscoretiny".split(" "),function(f,m,g,p,v,y){function o(a,t,e,i,r,n,o,s){var l,c,h,u,p,d;this.mapviewer=a._mapviewer,this.proxy=new f(this),this.addPoiVariables=a,this.parameters=t,void 0!==e&&void 0!==i&&(h=a.MapviewerPrivate,l=new v.Euler,this.rotationObject=new v.Object3D,this.rotationObject.name="rotationObject",this.rotationObject.matrixAutoUpdate=!1,t.fixed?(this.positionObject=new v.Object3D,this.positionObject.name="options fixed",o?l.set(-Math.PI/2,t.angle*Math.PI/180,0):l.set(0,0,-t.angle*Math.PI/180),this.rotationObject.rotation.copy(l),this.rotationObject.updateMatrix()):(this.positionObject=new g({face2d:t.face2d},this.mapviewer),this.positionObject.name="options !fixed",(r||n||o)&&e.cameraUpdatableObjects.push(this.positionObject)),this.positionObject.matrixAutoUpdate=!1,t.position.z=t.position.z||0,this.positionObject.position.copy(t.position),this.positionObject.position.add({x:0,y:0,z:h.zOffsetPOI}),this.positionObject.add(this.rotationObject),this.positionObject.vg={poi:t,meshes:{},opacity:d},this.rotationObject.current_alignment=t.alignment,this.rotationObject.current_aspect=0!==t.scale.y?t.scale.x/t.scale.y:1,this.rotationObject.lastCameraOrientationZ=!1,this.rotationObject.dirty=!1,this.rotationObject._isFlipped=void 0,(c=this).rotationObject.updateMatrix=function(){t:{var t=a._mapviewer.manipulator.radius,e=a._mapviewer.manipulator.orientationNormalized.z,i=c.parameters,r=0,n=(r=i.zoomScaleFast?.02*t*i.zoomScaleFactor:.15*Math.sqrt(t)*i.zoomScaleFactor)!==i._zoomScale,o=e!==this.lastCameraOrientationZ;if(this.dirty||o||0!==i.zoomScaleFactor&&n){if(0!==i.zoomScaleFactor&&(this.dirty||n)&&(i._zoomScale=r,r={x:i._zoomScale,y:i._zoomScale,z:1},-1!==i.width&&-1!==i.height?(void 0!==i.text&&""!==i.text&&i.multiline&&(n||c.shouldRecomputeLines(t))&&c.createMultiLineText(),c.getBoxScale()>i._zoomScale?this.visible=!0:this.visible=!1):this.visible=!0,this.lastCameraRadius=t,void 0!==c.positionObject.vg.meshes.poi_text&&0<c.positionObject.vg.meshes.poi_text.length?this.current_position=c.updateTextMeshes():void 0!==c.positionObject.vg.meshes.poi_url&&(this.current_position=y.extend({},c.positionObject.vg.meshes.poi_url.position)),this.current_position.x*=r.x,this.position.copy(new v.Vector3),this.position.x=-this.current_position.x/2,this.position.x+=i.alignment.x*this.current_position.x/2,this.dirty=!0,this.scale.copy(r)),i.fixed&&i.flip&&(this.dirty||o)){if(this.lastCameraOrientationZ=e,n=(t=i._inverseAngleInRadians-this.lastCameraOrientationZ)>Math.PI||t<0&&t>-Math.PI,!this.dirty&&n===this._isFlipped)break t;this.dirty=!1,this._isFlipped=n,t=-this.current_position.x,e=this.current_alignment,n?(void(n=0)!==i.text&&""!==i.text&&(n=i._textAspectRatio),void 0!==i.url&&""!==i.url&&(n+=this.current_aspect),this.position.set(.5*t*(e.x+1),t*e.y/(n=0===n?1:n),0),this.rotation.set(0,0,-(i.angle+180)*Math.PI/180)):(this.position.set(.5*t*(1-e.x),0,0),this.rotation.set(0,0,-i.angle*Math.PI/180)),(i=new v.Matrix4).makeRotationFromEuler(this.rotation),this.position.applyMatrix4(i)}this.dirty=!1}v.Object3D.prototype.updateMatrix.apply(this)}},(t.fixed&&t.flip||0<t.zoomScaleFactor)&&(this.rotationObject.matrixAutoUpdate=!1,(r||n||o)&&e.cameraUpdatableObjects.push(this.rotationObject)),d=void 0!==this.parameters.opacity?this.parameters.opacity:this.mapviewer.computeOpacity(this.positionObject.position,this.parameters,this.mapviewer.camera.position),h=new v.Vector3,o?this.setModel(t.model):(r&&(u=new m(this.mapviewer,t.url,!0),p=this.mapviewer.plane_geometry,d=new v.MeshBasicMaterial({map:u,color:16777215,side:v.FrontSide,transparent:!0,depthWrite:!1,depthTest:!t.overlay&&this.mapviewer.useDepthWriteForPOIs,opacity:d}),(d=new v.Mesh(p,d)).name="poi_url",d.matrixAutoUpdate=!1,d.renderOrder=-a.MapviewerPrivate.renderDepthPOI,t.overlay&&(d.renderOrder=-a.MapviewerPrivate.renderDepthPOIOverlay),this.positionObject.vg.meshes.poi_url=d,null!==e&&t.clickable&&(d.vg={id:t.id,poi:t,originalColor:16777215},e.pickables.push(d)),p=t.scale,0<t.zoomScaleFactor&&(p={x:1,y:1,z:1}),h.x+=.5*p.x,h.y+=.5*p.y*t.alignment.y,d.position.copy(h),h.x+=.5*p.x,d.scale.set(p.x,p.y,1),d.updateMatrix(),this.rotationObject.add(d)),n&&(t.multiline?this.createMultiLineText():(h=this.initText(t.text),this.parameters._textAspectRatio=h.aspectRatio,d=this.createTextMesh(this.parameters.text,h,0,0),this.rotationObject.add(d),this.positionObject.vg.meshes.poi_text=[],this.positionObject.vg.meshes.poi_text.push(d)),h=this.updateTextMeshes())),-1!==t.width&&-1!==t.height&&(d=this.getBoxScale(),this.rotationObject.scale.copy({x:d,y:d,z:1}),h.x*=this.rotationObject.scale.x),(d=new v.Matrix4).makeRotationFromEuler(l),this.rotationObject.current_position=h,this.rotationObject.position.x=-h.x/2,this.rotationObject.position.x+=t.alignment.x*h.x/2,this.rotationObject.position.applyMatrix4(d),void 0!==t.selector&&""!==t.selector&&this.setSelector(t.selector),this.positionObject.updateMatrix(),this.rotationObject.updateMatrix(),i.add(this.positionObject),this.positionObject.updateMatrixWorld(!0),(r||o||n||s)&&e.rampObjects.push(this.positionObject),this.updateVisibleObject(),this.mapviewer.mustUpdateCameraObjects=!0,this.mapviewer.requestRedraw())}(o.prototype.constructor=o).prototype.vg={poi:!0},o.prototype.updateVisibleObject=function(){this.visibleObject=void 0!==this.rotationObject?this.rotationObject:this.positionObject;var e=this.parameters;!1===this.parameters.visible&&this.visibleObject&&this.visibleObject.traverse(function(t){t.visible=e.visible})},o.prototype.getOpacity=function(){return this.parameters&&this.parameters.opacity},o.prototype.setOpacity=function(r){var t,e=this.parameters,i=this.mapviewer;"number"!=typeof(e.opacity=r)?(r=this.mapviewer.computeOpacity(this.positionObject.position,this.parameters,this.mapviewer.camera.position),delete e.opacity,-1===(t=(e=(e=(t=this.mapviewer.getFloor(this.parameters.floor)).getLOD(this.parameters.lod))||t.floorContentLOD).rampObjects.indexOf(this.positionObject))&&e.rampObjects.push(this.positionObject)):-1!==(t=(e=(e=(t=this.mapviewer.getFloor(this.parameters.floor)).getLOD(this.parameters.lod))||t.floorContentLOD).rampObjects.indexOf(this.positionObject))&&e.rampObjects.splice(t,1),this.positionObject.traverse(function(t){if(t.material&&((t.material.opacity=r)<1&&!t.material.transparent&&(t.material.transparent=!0),t=t.material.materials))for(var e=0,i=t.length;e<i;++e)(t[e].opacity=r)<1&&!t[e].transparent&&(t[e].transparent=!0)}),i.requestRedraw()},o.prototype.getVisible=function(){return this.parameters&&this.parameters.visible},o.prototype.setVisible=function(t){var e=this.parameters,i=this.visibleObject,r=this.mapviewer;null!==e&&e.visible!==t&&(e.visible=t,i&&i.traverse(function(t){t.visible=e.visible}),r.mustUpdateCameraObjects=!0,r.requestRedraw())},o.prototype.realRemove=function(t){var e,i,r,n=this.proxy.publicPOI,o=this.mapviewer,a=this.parameters,s=this.positionObject,l=this.rotationObject;if(t&&this.addPoiVariables.POIFactory.removeFromPois(o,a.id,n),s||l){void 0!==a._measuringCanvas&&(a._measuringCanvas=null),null===(n=(d=o.getFloor(a.floor)).getLOD(a.lod))&&(n=d.floorContentLOD);var c,h,u,p,d=s.vg.meshes,f=n.pickables;for(c in d)"poi_text"===c?d[c].forEach(function(t){-1!==(u=f.indexOf(t))&&f.splice(u,1),t.geometry&&t.geometry.vg&&t.geometry.vg.permanent||t.geometry.dispose()}):(h=d[c],-1!==(u=f.indexOf(h))&&f.splice(u,1),h.geometry&&h.geometry.vg&&h.geometry.vg.permanent||h.geometry.dispose());-1!==(u=o.pois_with_selector.indexOf(a))&&(null!==(c=document.querySelector(o.pois_with_selector[u].selector))&&(c.style.display="none"),o.pois_with_selector.splice(u,1)),void 0===a.model&&t&&(p=this.addPoiVariables,setTimeout((e=o,i=a,r=s,function(){p.POIFactory.removeMaterial(e,i,r)}),0)),void 0!==a.model&&(o.models[a.model].nbRefs--,0===o.models[a.model].nbRefs&&this.addPoiVariables.POIFactory.removeModel(o,a.model)),void 0!==s.parent&&s.parent.remove(s),void 0!==l&&(void 0!==l.parent&&l.parent.remove(s),-1!==(u=n.cameraUpdatableObjects.indexOf(l))&&n.cameraUpdatableObjects.splice(u,1),l.children.length&&(h=l.children[0],this.animations&&this.animations.length&&(Object.keys(this.animations).forEach(function(t){this.animations[t].action&&this.animations[t].action.stop(),this.mixer.uncacheClip(this.animations[t].clip)},this),-1!==(u=n.animatedObjects.indexOf(h))&&n.animatedObjects.splice(u,1),this.mapviewer.decrementUpdatableObjects()))),-1!==(u=n.cameraUpdatableObjects.indexOf(s))&&n.cameraUpdatableObjects.splice(u,1),-1!==(u=n.rampObjects.indexOf(s))&&n.rampObjects.splice(u,1),this.positionObject=null}},o.prototype.remove=function(){null!==this.parameters&&(this.realRemove(!0),this.mapviewer.requestRedraw(),this.parameters=this.mapviewer=null)},o.prototype.options=function(e,t,i){if(null!==this.parameters){if(void 0===e)return f.getPublicParameters(this.parameters);var r;if("object"==typeof e)this.parameters._empty?(r=y.extend({},this.parameters),Object.keys(e).forEach(function(t){void 0===e[t]?delete r[t]:r[t]=e[t]}),this.addPoiVariables.POIFactory.createPOI(this.addPoiVariables,r,this.proxy.publicPOI),this.realRemove(!1)):Object.keys(e).forEach(function(t){this.setParameter(t,e[t])},this);else if("string"==typeof e){if(void 0===t&&f.isPublicParameter(e))return"animationNames"===e?this.getAnimationNames():this.getParameter(e);this.parameters._empty?((r=y.extend({},this.parameters))[e]=t,this.realRemove(!1),this.addPoiVariables.POIFactory.createPOI(this.addPoiVariables,r,this.proxy.publicPOI)):this.setParameter(e,t)}}},o.prototype.setParameter=function(t,e){switch(t){case"position":this.setPosition(e);break;case"text":this.setText(e);break;case"multiline":this.setMultiline(e);break;case"visible":this.setVisible(e);break;case"opacity":this.setOpacity(e);break;case"textTextureHeight":this.setTextTextureHeight(e);break;case"color":this.setColor(e);break;case"family":this.setFamily(e);break;case"url":this.setURL(e);break;case"model":this.setModel(e);break;case"startAnimation":this.startAnimation(e);break;case"stopAnimation":this.stopAnimation(e);break;case"selector":this.setSelector(e);break;case"alignment":this.setAlignment(e);break;case"scale":this.setScale(e);break;case"zoomScaleFactor":this.setZoomScaleFactor(e);break;case"zoomScaleFast":this.setZoomScaleFast(e);break;case"iconScale":case"icon_scale":console.log('Deprecated option. It will be taken into account if there is no text. Otherwise, "scale" option will be used.'),void 0!==this.parameters.text&&""!==this.parameters.text||this.setScale(e);break;case"floor":this.setFloor(e);break;case"id":this.setID(e);break;case"visibilityRampStartVisible":this.parameters.visibilityRampStartVisible=e;break;case"visibilityRampFullyVisible":this.parameters.visibilityRampFullyVisible=e;break;case"visibilityRampStartInvisible":this.parameters.visibilityRampStartInvisible=e;break;case"visibilityRampFullyInvisible":this.parameters.visibilityRampFullyInvisible=e;break;case"onObjectMouseOver":this.parameters.onObjectMouseOver=e;break;case"onObjectMouseOut":this.parameters.onObjectMouseOut=e;break;case"onObjectMouseUp":this.parameters.onObjectMouseUp=e;break;case"clickable":this.setClickable(e);break;case"fixed":this.setFixed(e);break;case"angle":this.setAngle(e);break;case"heading":this.setHeading(e);break;case"width":this.setWidth(e);break;case"height":this.setHeight(e);break;case"overlay":this.setOverlay(e);break;case"flip":this.setFlip(e);break;case"face2d":this.setFace2d(e);break;case"track":this.setTrack(e)}},o.prototype.getParameter=function(t){return this.parameters&&this.parameters[t]},o.prototype.setPosition=function(t){var e=t||{x:0,y:0,z:0};e.z=t.z||0,this.parameters.position=e,void 0!==this.positionObject&&(this.positionObject.position.copy(e),this.positionObject._dirty=!0,this.positionObject.updateMatrix(),this.positionObject.updateMatrixWorld(),this.mapviewer.requestRedraw()),void 0!==this.parameters.track&&this.parameters.track&&void 0!==this.mapviewer.statistics&&this.mapviewer.statistics.logStat("position",{id:this.parameters.id,position:e})},o.prototype.initText=function(t){(t=this.mapviewer.textGenerator.generateTextNoAtlas(t,this.parameters)).texture.vg.nbRefs++;var e=void 0!==this.parameters.opacity?this.parameters.opacity:this.mapviewer.computeOpacity(this.positionObject.position,this.parameters,this.mapviewer.camera.position);return t.material=new v.MeshBasicMaterial({map:t.texture,color:16777215,side:v.FrontSide,transparent:!0,depthWrite:!1,depthTest:!this.parameters.overlay&&this.mapviewer.useDepthWriteForPOIs,opacity:e}),t.texture=null,t},o.prototype.pushToLists=function(){var t,e=this.mapviewer.getFloor(this.parameters.floor);e&&(t=(t=e.getLOD(this.parameters.lod))||e.floorContentLOD,this.parameters.fixed||-1===t.cameraUpdatableObjects.indexOf(this.positionObject)&&t.cameraUpdatableObjects.push(this.positionObject),(this.parameters.fixed&&this.parameters.flip||0<this.parameters.zoomScaleFactor)&&-1===t.cameraUpdatableObjects.indexOf(this.rotationObject)&&t.cameraUpdatableObjects.push(this.rotationObject),(void 0!==this.parameters.text&&""!==this.parameters.text||void 0!==this.parameters.url&&""!==this.parameters.url)&&-1===t.rampObjects.indexOf(this.positionObject)&&t.rampObjects.push(this.positionObject))},o.prototype.getBoxScale=function(){var e=this.parameters._textAspectRatio,t=1;void 0!==this.positionObject.vg.meshes.poi_text&&1<this.positionObject.vg.meshes.poi_text.length&&(t=this.positionObject.vg.meshes.poi_text.length,this.positionObject.vg.meshes.poi_text.forEach(function(t){e=Math.max(e,t.userData.aspectRatio)}));var i=t,r=t=0;return void 0!==this.parameters.url&&""!==this.parameters.url&&(r=t=1,0===this.parameters.zoomScaleFactor&&(t=this.parameters.scale.x,r=this.parameters.scale.y)),void 0!==this.parameters.text&&""!==this.parameters.text&&(0===this.parameters.zoomScaleFactor&&(e*=this.parameters.scale.x,i*=this.parameters.scale.y),t+=e,r=Math.max(r,i)),i=1,0<t&&(i=this.parameters.width/t),i=0<r&&r*i>this.parameters.height?this.parameters.height/r:i},o.prototype.shouldRecomputeLines=function(t){var e=this.parameters.text.split(" ").length;if(e<2||void 0===this.positionObject.vg.meshes.poi_text)return!1;var i=this.positionObject.vg.meshes.poi_text.length;if(t===this.rotationObject.lastCameraRadius||t>this.rotationObject.lastCameraRadius&&i===e||t<this.rotationObject.lastCameraRadius&&1===i)return!1;var r=0;return this.positionObject.vg.meshes.poi_text.forEach(function(t){t.userData.aspectRatio>r&&(r=t.userData.aspectRatio,currentLongestLine=t.userData.text)}),this.parameters.url&&(r+=this.parameters.scale.x/this.parameters.scale.y),e=this.getBoxScale(),0!==this.parameters.zoomScaleFactor&&(e=this.parameters._zoomScale),!(r*e<this.parameters.width&&t>this.rotationObject.lastCameraRadius)};return o.prototype.createMultiLineText=function(){var t=0;this.parameters.url&&(t+=this.parameters.scale.x/this.parameters.scale.y);var e=this.mapviewer.textGenerator.measureText(this.parameters.text,this.parameters),i=t+e.width/e.height,r=[this.parameters.text],n=this.parameters.text.split(" ").length,o=1,a=e.width,s=this.parameters.scale.x;0!==this.parameters.zoomScaleFactor&&(s=this.parameters._zoomScale);for(var l=i;s*l>this.parameters.width&&o<n;){var c=function(t,e){var i=t.split(" ");if(e<2||i.length<e)return[];for(var r=[],n=t.length/e,o=i[0],a=1;a<i.length;a++){var s=o.length+i[a].length+1;o.length>n||1.5*n<s?(r.push(o),o=i[a]):o+=" "+i[a]}return r.push(o),r}(this.parameters.text,++o);if(0===c.length)break;l=i=a=0,r.splice(0,r.length);for(var h=0;h<c.length;h++)e=this.mapviewer.textGenerator.measureText(c[h],this.parameters),l=Math.max(l,t+e.width/e.height),a=Math.max(a,e.width),i+=e.height,r.push(c[h]);i=(t+a)/i}if(n=!0,void 0!==this.positionObject.vg.meshes.poi_text&&0<this.positionObject.vg.meshes.poi_text.length){if(this.positionObject.vg.meshes.poi_text.length===r.length)for(n=!1,t=0;t<r.length;t++)if(this.positionObject.vg.meshes.poi_text[t].userData.text!==r[t]){n=!0;break}n&&(this.positionObject.vg.meshes.poi_text.forEach(function(t){t.material.map.vg.nbRefs--,this.mapviewer.textGenerator.disposeTexture(t.material.map),this.rotationObject.remove(t)},this),this.positionObject.vg.meshes.poi_text.splice(0,this.positionObject.vg.meshes.poi_text.length))}else this.positionObject.vg.meshes.poi_text=[];if(n){for(t=0;t<r.length;t++)(e=this.initText(r[t])).text=r[t],n=this.createTextMesh(e.text,e,0,.5*(r.length-1)-t),this.rotationObject.add(n),this.positionObject.vg.meshes.poi_text.push(n);this.parameters._textAspectRatio=i}},o.prototype.createTextMesh=function(t,e,i,r){var n=new v.Mesh(e.geometry,e.material);return n.name="poi_text",n.userData={text:t,width:e.width,height:e.height,aspectRatio:e.aspectRatio,horizontalOffset:i,verticalOffset:r},n.matrixAutoUpdate=!1,n.renderOrder=-this.addPoiVariables.MapviewerPrivate.renderDepthPOI,this.parameters.overlay&&(n.renderOrder=-this.addPoiVariables.MapviewerPrivate.renderDepthPOIOverlay),null!==(e=(e=(t=this.mapviewer.getFloor(this.parameters.floor)).getLOD(this.parameters.lod))||t.floorContentLOD)&&this.parameters.clickable&&(n.vg={id:this.parameters.id,poi:this.parameters,originalColor:16777215},e.pickables.push(n)),n},o.prototype.updateTextMeshes=function(){var i=new v.Vector3,e=this.parameters._textAspectRatio;return 1<this.positionObject.vg.meshes.poi_text.length&&this.positionObject.vg.meshes.poi_text.forEach(function(t){e=Math.max(e,t.userData.aspectRatio)}),0===this.parameters.zoomScaleFactor?(i.x+=.5*this.parameters.scale.x*e,i.y+=.5*this.parameters.scale.y*this.parameters.alignment.y,void 0!==this.parameters.url&&""!==this.parameters.url&&(i.x+=this.parameters.scale.x),this.positionObject.vg.meshes.poi_text.forEach(function(t){var e=y.extend({},i);e.x+=this.parameters.scale.x*t.userData.horizontalOffset,e.y+=this.parameters.scale.y*t.userData.verticalOffset,t.position.copy(e),t.scale.copy({x:t.userData.aspectRatio*this.parameters.scale.x,y:this.parameters.scale.y,z:1}),t.updateMatrix()},this),i.x+=.5*this.parameters.scale.x*e):(i.x+=.5*e,i.y+=.5*this.parameters.alignment.y,void 0!==this.parameters.url&&""!==this.parameters.url&&(i.x+=1),this.positionObject.vg.meshes.poi_text.forEach(function(t){var e=y.extend({},i);e.x+=t.userData.horizontalOffset,e.y+=t.userData.verticalOffset,t.position.copy(e),t.scale.copy({x:t.userData.aspectRatio,y:1,z:1}),t.updateMatrix()},this),i.x+=.5*e),i},o.prototype.setText=function(t,e){if(("string"!=typeof t||""===t)&&void 0!==this.positionObject.vg.meshes.poi_text&&0<this.positionObject.vg.meshes.poi_text.length){if(delete this.parameters.text,this.positionObject.vg.meshes.poi_text.forEach(function(t){this.rotationObject.remove(t)},this),this.positionObject.vg.meshes.poi_text.splice(0,this.positionObject.vg.meshes.poi_text.length),delete this.positionObject.vg.meshes.poi_text,void 0!==this.parameters.url&&""!==this.parameters.url){if(!(this.mapviewer.vgnobatch||this.mapviewer.vgnobatchicon||this.mapviewer.vgnobatchfacing&&!this.parameters.fixed))return this.realRemove(!1),void this.addPoiVariables.POIFactory.createPOI(this.addPoiVariables,this.parameters,this.proxy.publicPOI);this.rotationObject.dirty=!0,this.setURL(this.parameters.url)}}else{if(void 0!==this.parameters.model&&""!==this.parameters.model)return void console.log("Cannot set text on a POI initialized with a model.");var i;this.parameters.multiline?(this.parameters.text=t.replace(/\s+/g," ").trim(),this.createMultiLineText(),void 0!==this.positionObject.vg.meshes.poi_text&&0<this.positionObject.vg.meshes.poi_text.length&&this.pushToLists()):(this.parameters.text!==t||!this.parameters.multiline&&void 0!==this.positionObject.vg.meshes.poi_text&&1<this.positionObject.vg.meshes.poi_text.length)&&(this.parameters.text=t,i=this.initText(this.parameters.text),this.parameters._textAspectRatio=i.aspectRatio,void 0!==this.positionObject.vg.meshes.poi_text&&0<this.positionObject.vg.meshes.poi_text.length&&(this.positionObject.vg.meshes.poi_text.forEach(function(t){t.material.map.vg.nbRefs--,this.mapviewer.textGenerator.disposeTexture(t.material.map),this.rotationObject.remove(t)},this),this.positionObject.vg.meshes.poi_text.splice(0,this.positionObject.vg.meshes.poi_text.length)),i=this.createTextMesh(this.parameters.text,i,0,0),this.rotationObject.add(i),this.positionObject.vg.meshes.poi_text=[],this.positionObject.vg.meshes.poi_text.push(i),this.pushToLists()),i=this.updateTextMeshes(),0===this.parameters.zoomScaleFactor&&(-1!==this.parameters.width&&-1!==this.parameters.height&&(t=this.getBoxScale(),this.rotationObject.scale.copy({x:t,y:t,z:1}),i.x*=this.rotationObject.scale.x),this.rotationObject.current_position=i,this.rotationObject.position.copy(new v.Vector3),this.rotationObject.position.x=-this.rotationObject.current_position.x/2,this.rotationObject.position.x+=this.parameters.alignment.x*this.rotationObject.current_position.x/2),this.rotationObject.dirty=!0,this.rotationObject.updateMatrix()}this.positionObject.updateMatrix(),this.positionObject.updateMatrixWorld(!0),this.mapviewer.mustUpdateCameraObjects=!0,this.mapviewer.requestRedraw()},o.prototype.setMultiline=function(t){"boolean"==typeof t&&this.parameters.multiline!==t&&(this.parameters.multiline=t,void 0!==this.parameters.text&&""!==this.parameters.text&&this.setText(this.parameters.text))},o.prototype.setTextTextureHeight=function(t){"number"==typeof t&&this.parameters.textTextureHeight!==t&&(this.parameters.textTextureHeight=t,void 0!==this.parameters.text&&""!==this.parameters.text&&(this.positionObject.vg.meshes.poi_text.forEach(function(t){var e=this.initText(t.userData.text);t.material.map.vg.nbRefs--,this.mapviewer.textGenerator.disposeTexture(t.material.map),void 0!==t&&(t.material=e.material)},this),this.mapviewer.requestRedraw()))},o.prototype.setColor=function(t){"string"==typeof t&&this.parameters.color!==t&&null!==t.match("#[0-9A-Fa-f]{6}")&&(this.parameters.color=t,void 0!==this.parameters.text&&""!==this.parameters.text&&(this.positionObject.vg.meshes.poi_text.forEach(function(t){var e=this.initText(t.userData.text);t.material.map.vg.nbRefs--,this.mapviewer.textGenerator.disposeTexture(t.material.map),void 0!==t&&(t.material=e.material)},this),this.mapviewer.requestRedraw()))},o.prototype.setFamily=function(t){"string"==typeof t&&this.parameters.family!==t&&(this.parameters.family=t,void 0!==this.parameters.text&&""!==this.parameters.text&&(this.positionObject.vg.meshes.poi_text.forEach(function(t){var e=this.initText(t.userData.text);t.material.map.vg.nbRefs--,this.mapviewer.textGenerator.disposeTexture(t.material.map),void 0!==t&&(t.material=e.material)},this),this.mapviewer.requestRedraw()))},o.prototype.setURL=function(t){if(void 0!==t&&""!==t||void 0===this.positionObject.vg.meshes.poi_url){if(void 0!==this.parameters.model&&""!==this.parameters.model)return void console.log("Cannot set image on a POI initialized with a model.");var e=new v.Vector3,i=void 0!==(r=this.rotationObject.getObjectByName("poi_url"));if(!i||this.parameters.url!==t){if(!(r=this.mapviewer.textures[t])||!r.loaded)return void new m(this.mapviewer,t,!0,(o=t,a=this,function(t){a.options("url",o)}));this.parameters.url=t;var r=new m(this.mapviewer,this.parameters.url,!0),n=void 0!==this.parameters.opacity?this.parameters.opacity:this.mapviewer.computeOpacity(this.positionObject.position,this.parameters,this.mapviewer.camera.position);t=this.mapviewer.plane_geometry,n=new v.MeshBasicMaterial({map:r,color:16777215,side:v.FrontSide,transparent:!0,depthWrite:!1,depthTest:!this.parameters.overlay&&this.mapviewer.useDepthWriteForPOIs,opacity:n}),void 0===(r=this.positionObject.vg.meshes.poi_url)?((r=new v.Mesh(t,n)).name="poi_url",r.matrixAutoUpdate=!1,r.renderOrder=-this.addPoiVariables.MapviewerPrivate.renderDepthPOI,this.parameters.overlay&&(r.renderOrder=-this.addPoiVariables.MapviewerPrivate.renderDepthPOIOverlay),this.parameters.clickable&&(r.vg={id:this.parameters.id,poi:this.parameters,originalColor:16777215},(n=(n=(t=this.mapviewer.getFloor(this.parameters.floor)).getLOD(this.parameters.lod))||t.floorContentLOD).pickables.push(r)),this.positionObject.vg.meshes.poi_url=r,this.rotationObject.add(r)):r.material=n,i||this.pushToLists()}i=this.parameters.scale,0<this.parameters.zoomScaleFactor&&(i={x:1,y:1,z:1}),e.x+=.5*i.x,e.y+=.5*i.y*this.parameters.alignment.y,r.position.copy(e),e.x+=.5*i.x,r.scale.set(i.x,i.y,1),r.updateMatrix(),void 0!==this.positionObject.vg.meshes.poi_text&&0<this.positionObject.vg.meshes.poi_text.length&&(e=this.updateTextMeshes()),0===this.parameters.zoomScaleFactor&&(-1!==this.parameters.width&&-1!==this.parameters.height&&(i=this.getBoxScale(),this.rotationObject.scale.copy({x:i,y:i,z:1}),e.x*=this.rotationObject.scale.x),this.rotationObject.current_position=e,this.rotationObject.position.x=-e.x/2,this.rotationObject.position.x+=this.parameters.alignment.x*e.x/2),this.rotationObject.dirty=!0,this.rotationObject.updateMatrix()}else if(this.rotationObject.remove(this.positionObject.vg.meshes.poi_url),delete this.parameters.url,delete this.positionObject.vg.meshes.poi_url,void 0!==this.parameters.text&&""!==this.parameters.text){if(!this.mapviewer.vgnobatch&&!this.parameters._vgnobatch)return this.realRemove(!1),void this.addPoiVariables.POIFactory.createPOI(this.addPoiVariables,this.parameters,this.proxy.publicPOI);this.rotationObject.dirty=!0,this.setText(this.parameters.text)}var o,a;this.positionObject.updateMatrix(),this.positionObject.updateMatrixWorld(!0),this.mapviewer.mustUpdateCameraObjects=!0,this.mapviewer.requestRedraw()},o.prototype.setSelector=function(t){var e;"string"!=typeof t||""===t?document.querySelector(this.parameters.selector).remove():(this.parameters.selector=t,t=document.querySelector(this.parameters.selector),0===(e=void 0!==this.parameters.opacity?this.parameters.opacity:this.mapviewer.computeOpacity(this.positionObject.position,this.parameters,this.mapviewer.camera.position))?t.style.display="none":(t.style.opacity=e,t.style.display=""),this.addPoiVariables.container.appendChild(t),t.style.position="absolute",t.style.left="0px",t.style.top="0px",this.mapviewer.pois_with_selector.push(this.parameters))},o.animationLoopModes={once:v.LoopOnce,repeat:v.LoopRepeat,pingpong:v.LoopPingPong},o.prototype.getAnimationNames=function(){if(void 0===this.rotationObject.getObjectByName("poi_model"))return console.log("Warning: this POI is not a 3D model, animation was not started."),[];if(void 0===this.animations)return[];var e=[];return Object.keys(this.animations).forEach(function(t){e.push(this.animations[t].clip.name)},this),e},o.prototype.startAnimation=function(t){var e=this.rotationObject.getObjectByName("poi_model");if(void 0===e||void 0===this.animations)return console.log("Warning: this POI is not an animated 3D model."),!1;var i="",r=v.LoopRepeat;if("number"==typeof t)i=t;else if("string"==typeof t)var n=t,i=this.animations.findIndex(function(t){return n===t.clip.name});else{if("object"!=typeof t)return!1;if(void 0===(i=t.index)){if(void 0===(n=t.name))return console.log("No animation index or name was provided."),!1;i=this.animations.findIndex(function(t){return n===t.clip.name})}void 0!==t.loopMode&&void 0!==o.animationLoopModes[t.loopMode]&&(r=o.animationLoopModes[t.loopMode])}return e=this.rotationObject.getObjectByName("poi_model"),void 0===this.animations[i]?(console.log("Warning: requested animation does not exist."),!1):(this.animations[i].action&&(this.animations[i].action.isRunning()||!this.animations[i].action.enabled)||this.nbAnimationPlaying++,this.animations[i].action?this.animations[i].action.reset():this.animations[i].action=this.mixer.clipAction(this.animations[i].clip),this.animations[i].action.setLoop(r,1/0),this.animations[i].action.play(),1===this.nbAnimationPlaying&&((i=null===(i=(t=this.mapviewer.getFloor(this.parameters.floor)).getLOD(this.parameters.lod))?t.floorContentLOD:i).animatedObjects.push(e),this.mapviewer.incrementUpdatableObjects(),e.matrixAutoUpdate=!0,e.traverse(function(t){t.matrixAutoUpdate=!0})),!0)},o.prototype.stopAnimation=function(t){var e,i,r=this.rotationObject.getObjectByName("poi_model");return void 0===r||void 0===this.animations?(console.log("Warning: this POI is not an animated 3D model."),!1):("string"==typeof t&&(e=t,t=this.animations.findIndex(function(t){return e===t.clip.name})),void 0===this.animations[t]||void 0===this.animations[t].action||void 0!==this.animations[t].action&&!this.animations[t].action.isRunning()?(console.log("Warning: requested animation does not exist or it is not running."),!1):(this.animations[t].action.stop(),this.nbAnimationPlaying--,0===this.nbAnimationPlaying&&(-1!==(t=(i=null===(i=(t=this.mapviewer.getFloor(this.parameters.floor)).getLOD(this.parameters.lod))?t.floorContentLOD:i).animatedObjects.indexOf(r))&&i.animatedObjects.splice(t,1),this.mapviewer.decrementUpdatableObjects(),r.traverse(function(t){t.matrixAutoUpdate=!1})),!0))},o.prototype.initAnimations=function(t,e){var r,n=[];3.2===t.version?n=t.result.scene.animations:4.4<=t.version&&(n=t.scene.animations),void 0!==n&&0<n.length&&(r=[],e.forEach(function(t){r[t.name]={loopMode:t.loopMode}}),e=this.rotationObject.getObjectByName("poi_model"),this.mixer=new v.AnimationMixer(e),e.vg=e.vg||{},e.vg.mixer=this.mixer,this.animations=[],this.nbAnimationPlaying=0,Object.keys(n).forEach(function(t){var e=n[t],i=e.name;this.animations[t]={clip:e,action:!1},void 0!==r[i]&&this.startAnimation({index:t,loopMode:r[i].loopMode})},this))},o.prototype.setModel=function(r){var t,n,o,e,i,a,s,l,c,h,u;"string"!=typeof r||""===r?(this.rotationObject.remove(this.rotationObject.getObjectByName("poi_model")),delete this.parameters.model):(void 0!==this.parameters.url&&""!==this.parameters.url&&this.setURL(""),void 0!==this.parameters.text&&""!==this.parameters.text&&this.setText(""),(t=void 0!==(i=this.rotationObject.getObjectByName("poi_model")))&&this.parameters.model===r||(t&&(this.rotationObject.remove(i),this.mapviewer.models[this.parameters.model].nbRefs--,0===this.mapviewer.models[this.parameters.model].nbRefs&&this.addPoiVariables.POIFactory.removeModel(this.mapviewer,this.parameters.model)),this.parameters.model=r,n=this.mapviewer,void 0===this.mapviewer.models[this.parameters.model]?(o={url:this.parameters.model,loaded:!1,geometry:null,materials:null,bbox:null,pending:[],nbRefs:1},this.mapviewer.models[this.parameters.model]=o,this.mapviewer.loaderStatistics.models++,p.request(this.parameters.model,"GET",null,{crossDomain:!0}).then(function(t){var e,i=JSON.parse(t.response);n.loaderStatistics.models--,void 0!==i.metadata&&"Object"===i.metadata.type?((t=new v.ObjectLoader).crossOrigin="",o.version=i.metadata.version,e=v.LoaderUtils.extractUrlBase(r),t.texturePath=e,t.parse(i,function(t){t.updateMatrix(),o.loaded=!0,o.scene=t,Object.keys(o.pending).forEach(function(t){o.pending[t](o)}),n.requestRedraw()})):void 0===i.metadata||void 0!==i.metadata.formatVersion&&3.1===i.metadata.formatVersion?((t=new v.JSONLoader).crossOrigin="",e=v.LoaderUtils.extractUrlBase(r),void 0!==i.materials&&i.materials.forEach(function(t){void 0!==t.colorAmbient&&delete t.colorAmbient,void 0!==t.transparency&&(t.opacity=t.transparency,delete t.transparency)}),t=t.parse(i,e),o.loaded=!0,o.geometry=t.geometry,o.materials=t.materials,o.version=i.metadata.formatVersion,Object.keys(o.materials).forEach(function(t){o.materials[t].map.image.addEventListener("load",function(){n.requestRedraw()})}),Object.keys(o.pending).forEach(function(t){o.pending[t](o)})):((t=new v.SceneLoader).crossOrigin="",t.parse(i,function(t){o.loaded=!0,o.result=t,o.version=i.metadata.version||i.metadata.formatVersion,(t=o.result.scene).updateMatrix(),t.matrixAutoUpdate=!1,t.traverse(function(t){t.updateMatrix(),t.matrixAutoUpdate=!1}),Object.keys(o.pending).forEach(function(t){o.pending[t](o)})},r))}).catch(function(){n.loaderStatistics.models--})):this.mapviewer.models[this.parameters.model].nbRefs++,null===(i=(e=this.mapviewer.getFloor(this.parameters.floor)).getLOD(this.parameters.lod))&&(i=e.floorContentLOD),e=void 0!==this.parameters.opacity?this.parameters.opacity:this.mapviewer.computeOpacity(this.positionObject.position,this.parameters,this.mapviewer.camera.position),(o=this.mapviewer.models[this.parameters.model]).loaded?(this.addPoiVariables.POIFactory.onModelLoaded(this.mapviewer,o,this.parameters,e,this.rotationObject,i),this.initAnimations(o,this.parameters.startAnimations)):o.pending.push((s=o,l=(a=this).parameters,c=e,h=this.rotationObject,u=i,function(){a.addPoiVariables.POIFactory.onModelLoaded(n,s,l,c,h,u),a.initAnimations(s,a.parameters.startAnimations)})),t||this.pushToLists()),t=new v.Vector3,-1!==this.parameters.width&&-1!==this.parameters.height&&(i=this.getBoxScale(),this.rotationObject.scale.copy({x:i,y:1,z:i})),this.rotationObject.current_position=t,this.rotationObject.position.x=-t.x/2,this.rotationObject.position.x+=this.parameters.alignment.x*t.x/2,this.rotationObject.dirty=!0,this.rotationObject.updateMatrix()),this.positionObject.updateMatrix(),this.positionObject.updateMatrixWorld(!0),this.mapviewer.mustUpdateCameraObjects=!0,this.mapviewer.requestRedraw()},o.prototype.setAlignment=function(t){"object"==typeof t&&t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&(this.parameters.alignment=t,this.rotationObject.current_alignment=t,void 0!==this.parameters.model&&""!==this.parameters.model?this.setModel(this.parameters.model):(void 0!==this.parameters.url&&""!==this.parameters.url&&this.setURL(this.parameters.url),void 0!==this.parameters.text&&""!==this.parameters.text&&this.setText(this.parameters.text)))},o.prototype.setScale=function(t){t="number"==typeof t?{x:t,y:t,z:t}:t;"object"==typeof t&&this.parameters.scale!==t&&(this.parameters.scale=t,void 0!==this.parameters.url&&""!==this.parameters.url&&this.setURL(this.parameters.url),void 0!==this.parameters.text&&""!==this.parameters.text&&this.setText(this.parameters.text))},o.prototype.setZoomScaleFactor=function(t){var e;"number"!=typeof t||this.parameters.zoomScaleFactor===t||t<0||(this.parameters.zoomScaleFactor=t,t=(t=(e=this.mapviewer.getFloor(this.parameters.floor)).getLOD(this.parameters.lod))||e.floorContentLOD,0<this.parameters.zoomScaleFactor?-1===t.cameraUpdatableObjects.indexOf(this.rotationObject)&&t.cameraUpdatableObjects.push(this.rotationObject):(this.parameters._zoomScale=0,!this.parameters.fixed||this.parameters.flip||-1!==(e=t.cameraUpdatableObjects.indexOf(this.rotationObject))&&t.cameraUpdatableObjects.splice(e,1)),void 0!==this.parameters.url&&""!==this.parameters.url&&this.setURL(this.parameters.url),void 0!==this.parameters.text&&""!==this.parameters.text&&this.setText(this.parameters.text),this.rotationObject.updateMatrix(),this.mapviewer.mustUpdateCameraObjects=!0,this.mapviewer.requestRedraw())},o.prototype.setZoomScaleFast=function(t){"boolean"==typeof t&&this.parameters.zoomScaleFast!==t&&(this.parameters.zoomScaleFast=t,this.rotationObject.updateMatrix(),this.mapviewer.mustUpdateCameraObjects=!0,this.mapviewer.requestRedraw())},o.prototype.setFloor=function(t){if("string"==typeof t&&""!==t&&this.parameters.floor!==t){this.positionObject.parent.remove(this.positionObject),this.parameters.floor=t;var e=this.mapviewer.scene;if(null===(t=this.mapviewer.getFloor(this.parameters.floor)))console.log("Warning: POI was not updated, required floor doesn't exist.");else{if(null!==t){if(t=void 0!==this.parameters.lod?t.getLOD(this.parameters.lod):t.floorContentLOD,!this.parameters.overlay&&null===t)return;e=t.contentNode}e.add(this.positionObject)}}},o.prototype.setID=function(e){if("string"==typeof e&&this.parameters.id!==e)if(this.setClickable(!1),this.addPoiVariables.POIFactory.removeFromPois(this.mapviewer,this.parameters.id,this.proxy.publicPOI),""===e)for(var t in delete this.parameters.id,this.positionObject.vg.meshes)"poi_text"===t?this.positionObject.vg.meshes[t].forEach(function(t){t.vg.id=""}):this.positionObject.vg.meshes[t].vg.id="";else{for(t in this.addPoiVariables.POIFactory.addToPois(this.mapviewer,e,this.proxy.publicPOI),this.parameters.id=e,this.positionObject.vg.meshes)"poi_text"===t?this.positionObject.vg.meshes[t].forEach(function(t){t.vg.id=e}):this.positionObject.vg.meshes[t].vg.id=e;this.setClickable(!0)}},o.prototype.setClickable=function(t){if("boolean"==typeof t&&this.parameters.clickable!==t){this.parameters.clickable=t;var e=this.mapviewer.getFloor(this.parameters.floor).getLOD(this.parameters.lod);if(null!==e)if(this.parameters.clickable)for(var i in this.positionObject.vg.meshes)"poi_text"===i?this.positionObject.vg.meshes[i].forEach(function(t){e.pickables.push(t)}):(t=this.positionObject.vg.meshes[i],e.pickables.push(t));else for(i in this.positionObject.vg.meshes)"poi_text"===i?this.positionObject.vg.meshes[i].forEach(function(t){-1!==(t=e.pickables.indexOf(t))&&e.pickables.splice(t,1)}):(t=this.positionObject.vg.meshes[i],t=e.pickables.indexOf(t),-1!==t&&e.pickables.splice(t,1))}},o.prototype.setWidth=function(t){"number"==typeof t&&this.parameters.width!==t&&(this.parameters.width=t,void 0!==this.parameters.url&&""!==this.parameters.url&&this.setURL(this.parameters.url),void 0!==this.parameters.text&&""!==this.parameters.text&&this.setText(this.parameters.text))},o.prototype.setHeight=function(t){"number"==typeof t&&this.parameters.height!==t&&(this.parameters.height=t,void 0!==this.parameters.url&&""!==this.parameters.url&&this.setURL(this.parameters.url),void 0!==this.parameters.text&&""!==this.parameters.text&&this.setText(this.parameters.text))},o.prototype.setOverlay=function(t){"boolean"==typeof t&&this.parameters.overlay!==t&&(this.parameters.overlay=t,void 0!==this.positionObject.vg.meshes.poi_text&&0<this.positionObject.vg.meshes.poi_text.length&&this.positionObject.vg.meshes.poi_text.forEach(function(t){t.material.depthTest=!this.parameters.overlay&&this.mapviewer.useDepthWriteForPOIs,t.renderOrder=this.parameters.overlay?-this.addPoiVariables.MapviewerPrivate.renderDepthPOIOverlay:-this.addPoiVariables.MapviewerPrivate.renderDepthPOI},this),void 0!==(t=this.positionObject.vg.meshes.poi_url)&&(t.material.depthTest=!this.parameters.overlay&&this.mapviewer.useDepthWriteForPOIs,t.renderOrder=this.parameters.overlay?-this.addPoiVariables.MapviewerPrivate.renderDepthPOIOverlay:-this.addPoiVariables.MapviewerPrivate.renderDepthPOI))},o.prototype.setFixed=function(t){var e,i,r;"boolean"==typeof t&&this.parameters.fixed!==t&&(this.parameters.fixed=t,t=(t=(e=this.mapviewer.getFloor(this.parameters.floor)).getLOD(this.parameters.lod))||e.floorContentLOD,r=new v.Euler,this.parameters.fixed?((e=new v.Object3D).name="options fixed",r.set(0,0,this.parameters.angle*Math.PI/180)):((e=new g({face2d:this.parameters.face2d},this.mapviewer)).name="options !fixed",(void 0!==this.parameters.url&&""!==this.parameters.url||void 0!==this.parameters.model&&""!==this.parameters.model||void 0!==this.parameters.text&&""!==this.parameters.text)&&t.cameraUpdatableObjects.push(e)),e.vg=y.extend({},this.positionObject.vg),e.matrixAutoUpdate=!1,e.position.copy(this.positionObject.position),e.add(this.rotationObject),this.parameters.fixed&&this.parameters.flip&&(this.parameters.flip=!1,this.setFlip(!0)),(i=new v.Matrix4).makeRotationFromEuler(r),this.rotationObject.position.copy(new v.Vector3),this.rotationObject.position.x=-this.rotationObject.current_position.x/2,this.rotationObject.position.x+=this.parameters.alignment.x*this.rotationObject.current_position.x/2,this.rotationObject.position.applyMatrix4(i),(void 0!==this.parameters.url&&""!==this.parameters.url||void 0!==this.parameters.model&&""!==this.parameters.model||void 0!==this.parameters.text&&""!==this.parameters.text||void 0!==this.parameters.selector&&""!==this.parameters.selector)&&t.rampObjects.push(e),-1!==(i=t.cameraUpdatableObjects.indexOf(this.positionObject))&&t.cameraUpdatableObjects.splice(i,1),-1!==(i=t.rampObjects.indexOf(this.positionObject))&&t.rampObjects.splice(i,1),(t=this.positionObject.parent).remove(this.positionObject),t.add(e),this.positionObject=e,this.rotationObject.rotation.copy(r),this.rotationObject.updateMatrix(),this.positionObject.updateMatrix(),this.positionObject.updateMatrixWorld(!0),this.mapviewer.mustUpdateCameraObjects=!0,this.mapviewer.requestRedraw())},o.prototype.setFlip=function(t){var e;"boolean"==typeof t&&this.parameters.flip!==t&&(this.parameters.flip=t,t=(t=(e=this.mapviewer.getFloor(this.parameters.floor)).getLOD(this.parameters.lod))||e.floorContentLOD,this.parameters.fixed&&(this.parameters.flip?(this.rotationObject.current_alignment=this.parameters.alignment,this.rotationObject.current_aspect=0!==this.parameters.scale.y?this.parameters.scale.x/this.parameters.scale.y:1,this.rotationObject.matrixAutoUpdate=!1,(void 0!==this.parameters.url&&""!==this.parameters.url||void 0!==this.parameters.model&&""!==this.parameters.model||void 0!==this.parameters.text&&""!==this.parameters.text)&&t.cameraUpdatableObjects.push(this.rotationObject),this.mapviewer.mustUpdateCameraObjects=!0):0===this.parameters.zoomScaleFactor||-1!==(e=t.cameraUpdatableObjects.indexOf(this.rotationObject))&&t.cameraUpdatableObjects.splice(e,1),this.rotationObject.updateMatrix(),this.mapviewer.requestRedraw()))},o.prototype.setFace2d=function(t){"boolean"==typeof t&&this.parameters.face2d!==t&&(this.parameters.face2d=t,"boolean"==typeof this.parameters.fixed&&this.parameters.fixed||(this.positionObject.constraints=this.parameters.face2d?[v.Billboard.FIXED,v.Billboard.FIXED,v.Billboard.CAMERA_FACING]:[v.Billboard.CAMERA_FACING,v.Billboard.FIXED,v.Billboard.CAMERA_FACING],this.positionObject.lastCameraOrientationZ=!1,this.positionObject.face2d=this.parameters.face2d,this.positionObject.updateMatrix(),this.positionObject.updateMatrixWorld(!0),this.mapviewer.mustUpdateCameraObjects=!0,this.mapviewer.requestRedraw()))},o.prototype.setTrack=function(t){"boolean"==typeof t&&this.parameters.track!==t&&(this.parameters.track=t)},o.prototype.setAngle=function(t){var e;"number"==typeof t&&this.parameters.angle!==t&&(this.parameters.angle=t,this.parameters._inverseAngleInRadians=2*Math.PI-t*Math.PI/180,this.parameters.fixed)&&((t=new v.Euler).set(0,0,this.parameters.angle*Math.PI/180),this.rotationObject.rotation.copy(t),(e=new v.Matrix4).makeRotationFromEuler(t),this.rotationObject.position.copy(new v.Vector3),this.rotationObject.position.x=-this.rotationObject.current_position.x/2,this.rotationObject.position.x+=this.parameters.alignment.x*this.rotationObject.current_position.x/2,this.rotationObject.position.applyMatrix4(e),this.positionObject.updateMatrix(),this.rotationObject.dirty=!0,this.rotationObject.updateMatrix(),this.positionObject.updateMatrixWorld(!0),this.mapviewer.requestRedraw())},o.prototype.setHeading=function(t){"number"==typeof t&&this.parameters.heading!==t&&this.parameters.angle!==t-this.mapviewer.cameraNorthRotation&&(this.parameters.heading=t,this.setAngle(this.parameters.heading-this.mapviewer.cameraNorthRotation))},o.prototype.getUUID=function(){return this.positionObject?this.positionObject.uuid:"does not exist"},o}),mt("com/visioglobe/web/poi/POIBatchElement",["com/visioglobe/web/poi/POIProxy","underscoretiny"],function(o,n){function t(t,e,i,r){this.batch=t,this.index=e,this.parameters=i,this.proxy=new o(this),t=4*this.index,this.vertexOffsets=[t,t+1,t+2,t+3],(t=this.batch.geometry.getAttribute("normal")).needsUpdate=!0,t.setXYZ(this.vertexOffsets[3],0,0,1),(t=this.batch.geometry.getAttribute("uv")).needsUpdate=!0,e=r[0],i=r[5];var n=r[2];r=r[1],t.setXY(this.vertexOffsets[0],e,i),t.setXY(this.vertexOffsets[1],n,i),t.setXY(this.vertexOffsets[2],n,r),t.setXY(this.vertexOffsets[3],e,r),this.updateHalfWidthAndHeight(),this.updateTypesAttribute(),this.updateCenterAttribute(),this.updateGeometryAttributes(),this.updateVisibilityRampAttribute()}return(t.prototype.constructor=t).prototype.getVisible=function(){return this.getParameter("visible")},t.prototype.setVisible=function(t,e){var i,r,n;(this.parameters&&this.parameters.visible!=t||e)&&(this.parameters.visible=t,i=this.batch.geometry.getIndex(),r=6*this.index,n=this.batch.indices,e=4*this.index,t?(n[r]=e,n[1+r]=1+e,n[2+r]=3+e,n[3+r]=1+e,n[4+r]=2+e,n[5+r]=3+e):(n[r]=0,n[1+r]=0,n[2+r]=0,n[3+r]=0,n[4+r]=0,n[5+r]=0),i.needsUpdate=!0,this.batch.mesh.updateMatrix(),this.batch.mapviewer.requestRedraw())},t.prototype.getOpacity=function(){return 1},t.prototype.setOpacity=function(t){},t.prototype.options=function(e,t,i){if(!this.parameters)return!1;if(null!==this.parameters){if(void 0===e)return o.getPublicParameters(this.parameters);if("object"==typeof e){var r=n.extend({},this.parameters);Object.keys(e).forEach(function(t){void 0===e[t]?delete r[t]:r[t]=e[t]}),this.batch.addPoiVariables.POIFactory.createPOI(this.batch.addPoiVariables,r,this.proxy.publicPOI),this.realRemove(!1)}else if("string"==typeof e){if(void 0===t&&o.isPublicParameter(e))return this.getParameter(e);this.setParameter(e,t)}}},t.prototype.getParameter=function(t){return this.parameters&&this.parameters[t]},t.prototype.setParameter=function(t,e){switch(t){case"visibilityRampStartVisible":return this.parameters.visibilityRampStartVisible=e,void this.updateVisibilityRampAttribute();case"visibilityRampFullyVisible":return this.parameters.visibilityRampFullyVisible=e,void this.updateVisibilityRampAttribute();case"visibilityRampStartInvisible":return this.parameters.visibilityRampStartInvisible=e,void this.updateVisibilityRampAttribute();case"visibilityRampFullyInvisible":return this.parameters.visibilityRampFullyInvisible=e,void this.updateVisibilityRampAttribute();case"onObjectMouseOver":return void(this.parameters.onObjectMouseOver=e);case"onObjectMouseOut":return void(this.parameters.onObjectMouseOut=e);case"onObjectMouseUp":return void(this.parameters.onObjectMouseUp=e);case"visible":return void this.setVisible(e);case"opacity":return;case"position":return void this.setPosition(e);case"scale":return void this.setScale(e);case"zoomScaleFactor":if(0<e&&0<this.parameters.zoomScaleFactor||!this.parameters.fixed)return void this.setZoomScaleFactor(e);this.parameters.zoomScaleFactor=e;break;case"zoomScaleFast":return void this.setZoomScaleFast(e);case"iconScale":case"icon_scale":return console.log('Deprecated option. It will be taken into account if there is no text. Otherwise, "scale" option will be used.'),void(void 0!==this.parameters.text&&""!==this.parameters.text||this.setScale(e));case"angle":return void this.setAngle(e);case"heading":return void this.setHeading(e);case"width":return void this.setWidth(e);case"height":return void this.setHeight(e);case"fixed":if(this.parameters.fixed===e)return;if(0<this.parameters.zoomScaleFactor)return void this.setFixed(e);this.parameters.fixed=e;break;case"flip":return void this.setFlip(e);case"face2d":return void this.setFace2d(e);case"id":return void this.setID(e);case"clickable":return void this.setClickable(e);case"track":return void this.setTrack(e);default:this.parameters[t]=e}this.batch.addPoiVariables.POIFactory.createPOI(this.batch.addPoiVariables,this.parameters,this.proxy.publicPOI),this.batch.mesh.updateMatrix(),this.batch.mapviewer.requestRedraw(),this.realRemove(!1)},t.prototype.setPosition=function(t){this.parameters.position=t||{x:0,y:0,z:0},this.parameters.position.z=t.z||0,this.parameters._center=this.parameters.position,this.parameters._centerZ=this.parameters.position.z+this.parameters._zOffset,this.updateCenterAttribute(),this.updateGeometryAttributes(),this.parameters._dirty=!0,this.batch.mesh.updateMatrix(),this.batch.mapviewer.requestRedraw(),void 0!==this.parameters.track&&this.parameters.track&&void 0!==this.batch.mapviewer.statistics&&this.batch.mapviewer.statistics.logStat("position",{id:this.parameters.id,position:this.parameters.position})},t.prototype.setScale=function(t){t="number"==typeof t?{x:t,y:t,z:t}:t;"object"==typeof t&&this.parameters.scale!==t&&(this.parameters.scale=t,this.updateHalfWidthAndHeight(),this.updateCenterAttribute(),this.updateGeometryAttributes(),this.parameters._dirty=!0,this.batch.mesh.updateMatrix(),this.batch.mapviewer.requestRedraw())},t.prototype.setZoomScaleFactor=function(t){"number"==typeof t&&this.parameters.zoomScaleFactor!==t&&(this.parameters.zoomScaleFactor=t,this.updateHalfWidthAndHeight(),this.parameters._dirty=!0,this.batch.mesh.updateMatrix(),this.batch.mapviewer.requestRedraw())},t.prototype.setZoomScaleFast=function(t){"boolean"==typeof t&&this.parameters.zoomScaleFast!==t&&(this.parameters.zoomScaleFast=t,this.updateHalfWidthAndHeight(),this.parameters._dirty=!0,this.batch.mesh.updateMatrix(),this.batch.mapviewer.requestRedraw())},t.prototype.setWidth=function(t){"number"==typeof t&&this.parameters.width!==t&&(this.parameters.width=t,this.updateHalfWidthAndHeight(),this.updateCenterAttribute(),this.updateGeometryAttributes(),this.parameters._dirty=!0,this.batch.mesh.updateMatrix(),this.batch.mapviewer.requestRedraw())},t.prototype.setHeight=function(t){"number"==typeof t&&this.parameters.height!==t&&(this.parameters.height=t,this.updateHalfWidthAndHeight(),this.updateCenterAttribute(),this.updateGeometryAttributes(),this.parameters._dirty=!0,this.batch.mesh.updateMatrix(),this.batch.mapviewer.requestRedraw())},t.prototype.setAngle=function(t){"number"==typeof t&&this.parameters.angle!==t&&(this.parameters.angle=t,this.updateCenterAttribute(),this.updateGeometryAttributes(),this.parameters._dirty=!0,this.batch.mesh.updateMatrix(),this.batch.mapviewer.requestRedraw())},t.prototype.setHeading=function(t){"number"==typeof t&&this.parameters.heading!==t&&this.parameters.angle!==t-this.batch.mapviewer.cameraNorthRotation&&(this.parameters.heading=t,this.setAngle(this.parameters.heading-this.batch.mapviewer.cameraNorthRotation))},t.prototype.setFixed=function(t){"boolean"==typeof t&&this.parameters.fixed!==t&&(this.parameters.fixed=t,this.updateTypesAttribute(),this.parameters._dirty=!0,this.batch.mesh.updateMatrix(),this.batch.mapviewer.requestRedraw())},t.prototype.setFlip=function(t){"boolean"==typeof t&&this.parameters.flip!==t&&(this.parameters.flip=t,this.updateTypesAttribute(),this.parameters._dirty=!0,this.batch.mesh.updateMatrix(),this.batch.mapviewer.requestRedraw())},t.prototype.setFace2d=function(t){"boolean"==typeof t&&this.parameters.face2d!==t&&(this.parameters.face2d=t,this.updateTypesAttribute(),this.parameters._dirty=!0,this.batch.mesh.updateMatrix(),this.batch.mapviewer.requestRedraw())},t.prototype.setTrack=function(t){"boolean"==typeof t&&this.parameters.track!==t&&(this.parameters.track=t)},t.prototype.setID=function(t){"string"==typeof t&&this.parameters.id!==t&&(this.batch.addPoiVariables.POIFactory.removeFromPois(this.batch.mapviewer,this.parameters.id,this.proxy.publicPOI),""!==t&&this.batch.addPoiVariables.POIFactory.addToPois(this.batch.mapviewer,t,this.proxy.publicPOI),this.parameters.id=t)},t.prototype.setClickable=function(t){"boolean"==typeof t&&this.parameters.clickable!==t&&(this.parameters.clickable=t)},t.prototype.updateVisibility=function(){this.parameters._halfWidth*this.parameters._zoomScale<.5*this.parameters.width&&this.parameters._halfHeight*this.parameters._zoomScale<.5*this.parameters.height?this.setVisible(!0):this.setVisible(!1)},t.prototype.updateHalfWidthAndHeight=function(){var t,e,i;0<this.parameters.zoomScaleFactor?(e=.5*this.parameters._textAspectRatio,i=.5):(e=.5*this.parameters._textAspectRatio*this.parameters.scale.x,i=.5*this.parameters.scale.y,-1!==this.parameters.width&&-1!==this.parameters.height&&(e*=t=2*i*(t=this.parameters.width/(2*e))>this.parameters.height?this.parameters.height/(2*i):t,i*=t)),this.parameters._halfWidth=e,this.parameters._halfHeight=i},t.prototype.updateGeometryAttributesWithScale=function(t){var e=this.parameters._halfWidth*t,i=this.parameters._halfHeight*t,r=this.parameters.position,n=this.parameters._centerZ,o=-this.parameters.angle*Math.PI/180;t=Math.cos(o);var a=(o=Math.sin(o))*e,e=t*e,s=o*i,i=t*i,l=this.batch.geometry.getAttribute("position");l.needsUpdate=!0,l.setXYZ(this.vertexOffsets[0],r.x-e+s,r.y-a-i,n),l.setXYZ(this.vertexOffsets[1],r.x+e+s,r.y+a-i,n),l.setXYZ(this.vertexOffsets[2],r.x+e-s,r.y+a+i,n),l.setXYZ(this.vertexOffsets[3],r.x-e-s,r.y-a+i,n),(r=this.batch.geometry.getAttribute("centerOffset")).needsUpdate=!0,r.setXY(this.vertexOffsets[0],s-e,-a-i),r.setXY(this.vertexOffsets[1],+e+s,a-i),r.setXY(this.vertexOffsets[2],e-s,+a+i),r.setXY(this.vertexOffsets[3],-e-s,i-a),(r=this.batch.geometry.getAttribute("angleVector")).needsUpdate=!0,r.setXY(this.vertexOffsets[0],-o,t),r.setXY(this.vertexOffsets[1],-o,t),r.setXY(this.vertexOffsets[2],-o,t),r.setXY(this.vertexOffsets[3],-o,t)},t.prototype.updateGeometryAttributes=function(){this.updateGeometryAttributesWithScale(1)},t.prototype.updateCenterAttribute=function(){var t=this.parameters.position,e=this.parameters._centerZ,i=this.batch.geometry.getAttribute("center");i.needsUpdate=!0,i.setXYZ(this.vertexOffsets[0],t.x,t.y,e),i.setXYZ(this.vertexOffsets[1],t.x,t.y,e),i.setXYZ(this.vertexOffsets[2],t.x,t.y,e),i.setXYZ(this.vertexOffsets[3],t.x,t.y,e)},t.prototype.updateGeometryAttributeFace2d=function(t,e,i){var r=this.parameters._center,n=this.parameters._centerZ,o=this.parameters._halfWidth*i,a=this.parameters._halfHeight*i;i=e*o,o*=t,e*=a,t*=a,(a=this.batch.geometry.getAttribute("position")).needsUpdate=!0,a.setXYZ(this.vertexOffsets[0],r.x-o+e,r.y-i-t,n),a.setXYZ(this.vertexOffsets[1],r.x+o+e,r.y+i-t,n),a.setXYZ(this.vertexOffsets[2],r.x+o-e,r.y+i+t,n),a.setXYZ(this.vertexOffsets[3],r.x-o-e,r.y-i+t,n)},t.prototype.updateGeometryAttributeFacing=function(t,e){var i=this.parameters._center,r=this.parameters._centerZ,n=this.parameters._halfWidth*e,o=this.parameters._halfHeight*e,n=[{x:-n,y:-o},{x:n,y:-o},{x:n,y:o},{x:-n,y:o}];(o=this.batch.geometry.getAttribute("position")).needsUpdate=!0;for(var a=0;a<4;a++)o.setXYZ(this.vertexOffsets[a],t[0]*n[a].x+t[3]*n[a].y+i.x,t[1]*n[a].x+t[4]*n[a].y+i.y,t[2]*n[a].x+t[5]*n[a].y+r)},t.prototype.updateTypesAttribute=function(){var t=this.parameters.fixed?this.parameters.flip?0:1:this.parameters.face2d?(this.batch.mapviewer.mustUpdateCameraObjects=!0,2):(this.batch.mapviewer.mustUpdateCameraObjects=!0,3),e=this.batch.geometry.getAttribute("type");e.needsUpdate=!0,e.setX(this.vertexOffsets[0],t),e.setX(this.vertexOffsets[1],t),e.setX(this.vertexOffsets[2],t),e.setX(this.vertexOffsets[3],t)},t.prototype.updateVisibilityRampAttribute=function(){var t=this.batch.geometry.getAttribute("visibilityRamp");t.needsUpdate=!0,t.setXYZW(this.vertexOffsets[0],this.parameters.visibilityRampStartVisible,this.parameters.visibilityRampFullyVisible,this.parameters.visibilityRampStartInvisible,this.parameters.visibilityRampFullyInvisible),t.setXYZW(this.vertexOffsets[1],this.parameters.visibilityRampStartVisible,this.parameters.visibilityRampFullyVisible,this.parameters.visibilityRampStartInvisible,this.parameters.visibilityRampFullyInvisible),t.setXYZW(this.vertexOffsets[2],this.parameters.visibilityRampStartVisible,this.parameters.visibilityRampFullyVisible,this.parameters.visibilityRampStartInvisible,this.parameters.visibilityRampFullyInvisible),t.setXYZW(this.vertexOffsets[3],this.parameters.visibilityRampStartVisible,this.parameters.visibilityRampFullyVisible,this.parameters.visibilityRampStartInvisible,this.parameters.visibilityRampFullyInvisible)},t.prototype.realRemove=function(t){var e=this.parameters;if(!e)return!1;void 0!==e._measuringCanvas&&(e._measuringCanvas=null),this.setVisible(!1,!0),this.parameters=null;var i=this.proxy;t&&this.batch.addPoiVariables.POIFactory.removeFromPois(this.batch.mapviewer,e.id,i.publicPOI),this.proxy=null,this.batch.inuse--,0==this.batch.inuse&&this.batch.dispose()},t.prototype.remove=function(){this.realRemove(!0)},t}),mt("com/visioglobe/web/poi/POIBatchMultiLineText",["com/visioglobe/web/poi/POIProxy","com/visioglobe/web/poi/POIBatchElement"],function(s,t){function e(t,e,i,r,n){for(this.batch=t,this.index=e,this.parameters=i,this.fragments=r,this.space=n,this.lines=[],this.proxy=new s(this),t=0;t<this.fragments.length;t++){i=4*(e=this.fragments[t]).index,e.vertexOffsets=[i,i+1,i+2,i+3],(i=this.batch.geometry.getAttribute("normal")).needsUpdate=!0,i.setXYZ(e.vertexOffsets[3],0,0,1),(i=this.batch.geometry.getAttribute("uv")).needsUpdate=!0,r=e.uvArray[0],n=e.uvArray[5];var o=e.uvArray[2],a=e.uvArray[1];i.setXY(e.vertexOffsets[0],r,n),i.setXY(e.vertexOffsets[1],o,n),i.setXY(e.vertexOffsets[2],o,a),i.setXY(e.vertexOffsets[3],r,a)}this.updateHalfWidthAndHeight(),this.updateTypesAttribute(),this.updateCenterAttribute(),this.updateGeometryAttributes(),this.updateVisibilityRampAttribute()}return((e.prototype=Object.create(t.prototype)).constructor=e).prototype.setVisible=function(t,e){if(this.parameters&&this.parameters.visible!=t||e){this.parameters.visible=t;var e=this.batch.geometry.getIndex(),i=this.batch.indices;if(t)for(var r=0;r<this.fragments.length;r++){var n=6*(o=this.fragments[r]).index,o=4*o.index;i[n]=o,i[n+1]=o+1,i[n+2]=o+3,i[n+3]=o+1,i[n+4]=o+2,i[n+5]=o+3}else for(r=0;r<this.fragments.length;r++)i[n=6*(o=this.fragments[r]).index]=0,i[n+1]=0,i[n+2]=0,i[n+3]=0,i[n+4]=0,i[n+5]=0;e.needsUpdate=!0}},e.prototype.shouldRecomputeLines=function(){if(0===this.lines.length)return!0;var t=this.lines.length,e=this.fragments.length;return!(0<this.parameters.zoomScaleFactor&&(this.parameters._zoomScale===this.parameters._previousZoomScale||this.parameters._zoomScale>this.parameters._previousZoomScale&&t===e||this.parameters._zoomScale<this.parameters._previousZoomScale&&1===t))},e.prototype.computeLines=function(t){var e=this.parameters._textAspectRatio/t,i=this.fragments[0].aspectRatio,r=0;this.lines.splice(0,this.lines.length),this.fragments[0].lineNb=0,this.lines[0]={fragments:[0],width:this.fragments[0].width,height:this.fragments[0].height,aspectRatio:this.fragments[0].aspectRatio};for(var n=1;n<this.fragments.length;n++){var o=this.fragments[n],a=i+this.space.aspectRatio+o.aspectRatio;r<t&&(e<i||1.5*e<a)?(r++,o.lineNb=r,this.lines[r]={fragments:[n],width:o.width,height:o.height,aspectRatio:o.aspectRatio},i=o.aspectRatio):(i=a,o.lineNb=r,this.lines[r].fragments.push(n),this.lines[r].width+=this.space.width+o.width,this.lines[r].height=Math.max(this.lines[r].height,o.height))}},e.prototype.updateLines=function(t){var e=this.parameters._textAspectRatio,i=1;for(this.computeLines(i);t*e>this.parameters.width&&i<this.fragments.length;){i++,this.computeLines(i);for(var r=e=0;r<this.lines.length;r++)e=Math.max(e,this.lines[r].width/this.lines[r].height)}},e.prototype.updateHalfWidthAndHeight=function(){var t;if(this.shouldRecomputeLines()&&(t=this.parameters.scale.x,0<this.parameters.zoomScaleFactor&&(t=this.parameters._zoomScale),this.updateLines(t)),0<this.parameters.zoomScaleFactor){this.parameters._previousZoomScale=this.parameters._zoomScale;for(var e=this.parameters._halfWidth=0;e<this.lines.length;e++){var i=this.lines[e];i.aspectRatio=i.width/i.height;for(var r=.5*-i.aspectRatio,n=.5*(this.lines.length-1)-e,o=0;o<i.fragments.length;o++)r+=.5*(t=this.fragments[i.fragments[o]]).aspectRatio,t.horizontalOffset=r,r+=.5*t.aspectRatio,o<i.fragments.length-1&&(r+=this.space.aspectRatio),t.verticalOffset=n,t.halfWidth=.5*t.aspectRatio,t.halfHeight=.5;this.parameters._halfWidth=Math.max(this.parameters._halfWidth,.5*i.aspectRatio)}this.parameters._halfHeight=.5*this.lines.length}else{for(e=0;e<this.lines.length;e++)for((i=this.lines[e]).aspectRatio=i.width/i.height,r=.5*-i.aspectRatio*this.parameters.scale.x,n=.5*(this.lines.length-1)-e,o=0;o<i.fragments.length;o++)r+=.5*(t=this.fragments[i.fragments[o]]).aspectRatio*this.parameters.scale.x,t.horizontalOffset=r,r+=.5*t.aspectRatio*this.parameters.scale.x,o<i.fragments.length-1&&(r+=this.space.aspectRatio*this.parameters.scale.x),t.verticalOffset=n*this.parameters.scale.y,t.halfWidth=.5*t.aspectRatio*this.parameters.scale.x,t.halfHeight=.5*this.parameters.scale.y;if(-1!==this.parameters.width&&-1!==this.parameters.height){for(e=t=0;e<this.lines.length;e++)t=Math.max(t,this.lines[e].aspectRatio);if(t*=this.parameters.scale.x,1!==(e=(i=this.lines.length*this.parameters.scale.y)*(e=this.parameters.width/t)>this.parameters.height?this.parameters.height/i:e))for(i=0;i<this.fragments.length;i++)(t=this.fragments[i]).horizontalOffset*=e,t.verticalOffset*=e,t.halfWidth*=e,t.halfHeight*=e}}},e.prototype.updateVisibility=function(){this.updateHalfWidthAndHeight(),this.parameters._halfWidth*this.parameters._zoomScale<.5*this.parameters.width&&this.parameters._halfHeight*this.parameters._zoomScale<.5*this.parameters.height?this.setVisible(!0):this.setVisible(!1)},e.prototype.updateGeometryAttributesWithScale=function(t){var e=this.batch.geometry.getAttribute("position"),i=this.batch.geometry.getAttribute("centerOffset"),r=this.batch.geometry.getAttribute("angleVector");e.needsUpdate=!0,i.needsUpdate=!0,r.needsUpdate=!0;for(var n=this.parameters._centerZ,o=-this.parameters.angle*Math.PI/180,a=Math.cos(o),o=Math.sin(o),s=0;s<this.fragments.length;s++)for(var l=this.fragments[s],c=l.halfWidth,h=l.halfHeight,c=[{x:-c+l.horizontalOffset,y:-h+l.verticalOffset},{x:c+l.horizontalOffset,y:-h+l.verticalOffset},{x:c+l.horizontalOffset,y:h+l.verticalOffset},{x:-c+l.horizontalOffset,y:h+l.verticalOffset}],h=this.parameters.position,u=0;u<4;u++){var p=(a*(d=c[u]).x-o*d.y)*t,d=(o*d.x+a*d.y)*t;e.setXYZ(l.vertexOffsets[u],h.x+p,h.y+d,n),i.setXY(l.vertexOffsets[u],p,d),r.setXY(l.vertexOffsets[u],-o,a)}},e.prototype.updateCenterAttribute=function(){var t=this.parameters.position,e=this.parameters._centerZ,i=this.batch.geometry.getAttribute("center");i.needsUpdate=!0;for(var r=0;r<this.fragments.length;r++){var n=this.fragments[r];i.setXYZ(n.vertexOffsets[0],t.x,t.y,e),i.setXYZ(n.vertexOffsets[1],t.x,t.y,e),i.setXYZ(n.vertexOffsets[2],t.x,t.y,e),i.setXYZ(n.vertexOffsets[3],t.x,t.y,e)}},e.prototype.updateGeometryAttributeFace2d=function(t,e,i){var r=this.parameters._centerZ,n=this.batch.geometry.getAttribute("position");n.needsUpdate=!0;for(var o=0;o<this.fragments.length;o++)for(var a=this.fragments[o],s=a.halfWidth,l=a.halfHeight,s=[{x:-s+a.horizontalOffset,y:-l+a.verticalOffset},{x:s+a.horizontalOffset,y:-l+a.verticalOffset},{x:s+a.horizontalOffset,y:l+a.verticalOffset},{x:-s+a.horizontalOffset,y:l+a.verticalOffset}],l=this.parameters.position,c=0;c<4;c++){var h=s[c];n.setXYZ(a.vertexOffsets[c],l.x+(t*h.x-e*h.y)*i,l.y+(e*h.x+t*h.y)*i,r)}},e.prototype.updateGeometryAttributeFacing=function(t,e){var i=this.parameters._centerZ,r=this.batch.geometry.getAttribute("position");r.needsUpdate=!0;for(var n=0;n<this.fragments.length;n++)for(var o=this.fragments[n],a=o.halfWidth,s=o.halfHeight,a=[{x:-a+o.horizontalOffset,y:-s+o.verticalOffset},{x:a+o.horizontalOffset,y:-s+o.verticalOffset},{x:a+o.horizontalOffset,y:s+o.verticalOffset},{x:-a+o.horizontalOffset,y:s+o.verticalOffset}],s=this.parameters.position,l=0;l<4;l++){var c=(h=a[l]).x*e,h=h.y*e;r.setXYZ(o.vertexOffsets[l],t[0]*c+t[3]*h+s.x,t[1]*c+t[4]*h+s.y,t[2]*c+t[5]*h+i)}},e.prototype.updateTypesAttribute=function(){var t=this.parameters.fixed?this.parameters.flip?0:1:this.parameters.face2d?(this.batch.mapviewer.mustUpdateCameraObjects=!0,2):(this.batch.mapviewer.mustUpdateCameraObjects=!0,3),e=this.batch.geometry.getAttribute("type");e.needsUpdate=!0;for(var i=0;i<this.fragments.length;i++){var r=this.fragments[i];e.setX(r.vertexOffsets[0],t),e.setX(r.vertexOffsets[1],t),e.setX(r.vertexOffsets[2],t),e.setX(r.vertexOffsets[3],t)}},e.prototype.updateVisibilityRampAttribute=function(){var t=this.batch.geometry.getAttribute("visibilityRamp");t.needsUpdate=!0;for(var e=0;e<this.fragments.length;e++){var i=this.fragments[e];t.setXYZW(i.vertexOffsets[0],this.parameters.visibilityRampStartVisible,this.parameters.visibilityRampFullyVisible,this.parameters.visibilityRampStartInvisible,this.parameters.visibilityRampFullyInvisible),t.setXYZW(i.vertexOffsets[1],this.parameters.visibilityRampStartVisible,this.parameters.visibilityRampFullyVisible,this.parameters.visibilityRampStartInvisible,this.parameters.visibilityRampFullyInvisible),t.setXYZW(i.vertexOffsets[2],this.parameters.visibilityRampStartVisible,this.parameters.visibilityRampFullyVisible,this.parameters.visibilityRampStartInvisible,this.parameters.visibilityRampFullyInvisible),t.setXYZW(i.vertexOffsets[3],this.parameters.visibilityRampStartVisible,this.parameters.visibilityRampFullyVisible,this.parameters.visibilityRampStartInvisible,this.parameters.visibilityRampFullyInvisible)}},e}),mt("com/visioglobe/web/helpers/TextGenerator",["three"],function(m){function d(t){for(var e=t=t+.5|0,i=0;e>>=1;)i++;return t==(e=1<<i)?e:2*e}var t=function(){this.id=t.count++,this.plane_geometry=new m.PlaneBufferGeometry(1,1),this.plane_geometry.vg={permanent:!0},this.iconsAtlas={}};return t.count=0,t.prototype.activeAtlas=null,t.prototype.activeTexture=null,t.prototype.textureAtlasParameters={width:1024,height:1024},t.prototype.disposeTexture=function(t){var e,i;if(0===t.vg.nbRefs&&(t.dispose(),this.activeTexture===t&&(this.activeAtlas=this.activeTexture=null),t.vg&&t.vg.options&&(t.vg.options.canvas=void 0,t.vg.options=null),t.onUpdate=void 0,t.image=null,t.vg.inIconsAtlas))for(i in this.iconsAtlas)this.iconsAtlas[i].texture===t&&(e=this.iconsAtlas[i],e.texture=!1,e.debugImage=!1,e.loaded=!1,this.iconsAtlas[i]=!1)},t.prototype.generateTextNoAtlas=function(t,e){e.canvas=document.createElement("canvas");var i=e.canvas,r=i.getContext("2d"),n=Math.floor(.8*(e.textTextureHeight-4)),o=n+"px "+e.family;r.font=o;var a=Math.ceil(r.measureText(t).width),s=Math.ceil(1.25*n),l=0,c=0,h=1,u=1,p=n+2;return e._vgmipmap?(h=d(a+4),c=d(s+4),l=1/(i.width=h),u=1-2/(i.height=c),h=(a+2)/h,c=1-(s+2)/c):(i.width=a+4,i.height=s+4),n=a/s,r.font=o,r.fillStyle="#"+("000000"+e.color.toString(16)).slice(-6),r.fillText(t,2,p),(o=new m.Texture(i)).vg={nbRefs:0},i=r=null,o.minFilter=m.LinearFilter,o.magFilter=m.LinearFilter,o.needsUpdate=!0,o.vg.options=e,o.onUpdate=function(){this.vg.options.canvas=void 0,this.vg.options=null,this.onUpdate=void 0,this.image=null},i=this.plane_geometry,e._vgmipmap&&(o.minFilter=m.LinearMipMapLinearFilter,(r=(i=this.plane_geometry.clone()).attributes.uv.array)[0]=l,r[1]=u,r[2]=h,r[3]=u,r[4]=l,r[5]=c,r[6]=h,r[7]=c,i.attributes.uv.needsUpdate=!0),{aspectRatio:n,width:a,height:s,geometry:i,texture:o}},t.prototype.measureText=function(t,e){void 0===e._measuringCanvas&&(e._measuringCanvas=document.createElement("canvas"));var i=e._measuringCanvas.getContext("2d"),r=Math.floor(.8*(e.textTextureHeight-4));return i.font=r+"px "+e.family,{width:i=Math.ceil(i.measureText(t).width),height:Math.ceil(1.25*r)}},t.prototype.generateTextOnAtlas=function(t,e,i){var r=this.activeAtlas,n=this.activeTexture;null===r&&(this.activeAtlas=r=new t(this.textureAtlasParameters),this.activeTexture=n=new m.Texture(r.canvas),n.name="generateTextOnAtlas",n.vg={nbRefs:0});var o=r.canvasContext,a=Math.floor(.8*(i.textTextureHeight-4)),s=a+"px "+i.family;o.font=s;var l,h=Math.ceil(o.measureText(e).width),u=Math.ceil(1.25*a),p=0,d=1,f=a+2,d={width:h+4,height:u+4};return!r.isLargerThanAtlas(d)&&(!(!(p=r.getTexturePlacement(d))&&(0<n.vg.nbRefs?(this.activeAtlas=r=new t(this.textureAtlasParameters),this.activeTexture=n=new m.Texture(r.canvas),n.name="generateTextOnAtlas2",n.vg={nbRefs:0},o=r.canvasContext):(o.clearRect(0,0,r.width,r.height),r.resetNodes()),!1===(p=r.getTexturePlacement(d))))&&(aspectRatio=h/u,o.font=s,o.fillStyle="#"+("000000"+i.color.toString(16)).slice(-6),o.fillText(e,p.x+2,p.y+f),c=null,(t=n).minFilter=m.LinearMipMapLinearFilter,t.magFilter=m.LinearFilter,t.needsUpdate=!0,e=this.plane_geometry,f=(p.x+2-1)/r.width,l=1-(p.y+2)/r.height,d=(p.x+p.width-2)/r.width,p=1-(p.y+p.height-2)/r.height,(r=(e=this.plane_geometry.clone()).attributes.uv.array)[0]=f,r[1]=l,r[2]=d,r[3]=l,r[4]=f,r[5]=p,r[6]=d,r[7]=p,e.attributes.uv.needsUpdate=!0,{aspectRatio:aspectRatio,width:h,height:u,geometry:e,texture:t}))},t.prototype.generateIconOnAtlasFromImage=function(t,e,i){return iconSlot=this.iconsAtlas[e],"undefined"!=typeof iconSlot&&!1!==iconSlot||(iconSlot={debugUrl:e,debugImage:i,geometry:!1,aspectRatio:!1,texture:!1},this.iconsAtlas[e]=iconSlot,(t=this.findAtlasForImage(t,i)).texture.vg.inIconsAtlas=!0,iconSlot.aspectRatio=t.aspectRatio,iconSlot.geometry=t.geometry,iconSlot.texture=t.texture,iconSlot.loaded=!0),iconSlot},t.prototype.findAtlasForImage=function(t,e){var i=this.activeAtlas,r=this.activeTexture,n=e.width/e.height;null===i&&(this.activeAtlas=i=new t(this.textureAtlasParameters),this.activeTexture=r=new m.Texture(i.canvas),r.name="findAtlasForImage",r.vg={nbRefs:0});var o=0,a=0;if(i.isLargerThanAtlas(e,2))return(r=new m.Texture(e)).name="single after isLargerThanAtlas",r.needsUpdate=!0,r.vg={nbRefs:0},{texture:r,aspectRatio:n,geometry:i=this.plane_geometry};if(o=i.canvasContext,!(a=i.insert(e,2))&&(0<r.vg.nbRefs?(this.activeAtlas=i=new t(this.textureAtlasParameters),this.activeTexture=r=new m.Texture(i.canvas),r.name="findAtlasForImage2",r.vg={nbRefs:0}):(o.clearRect(0,0,i.width,i.height),i.resetNodes()),!1===(a=i.insert(e))))return!1;c=null,r.minFilter=m.LinearMipMapLinearFilter,r.magFilter=m.LinearFilter,r.needsUpdate=!0;var o=(a.x+2)/i.width,s=1-(a.y+2)/i.height,l=(a.x+a.width-2)/i.width,a=1-(a.y+a.height-1-2)/i.height,e=(i=this.plane_geometry.clone()).attributes.uv.array;return e[0]=o,e[1]=s,e[2]=l,e[3]=s,e[4]=o,e[5]=a,e[6]=l,e[7]=a,i.attributes.uv.needsUpdate=!0,{aspectRatio:n,geometry:i,texture:r}},t}),mt("text",{load:function(t){throw Error("Dynamic load not allowed: "+t)}}),mt("text!com/visioglobe/web/shaders/poi.frag",[],function(){return"varying vec2 vUv;uniform sampler2D map;uniform float opacity;varying float visibilityOpacity;void main(){gl_FragColor=vec4(vec3(1.0),1.0)*texture2D(map,vUv);gl_FragColor.a*=visibilityOpacity*opacity;}"}),mt("text!com/visioglobe/web/shaders/poi.vert",[],function(){return"uniform vec2 camAngleVector;varying vec2 vUv;varying float visibilityOpacity;attribute vec4 visibilityRamp;attribute vec3 center;attribute vec2 angleVector;attribute vec2 centerOffset;attribute float type;float a(vec3 b){return sqrt((b.x*b.x)+(b.y*b.y)+(b.z*b.z));}float c(vec2 d,vec2 e){return ((d.x*e.x)+(d.y*e.y));}float f(float g){float h;float i=visibilityRamp.x;float j=visibilityRamp.y;float k=visibilityRamp.z;float l=visibilityRamp.w;if(g>j){if(g<k){h=1.0;}else if(g>l){h=0.0;}else{h=1.0-((g-k)/(l-k));}}else if(g<i){h=0.0;}else{h=(g-i)/(j-i);}return h;}void main(){float m=c(angleVector,camAngleVector);vec3 n;if(type==0.0&&m>=0.0){n=center-vec3(centerOffset,0);}else{n=position;}vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(n,1.0);vec4 o=modelMatrix*vec4(center,1.0);vec3 p=cameraPosition-o.xyz;float q=a(p);visibilityOpacity=f(q);}"}),mt("com/visioglobe/web/poi/POIBatch","com/visioglobe/web/poi/POIBatchElement com/visioglobe/web/poi/POIBatchMultiLineText com/visioglobe/web/helpers/TextGenerator text!com/visioglobe/web/shaders/poi.frag text!com/visioglobe/web/shaders/poi.vert three".split(" "),function(n,o,t,a,s,d){function e(t,e,i,r,n,o){this.mapviewer=r,(this.texture=t).vg.nbRefs++,this.dynamic=o,this.poiBatches=e,this.geometry=new d.BufferGeometry,this.geometry.matrixAutoUpdate=!1,this.material=new d.ShaderMaterial({uniforms:{map:{type:"t",value:t},opacity:{type:"f",value:1},camAngleVector:{type:"v2",value:r.manipulator.cameraAngleVector}},vertexShader:s,fragmentShader:a,transparent:!0,side:d.DoubleSide,depthWrite:!1,depthTest:!n&&r.useDepthWriteForPOIs}),this.mesh=new d.Mesh(this.geometry,this.material),this.mesh.matrixAutoUpdate=!1,o&&(this.orientationSerials=new Uint16Array(200),this.mesh.updateMatrix=function(){var n=this.vgbatch,o=n.types,a=n.indices,t=n.mapviewer,s=t.manipulator.cameraAngleVector.x,l=-t.manipulator.cameraAngleVector.y,c=t.manipulator.orientationSerial,h=n.orientationSerials,u=t.manipulator.radius,p=(t.camera.vg.cameraMatrix3||new d.Matrix3).elements;Object.keys(n.pois).forEach(function(t){var e,i=n.pois[t],r=i.parameters;r&&((e=0)<(e=r.zoomScaleFast?.02*u*r.zoomScaleFactor:.15*Math.sqrt(u)*r.zoomScaleFactor)&&e!==r._zoomScale&&-1!==r.width&&-1!==r.height&&(r._zoomScale=e,i.updateVisibility()),a[6*t]!==a[6*t+1]&&(c!=h[t]||r._dirty||0<e)&&(h[t]=c,r._dirty=!1,r=0<e?e:1,(t=o[4*t])<2&&0<e?i.updateGeometryAttributesWithScale(r):2===t?i.updateGeometryAttributeFace2d(l,s,r):3===t&&i.updateGeometryAttributeFacing(p,r)))}),d.Object3D.prototype.updateMatrix.apply(this)},this.mesh.vgbatch=this),this.mesh.renderOrder=-i,this.capacity=200,this.nextFreeQuadNumber=this.inuse=0,this.vertices=new Float32Array(2400),this.types=new Float32Array(800),this.center=new Float32Array(2400),this.centerOffset=new Float32Array(1600),this.visibilityRamp=new Float32Array(3200),this.normals=new Float32Array(2400),this.uvs=new Float32Array(1600),this.angleVector=new Float32Array(1600),this.geometry.addAttribute("position",new d.BufferAttribute(this.vertices,3)),this.geometry.addAttribute("type",new d.BufferAttribute(this.types,1)),this.geometry.addAttribute("center",new d.BufferAttribute(this.center,3)),this.geometry.addAttribute("centerOffset",new d.BufferAttribute(this.centerOffset,2)),this.geometry.addAttribute("normal",new d.BufferAttribute(this.normals,3)),this.geometry.addAttribute("uv",new d.BufferAttribute(this.uvs,2)),this.geometry.addAttribute("visibilityRamp",new d.BufferAttribute(this.visibilityRamp,4)),this.geometry.addAttribute("angleVector",new d.BufferAttribute(this.angleVector,2)),this.pois=[]}return(e.prototype.constructor=e).prototype.dispose=function(){this.texture.vg.nbRefs--,this.poiBatches.removeBatch(this),this.pois=this.angleVector=this.uvs=this.normals=this.visibilityRamp=this.centerOffset=this.center=this.types=this.vertices=this.poiBatches=null,this.mesh=this.mesh.vgbatch=null,this.material.dispose(),this.geometry.dispose()},e.prototype.isFull=function(t){return this.nextFreeQuadNumber+t-1>=this.capacity},e.prototype.allocateNextFreeQuad=function(t){var e=this.nextFreeQuadNumber++;this.inuse++;var i=0,i=6*this.nextFreeQuadNumber,r=this.indices,n=new(65535<i?Uint32Array:Uint16Array)(i),o=i=0;if(r){for(;i<6*e;++i)n[i]=r[i];o=4*e}return t?(n[i]=o,n[i+1]=o+1,n[i+2]=o+3,n[i+3]=o+1,n[i+4]=o+2,n[i+5]=o+3):(n[i]=0,n[i+1]=0,n[i+2]=0,n[i+3]=0,n[i+4]=0,n[i+5]=0),this.indices=n,this.geometry.setIndex(new d.BufferAttribute(this.indices,1)),e},e.prototype.getPickableFromIntersection=function(t){if(!this.pois)return!1;if(t&&t.face){var e=t.face.a/4|0;if(e<this.nextFreeQuadNumber){for(;void 0===this.pois[e];)e--;var i=this.pois[e].parameters;return i?!((t=t.distance)<i.visibilityRampStartVisible||t>i.visibilityRampFullyInvisible)&&{publicObject:this.pois[e].proxy.publicPOI,options:{id:i.id,poi:i}}:!1}}return!1},e.prototype.recalculatePositionCameraFacing=function(t,e,i){t=t.matrix;var r=new d.Matrix3;t=t.elements,(a=r.elements)[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[4],a[4]=t[5],a[5]=t[6],a[6]=t[8],a[7]=t[9],a[8]=t[10];var n=e._halfWidth,o=e._halfHeight;t=e._center,e=e._centerZ;var a=new d.Vector3(-n,-o,0),s=new d.Vector3(n,-o,0),l=new d.Vector3(n,o,0),n=new d.Vector3(-n,o,0);a.applyMatrix3(r),s.applyMatrix3(r),l.applyMatrix3(r),n.applyMatrix3(r);var r=i+1,o=i+2,c=i+3,h=this.geometry.getAttribute("position");h.setXYZ(i,a.x+t.x,a.y+t.y,a.z+e),h.setXYZ(r,s.x+t.x,s.y+t.y,s.z+e),h.setXYZ(o,l.x+t.x,l.y+t.y,l.z+e),h.setXYZ(c,n.x+t.x,n.y+t.y,n.z+e),h.needsUpdate=!0},e.prototype.recalculatePositionFace2D=function(t,e,i,r){var n=i._halfWidth,o=i._halfHeight,a=i._center;i=i._centerZ;var s=r+1,l=r+2,c=r+3,h=t*n,n=e*n;t*=o,e*=o,(o=this.geometry.getAttribute("position")).setXYZ(r,a.x-n+t,a.y-h-e,i),o.setXYZ(s,a.x+n+t,a.y+h-e,i),o.setXYZ(l,a.x+n-t,a.y+h+e,i),o.setXYZ(c,a.x-n-t,a.y-h+e,i),o.needsUpdate=!0},e.prototype.createElement=function(t,e,i,r){return r._textAspectRatio=t,r._zOffset=i,r._center=r.position,r._centerZ=(r.position.z||0)+i,t=this.allocateNextFreeQuad(r.visible),e=new n(this,t,r,e),this.pois[t]=e,this.geometry.needsUpdate=!0,this.geometry.computeBoundingSphere(),this.mesh.updateMatrix(),this.mesh.updateMatrixWorld(!0),e},e.prototype.createMultiLineText=function(t,e,i,r,n){for(n._textAspectRatio=t,n._zOffset=r,n._center=n.position,n._centerZ=(n.position.z||0)+r,t=0;t<e.length;t++)e[t].index=this.allocateNextFreeQuad(n.visible);return i=new o(this,e[0].index,n,e,i),this.pois[e[0].index]=i,this.geometry.needsUpdate=!0,this.geometry.computeBoundingSphere(),this.mesh.updateMatrix(),this.mesh.updateMatrixWorld(!0),i},e}),mt("com/visioglobe/web/helpers/TextureAtlas",[],function(){function i(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.right=this.left=this.image=null}i.prototype.isLeaf=function(){return null===this.left&&null===this.right},i.prototype.insert=function(t){if(this.isLeaf())return null!==this.image||t.width>this.width||t.height>this.height?null:t.width===this.width&&t.height===this.height?(this.image=t,this):(this.width-t.width>this.height-t.height?(this.left=new i({x:this.x,y:this.y,width:t.width,height:this.height}),this.right=new i({x:this.x+t.width,y:this.y,width:this.width-t.width,height:this.height})):(this.left=new i({x:this.x,y:this.y,width:this.width,height:t.height}),this.right=new i({x:this.x,y:this.y+t.height,width:this.width,height:this.height-t.height})),this.left.insert(t));var e=this.left.insert(t);return null!==e?e:this.right.insert(t)};function e(t){this.width=void 0!==t.width?t.width:2048,this.height=void 0!==t.height?t.height:2048,this.canvas=t=document.createElement("canvas"),t.width=this.width,t.height=this.height,this.canvasContext=t.getContext("2d"),this.count=0,this.resetNodes()}return e.prototype.resetNodes=function(){this.root=new i({x:0,y:0,width:this.width,height:this.height}),this.nodesBySrc={}},e.prototype.insert=function(t,e){var i=this.root.insert({width:t.width+2*(e=e||0),height:t.height+2*e});return null!==i&&(this.count++,this.canvasContext.drawImage(t,i.x+e,i.y+e),i)},e.prototype.getOrInsert=function(t){var e=t.src;return void 0!==this.nodesBySrc[e]?this.nodesBySrc[e]:(t=this.insert(t),this.nodesBySrc[e]=t)},e.prototype.isLargerThanAtlas=function(t,e){return t.width+(e=e||0)>this.width||t.height+e>this.height},e.prototype.getTexturePlacement=function(t){return null!==(t=this.root.insert(t))&&(this.count++,t.uvx=t.x/this.canvas.width,t.uvy=t.y/this.canvas.height,t.image=e.anonymousCounter,this.nodesBySrc[e.anonymousCounter++]=t)},e.prototype.remove=function(t){t=t.src;var e=this.nodesBySrc[t];void 0!==e&&(this.count--,e.image=null,delete this.nodesBySrc[t])},e.anonymousCounter=0,e}),mt("com/visioglobe/web/poi/POIBatches",["com/visioglobe/web/poi/POIBatch","com/visioglobe/web/helpers/TextureAtlas","com/visioglobe/web/helpers/TextGenerator"],function(s,d,n){function t(t,e,i,r){this.lod=t,this.renderDepthPOI=i,this.overlay=e.overlay,this.dynamic=!e.fixed||0<e.zoomScaleFactor,this.textGenerator=r||new n,this.batches=[]}return(t.prototype.constructor=t).prototype.removeBatch=function(t){index=this.batches.indexOf(t),-1!==index&&(this.batches.splice(index,1),this.textGenerator.disposeTexture(t.texture),index=this.lod.pickables.indexOf(t.mesh),-1!==index&&this.lod.pickables.splice(index,1),t.mesh.parent&&t.mesh.parent.remove(t.mesh),t.dynamic&&(index=this.lod.cameraUpdatableObjects.indexOf(t.mesh),-1!==index&&this.lod.cameraUpdatableObjects.splice(index,1)))},t.prototype.addBatch=function(t){this.batches.push(t);var e=t.mesh;this.lod.contentNode.add(e),e.vg={id:!0,batch:t},this.lod.pickables.push(e),t.dynamic&&this.lod.cameraUpdatableObjects.push(t.mesh)},t.prototype.getBatch=function(t,e,i,r,n){if(r)for(var o=0,a=this.batches.length;o<a;++o)if((r=this.batches[o]).texture===t&&!r.isFull(n))return this.batches[o];return(r=0==this.batches.length?{}:this.batches[this.batches.length-1]).texture===t&&!r.isFull(n)||((r=new s(t,this,this.renderDepthPOI,e,this.overlay,this.dynamic)).addPoiVariables=i,this.addBatch(r)),r},t.prototype.createPOI=function(t,e){var i=t.MapviewerPrivate,r=t._mapviewer,n=e.text;if(void 0!==n&&""!==n){var o=n.replace(/\s+/g," ").trim().split(" ");if(e.multiline&&1<o.length){if(!1===(n=this.textGenerator.generateTextOnAtlas(d," ",e)))return!1;for(var a=[],s=0,l=0,c=!1,h=0;h<o.length;h++){var u=o[h],p=this.textGenerator.generateTextOnAtlas(d,u,e),c=c||p.texture;if(!1===p||c!==p.texture)return!1;l+=p.width,s=Math.max(s,p.height),a.push({text:u,uvArray:p.geometry.attributes.uv.array,width:p.width,height:p.height,aspectRatio:p.aspectRatio,space:!1}),h<o.length-1&&(l+=n.width)}o=l/s,i=(c=this.getBatch(c,r,t,!1,a.length)).createMultiLineText(o,a,n,i.zOffsetPOI,e)}else{if(!1===(p=this.textGenerator.generateTextOnAtlas(d,n,e)))return!1;i=(c=this.getBatch(p.texture,r,t,!1,1)).createElement(p.aspectRatio,p.geometry.attributes.uv.array,i.zOffsetPOI,e)}}else{if(!1===(p=this.textGenerator.generateIconOnAtlasFromImage(d,e.url,r.textures[e.url].texture.image)))return!1;p.aspectRatio=1,i=(c=this.getBatch(p.texture,r,t,!0,1)).createElement(p.aspectRatio,p.geometry.attributes.uv.array,i.zOffsetPOI,e)}return r.requestRedraw(),i},t}),mt("com/visioglobe/web/poi/POIFactory","com/visioglobe/web/poi/PublicPOI com/visioglobe/web/poi/POI com/visioglobe/web/poi/POIBatches com/visioglobe/web/helpers/CachedTexture com/visioglobe/web/helpers/MathUtils com/visioglobe/web/helpers/TextGenerator three".split(" "),function(n,g,l,v,y,c,u){var b={DEFAULT_POI_OPTIONS:{family:"Arial",textTextureHeight:64,color:16777215,visibilityRampStartVisible:2,visibilityRampFullyVisible:5,visibilityRampStartInvisible:3e3,visibilityRampFullyInvisible:5e3},removeFromPois:function(t,e,i){var r;null!=e&&(void 0===(r=t.pois[e])||-1!==(i=r.indexOf(i))&&(r.splice(i,1),0==r.length&&delete t.pois[e]))},addToPois:function(t,e,i){null!=e&&(void 0===t.pois[e]&&(t.pois[e]=[]),t.pois[e].push(i))},updateOrCreatePublicPOI:function(t,e,i){var r;return i?i.proxy=e:(i=new n(e),r=e.options("id"),b.addToPois(t._mapviewer,r,i)),e.publicPOI=i},createPOIBatchElement:function(t,e,i,r,n){var o,a=t.MapviewerPrivate,s=t._mapviewer;return n?o=e.overlay?i.poiBatchesOverlay||(i.poiBatchesOverlay=new l(i,e,a.renderDepthPOIOverlay)):!e.fixed||0<e.zoomScaleFactor?i.poiBatchesFacing||(i.poiBatchesFacing=new l(i,e,a.renderDepthPOIFacing)):i.poiBatches||(i.poiBatches=new l(i,e,a.renderDepthPOI)):r&&(s.iconGenerator||(s.iconGenerator=new c),o=e.overlay?i.poiBatchesIconsOverlay||(i.poiBatchesIconsOverlay=new l(i,e,a.renderDepthPOIOverlay,s.iconGenerator)):!e.fixed||0<e.zoomScaleFactor?i.poiBatchesIconsFacing||(i.poiBatchesIconsFacing=new l(i,e,a.renderDepthPOIFacing,s.iconGenerator)):i.poiBatchesIcons||(i.poiBatchesIcons=new l(i,e,a.renderDepthPOI,s.iconGenerator))),o.createPOI(t,e)},createPOI:function(t,e,i){t.POIFactory=b;var r,n=t._mapviewer,o=b.DEFAULT_POI_OPTIONS;for(void 0!==e.model&&(o.visibilityRampStartVisible=0,o.visibilityRampFullyVisible=0,o.visibilityRampStartInvisible=1/0,o.visibilityRampFullyInvisible=1/0),"number"==typeof(o={text:void 0!==e.text&&""!==e.text?String(e.text):"",url:e.url,model:e.model,startAnimations:e.startAnimations||[],textureAnimation:e.textureAnimation,selector:e.selector,textTextureHeight:e.textTextureHeight||o.textTextureHeight,family:e.family||o.family,color:(void 0!==e.color?e:o).color,position:e.position||{x:0,y:0,z:0},alignment:e.alignment||{x:0,y:0},_textAspectRatio:1,multiline:e.multiline||!1,_textNbLines:1,scale:e.scale||e.iconScale||e.icon_scale||{x:1,y:1,z:1},zoomScaleFactor:e.zoomScaleFactor||0,zoomScaleFast:e.zoomScaleFast||!1,_zoomScale:0,_previousZoomScale:0,angle:e.angle,heading:e.heading,_inverseAngleInRadians:0,floor:void 0!==e.floor?e.floor:n.currentFloorName,lod:e.lod,visible:void 0===e.visible||e.visible,id:void 0!==e.id?e.id:"_anonymous"+ ++n._anonymous_poi_counter,visibilityRampStartVisible:e.visibilityRampStartVisible||o.visibilityRampStartVisible,visibilityRampFullyVisible:e.visibilityRampFullyVisible||o.visibilityRampFullyVisible,visibilityRampStartInvisible:e.visibilityRampStartInvisible||o.visibilityRampStartInvisible,visibilityRampFullyInvisible:e.visibilityRampFullyInvisible||o.visibilityRampFullyInvisible,clickable:void 0===e.clickable||e.clickable,fixed:void 0!==e.fixed&&e.fixed,width:void 0!==e.width&&0!==e.width?e.width:-1,height:void 0!==e.height&&0!==e.height?e.height:-1,overlay:void 0!==e.overlay&&e.overlay,flip:void 0!==e.flip&&e.flip,face2d:void 0!==e.face2d&&e.face2d,image:void 0!==e.image&&e.image,onObjectMouseOver:e.onObjectMouseOver,onObjectMouseOut:e.onObjectMouseOut,onObjectMouseUp:e.onObjectMouseUp,track:void 0!==e.track&&e.track,_vgnobatch:void 0!==e.vgnobatch&&e.vgnobatch,_vgnobatchfacing:void 0!==e.vgnobatchfacing&&e.vgnobatchfacing,_vgnobatchicon:void 0!==e.vgnobatchicon&&e.vgnobatchicon,_vgmipmap:void 0!==e.vgmipmap?e.vgmipmap:!(n.vgnobatch||e.vgnobatch),_empty:!1}).heading&&(o.angle=e.heading-n.cameraNorthRotation),o.angle=void 0!==o.angle?o.angle:0;o.angle<0;)o.angle+=360;for(;360<o.angle;)o.angle-=360;o._inverseAngleInRadians=y.TWOPI-o.angle*Math.PI/180,"number"==typeof o.scale&&(o.scale={x:o.scale,y:o.scale,z:o.scale}),e=void 0!==o.url&&""!==o.url;var a=void 0!==o.text&&""!==o.text,s=void 0!==o.model&&""!==o.model,l=void 0!==o.selector&&""!==o.url,c=!1;e&&(c=(c=n.textures[o.url])&&c.loaded),o._empty=!(e&&c||a||s||l);var h,u,p=n.scene;if(null===(d=n.getFloor(o.floor)))return console.log("Warning: POI was not created, required floor doesn't exist."),null;if(null!==d){if(r=void 0!==o.lod?d.getLOD(o.lod):d.floorContentLOD,!o.overlay&&!r)return null;p=r.contentNode}if(!(e&&c||a||s||l))return r=new g(t,o,r,p,e,a,s,l),i&&n.requestRedraw(),r=b.updateOrCreatePublicPOI(t,r.proxy,i),e&&!c&&(t=o.url,r.options("url",""),new v(n,t,!0,(h=t,u=r,function(t){u.options("url",h)}))),r;var d=!1,f=n.vgnobatch||o._vgnobatch,m=n.vgnobatchfacing||o._vgnobatchfacing,n=n.vgnobatchicon||o._vgnobatchicon;return(d=s||l||f||m&&!o.fixed||!(!n&&!a&&e&&c||a&&!e)||0!==o.alignment.x||0!==o.alignment.y?d:this.createPOIBatchElement(t,o,r,e,a))?this.updateOrCreatePublicPOI(t,d.proxy,i):(n=new g(t,o,r,p,e,a,s,l),this.updateOrCreatePublicPOI(t,n.proxy,i))},createTextureAnimation:function(t,e,i){if(null!==(i=i.match(/(sintranslate|timetranslate|sinscale)\(\s*([0-9\.-]+)\s*,\s*([0-9\.-]+)\s*,\s*([0-9\.-]+)\s*,\s*([0-9\.-]+)\s*\)/))){var r=i[2],n=i[3],o=i[4];switch(i[1]){case"timetranslate":(t=t.animateValue(0,1,{duration:1e3*r,step:function(t){e.offset.set((t=-t)*n,t*o)}})).repeat(1/0);break;case"sintranslate":(t=t.animateValue(0,1,{duration:1e3*r,step:function(t){t=Math.sin(y.TWOPI*t),e.offset.set(t*n,t*o)}})).repeat(1/0);break;case"sinscale":(t=t.animateValue(0,1,{duration:1e3*r,step:function(t){t=Math.sin(y.TWOPI*t),e.repeat.set(1+t*n,1+t*o),e.offset.set(-.5*t*n,-.5*t*o)}})).repeat(1/0)}}},onModelLoaded:function(e,i,r,n,t,o){var a,s;if(3.1===i.version){var l,c=!1,h=[];Object.keys(i.materials).forEach(function(t){t=new u.MeshBasicMaterial({map:i.materials[t].map,color:16777215,side:u.FrontSide,transparent:i.materials[t].transparent,alphaTest:.1,opacity:n}),h.push(t),!c&&t.transparent&&(c=!0)}),(a=new u.Mesh(i.geometry,h)).matrixAutoUpdate=!1,(0<r.visibilityRampStartVisible||0<r.visibilityRampFullyVisible||1/0>r.visibilityRampStartInvisible||1/0>r.visibilityRampFullyInvisible)&&(h.forEach(function(t,e){h[e].transparent=!0}),c=!0),a.renderOrder=c?1:0,a.vg={id:r.id,poi:r,originalColor:16777215},o.pickables.push(a),null===i.bbox?((l=new u.Box3).setFromObject(a),i.bbox=l):l=i.bbox,l=l.getSize(),l=Math.max(l.x,l.y,l.z)/r.scale.x,a.position.x=0,a.position.y=0,a.position.z=0,a.scale.x=1/l,a.scale.y=-1/l,a.scale.z=-1/l,a.updateMatrix(),a.traverse(function(t){t instanceof u.Mesh&&(t.castShadow=!0,t.receiveShadow=!0),t.matrixAutoUpdate=a.matrixAutoUpdate})}else if(4.4<=i.version)(a=i.scene.clone(void 0,!1)).updateMatrixWorld(!0),c=!1,a.matrixAutoUpdate=!1,a.traverse(function(t){t.matrixAutoUpdate=a.matrixAutoUpdate,t instanceof u.Mesh&&((t.material instanceof u.MeshBasicMaterial||t.material instanceof u.MeshLambertMaterial||t.material instanceof u.MeshPhongMaterial)&&t.material.map&&t.material.color.setHex(16777215),void 0!==r.textureAnimation&&(t.material=t.material.clone()),t.material.side=u.FrontSide,t.material.alphaTest=.1,t.material.opacity=n,!c&&t.material.transparent&&(c=!0),t.material.map&&void 0!==t.material.map.image&&(void 0!==r.textureAnimation&&(t.material.map=t.material.map.clone(),b.createTextureAnimation(e,t.material.map,r.textureAnimation)),t.material.map.wrapS=u.RepeatWrapping,t.material.map.wrapT=u.RepeatWrapping,t.material.map.needsUpdate=!0),t.vg={id:r.id,poi:r,originalColor:16777215},o.pickables.push(t),t.castShadow=!0,t.receiveShadow=!0)}),(0<r.visibilityRampStartVisible||0<r.visibilityRampFullyVisible||1/0>r.visibilityRampStartInvisible||1/0>r.visibilityRampFullyInvisible)&&(a.traverse(function(i){i instanceof u.Mesh&&(Array.isArray(i.material)?i.material.forEach(function(t,e){i.material[e].transparent=!0}):i.material.transparent=!0)}),c=!0),a.renderOrder=c?1:0,null===i.bbox?((l=new u.Box3).setFromObject(a),i.bbox=l):l=i.bbox,a.position.x=0,a.position.y=0,a.position.z=0,l=2*Math.max(Math.abs(l.min.x),Math.abs(l.max.x),Math.abs(l.min.y),Math.abs(l.max.y))/Math.max(r.scale.x,r.scale.y),a.scale.x*=1/l,a.scale.y*=1/l,a.scale.z*=1/l,a.rotation.x=y.PI_2,a.updateMatrix(),a.updateMatrixWorld();else if(3.2===i.version){for(l in c=!1,i.result.materials)(i.result.materials[l]instanceof u.MeshBasicMaterial||i.result.materials[l]instanceof u.MeshLambertMaterial||i.result.materials[l]instanceof u.MeshPhongMaterial)&&i.result.materials[l].map&&i.result.materials[l].color.setHex(16777215),i.result.materials[l].side=u.FrontSide,i.result.materials[l].alphaTest=.1,i.result.materials[l].opacity=n,!c&&i.result.materials[l].transparent&&(c=!0),i.result.materials[l].map&&((s=i.result.materials[l].map).wrapS=u.RepeatWrapping,s.wrapT=u.RepeatWrapping);a=i.result.scene.clone(void 0,!1),(0<r.visibilityRampStartVisible||0<r.visibilityRampFullyVisible||1/0>r.visibilityRampStartInvisible||1/0>r.visibilityRampFullyInvisible)&&(a.traverse(function(i){i instanceof u.Mesh&&(Array.isArray(i.material)?i.material.forEach(function(t,e){i.material[e].transparent=!0}):i.material.transparent=!0)}),c=!0),a.renderOrder=c?1:0,a.matrixAutoUpdate=!1,a.traverse(function(t){t.matrixAutoUpdate=a.matrixAutoUpdate,t instanceof u.Mesh&&(t.vg={id:r.id,poi:r,originalColor:16777215},o.pickables.push(t),t.castShadow=!0,t.receiveShadow=!0)}),null===i.bbox?((l=new u.Box3).setFromObject(a),i.bbox=l):l=i.bbox,l=2*Math.max(Math.abs(l.min.x),Math.abs(l.max.x),Math.abs(l.min.y),Math.abs(l.max.y))/Math.max(r.scale.x,r.scale.y),a.position.x=0,a.position.y=0,a.position.z=0,a.scale.x=1/l,a.scale.y=1/l,a.scale.z=1/l,a.rotation.x=y.PI_2,a.updateMatrix(),a.updateMatrixWorld()}a.name="poi_model",t.add(a),t.updateMatrixWorld(!0),r._opacity=null,e.mustUpdateCameraObjects=!0,e.requestRedraw()},removeMaterial:function(r,t,e){null!==t&&e.traverse(function(e){var i;e&&void 0!==e.material&&null!==e.material.map&&"object"==typeof e.material.map&&(i=function(t){void 0!==e.material.map.vg&&e.material.map.vg.nbRefs--,(void 0===e.material.map.vg||e.material.map.vg.nbRefs<=0)&&((t=e.material.map).dispose(),t.sourceFile&&void 0!==r.textures[t.sourceFile]&&delete r.textures[t.sourceFile],t.image instanceof HTMLCanvasElement||(t.image=null))},"object"==typeof e.material.map?i(e.material):void 0!==e.material.length&&e.material.forEach(function(t){i(t)}))})},removeModel:function(t,e){var i=function(t){t instanceof u.Material?(t.map&&t.map.dispose(),t.dispose()):0<t.length&&t.forEach(function(t){i(t)})},r=t.models[e];if(3.1===r.version){r.geometry.dispose();for(var n=r.materials.length-1;0<=n;n--)i(r.materials[n])}else 3.2===r.version?(Object.keys(r.result.geometries).forEach(function(t){r.result.geometries[t].dispose()}),Object.keys(r.result.materials).forEach(function(t){i(r.result.materials[t])}),Object.keys(r.result.textures).forEach(function(t){r.result.textures[t].dispose()})):4.4<=r.version&&r.scene.traverse(function(t){t.geometry&&t.geometry.dispose(),void 0!==t.material&&i(t.material)});delete t.models[e]}};return b}),mt("text!com/visioglobe/web/shaders/sky.frag",[],function(){return"uniform vec3 topColor;uniform vec3 bottomColor;uniform float offset;uniform float exponent;varying vec3 vWorldPosition;void main(){float a=normalize(vWorldPosition.yzx+offset).y;gl_FragColor=vec4(mix(bottomColor,topColor,max(pow(max(a,0.0),exponent),0.0)),1.0);}"}),mt("text!com/visioglobe/web/shaders/sky.vert",[],function(){return"varying vec3 vWorldPosition;void main(){vec4 a=modelMatrix*vec4(position,1.0);vWorldPosition=a.xyz;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}"}),mt("com/visioglobe/web/helpers/Skybox",["three","text!com/visioglobe/web/shaders/sky.frag","text!com/visioglobe/web/shaders/sky.vert"],function(l,i,r){function t(t){this.mapviewer=t,this.camera=new l.PerspectiveCamera(this.mapviewer.camera.fov,this.mapviewer.camera.aspect,.1,2),this.scene=new l.Scene,this.scene.autoUpdate=!1,this.textureCube=null,this.rotateCameraX=!1}return(t.prototype.constructor=t).prototype.initializeWithFaces=function(t){var e;void 0!==t&&Array.isArray(t.images)&&6===t.images.length&&(this.textureCube=(new l.CubeTextureLoader).load(t.images,function(){this.mapviewer.requestRedraw()}.bind(this)),this.textureCube.format=l.RGBFormat,this.textureCube.mapping=l.CubeReflectionMapping,t=l.ShaderLib.cube,(t=new l.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:t.uniforms,depthWrite:!1,side:l.BackSide})).uniforms.tCube.value=this.textureCube,e=new l.BoxGeometry(1,1,1),this.mesh=new l.Mesh(e,t),this.scene.add(this.mesh),this.rotateCameraX=!0)},t.prototype.initializeWithStrip=function(a){var s;void 0!==a&&"string"==typeof a.image&&((s=new Image).onload=function(){this.textureCube=new l.CubeTexture,this.textureCube.format=l.RGBFormat,this.textureCube.mapping=l.CubeReflectionMapping;var t,e,i=s.height;s.width<s.height&&(i=s.width);for(var r=a.rhs?[5,4,2,3,1,0]:[0,1,2,3,4,5],n=0;n<6;n++){e=(t=document.createElement("canvas")).getContext("2d"),t.height=i,t.width=i;var o=r[n];s.width<s.height?e.drawImage(s,0,i*o,i,i,0,0,i,i):e.drawImage(s,i*o,0,i,i,0,0,i,i),this.textureCube.images[n]=t}this.textureCube.needsUpdate=!0,t=l.ShaderLib.cube,(t=new l.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:t.uniforms,depthWrite:!1,side:l.BackSide})).uniforms.tCube.value=this.textureCube,e=new l.BoxGeometry(1,1,1),this.mesh=new l.Mesh(e,t),this.scene.add(this.mesh),this.rotateCameraX=!0,this.mapviewer.requestRedraw()}.bind(this),s.src=a.image)},t.prototype.initializeWithGradient=function(t){void 0!==t&&Array.isArray(t.colors)&&2===t.colors.length||(t={colors:[30719,7864319]}),t={topColor:{type:"c",value:new l.Color(t.colors[0])},bottomColor:{type:"c",value:new l.Color(t.colors[1])},offset:{type:"f",value:t.offset||.033},exponent:{type:"f",value:t.exponent||.55}},t=new l.ShaderMaterial({fragmentShader:i,vertexShader:r,uniforms:t,depthWrite:!1,side:l.BackSide});var e=new l.SphereGeometry(1,32,15);this.mesh=new l.Mesh(e,t),this.scene.add(this.mesh),this.mapviewer.requestRedraw()},t.prototype.setFov=function(t){this.fov=t,this.camera.fov=this.fov,this.camera.updateProjectionMatrix()},t.prototype.dispose=function(){this.mesh.geometry.dispose(),(this.mesh=null)!==this.textureCube&&(this.textureCube.dispose(),this.textureCube.images.forEach(function(t){}),this.textureCube=null),this.scene=null},t.prototype.update=function(t,e){null===this.fov&&(this.camera.fov=t),this.camera.aspect=e,this.camera.updateProjectionMatrix()},t.prototype.render=function(){this.camera.rotation.copy(this.mapviewer.camera.rotation),this.rotateCameraX&&(this.camera.rotation.x-=Math.PI/2),this.mapviewer.renderer.render(this.scene,this.camera)},t}),mt("com/visioglobe/web/helpers/SvgUtils",["com/visioglobe/web/helpers/MathUtils"],function(r){function o(){}o.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},o.compressSpaces=function(t){return t.replace(/[\s\r\t\n]+/gm," ")},o.Point=function(t,e){this.x=t,this.y=e,this.clone=function(){return new o.Point(this.x,this.y)},this.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},this.equals=function(t,e){return e=e||.01,Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e}},o.equalsPoints=function(t,e,i){return i=i||.01,Math.abs(e.x-t.x)<i&&Math.abs(e.y-t.y)<i},(o.Parser={}).color=function(t){if(void 0===t)return 0;var e,i=parseInt;if(t=t.replace(/\s\s*/g,""),e=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})/.exec(t))e=[i(e[1],16),i(e[2],16),i(e[3],16)];else{if(!(e=/^#([\da-fA-F])([\da-fA-F])([\da-fA-F])/.exec(t)))return 0;e=[17*i(e[1],16),17*i(e[2],16),17*i(e[3],16)]}return 65536*e[0]+256*e[1]+e[2]};function e(t){this.tokens=t.split(" ")}e.prototype.reset=function(){this.i=-1,this.previousCommand=this.command="",this.start=new o.Point(0,0),this.control=new o.Point(0,0),this.current=new o.Point(0,0),this.points=[],this.angles=[]},e.prototype.isEnd=function(){return this.i>=this.tokens.length-1},e.prototype.isCommandOrEnd=function(){return!!this.isEnd()||null!==this.tokens[this.i+1].match(/^[A-Za-z]$/)},e.prototype.isRelativeCommand=function(){return this.command===this.command.toLowerCase()},e.prototype.getToken=function(){return this.i+=1,this.tokens[this.i]},e.prototype.getScalar=function(){return parseFloat(this.getToken())},e.prototype.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},e.prototype.getPoint=function(){var t=new o.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},e.prototype.getAsControlPoint=function(){var t=this.getPoint();return this.control=t},e.prototype.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t},e.prototype.getReflectedControlPoint=function(){return"c"!==this.previousCommand.toLowerCase()&&"s"!==this.previousCommand.toLowerCase()?this.current:new o.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},e.prototype.makeAbsolute=function(t){return this.isRelativeCommand()&&(t.x=this.current.x+t.x,t.y=this.current.y+t.y),t},e.prototype.addMarker=function(t,e,i){null!==i&&0<this.angles.length&&null===this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(i)),this.addMarkerAngle(t,null===e?null:e.angleTo(t))},e.prototype.addMarkerAngle=function(t,e){this.points.push(t),this.angles.push(e)},e.prototype.getMarkerPoints=function(){return this.points},e.prototype.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++)if(null===this.angles[t])for(var e=t+1;e<this.angles.length;e++)if(null!==this.angles[e]){this.angles[t]=this.angles[e];break}return this.angles},o.Parser.path=function(t){return t=t.replace(/,/gm," ").replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2").replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2").replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2").replace(/([0-9])([+\-])/gm,"$1 $2").replace(/(\.[0-9]*)(\.)/gm,"$1 $2").replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),t=o.compressSpaces(t),t=o.trim(t),this.PathParser=e,new this.PathParser(t)},o.convertRectToPath=function(t){var e=t.getAttribute("x")||0,i=t.getAttribute("y")||0,r=t.getAttribute("width"),n=t.getAttribute("height");t.setAttribute("d",e=(e=(e=(e=(e="m"+e+","+i+"l0,"+n)+"l"+r+",0")+"l0,"+-n)+"l"+-r+",0")+"z")},o.convertCircleToPath=function(t,e){for(var i,r,n,o,a,s,l=parseFloat(t.getAttribute("cx")),c=parseFloat(t.getAttribute("cy")),h=parseFloat(t.getAttribute("r")),u="",p=e||24,d=0;d<p;++d)i=l+h*Math.cos(2*d*Math.PI/(p-1)),r=c+h*Math.sin(2*d*Math.PI/(p-1)),0===d?(u+="m"+i+","+r,a=i,s=r):(n=i-a,o=r-s,a=i,s=r,u+="l"+n+","+o);t.setAttribute("d",u+"z")},o.convertEllipseToPath=function(t,e){for(var i,r,n,o,a,s,l=parseFloat(t.getAttribute("cx")),c=parseFloat(t.getAttribute("cy")),h=parseFloat(t.getAttribute("rx")),u=parseFloat(t.getAttribute("ry")),p="",d=e||24,f=0;f<d;++f)i=l+h*Math.cos(2*f*Math.PI/(d-1)),r=c+u*Math.sin(2*f*Math.PI/(d-1)),0===f?(p+="m"+i+","+r,a=i,s=r):(n=i-a,o=r-s,a=i,s=r,p+="l"+n+","+o);t.setAttribute("d",p+"z")},o.convertPolygonToPath=function(t){for(var e="",i=t.getAttribute("points").split(/[, ]/).filter(function(t){return""!==t}).map(function(t){return""===t?null:parseFloat(t)}),r=0,n=i.length/2;r<n;++r){var o,a,s,l,c=i[2*r+0],h=i[2*r+1];0===r?(e+="m"+c+","+h,s=c,l=h):(o=c-s,a=h-l,s=c,l=h,e+="l"+o+","+a)}t.setAttribute("d",e+"z")},o.deg2rad=function(t){return t*r.DEG2RAD},(o.Transform=function(t){this.matrix=t||[1,0,0,1,0,0]}).prototype.multiply=function(t,e){var i=t.matrix[0],r=t.matrix[1],n=t.matrix[2],o=t.matrix[3],a=t.matrix[4],s=t.matrix[5],l=e.matrix[0],c=e.matrix[1],h=e.matrix[2],u=e.matrix[3],t=e.matrix[4],e=e.matrix[5];this.matrix[0]=i*l+r*h,this.matrix[1]=i*c+r*u,this.matrix[2]=n*l+o*h,this.matrix[3]=n*c+o*u,this.matrix[4]=a*l+s*h+ +t,this.matrix[5]=a*c+s*u+ +e},o.Transform.prototype.multiplyVector=function(t){var e=t.x,i=t.y;t.x=this.matrix[0]*e+this.matrix[2]*i+this.matrix[4],t.y=this.matrix[1]*e+this.matrix[3]*i+this.matrix[5]},o.Transform.prototype.decompose=function(){var t={},e=r.sign(this.matrix[0]);0===e&&(e=1);var i=r.sign(this.matrix[3]);return 0===i&&(i=1),t.sx=e*Math.sqrt(this.matrix[0]*this.matrix[0]+this.matrix[2]*this.matrix[2]),t.sy=i*Math.sqrt(this.matrix[1]*this.matrix[1]+this.matrix[3]*this.matrix[3]),t.angle=180*Math.atan2(-this.matrix[2],this.matrix[0])/Math.PI,t.tx=this.matrix[4]/t.sx,t.ty=this.matrix[5]/t.sy,t};var i=/((translate|rotate|matrix|scale|skewX|skewY)(\([0-9eE\-\. ,]*\)))/g;return o.Transform.parse=function(t){var r=new o.Transform([1,0,0,1,0,0]);if(null==t)return r;var n=t.match(i);return Object.keys(n).forEach(function(t){var e=(t=n[t]).substring(0,t.indexOf("("));switch(t=function(t){var e=t.indexOf("("),i=t.indexOf(")");if(-1===e||-1===i)return[];for(t=(t=(t=t.substring(e+1,i)).replace(/[ ,]/g," ")).split(" "),e=0;e<t.length;++e)""===t[e]&&(t.splice(e,1),--e);return t.map(function(t){return parseFloat(t)})}(t),e){case"matrix":if(6!==t.length)return null;r.multiply(new o.Transform(t),r);break;case"translate":if(t.length<1)return null;1===t.length&&t.push(0),e=[1,0,0,1,t[0],t[1]],r.multiply(new o.Transform(e),r);break;case"scale":if(t.length<1)return null;1===t.length&&t.push(t[0]),e=[t[0],0,0,t[1],0,0],r.multiply(new o.Transform(e),r);break;case"rotate":if(t.length<1)return null;var e=Math.cos(o.deg2rad(t[0])),i=Math.sin(o.deg2rad(t[0])),e=[e,i,-i,e,0,0];1!==t.length&&(i=new o.Transform([1,0,0,1,-t[1],-t[2]]),t=new o.Transform([1,0,0,1,t[1],t[2]]),i.multiply(i,new o.Transform(e)),i.multiply(i,t),e=i.matrix),r.multiply(new o.Transform(e),r);break;case"skewX":if(t.length<1)return null;t=Math.tan(o.deg2rad(t[0])),r.multiply(new o.Transform(e=[1,0,t,1,0,0]),r);break;case"skewY":if(t.length<1)return null;t=Math.tan(o.deg2rad(t[0])),r.multiply(new o.Transform(e=[1,t,0,1,0,0]),r)}}),r},o}),mt("com/visioglobe/web/helpers/PathUtils",["three"],function(_){var A,t={};return A=Math.PI/180,t.transformSVGPath=function(r){function t(){for(var t,e,i=!1;a<s&&(44===(e=r.charCodeAt(a))||32===e);)a++;for(t=45===e?a++:a;a<s;)if(48<=(e=r.charCodeAt(a))&&e<=57)a++;else{if(46!==e&&101!==e&&69!==e&&45!==e)return t=r.substring(t,a),(i?parseFloat:parseInt)(t);a++,i=!0}return t=r.substring(t),(i?parseFloat:parseInt)(t)}for(var e,i,n,o=new _.ShapePath,a=1,s=r.length,l=0,c=0,h=0,u=0,p=null,d=null,f=0,m=0,g=0,v=0,y=0,b=0,x=0,w=r[0];a<=s;){switch(n=!0,w){case"M":l=t(),c=t(),o.moveTo(l,c),w="L",p=l,d=c;break;case"m":l+=t(),c+=t(),o.moveTo(l,c),w="l",p=l,d=c;break;case"Z":case"z":n=!1,l===p&&c===d||o.lineTo(p,d);break;case"L":case"H":case"V":h="V"===w?l:t(),u="H"===w?c:t(),o.lineTo(h,u),l=h,c=u;break;case"l":case"h":case"v":h="v"===w?l:l+t(),u="h"===w?c:c+t(),o.lineTo(h,u),l=h,c=u;break;case"C":f=t(),g=t();case"S":"S"===w&&(f=2*l-m,g=2*c-v),m=t(),v=t(),h=t(),u=t(),o.bezierCurveTo(f,g,m,v,h,u),l=h,c=u;break;case"c":f=l+t(),g=c+t();case"s":"s"===w&&(f=2*l-m,g=2*c-v),m=l+t(),v=c+t(),h=l+t(),u=c+t(),o.bezierCurveTo(f,g,m,v,h,u),l=h,c=u;break;case"Q":f=t(),g=t();case"T":"T"===w&&(f=2*l-f,g=2*c-g),h=t(),u=t(),o.quadraticCurveTo(f,g,h,u),l=h,c=u;break;case"q":f=l+t(),g=c+t();case"t":"t"===w&&(f=2*l-f,g=2*c-g),h=l+t(),u=c+t(),o.quadraticCurveTo(f,g,h,u),l=h,c=u;break;case"A":e=t(),y=t(),b=t()*A,x=t(),i=t(),h=t(),u=t(),e!==y&&console.warn("Forcing elliptical arc to be a circular one :(",e,y),f=Math.cos(b)*(l-h)/2+Math.sin(b)*(c-u)/2,g=-Math.sin(b)*(l-h)/2+Math.cos(b)*(c-u)/2,v=Math.sqrt((e*e*y*y-e*e*g*g-y*y*f*f)/(e*e*g*g+y*y*f*f));var m=(v=x===i?-v:v)*e*g/y,v=v*-y*f/e,l=Math.cos(b)*m-Math.sin(b)*v+(l+h)/2,c=Math.sin(b)*m+Math.cos(b)*v+(c+u)/2,b=new _.Vector2(1,0),x=new _.Vector2((f-m)/e,(g-v)/y),M=Math.acos(b.dot(x)/b.length()/x.length());b.x*x.y-b.y*x.x<0&&(M=-M),b.x=(-f-m)/e,b.y=(-g-v)/y,y=Math.acos(x.dot(b)/x.length()/b.length()),x.x*b.y-x.y*b.x<0&&(y=-y),!i&&0<y&&(y-=2*Math.PI),i&&y<0&&(y+=2*Math.PI),o.absarc(l,c,e,M,M+y,i),l=h,c=u;break;case" ":break;default:throw Error("weird path command: '"+w+"'")}n&&function(){for(var t;a<s&&(44===(t=r.charCodeAt(a))||32===t);)a++;return 45===(t=r.charCodeAt(a))||48<=t&&t<=57}()||(w=r[a++])}return o},t}),mt("com/visioglobe/web/CameraDrivenExplorer",["com/visioglobe/common/PublicInterface"],function(e){function i(t){e.create(this,t,r,n,o)}function t(t){this.panFromUndergroundFloor=!1,this.maxExploreDistance=0,this.isEnabled=!1,this.publicCameraDrivenExplorer=new i(this),this.multiBuildingView=t,this.mapviewer=t.mapviewer,this.camera=t.mapviewer.publicCamera,this._updateAndExplore=a.bind(this),this.maxViewpointRadius=0,this.buildingParameters={}}var r=["panFromUndergroundFloor","maxExploreDistance"],n=["isEnabled"],o=["setEnabled","setBuildingEnabled"],a=function(t){this.updateBuildingViewpoints(),this.explore()};return(t.prototype.constructor=t).prototype.setEnabled=function(t){var e;t!==this.isEnabled&&((this.isEnabled=t)&&this.multiBuildingView.venueLayout.hasGlobalLayer?(this.initBuildingInfo(),(e=this).mapviewer.publicCamera.setCustomPostManipulatorListener(function(){e.explore()}),this.mapviewer.on("resize",this._updateAndExplore)):(this.mapviewer.publicCamera.removeCustomPostManipulatorListener(),this.mapviewer.off("resize",this._updateAndExplore)))},t.prototype.setBuildingEnabled=function(t,e,i){if(void 0===i&&(i="inout"),"string"==typeof e&&void 0!==this.buildingParameters[e])switch(i){case"in":this.buildingParameters[e].exploreTo=t;break;case"out":this.buildingParameters[e].exploreFrom=t;break;default:this.buildingParameters[e].exploreTo=t,this.buildingParameters[e].exploreFrom=t}else if("string"!=typeof e&&0<e.length)for(var r in e)this.setBuildingEnabled(t,e[r],i)},t.prototype.initBuildingInfo=function(){this.multiBuildingView.venueLayout.buildings.forEach(function(t){var e=t.id;this.buildingParameters[e]={},this.buildingParameters[e].viewpoint=this.mapviewer.getPOF(e),this.buildingParameters[e].exploreTo=t.exploreTo,this.buildingParameters[e].exploreFrom=t.exploreFrom},this),this.updateBuildingViewpoints()},t.prototype.updateBuildingViewpoints=function(){this.maxViewpointRadius=0,this.multiBuildingView.venueLayout.buildings.forEach(function(t){var e=t.id;t=this.mapviewer.getFootprintPoints(e);var e=this.mapviewer.getPOF(e),i=this.multiBuildingView.floorModePaddingFactor;(t=this.mapviewer.getViewpointFromPositions({points:t,top:i*this.multiBuildingView.containerHeight,bottom:i*this.multiBuildingView.containerHeight,left:i*this.multiBuildingView.containerWidth,right:i*this.multiBuildingView.containerWidth,pitch:this.multiBuildingView.floorModePitch,heading:e.headingInDegrees}))&&t.radius>this.maxViewpointRadius&&(this.maxViewpointRadius=t.radius)},this),this.maxViewpointRadius*=2},t.prototype.explore=function(){if(this.multiBuildingView.goToPromise.isPending())return!1;var t,e,i=this.camera.position,r=this.camera.position.radius,n=this.camera.pitch,o=this.camera.heading,a=!1,s=this.multiBuildingView.getCurrentExploreState(),l=0!==this.maxExploreDistance?this.maxExploreDistance:this.maxViewpointRadius,c=Math.max(this.maxExploreDistance,this.maxViewpointRadius);if(void 0!==s.buildingID&&(void 0===this.buildingParameters[s.buildingID].exploreFrom||!this.buildingParameters[s.buildingID].exploreFrom))return!1;var h=function(t){if("floor"!==s.mode)return!1;var e=t.buildingByID[s.buildingID].floorByID[s.floorID];if(e.levelIndex<0)return!0;t=Object.keys(e.connectedFloors);return!!(0<t.length&&t.some(function(t){return e.connectedFloors[t].levelIndex<0}))}(this.multiBuildingView.venueLayout);if(h&&!this.panFromUndergroundFloor)e=s.buildingID,a=!0;else if("global"!==s.mode&&r<c&&this.mapviewer.isInsideFootprint(i,s.buildingID))e=s.buildingID,a=!0;else if(r<l)for(t in this.buildingParameters)if(void 0!==this.buildingParameters[t].exploreTo&&this.buildingParameters[t].exploreTo&&this.mapviewer.isInsideFootprint(i,t)){e=t,a=!0;break}i=!1,(c<r||!a)&&"global"!==s.mode?(i={mode:"global",buildingID:s.buildingID,floorID:s.floorID,viewpoint:{position:this.camera.position,heading:o,pitch:n},animationDuration:.5,noViewpoint:!0},h&&(i.floorAnimationDuration=0)):a&&("global"===s.mode||"floor"===s.mode&&s.buildingID!==e)&&(r=this.multiBuildingView.DEFAULT,e===s.buildingID?r=s.floorID:"floor"!==s.mode||void 0!==(a=this.multiBuildingView.venueLayout.buildingByID[s.buildingID].floorByID[s.floorID]).connectedFloors[e]&&(r=a.connectedFloors[e].floor),i=this.multiBuildingView.buildingModeEnabled?{mode:"building",buildingID:e,floorID:r,animationDuration:.5}:{mode:"floor",buildingID:e,floorID:r,viewpoint:{position:this.camera.position,heading:o,pitch:n},animationDuration:.5,noViewpoint:!0}),i&&this.multiBuildingView.goTo(i)},t}),mt("com/visioglobe/common/MultiBuildingView",["com/visioglobe/common/PublicInterface","com/visioglobe/web/helpers/MathUtils","bluebird","underscoretiny"],function(e,y,b,t){function d(t){e.create(this,t,r,n,o)}function g(e,t,i,r){this.debug=!1,b.config({cancellation:!0}),this.mapviewer=e,this.viewType=void 0!==r.viewType?r.viewType:"multibuilding",this.animationType=void 0!==r.animationType?r.animationType:"translation",this.buildingModePaddingFactor=this.floorModePaddingFactor=.1,this.globalModePaddingFactor=0,this.buildingModeEnabled=!1;var n=-50,o=-20,a=-50;e.publicCamera.maxPitch=Math.max(n,Math.max(o,a)),e.publicCamera.minPitch=-90,Object.defineProperty(this,"globalModePitch",{get:function(){return n},set:function(t){n=t,e.publicCamera.maxPitch=Math.max(t,Math.max(o,a))}}),Object.defineProperty(this,"buildingModePitch",{get:function(){return o},set:function(t){o=t,e.publicCamera.maxPitch=Math.max(t,Math.max(n,a))}}),Object.defineProperty(this,"floorModePitch",{get:function(){return a},set:function(t){a=t,e.publicCamera.maxPitch=Math.max(t,Math.max(n,o))}}),this.floorAnimationDuration=1,this.buildingModelAnimationDurationUp=this.cameraPositionAnimationDuration=this.headingAnimationDuration=this.pitchAnimationDuration=.7,this.buildingModelAnimationDurationDown=0,this.stackHeightFarAway=500,this.buildingMarkerHeight=50,this.buildingMarkerScale=30,this.publicMultiBuildingView=new d(this),this.mapviewerFloorByID={};for(var s,l,c,h=e.getFloors(),u=0,p=h.length;u<p;u++)(s=h[u]).setEnabled(!1),this.mapviewerFloorByID[s.name]=s;this.venueLayout=this.parseVenueLayout(e,this.mapviewerFloorByID,t),this.setVenueLayoutLocalization(i),this.parameters=r,this.exploreState={mode:"global"},this.originalChangeFloorFunction=e.changeFloor,this.goToPromise=b.resolve(),this.nextExploreState=!1,e.changeFloor=this.setCurrentFloor.bind(this),e.getCurrentFloor=this.getCurrentFloor.bind(this),this.container=document.querySelector(r.containerDivSelector),this.customPreManipulatorStartCenter=!1,this.containerHeight=parseInt(window.getComputedStyle(this.container).height,10),this.containerWidth=parseInt(window.getComputedStyle(this.container).width,10),this.verticalPanChangeFloorThreshold=.1*this.containerHeight,this.activeBuildingMarkerPOIs={},this.inactiveBuildingMarkerPOIs={},this.setupActiveBuildingMarkerPOIs(),"multifloor"===this.viewType&&"undefined"!=typeof MyRoute&&(MyRoute.prototype.use_links=!0,e.on("MultiBuildingView.exploreStateWillChange",m)),this._onBuildingMouseUp=f.bind(this),e.on("mouseup",this._onBuildingMouseUp),(this.isWeb2d="web2d"===e.sdkType)&&(this.buildingModeEnabled=!1,this.pitchAnimationDuration=this.headingAnimationDuration=this.floorAnimationDuration=this.globalModePaddingFactor=this.buildingAndFloorModePaddingFactor=0,t=e.getFloors(),l={setPosition:i=function(){},getPosition:function(){return{x:0,y:0,z:0}},setAutoUpdateLOD:i,getLODs:function(){return[]}},t.forEach(function(e){Object.keys(l).forEach(function(t){"function"!=typeof e[t]&&(e[t]=l[t])})}),c={setManipulator:i,getManipulator:i,setCustomPreManipulatorListener:i,getCustomPreManipulatorListener:function(){return!1}},Object.keys(c).forEach(function(t){"function"!=typeof e.publicCamera[t]&&(e.publicCamera[t]=c[t])}))}var r="floorModePaddingFactor buildingModePaddingFactor globalModePaddingFactor buildingModeEnabled globalModePitch buildingModePitch floorModePitch floorAnimationDuration pitchAnimationDuration headingAnimationDuration cameraPositionAnimationDuration buildingModelAnimationDurationUp buildingModelAnimationDurationDown stackHeightFarAway buildingMarkerHeight buildingMarkerScale".split(" "),n=["DEFAULT"],o="getCurrentFloor setCurrentFloor goTo getCurrentExploreState getLocalizedName getVenueLayout animatePitch animateHeading".split(" ");(g.prototype.constructor=g).VgFloor=function(t,e){this.id=t,this.levelIndex=parseInt(e,10)},g.VgBuilding=function(t,e,i,r,n,o,a,s){for(this.id=t,this.displayIndex=e,this.exploreTo=i,this.exploreFrom=r,this.floors=n,this.groundFloorIndex=o,this.defaultFloorIndex=a,this.floorByID={},t=0,e=this.floors.length;t<e;t++)i=this.floors[t],this.floorByID[i.id]=i;this.modelPOIs=Array.isArray(s)?s:[]},g.VgVenueLayout=function(t,e,i){var r,n;for(this.buildings=t,this.defaultBuildingIndex=e,void 0!==i&&0<i.length?(this.hasGlobalLayer=!0,this.globalLayerID=i):this.hasGlobalLayer=!1,this.buildingByID={},this.buildingByFloorID={},t=0,e=this.buildings.length;t<e;t++)for(i=this.buildings[t],r=0,n=(this.buildingByID[i.id]=i).floors.length;r<n;r++)this.buildingByFloorID[i.floors[r].id]=i},g.prototype.DEFAULT="<DEFAULT VALUE>",g.prototype.resolveExploreState=function(t){var e,i,r,n=this.venueLayout,o=this.mapviewer,a={};if(void 0!==t.place){if(t=t.place,!(e=o.getPlace(t)))return!1;if(e.vg&&e.vg.floor&&e.vg.floor==n.globalLayerID)a={mode:"global",place:t};else{if(e=e.vg.floor,void 0===(a=n.buildingByFloorID[e]))throw Error("ERROR cannot find building for floorID: "+e);if(o=a.id,void 0===a.floorByID[e])throw Error("ERROR cannot find floorID: "+e+" in building "+o);a={mode:"floor",buildingID:o,floorID:e,place:t}}return a}if(t.buildingID===this.DEFAULT&&(!1!==this.venueLayout.defaultBuildingIndex?t.buildingID=n.buildings[this.venueLayout.defaultBuildingIndex].id:(t.buildingID=void 0,t.floorID===this.DEFAULT&&(t.floorID=void 0))),void 0!==t.buildingID){if(o=t.buildingID,void 0===(a=n.buildingByID[o]))throw Error("ERROR cannot find building for floorID: "+e);e=void 0!==t.floorID&&t.floorID!==this.DEFAULT?t.floorID:a.floors[a.defaultFloorIndex].id}else if(void 0!==t.floorID)if(t.floorID===n.globalLayerID)t.mode="global",e=this.exploreState.floorID,o=this.exploreState.buildingID;else{if(e=t.floorID,void 0===(a=n.buildingByFloorID[e]))throw Error("ERROR cannot find building for floorID: "+e);if(o=a.id,void 0===a.floorByID[e])throw Error("ERROR cannot find floorID: "+e+" in building "+o)}else e=this.exploreState.floorID,o=this.exploreState.buildingID;if("global"!=(r=(void 0!==t.mode?t:this.exploreState).mode)||n.hasGlobalLayer||(console.log("WARNING, global mode requested, but does not exist"),r="building"),"building"!=r&&"floor"!=r||(void 0===o&&0<n.buildings.length&&(o=n.buildings[0].id),void 0===e&&(a=n.buildingByID[o])&&0<a.floors.length&&(e=a.floors[0].id)),"floor"==(r="building"==r&&(!this.buildingModeEnabled||!(a=n.buildingByID[o])||a.floors.length<=1)?"floor":r)&&!(a=n.buildingByID[o])){if(!n.hasGlobalLayer)throw Error("ERROR, no focused building, and no global mode");r="global",console.log("WARNING, requesting a floor, but no focused building, fallback to global")}if(void 0!==t.viewpoint&&(i=t.viewpoint,"building"==r&&(console.log("WARNING: asking for a viewpoint in building mode not possible"),i=void 0)),!("building"!==r&&"floor"!==r||void 0!==e&&void 0!==o)){if(!n.hasGlobalLayer)throw Error("ERROR: invalid targetFloor or targetBuilding, and no global mode to fallback to");r="global",console.log("WARNING: targetMode was building or floor, but invalid targetFloor or targetBuilding: "+e+"/"+o)}return a={mode:r,buildingID:o,floorID:e},void 0!==i&&(a.viewpoint=i),a},g.prototype.goTo=function(t){var e,i=this.mapviewer;!1!==this.goToPromise&&this.goToPromise.isPending()&&(e=this.exploreState,this.exploreState.mode=this.nextExploreState.mode,void 0!==this.nextExploreState.buildingID&&(this.exploreState.buildingID=this.nextExploreState.buildingID),void 0!==this.nextExploreState.floorID&&(this.exploreState.floorID=this.nextExploreState.floorID),i.trigger("MultiBuildingView.exploreStateChanged",{current:this.nextExploreState,previous:e,view:this}),this.currentFloorAnimation.stop(),this.currentHeadingAnimation.stop(),this.currentPitchAnimation.stop(),this.goToPromise.cancel()),this.debug&&console.log("CALL goTo(mode: "+t.mode+", buildingID: "+t.buildingID+", floorID: "+t.floorID);try{this.nextExploreState=this.resolveExploreState(t)}catch(t){return b.reject(t)}this.debug&&console.log("CALL goTo resolved(mode: "+this.nextExploreState.mode+", buildingID: "+this.nextExploreState.buildingID+", floorID: "+this.nextExploreState.floorID);var r=this.getMapStateForExploreState(this.nextExploreState);return t.noViewpoint&&(r.cameraConfig=!1),!1===i.trigger("MultiBuildingView.exploreStateWillChange",{target:this.nextExploreState,current:this.getCurrentExploreState(),view:this})?b.reject(Error("trigger handler for MultiBuildingView.exploreStateWillChange returned false")):(e=this.getCurrentExploreState(),void 0!==t.animationDuration&&(r.pitchAnimationDuration=t.animationDuration,r.headingAnimationDuration=t.animationDuration,r.cameraPositionAnimationDuration=t.animationDuration),void 0!==t.pitchAnimationDuration&&(r.pitchAnimationDuration=t.pitchAnimationDuration),void 0!==t.headingAnimationDuration&&(r.headingAnimationDuration=t.headingAnimationDuration),void 0!==t.cameraPositionAnimationDuration&&(r.cameraPositionAnimationDuration=t.cameraPositionAnimationDuration),void 0!==t.floorAnimationDuration&&(r.floorAnimationDuration=t.floorAnimationDuration),this.goToPromise=this.applyMapState(r),this.goToPromise.then(function(){var t;this.exploreState.mode=this.nextExploreState.mode,void 0!==this.nextExploreState.buildingID&&(this.exploreState.buildingID=this.nextExploreState.buildingID,t=this.venueLayout.buildingByID[this.nextExploreState.buildingID],this.mapviewer.currentFloorName=t.floors[t.defaultFloorIndex].id),void 0!==this.nextExploreState.floorID&&(this.exploreState.floorID=this.nextExploreState.floorID,this.mapviewer.currentFloorName=this.nextExploreState.floorID),"global"===this.exploreState.mode&&(this.mapviewer.currentFloorName=this.venueLayout.globalLayerID),i.trigger("MultiBuildingView.exploreStateChanged",{current:this.nextExploreState,previous:e,view:this})}.bind(this)))},g.prototype.getMapStateForExploreState=function(t){var e,n,i,o=this.venueLayout,r=this.mapviewer,a={targetLevelIndex:!1,layerConfig:{},cameraConfig:{},buildingModels:{},manipulator:"map",floorAnimationDuration:this.floorAnimationDuration,pitchAnimationDuration:this.pitchAnimationDuration,headingAnimationDuration:this.headingAnimationDuration,cameraPositionAnimationDuration:this.cameraPositionAnimationDuration,buildingModelAnimationDurationUp:this.buildingModelAnimationDurationUp,buildingModelAnimationDurationDown:this.buildingModelAnimationDurationDown},s=t.mode,l=t.buildingID,c=t.floorID;if(void 0!==l){if(void 0===(e=o.buildingByID[l]))return console.log("ERROR: unknown targetBuildingID: "+l),!1;if(void 0===c)return console.log("ERROR: unknown targetFloorID: "+c),!1;if(void 0===(n=e.floorByID[c]))return console.log("ERROR: unknown targetFloorID "+c),!1;a.targetLevelIndex=n.levelIndex}if("global"===s||void 0!==n&&void 0!==e||this.debug,o.hasGlobalLayer){switch(s){case"global":i={lod:"auto",position:{x:0,y:0,z:0},visible:!0},"global"===this.exploreState.mode||"multifloor"!==this.viewType&&("translation"===this.animationType||this.mapviewerFloorByID[o.globalLayerID].isEnabled())||(i.fadeIn=!0);break;case"building":case"floor":"multifloor"===this.viewType?i={lod:"auto",position:{x:0,y:0,z:-n.groundStackHeight},visible:!1,fadeOut:!0}:(e=0<=n.levelIndex,(e=0<(c=Object.keys(n.connectedFloors)).length?e&&!c.some(function(t){return n.connectedFloors[t].levelIndex<0}):e)?(i={lod:"auto",position:{x:0,y:0,z:"singlefloor"===this.viewType?0:-n.groundStackHeight},visible:!0},this.mapviewerFloorByID[o.globalLayerID].isEnabled()||"opacity"!==this.animationType&&"both"!==this.animationType||(i.fadeIn=!0)):(i={lod:"auto",position:{x:0,y:0,z:"opacity"===this.animationType?-n.groundStackHeight:this.stackHeightFarAway},visible:!1},!this.mapviewerFloorByID[o.globalLayerID].isEnabled()||"opacity"!==this.animationType&&"both"!==this.animationType||(i.fadeOut=!0)))}a.layerConfig[o.globalLayerID]=i}"floor"===s&&("global"===this.exploreState.mode||"floor"===this.exploreState.mode&&this.exploreState.buildingID!==l)&&(a.floorAnimationDuration=0);var h={};switch(Object.keys(o.buildings).forEach(function(t){var r=o.buildings[t];Object.keys(r.floors).forEach(function(t){switch(t=r.floors[t],s){case"global":h=t.levelIndex<=0?{lod:"auto",position:{x:0,y:0,z:t.groundStackHeight},visible:!1,immediateVisible:!1}:{lod:"auto",position:{x:0,y:0,z:this.stackHeightFarAway},visible:!1,immediateVisible:!1};break;case"building":case"floor":if(r.id===l||void 0!==n.connectedFloors[r.id]){var e=(r.id===l?n:n.connectedFloors[r.id]).levelIndex,i=!1;if(this.isWeb2d)i=t.levelIndex===e;else switch(this.viewType){case"singlefloor":i=t.levelIndex===e;break;case"multifloor":i="building"===s&&r.id===l||t.levelIndex===e;break;case"multibuilding":i=t.levelIndex<=e}i?(h={lod:t.levelIndex===e?"auto":0,position:{x:0,y:0,z:t.groundStackHeight-n.groundStackHeight},visible:!0},t.levelIndex!==e||this.mapviewerFloorByID[t.id].isEnabled()||t.id===this.exploreState.floorID||"opacity"!==this.animationType&&"both"!==this.animationType||"multifloor"===this.viewType||(h.fadeIn=!0),"multifloor"===this.viewType&&(h.lod="building"===s?0:"auto")):(h={lod:"auto",position:{x:0,y:0,z:this.stackHeightFarAway},visible:!1},"opacity"===this.animationType?h.position.z=t.groundStackHeight-n.groundStackHeight:"multibuilding"!==this.viewType&&(h.position.z*=t.levelIndex<n.levelIndex?-1:1),"opacity"!==this.animationType&&"both"!==this.animationType||(h.fadeOut=!0))}else 0<t.levelIndex&&"multibuilding"===this.viewType?(h={lod:"auto",position:{x:0,y:0,z:this.stackHeightFarAway},visible:!1},"opacity"===this.animationType&&(h.position.z=t.groundStackHeight-n.groundStackHeight)):h={lod:t.levelIndex==n.levelIndex?"auto":0,position:{x:0,y:0,z:t.groundStackHeight-n.groundStackHeight},visible:!1},"opacity"!==this.animationType&&"both"!==this.animationType||(h.fadeOut=!0)}a.layerConfig[t.id]=h},this)},this),Object.keys(o.buildings).forEach(function(t){t=o.buildings[t],a.buildingModels[t.id]={visible:"global"==s||t.id!=l&&void 0===n.connectedFloors[t.id]}},this),c=e=!1,i=0,s){case"global":a.cameraConfig.pitch=this.globalModePitch,e=r.getFootprintPoints(o.globalLayerID),c=r.getPOF(o.globalLayerID),i=this.globalModePaddingFactor;break;case"building":a.cameraConfig.pitch=this.buildingModePitch,e=r.getFootprintPoints(l)||r.getFootprintPoints(o.globalLayerID),c=r.getPOF(l)||r.getPOF(o.globalLayerID),i=this.buildingModePaddingFactor;break;case"floor":a.cameraConfig.pitch=this.floorModePitch,e=r.getFootprintPoints(l)||r.getFootprintPoints(o.globalLayerID),c=r.getPOF(l)||r.getPOF(o.globalLayerID),i=this.floorModePaddingFactor}return t.noViewpoint?a.cameraConfig=!1:void 0!==t.viewpoint&&void 0!==t.viewpoint.position?(a.cameraConfig.position=t.viewpoint.position,void 0!==t.viewpoint.heading&&(a.cameraConfig.heading=t.viewpoint.heading),void 0!==t.viewpoint.pitch&&(a.cameraConfig.pitch=t.viewpoint.pitch)):(void 0!==t.place&&(t=r.getFootprintPoints(t.place))&&(e=t),c&&(a.cameraConfig.heading=c.headingInDegrees),e&&(t={points:e,top:i*this.containerHeight,bottom:i*this.containerHeight,left:i*this.containerWidth,right:i*this.containerWidth,pitch:a.cameraConfig.pitch,heading:(void 0!==a.cameraConfig.heading?a.cameraConfig:r.publicCamera).heading},a.cameraConfig.position=r.getViewpointFromPositions(t)),"multifloor"===this.viewType&&!1===e&&(void 0===this.cachedInitialPosition&&(this.cachedInitialPosition=r.publicCamera.position),a.cameraConfig.position={x:this.cachedInitialPosition.x,y:this.cachedInitialPosition.y,radius:this.cachedInitialPosition.radius},"floor"===s&&((r=a.cameraConfig.position).radius*=.75,a.cameraConfig.position=r))),a.manipulator="building"==s?"custom":"map",a},g.prototype.applyMapState=function(e){var i,n,r,o,a=this.venueLayout,l=this.mapviewer,s=[],t=(void 0!==e.pitchAnimationDuration?e:this).pitchAnimationDuration,c=(void 0!==e.headingAnimationDuration?e:this).headingAnimationDuration,h=(void 0!==e.floorAnimationDuration?e:this).floorAnimationDuration,u=(void 0!==e.cameraPositionAnimationDuration?e:this).cameraPositionAnimationDuration,p=(void 0!==e.buildingModelAnimationDurationUp?e:this).buildingModelAnimationDurationUp,d=(void 0!==e.buildingModelAnimationDurationDown?e:this).buildingModelAnimationDurationDown;Object.keys(e.layerConfig).forEach(function(t){if(void 0===(n=this.mapviewerFloorByID[t]))return console.log("ERROR applyMapState to a non-existing floorID: "+t),b.reject();if(i=e.layerConfig[t],o=n.isEnabled(),void 0===i.visible&&(i.visible=o),void 0!==i.immediateVisible&&n.setEnabled(i.immediateVisible),o&&i.fadeOut?(n.fadeOut(500),s.push({mapviewerFloor:n,startPosition:n.getPosition(),endPosition:{x:i.position.x,y:i.position.y,z:i.position.z},visible:i.visible})):i.visible||o?(!o&&i.visible&&n.setEnabled(i.visible),i.fadeIn&&("multifloor"===this.viewType&&t===this.venueLayout.globalLayerID||"opacity"===this.animationType?n.fadeIn(500):"both"===this.animationType&&n.fadeIn(1e3*h)),s.push({mapviewerFloor:n,startPosition:n.getPosition(),endPosition:{x:i.position.x,y:i.position.y,z:i.position.z},visible:i.visible})):(n.setPosition(i.position),n.setEnabled(i.visible)),n.isEnabled())if("auto"==i.lod)n.setAutoUpdateLOD(!0),n.setContentEnabled(!0);else for(n.setAutoUpdateLOD(!1),n.setContentEnabled("multifloor"===this.viewType),t=n.getLODs(),r=0;r<t.length;r++)t[r].setEnabled(r==i.lod)},this);var f,m,g,v=[];switch(v.push(new b(function(t,e){function i(){s.forEach(function(t){(n=t.mapviewerFloor).setPosition(t.endPosition),n.setEnabled(t.visible)}),t()}0<h?(this.currentFloorAnimation&&this.currentFloorAnimation.stop&&this.currentFloorAnimation.stop(),this.currentFloorAnimation=l.animateValue(0,1,{duration:1e3*h,step:function(t){var e,i,r=y.easeInOut(t);s.forEach(function(t){n=t.mapviewerFloor,e=t.startPosition,i=t.endPosition,e={x:e.x+(i.x-e.x)*r,y:e.x+(i.y-e.y)*r,z:e.z+(i.z-e.z)*r},n.setPosition(e)})},complete:i})):i()}.bind(this))),this.isWeb2d||this.venueLayout.hasGlobalLayer&&Object.keys(e.buildingModels).forEach(function(t){(m=this.venueLayout.buildingByID[t])&&0<m.modelPOIs.length?(m=m.modelPOIs,f=e.buildingModels[t],m.forEach(function(t){t._modelAnimation&&t._modelAnimation.stop();var e,i,r,n=t.options("position"),o=n.z,a=f.visible?0:200,s=(0==o?p:d)*Math.abs(o-a)/200;t.visible!=f.visible&&(i=n,r=f,(e=t).visible=!0,e._modelAnimation&&e._modelAnimation.stop(),e._modelAnimation=l.animateValue(o,a,{duration:1e3*s,easing:"linear",step:function(t){i.z=t,e.options("position",i)},stop:function(){e.visible=r.visible,e._modelAnimation=null},complete:function(){e.visible=r.visible,e._modelAnimation=null}}))},this)):a.hasGlobalLayer&&console.log("WARNING no model for buildingID: "+t)},this),e.manipulator){case"map":l.publicCamera.setManipulator("map"),l.publicCamera.getCustomPreManipulatorListener()===this.mapviewerCustomPreManipulatorListener&&l.publicCamera.setCustomPreManipulatorListener(!1);break;case"custom":l.publicCamera.setManipulator("none"),!1===l.publicCamera.getCustomPreManipulatorListener()&&l.publicCamera.setCustomPreManipulatorListener(this.mapviewerCustomPreManipulatorListener.bind(this));break;default:console.log("ERROR do not know how to handle manipulator "+e.manipulator)}return e.cameraConfig&&e.cameraConfig.position&&(g=l.publicCamera.getManipulator(),l.publicCamera.setManipulator("none"),v.push(l.publicCamera.goTo(e.cameraConfig.position,{animationDuration:1e3*u}).then(function(){l.publicCamera.setManipulator(g)}))),e.cameraConfig&&void 0!==e.cameraConfig.pitch&&(0<t?v.push(this.animatePitch(e.cameraConfig.pitch,{durationInSeconds:t})):l.publicCamera.pitch=e.cameraConfig.pitch),e.cameraConfig&&void 0!==e.cameraConfig.heading&&(0<c?v.push(this.animateHeading(e.cameraConfig.heading,{durationInSeconds:c})):l.publicCamera.heading=e.cameraConfig.heading),b.all(v)},g.prototype.getCurrentExploreState=function(){return t.extend({},this.exploreState)},g.prototype.parseVenueLayout=function(n,o,a){var t,s,l,c,h,u,p,d,f,m=[],e=!1;if("string"==typeof a.layer&&0<a.layer.length&&(void 0!==o[a.layer]?e=a.layer:console.log("WARNING: venueLayout has layer: "+a.layer+" but non existant in map")),Object.keys(a.buildings).forEach(function(t){l=[];var r=a.buildings[t];if(Object.keys(r.floors).forEach(function(t){var e=r.floors[t];void 0!==o[t]?((c=new g.VgFloor(t,e.levelIndex)).stackHeightMax=e.stackHeightMax||0,c.stackHeightMin=e.stackHeightMin||0,c.stackGap=e.stackGap||0,c.connectedFloors=e.connectedFloors||[],l.push(c),0===c.levelIndex&&(floorLevel0=c)):console.log("WARNING: venueLayout building has floorID : "+t+" but non existant in map")},this),l.sort(function(t,e){return parseInt(t.levelIndex,10)-parseInt(e.levelIndex,10)}),u=h=!1,void 0!==r.defaultFloor){for(f=!1,i=0,s=l.length;i<s;i++)if(l[i].id==r.defaultFloor){u=i,f=!0;break}f||console.log("WARNING, there is a defaultFloor: "+r.defaultFloor+" but no floor found for it")}for(f=!1,i=0,s=l.length;i<s;i++)if(0==l[i].levelIndex){h=i,f=!0;break}f||(console.log("WARNING, no groundFloor found (with levelIndex 0) for building "+t),h=0);var e=0;for(l[h].groundStackHeight=0,i=h+1,s=l.length;i<s;i++)e+=l[i-1].stackHeightMax+l[i-1].stackGap-l[i].stackHeightMin,l[i].groundStackHeight=e;for(e=0,i=h-1;0<=i;i--)e-=l[i].stackHeightMax+l[i].stackGap-l[i+1].stackHeightMin,l[i].groundStackHeight=e;if(p=[],!this.isWeb2d&&void 0!==(d=n.getPOI(t)))for(i=0;i<d.length;i++)d[i].options("model")&&p.push(d[i]);m.push(new g.VgBuilding(t,r.displayIndex,"boolean"!=typeof r.exploreTo||r.exploreTo,"boolean"!=typeof r.exploreFrom||r.exploreFrom,l,h,u,p))},this),m.sort(function(t,e){return t.displayIndex-e.displayIndex}),m.forEach(function(t){t.floors.forEach(function(t){var i;0<t.connectedFloors.length&&(i={},t.connectedFloors.forEach(function(e){var t=m.find(function(t){return void 0!==t.floorByID[e]});void 0!==t&&(i[t.id]={floor:e,levelIndex:t.floorByID[e].levelIndex})}),t.connectedFloors=i)})}),t=!1,void 0!==a.defaultBuilding){for(f=!1,i=0,s=m.length;i<s;i++)if(m[i].id==a.defaultBuilding){t=i,f=!0;break}f||console.log('WARNING: no building found with venueLayout.defaultBuilding "'+a.defaultBuilding+'"')}return new g.VgVenueLayout(m,t,e)},g.prototype.getVenueLayout=function(){return t.extend({},this.venueLayout)},g.prototype.animatePitch=function(i,t){var r=this.mapviewer,n=r.publicCamera.pitch,o=1e3*((t=t||{}).durationInSeconds||(i-n)/4);return this.currentPitchAnimation&&this.currentPitchAnimation.stop&&this.currentPitchAnimation.stop(),new b(function(t,e){this.currentPitchAnimation=r.animateValue(parseFloat(n),parseFloat(i),{duration:o,easing:"linear",step:function(t){r.publicCamera.pitch=t},complete:function(){t()}})}.bind(this))},g.prototype.animateHeading=function(t,e){var i=this.mapviewer,r=i.publicCamera.heading;(r=r%360)<0&&(r+=360);var n=1e3*((e=e||{}).durationInSeconds||(t-r)/4),o=parseFloat(t);return(o=o%360)<0&&(o+=360),180<Math.abs(r-o)&&(o<r?r-=360:o-=360),this.currentHeadingAnimation&&this.currentHeadingAnimation.stop&&this.currentHeadingAnimation.stop(),new b(function(t,e){this.currentHeadingAnimation=i.animateValue(parseFloat(r),o,{duration:n,easing:"linear",step:function(t,e){i.publicCamera.heading=t},complete:function(){t()}})}.bind(this))},g.prototype.setCurrentFloor=function(t,e){var i=t==this.venueLayout.globalLayerID?{mode:"global",noViewpoint:!0}:this.venueLayout.buildingByID[t]?{mode:"building",buildingID:t}:{mode:"floor",buildingID:(i=this.venueLayout.buildingByFloorID[t])&&i.id,floorID:t,noViewpoint:!0};return e&&void 0!==e.animationDuration&&(i.floorAnimationDuration=e.animationDuration/1e3),this.goTo(i)},g.prototype.getCurrentFloor=function(){return"global"===this.exploreState.mode?this.venueLayout.globalLayerID:this.exploreState.floorID},g.prototype.mapviewerCustomPreManipulatorListener=function(t){if("building"==this.exploreState.mode){var e=!1,i=!1;if("wheel"===t.type)if(t.delta=t.delta||0,0<t.delta)e=!0;else{if(!(t.delta<0))return!1;i=!0}else switch(o=this.container.getBoundingClientRect(),o={left:t.center.x-o.left,top:t.center.y-o.top},t.type){case"panstart":this.customPreManipulatorStartCenter=o;break;case"panmove":t=o.top-this.customPreManipulatorStartCenter.top,Math.abs(t)>this.verticalPanChangeFloorThreshold&&(0<t?e=!0:i=!0,this.customPreManipulatorStartCenter=o);break;case"tap":return this.goTo({mode:"floor"}),!1}if((e||i)&&void 0!==this.exploreState.buildingID&&void 0!==this.exploreState.floorID){var r,n=this.exploreState.floorID,o=(r=this.venueLayout.buildingByID[this.exploreState.buildingID].floors).length,a=!1;for(t=0;t<o;t++)if(r[t].id==n){a=!0;break}a?e&&t<o-1?this.goTo({mode:"building",buildingID:this.exploreState.buildingID,floorID:r[t+1].id}):i&&0<t&&this.goTo({mode:"building",buildingID:this.exploreState.buildingID,floorID:r[t-1].id}):console.log("ERROR: this.exploreState.floorID not found!: "+this.exploreState.floorID)}return!1}},g.prototype.setVenueLayoutLocalization=function(t){this.venueLayoutLocalization=t||{}},g.prototype.getLocalizedName=function(t){return this.venueLayoutLocalization[t]&&this.venueLayoutLocalization[t].name||t},g.prototype.setupActiveBuildingMarkerPOIs=function(){var i,r,n=l.imagePath||"../media",o=this.mapviewer,a=this.venueLayout;a.hasGlobalLayer&&(this.venueLayout.buildings.forEach(function(t){t=t.id;var e=o.getPOF(t);e&&(i=o.addPOI({id:t,url:n+"/building_focused.png",image:!0,position:{x:e.x,y:e.y,z:this.buildingMarkerHeight},floor:a.globalLayerID,alignment:{x:0,y:1},scale:this.buildingMarkerScale,visible:!1,overlay:!0}),r=o.addPOI({id:t,url:n+"/building.png",image:!0,position:{x:e.x,y:e.y,z:this.buildingMarkerHeight},floor:a.globalLayerID,alignment:{x:0,y:1},scale:this.buildingMarkerScale,visible:!1,overlay:!0}),i&&r&&(this.activeBuildingMarkerPOIs[t]=i,this.inactiveBuildingMarkerPOIs[t]=r))},this),o.on("MultiBuildingView.exploreStateWillChange",s))};var f=function(t){if(t=t.args.element,Array.isArray(t))console.log("WARNING getting array maybe many POIs, should not happen on VisioWeb 1.7.17+");else if(t&&t.options&&(t=t.options("id"),void 0!==this.venueLayout.buildingByID[t]))return this.goTo({mode:"building",buildingID:t,floorID:this.DEFAULT}).delay(0),!1},s=function(t){var e=t.args.view,i=(t=t.args.target).buildingID,r=void 0!==i;"global"==t.mode?Object.keys(e.activeBuildingMarkerPOIs).forEach(function(t){r&&t==i?(e.activeBuildingMarkerPOIs[t].show(),e.inactiveBuildingMarkerPOIs[t].hide()):(e.activeBuildingMarkerPOIs[t].hide(),e.inactiveBuildingMarkerPOIs[t].show())},this):this.isWeb2d?Object.keys(e.activeBuildingMarkerPOIs).forEach(function(t){t==i?(e.activeBuildingMarkerPOIs[t].hide(),e.inactiveBuildingMarkerPOIs[t].hide()):(e.activeBuildingMarkerPOIs[t].hide(),e.inactiveBuildingMarkerPOIs[t].show())},this):Object.keys(e.activeBuildingMarkerPOIs).forEach(function(t){e.activeBuildingMarkerPOIs[t].hide(),e.inactiveBuildingMarkerPOIs[t].hide()},this)},m=function(t){"undefined"!=typeof currentRoute&&currentRoute&&("floor"===t.args.target.mode?currentRoute.hideLinks():currentRoute.showLinks())};return g.prototype.removeCallbacks=function(){this.mapviewer.off("mouseup",this._onBuildingMouseUp),this.mapviewer.off("MultiBuildingView.exploreStateWillChange",s),"multifloor"===this.viewType&&this.mapviewer.off("MultiBuildingView.exploreStateWillChange",m)},g}),mt("com/visioglobe/web/TrackballManipulator",["com/visioglobe/web/helpers/MathUtils","com/visioglobe/common/utils/Utils","three"],function(o,t,a){return function(r,n){this.radius=1e3,this.orientation=new a.Vector3(-.9800000000000013,0,-1.5707963267948966),this.orientationSerial=1,this.orientationLast=new a.Vector3,this.orientationNormalized=this.orientation.clone(),this.target=new a.Vector3(0,0,0),this.translateSpeed=1,this.rotationSpeed=.005*o.RAD2DEG,this.rotationXMin=-90*o.DEG2RAD,this.rotationXMax=-45*o.DEG2RAD,this.zoomSpeed=.003,this.minRadius=10,this.maxRadius=5e3,this.panManipulatorEnabled=this.zoomManipulatorEnabled=this.rotationManipulatorEnabled=this.pitchManipulatorEnabled=!0,this.cameraAngleVector={x:0,y:1},this.boundary=[{x:-1e9,y:-1e9},{x:1e9,y:-1e9},{x:1e9,y:1e9},{x:-1e9,y:1e9},{x:-1e9,y:-1e9}],this.update=function(){var t=!1;for(this.orientation.x===this.orientationLast.x&&this.orientation.y===this.orientationLast.y&&this.orientation.z===this.orientationLast.z||(this.orientationLast=this.orientation.clone(),this.orientationSerial++,t=!0),this.orientationNormalized.x=this.orientation.x,this.orientationNormalized.z=this.orientation.z;this.orientationNormalized.z>2*Math.PI;)this.orientationNormalized.z-=2*Math.PI;for(;this.orientationNormalized.z<0;)this.orientationNormalized.z+=2*Math.PI;this.previousMaxRadius!=this.maxRadius&&"number"==typeof r.sideInMeters&&(n.far=Math.max(this.maxRadius+r.sideInMeters*Math.sqrt(2)),n.updateProjectionMatrix(),this.previousMaxRadius=this.maxRadius),this.radius=a.Math.clamp(this.radius,this.minRadius,this.maxRadius),this.translateSpeed=this.radius/616;var e=o.projectPointToPolygon(this.target,this.boundary);this.target.x=e.x,this.target.y=e.y;var e=this.orientation.z-.5*Math.PI,i=this.orientation.x;n.position.x=this.target.x+Math.sin(e)*Math.cos(i)*-this.radius,n.position.y=this.target.y-Math.cos(e)*Math.cos(i)*-this.radius,n.position.z=this.target.z+Math.sin(i)*-this.radius,i<=.5*-Math.PI+.001?(n.up.x=Math.sin(e),n.up.y=-Math.cos(e),n.up.z=0):(n.up.x=0,n.up.y=0,n.up.z=1),this.cameraAngleVector.x=-Math.sin(e),this.cameraAngleVector.y=Math.cos(e),n.lookAt(this.target),r.mustUpdateCameraObjects=!0,n instanceof a.OrthographicCamera&&r.orthographicNormalizedZoom&&this.wholeRadius&&(n.zoom=r.orthographicNormalizedZoom*this.wholeRadius/this.radius,n.updateProjectionMatrix()),n.updateMatrix(),n.updateMatrixWorld(),n.matrixWorldInverse.getInverse(n.matrixWorld),n.vg||(n.vg={camera_rotation:new a.Euler,cameraComponents:!1,cameraMatrix3:new a.Matrix3}),(e=new a.Quaternion).setFromRotationMatrix(n.matrixWorldInverse),n.vg.camera_rotation.setFromQuaternion(e,"XYZ"),n.vg.cameraComponents=n.vg.camera_rotation.toArray(),t&&(t=n.matrix.elements,(e=n.vg.cameraMatrix3.elements)[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10]),r.requestRedraw()}}}),mt("heap",[],function(){function r(t,e){if(null==t)return-1;for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1}var l=Math.floor,s=Math.min,c=function(t,e){return t<e?-1:e<t?1:0},h=function(t,e,i,r,n){var o;if(null==n&&(n=c),(i=null==i?0:i)<0)throw Error("lo must be non-negative");for(null==r&&(r=t.length);i<r;)n(e,t[o=l((i+r)/2)])<0?r=o:i=o+1;return[].splice.apply(t,[i,i-i].concat(e)),e},e=function(t,e,i){return null==i&&(i=c),t.push(e),d(t,0,t.length-1,i)},u=function(t,e){var i,r;return null==e&&(e=c),i=t.pop(),t.length?(r=t[0],t[0]=i,f(t,0,e)):r=i,r},i=function(t,e,i){var r;return null==i&&(i=c),r=t[0],t[0]=e,f(t,0,i),r},a=function(t,e,i){var r;return null==i&&(i=c),t.length&&i(t[0],e)<0&&(e=(r=[t[0],e])[0],t[0]=r[1],f(t,0,i)),e},p=function(i,t){var e,r,n,o,a,s;for(null==t&&(t=c),a=[],r=0,n=(o=function(){s=[];for(var t=0,e=l(i.length/2);0<=e?t<e:e<t;0<=e?t++:t--)s.push(t);return s}.apply(this).reverse()).length;r<n;r++)e=o[r],a.push(f(i,e,t));return a},n=function(t,e,i){if(null==i&&(i=c),-1!==(e=r(t,e)))return d(t,0,e,i),f(t,e,i)},t=function(t,e,i){var r,n,o;if(null==i&&(i=c),!(r=t.slice(0,e)).length)return r;for(p(r,i),o=t.slice(e),e=0,n=o.length;e<n;e++)t=o[e],a(r,t,i);return r.sort(i).reverse()},o=function(t,e,i){var r,n,o,a;if(null==i&&(i=c),10*e<=t.length){if(!(n=t.slice(0,e).sort(i)).length)return n;for(r=n[n.length-1],a=t.slice(e),e=0,o=a.length;e<o;e++)i(t=a[e],r)<0&&(h(n,t,0,null,i),n.pop(),r=n[n.length-1]);return n}for(p(t,i),n=[],r=0,e=s(e,t.length);0<=e?r<e:e<r;0<=e?++r:--r)n.push(u(t,i));return n},d=function(t,e,i,r){var n,o,a;for(null==r&&(r=c),n=t[i];e<i&&r(n,o=t[a=i-1>>1])<0;)t[i]=o,i=a;return t[i]=n},f=function(t,e,i){var r,n,o,a,s;for(null==i&&(i=c),n=t.length,o=t[s=e],r=2*e+1;r<n;)(a=r+1)<n&&!(i(t[r],t[a])<0)&&(r=a),t[e]=t[r],r=2*(e=r)+1;return t[e]=o,d(t,s,e,i)};return m.push=e,m.pop=u,m.replace=i,m.pushpop=a,m.heapify=p,m.updateItem=n,m.nlargest=t,m.nsmallest=o,m.prototype.push=function(t){return e(this.nodes,t,this.cmp)},m.prototype.pop=function(){return u(this.nodes,this.cmp)},m.prototype.peek=function(){return this.nodes[0]},m.prototype.contains=function(t){return-1!==r(this.nodes,t)},m.prototype.replace=function(t){return i(this.nodes,t,this.cmp)},m.prototype.pushpop=function(t){return a(this.nodes,t,this.cmp)},m.prototype.heapify=function(){return p(this.nodes,this.cmp)},m.prototype.updateItem=function(t){return n(this.nodes,t,this.cmp)},m.prototype.clear=function(){return this.nodes=[]},m.prototype.empty=function(){return 0===this.nodes.length},m.prototype.size=function(){return this.nodes.length},m.prototype.clone=function(){var t=new m;return t.nodes=this.nodes.slice(0),t},m.prototype.toArray=function(){return this.nodes.slice(0)},m.prototype.insert=m.prototype.push,m.prototype.top=m.prototype.peek,m.prototype.front=m.prototype.peek,m.prototype.has=m.prototype.contains,m.prototype.copy=m.prototype.clone,m;function m(t){this.cmp=null!=t?t:c,this.nodes=[]}}),mt("vector",[],function(){function r(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}return r.prototype={negative:function(){return new r(-this.x,-this.y,-this.z)},add:function(t){return t instanceof r?new r(this.x+t.x,this.y+t.y,this.z+t.z):new r(this.x+t,this.y+t,this.z+t)},subtract:function(t){return t instanceof r?new r(this.x-t.x,this.y-t.y,this.z-t.z):new r(this.x-t,this.y-t,this.z-t)},multiply:function(t){return t instanceof r?new r(this.x*t.x,this.y*t.y,this.z*t.z):new r(this.x*t,this.y*t,this.z*t)},divide:function(t){return t instanceof r?new r(this.x/t.x,this.y/t.y,this.z/t.z):new r(this.x/t,this.y/t,this.z/t)},equals:function(t){return this.x==t.x&&this.y==t.y&&this.z==t.z},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){return new r(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},length:function(){return Math.sqrt(this.dot(this))},lengthSq:function(){return this.dot(this)},unit:function(){return this.divide(this.length())},normalize:function(){return this.divide(this.length())},min:function(){return Math.min(Math.min(this.x,this.y),this.z)},max:function(){return Math.max(Math.max(this.x,this.y),this.z)},toAngles:function(){return{theta:Math.atan2(this.z,this.x),phi:Math.asin(this.y/this.length())}},angleTo:function(t){return Math.acos(this.dot(t)/(this.length()*t.length()))},toArray:function(t){return[this.x,this.y,this.z].slice(0,t||3)},clone:function(){return new r(this.x,this.y,this.z)},init:function(t,e,i){return this.x=t,this.y=e,this.z=i,this}},r.negative=function(t,e){return e.x=-t.x,e.y=-t.y,e.z=-t.z,e},r.add=function(t,e,i){return e instanceof r?(i.x=t.x+e.x,i.y=t.y+e.y,i.z=t.z+e.z):(i.x=t.x+e,i.y=t.y+e,i.z=t.z+e),i},r.subtract=function(t,e,i){return e instanceof r?(i.x=t.x-e.x,i.y=t.y-e.y,i.z=t.z-e.z):(i.x=t.x-e,i.y=t.y-e,i.z=t.z-e),i},r.multiply=function(t,e,i){return e instanceof r?(i.x=t.x*e.x,i.y=t.y*e.y,i.z=t.z*e.z):(i.x=t.x*e,i.y=t.y*e,i.z=t.z*e),i},r.divide=function(t,e,i){return e instanceof r?(i.x=t.x/e.x,i.y=t.y/e.y,i.z=t.z/e.z):(i.x=t.x/e,i.y=t.y/e,i.z=t.z/e),i},r.cross=function(t,e,i){return i.x=t.y*e.z-t.z*e.y,i.y=t.z*e.x-t.x*e.z,i.z=t.x*e.y-t.y*e.x,i},r.unit=function(t,e){var i=t.length();return e.x=t.x/i,e.y=t.y/i,e.z=t.z/i,e},r.fromAngles=function(t,e){return new r(Math.cos(t)*Math.cos(e),Math.sin(e),Math.sin(t)*Math.cos(e))},r.randomDirection=function(){return r.fromAngles(Math.random()*Math.PI*2,Math.asin(2*Math.random()-1))},r.min=function(t,e){return new r(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.min(t.z,e.z))},r.max=function(t,e){return new r(Math.max(t.x,e.x),Math.max(t.y,e.y),Math.max(t.z,e.z))},r.lerp=function(t,e,i){return e.subtract(t).multiply(i).add(t)},r.fromArray=function(t){return new r(t[0],t[1],t[2])},r.angleBetween=function(t,e){return t.angleTo(e)},r}),mt("com/visioglobe/common/routing/AStarRoutingSolver",["heap","underscoretiny","vector"],function(M,_,p){function d(t,e,i,r,n){for(this.solver=t,this.origin=e,this.inputDestinations=i,this.numInputDestinations=i.length,this.runParameters=r,this.finishOnLast=n,this.found=!1,this.bestDistance=Number.POSITIVE_INFINITY,this.numDestinations=i.length+1,this.destinations=[],this.bestSolution=[],this.nodeIDs=[],this.nodes=[],this.distances=[],t=0,r=this.numDestinations;t<r;t++)this.destinations[t]=t;for(t=0,r=this.numInputDestinations;t<r;t++)this.nodeIDs[t]=i[t].id,this.nodes[t]=i[t];for(this.nodeIDs[this.numInputDestinations]=e.id,this.nodes[this.numInputDestinations]=e,this.originNodeIndex=this.numInputDestinations,t=0,r=this.numDestinations*this.numDestinations;t<r;t++)this.distances[t]=!1;this.finishOnLast?(this.lastNodeIndex=this.numInputDestinations-1,this.numSearchDestinations=this.numInputDestinations-1):this.numSearchDestinations=this.numInputDestinations}d.prototype.distance=function(t,e){if(this.nodeIDs[t]==this.nodeIDs[e])return!1;var i=t*this.numDestinations+e,r=this.distances[i];if(!1===r){var n={legs:[],length:0,duration:0,status:200},e=this.solver.run(this.nodes[t],this.nodes[e],this.runParameters);if(!1!==this.solver._appendRunResult(n,e,i))return(r={found:!0}).distance=this.runParameters.fastest?n.length:n.duration,(this.distances[i]=r).distance;r.found=!1,this.distances[i]=r}else if(r.found)return r.distance;return!1},d.prototype.find=function(t,e,i,r){var n,o,a,s;if(0==i)return!1;if(1==i){if(!1!==(n=this.distance(t,this.destinations[e]))){if(this.finishOnLast){if(!1===(t=this.distance(this.destinations[e],this.lastNodeIndex)))return!1;n+=t}if(n+=r,!1===this.found||n<this.bestDistance)return this.found=!0,this.bestDistance=n,this.bestSolution=this.destinations.slice(0),!0}return!1}for(!1!==(n=this.distance(t,this.destinations[e]))&&((n=r+n)<this.bestDistance&&this.find(this.destinations[e],e+1,i-1,n)),o=this.destinations[e],s=1;s<i;s++)a=this.destinations[e+s],this.destinations[e+s]=o,this.destinations[e]=a,!1!==(n=this.distance(t,a))&&((n=r+n)<this.bestDistance&&this.find(a,e+1,i-1,n)),this.destinations[e+s]=a,this.destinations[e]=o;return!0},d.prototype.compute=function(){var t,e,i,r=[];if(this.find(this.originNodeIndex,0,this.numSearchDestinations,0),this.found){for(t=0,e=this.numInputDestinations;t<e;t++)i=this.bestSolution[t],r[t]=this.inputDestinations[i];return this.solver.runInOrder(this.origin,r,this.runParameters,this.bestSolution)}return{legs:[],length:0,duration:0,status:404,message:"No solution found"}};function g(t,e){this.geoinformation=e,void 0!==t.routing&&this.load(t.routing)}return g.prototype._initializeLayerNameToIDMap=function(){var i=this;_.each(this.floors,function(t,e){i.layerNameToIDMap[t.name]=e,i.layerIDToNameMap[e]=t.name})},g.prototype.getLayerID=function(t){return void 0!==(t=this.layerNameToIDMap[t])&&t},g.prototype.getLayerIDsForHeight=function(i){var r=[];return _.each(this.floors,function(t,e){i>=t.zmin&&i<=t.zmax&&r.push(e)}),0<r.length&&r},g.prototype._getSqDistanceOfPointNoZ=function(t,e,i){var r={onEdge:!1,distSq:0};t=new p(t.x,t.y,0),e=new p(e.x,e.y,0);var n=new p(i.x,i.y,0);i=n.subtract(e);var o=t.subtract(e);if((a=i.lengthSq())<1e-6)return r.distSq=o.lengthSq(),r;var a=Math.sqrt(a),s=(i=i.divide(a)).dot(o);return s<0?r.distSq=o.lengthSq():(s<a?(t=o.subtract(i.multiply(s)),r.onEdge=!0,r.projectionFromStart=s/a,r.projectionPosition=e.add(i.multiply(s))):t=t.subtract(n),r.distSq=t.lengthSq()),r},g.prototype._getClosestNodeWithoutZ=function(a,t,e,i){searchType=(i=i||{}).option||"onEdge";var r,n,o,s=!1,l=this,c={},h=!1;if(Array.isArray(i.excludedModalities))for(r=0,n=i.excludedModalities.length;r<n;r++)-1!==(o=this.modalityToID[this.modalities,i.excludedModalities[r]])&&(h=c[o]=!0);else"string"==typeof i.excludedModalities&&(-1!==(o=this.modalityToID[i.excludedModalities])&&(h=c[o]=!0));var u=t*t;return _.each(e,function(o){"onEdge"===searchType?(_.each(l.nodesByFloor[o],function(t){if(!1===t.isVirtual)for(var e=0,i=t.modalityEdges.length;e<i;e++){var r,n=t.modalityEdges[e];h&&c[n.modality]||(n=n.edge,r=l.nodes[n.endNode],!1!==t.isVirtual||o!==l.nodes[n.endNode].floor||(r=l._getSqDistanceOfPointNoZ(a,t,r)).onEdge&&r.distSq<u&&(u=r.distSq,s={type:"edge",node:null,edge:n,floor:o,edgeExtra:r,hasEdgeExcludedModalities:h,edgeExcludedModalities:c}))}(e=(t.x-a.x)*(t.x-a.x)+(t.y-a.y)*(t.y-a.y))<u&&!1===t.isVirtual&&(u=e,s={type:"node",node:t,edge:null,floor:o})}),"edge"===s.type&&(s.edgeExtra.projectionFromStart<1e-5?(s.type="node",s.node=l.nodes[s.edge.startNode],s.edge=null,s.edgeExtra=null):.99999<s.edgeExtra.projectionFromStart&&(s.type="node",s.node=l.nodes[s.edge.endNode],s.edge=null,s.edgeExtra=null))):_.each(l.nodesByFloor[o],function(t){var e=(t.x-a.x)*(t.x-a.x)+(t.y-a.y)*(t.y-a.y);e<u&&!1===t.isVirtual&&(u=e,s={type:"node",node:t,floor:o})})}),s},g.prototype.getAccessNearWithoutZ=function(r,t,e){var n=[],o=t*t;return _.each(this.accessByFloor[e],function(t,e){var i=(t.x-r.x)*(t.x-r.x)+(t.y-r.y)*(t.y-r.y);i<o&&n.push({node:t,distSq:i,accessName:t.accessName,nodeID:t.id})}),n},g.prototype.getAttributes=function(){return this.attributes},g.prototype.getModalities=function(){return this.modalities},g.prototype.getRoutingNode=function(t,e){var i;return void 0!==t._hint?t:"string"==typeof t?void 0!==this.accesses[t]&&{id:t,_hint:{type:"node",node:i=this.accesses[t].node},floor:this.layerIDToNameMap[i.floor]}:!1!==(i=this.getNodeHintForPosition(t,e))&&{position:t,routePosition:this._getPointFromHint(i),floor:this.layerIDToNameMap[i.floor],_hint:i}},g.prototype.processSnapToEdgeRoutingNodes=function(t){var e,i,r={originalNumberOfNodes:this.nodes.length,originalNumberOfEdges:this.edges.length,nodeModalityEdgeRollbackMap:{}},n=null,o=null,a=null,s=null,l=null;if(t.src=this.getRoutingNode(t.src),t.src._hint&&"edge"==t.src._hint.type&&(n=t.src._hint,a=this._constructNodeEdgesFromHint(n,!0,r),t.src={_hint:{type:"node",node:a}}),Array.isArray(t.dst)&&0<t.dst.length){t.dst=t.dst.slice(0);for(var c=0;c<t.dst.length-1;c++)(l=this.getRoutingNode(t.dst[c]))._hint&&"edge"===l._hint.type&&(l=this.nodes[l._hint.edgeExtra.projectionFromStart<.5?l._hint.edge.startNode:l._hint.edge.endNode],t.dst[c]={_hint:{type:"node",node:l}});(c=this.getRoutingNode(t.dst[t.dst.length-1]))._hint&&"edge"==c._hint.type&&(o=c._hint,s=this._constructNodeEdgesFromHint(o,!1,r),t.dst[t.dst.length-1]={_hint:{type:"node",node:s}})}else t.dst=this.getRoutingNode(t.dst),t.dst._hint&&"edge"===t.dst._hint.type&&(o=t.dst._hint,s=this._constructNodeEdgesFromHint(o,!1,r),t.dst={_hint:{type:"node",node:s}});return null!==n&&null!==o&&null!==a&&null!==s&&(t=!1,e=0,(n.edge.startNode===o.edge.startNode&&n.edge.endNode===o.edge.endNode||n.edge.startNode===o.edge.endNode&&n.edge.endNode===o.edge.startNode)&&(void 0===n.oppositeEdge?n.edgeExtra.projectionFromStart<o.edgeExtra.projectionFromStart&&(t=!0,e=o.edgeExtra.projectionFromStart-n.edgeExtra.projectionFromStart):(t=!0,(e=n.edge===o.edge?o.edgeExtra.projectionFromStart-n.edgeExtra.projectionFromStart:1-o.edgeExtra.projectionFromStart-n.edgeExtra.projectionFromStart)<0&&(e=-e))),t&&(i={startNode:a.id,endNode:s.id,length:n.edge.length*e,attributes:n.edge.attributes},this.edges[this.edges.length]=i,_.each(this.nodes[n.edge.startNode].modalityEdges,function(t){t.edge!==n.edge||n.hasEdgeExcludedModalities&&!0===n.edgeExcludedModalities[t.modality]||a.modalityEdges.push({edge:i,modality:t.modality,time:t.time*e})}))),r},g.prototype.rollbackEdgeRoutingNodes=function(t){this.nodes.length=t.originalNumberOfNodes,this.edges.length=t.originalNumberOfEdges;var i=this;_.each(t.nodeModalityEdgeRollbackMap,function(t,e){i.nodes[e].modalityEdges.length=t})},g.prototype._getPointFromHint=function(t){if("edge"===t.type)t={x:t.edgeExtra.projectionPosition.x,y:t.edgeExtra.projectionPosition.y,z:this.nodes[t.edge.startNode].z*this.geoinformation.meters_per_pixel};else{if("node"!==t.type)return!1;t=t.node,altitude=t.z,t={x:t.x,y:t.y,z:t.z*this.geoinformation.meters_per_pixel}}return this.geoinformation.convertSVGToPoint(t)},g.prototype._constructNodeEdgesFromHint=function(e,i,r){var n=this,o=e.edge,t=this.nodes[o.startNode],a=this.nodes[o.endNode],s={attributes:(i?t:a).attributes,floor:t.floor,id:this.nodes.length,modalityEdges:[],w:void 0,x:e.edgeExtra.projectionPosition.x,y:e.edgeExtra.projectionPosition.y,z:t.z,isVirtual:!1,isAccess:!1};this.nodes[this.nodes.length]=s;var l={startNode:i?s.id:o.startNode,endNode:i?o.endNode:s.id,length:o.length*(i?1-e.edgeExtra.projectionFromStart:e.edgeExtra.projectionFromStart),attributes:o.attributes};this.edges[this.edges.length]=l,_.each(t.modalityEdges,function(t){t.edge!==o||e.hasEdgeExcludedModalities&&!0===e.edgeExcludedModalities[t.modality]||(t={edge:l,modality:t.modality,time:t.time*(i?1-e.edgeExtra.projectionFromStart:e.edgeExtra.projectionFromStart)},i?s.modalityEdges.push(t):(void 0===r.nodeModalityEdgeRollbackMap[o.startNode]&&(r.nodeModalityEdgeRollbackMap[o.startNode]=n.nodes[o.startNode].modalityEdges.length),n.nodes[o.startNode].modalityEdges.push(t)))});for(var c=0,h=a.modalityEdges,c=0;c<h.length;c++)if(h[c].edge.endNode===t.id){var u=h[c].edge;e.oppositeEdge=u;var p={startNode:i?s.id:u.startNode,endNode:i?u.endNode:s.id,length:o.length*(i?e.edgeExtra.projectionFromStart:1-e.edgeExtra.projectionFromStart),attributes:u.attributes};this.edges[this.edges.length]=p,_.each(a.modalityEdges,function(t){t.edge!==u||e.hasEdgeExcludedModalities&&!0===e.edgeExcludedModalities[t.modality]||(t={edge:p,modality:t.modality,time:t.time*(i?e.edgeExtra.projectionFromStart:1-e.edgeExtra.projectionFromStart)},i?s.modalityEdges.push(t):(void 0===r.nodeModalityEdgeRollbackMap[u.startNode]&&(r.nodeModalityEdgeRollbackMap[u.startNode]=n.nodes[u.startNode].modalityEdges.length),n.nodes[u.startNode].modalityEdges.push(t)))});break}return s},g.prototype.load=function(t){var r=this;this.maxSpeed=t.maxSpeed||1,this.floors=t.floors,this.layerNameToIDMap={},this.layerIDToNameMap={},this._initializeLayerNameToIDMap(),this.attributes=t.attributes,this.modalities=t.modalities,this.modalityToID={},_.each(this.modalities,function(t,e){r.modalityToID[t]=e}),this.nodesByFloor=[],_.each(this.floors,function(t,e){r.nodesByFloor[e]=[]}),this.accessByFloor=[],_.each(this.floors,function(t,e){r.accessByFloor[e]=[]}),this.virtualAttributeID=_.indexOf(t.attributes,"virtual"),this.accessAttributeID=_.indexOf(t.attributes,"access"),this.intersectionAttributeID=_.indexOf(t.attributes,"intersection"),this.nodes=[],_.each(t.nodes,function(t,e){var i={x:t.x,y:t.y,z:t.z,w:t.w,floor:t.f,id:e,modalityEdges:[],attributes:!1,isAccess:!1,isVirtual:!1};r.nodes[e]=i,r.nodesByFloor[t.f].push(i)}),this.edges=[],_.each(t.edges,function(t){r.edges.push({startNode:t.s,endNode:t.e,length:t.l,attributes:!1})}),_.each(t.routingNodeAttributes,function(t){var e=r.nodes[t.n];(t=t.a)===r.virtualAttributeID?e.isVirtual=!0:t===r.accessAttributeID?(e.isAccess=!0,r.accessByFloor[e.floor].push(e)):t===r.intersectionAttributeID?e.isIntersection=!0:!1===e.attributes?e.attributes=[t]:e.attributes.push(t)}),_.each(t.routingEdgeAttributes,function(t){var e=r.edges[t.e];t=t.a,!1===e.attributes?e.attributes=[t]:e.attributes.push(t)}),_.each(t.routingEdgeModalities,function(t){var e=r.edges[t.e];r.nodes[e.startNode].modalityEdges.push({time:t.t,edge:e,modality:t.m})}),this.accesses={},_.each(t.poiRoutingNodes,function(t){void 0===r.accesses[t.a]&&(r.accesses[t.a]={entries:[]}),r.accesses[t.a].entries.push({node:r.nodes[t.n]}),r.nodes[t.n].accessName=t.a}),_.each(this.accesses,function(t){var e,i=!1;_.each(t.entries,function(t){t.node.isVirtual&&(i=t.node)}),!1!==i&&(e=[],_.each(t.entries,function(t){_.each(t.node.modalityEdges,function(t){t.edge.startNode!==i.id&&t.edge.endNode!==i.id||(t.originalTime=t.time,t.edge.originalLength=t.edge.length,e.push(t))})}),t.node=i,t.modalityEdges=e)})},g.prototype.hasIntersections=function(){return-1!==this.intersectionAttributeID},g.prototype._heuristic=function(t,e,i){var r=parseFloat(t.x),n=parseFloat(t.y);t=parseFloat(t.z);var o=parseFloat(e.x),a=parseFloat(e.y),s=parseFloat(e.z),r=Math.sqrt((o-r)*(o-r)+(a-n)*(a-n)+(s-t)*(s-t));return void 0!==e.w&&(r-=e.w),void 0!==i.w&&(r-=i.w),Math.max(r,0)},g.prototype.run=function(t,e,i){var r,n,o=(i=i||{}).fastest,a=i.weight,s=i.hasExcludedAttributes,l=i.hasExcludedModalities,c=i.excludedAttributes,h=i.excludedModalities,u=i.hasRemapResultinModality;i=i.remapResultingModalityByID;var p=new M(function(t,e){return t.f-e.f}),d=e.isVirtual;for(_.each(this.nodes,function(t){t.parentModalityEdge=null,t.f=0,t.g=0,t.h=0,t.closed=!1,t.opened=!1}),p.push(t),t.opened=!0;!p.empty();){var f=p.pop();if(f.closed=!0,f===e){for(e=[];null!==f.parentModalityEdge;)!1===f.isVirtual&&!1===this.nodes[f.parentModalityEdge.edge.startNode].isVirtual&&(t=f.parentModalityEdge.modality,u&&(void 0===(t=i[t])&&(t=f.parentModalityEdge.modality)),e.push({startNode:f.parentModalityEdge.edge.startNode,endNode:f.id,modality:this.modalities[t],time:f.parentModalityEdge.time,lengthSvg:f.parentModalityEdge.edge.length,attributes:f.parentModalityEdge.edge.attributes})),f=this.nodes[f.parentModalityEdge.edge.startNode];return e.reverse()}for(var m=f.modalityEdges,g=0,v=m.length;g<v;++g){var y=m[g],b=this.nodes[y.edge.endNode];if(!(b.closed||!(!0!==b.isVirtual||d&&b.id===e.id)||l&&h[y.modality])){var x=y.edge.attributes,w=!1;if(s&&!1!==x)for(n=0,r=x.length;n<r;n++)if(c[x[n]]){w=!0;break}!w&&(r=o?y.time:y.edge.length,r=f.g+r,!b.opened||r<b.g)&&(b.g=r,b.h=b.h||a*this._heuristic(b,e,t),b.f=b.g+b.h,b.parentModalityEdge=y,b.opened?p.updateItem(b):(p.push(b),b.opened=!0))}}}return[]},g.prototype.queryNearPlaces=function(t,e){var i,o,a,s,l,c,h=[],r="number"==typeof(e=e||{heading:0,threshold:10}).threshold?e.threshold:10,u=e.heading||0,n=t.lon,e=t.alt||t.z||0;return void 0!==t.lat&&void 0!==n?i=this.geoinformation.convertLatLonToPoint(t):void 0!==t.x&&void 0!==t.y&&(i={x:t.x,y:t.y}),void 0!==i&&(n=!1,void 0!==t.floor?!1!==(e=this.getLayerID(t.floor))&&(n=[e]):n=this.getLayerIDsForHeight(e),!1!==n&&(o=this.geoinformation.convertPointToSVG(i),a=this.geoinformation.meters_per_pixel,s=this.geoinformation.rotation_angle_in_degrees,l=r/a,c=this,_.each(n,function(t){for(var e=0,i=(t=c.getAccessNearWithoutZ(o,l,t)).length;e<i;e++){var r=t[e],n=new p(r.node.x-o.x,r.node.y-o.y).normalize();for(n.y=-n.y,n=0<n.x?Math.acos(n.y):-Math.acos(n.y),n*=180/Math.PI,n-=u,n-=s;180<n;)n-=360;for(;n<-180;)n+=360;h.push({id:r.accessName,distance:Math.sqrt(r.distSq)*a,angle:n})}})),h.sort(function(t,e){return t.distance-e.distance})),h},g.prototype.getNodeHintForPosition=function(t,e){var i,r=e||{option:"onEdge",distanceThreshold:200},n="number"==typeof r.distanceThreshold?r.distanceThreshold:200,o=t.lon,a=t.alt||t.z||0;void 0!==t.lat&&void 0!==o?i=this.geoinformation.convertLatLonToPoint(t):void 0!==t.x&&void 0!==t.y&&(i={x:t.x,y:t.y});var s=!1;return void 0!==i&&(e=o=!1,void 0!==t.floor?!1!==(e=this.getLayerID(t.floor))&&(o=[e]):o=this.getLayerIDsForHeight(a),!1!==o&&(a=this.geoinformation.convertPointToSVG(i),s=this._getClosestNodeWithoutZ(a,n/this.geoinformation.meters_per_pixel,o,r))),s},g.prototype._getLayerName=function(t){var e=!1;return e=void 0!==this.floors&&t.floor<this.floors.length?this.floors[t.floor].name:e},g.prototype.addPointToLeg=function(t,e,i,r,n){var o=this.geoinformation.convertSVGToPoint(e),o=this.geoinformation.convertPointToLatLon(o);t.points.push({lat:o.lat,lon:o.lon,_svg:{x:e.x,y:e.y,z:e.z},_routing:{id:e.id,isIntersection:e.isIntersection||!1,pointAttributes:e.attributes,edgeAttributes:n},_cumullength:i,_cumultime:r})},g.prototype._appendRunResult=function(c,t,h){if(t&&0<t.length){var u=!1,p=c.duration,d=c.length,f=t.length,m=this;return _.each(t,function(t,e,i){var r=t.time,n=t.lengthSvg*m.geoinformation.meters_per_pixel,o=m.nodes[t.startNode],a=m.nodes[t.endNode];!1===u&&(u=g.createLeg(m._getLayerName(o),t.modality,o.z*m.geoinformation.meters_per_pixel,h),c.legs.push(u),m.addPointToLeg(u,o,d,p,t.attributes));var s=u.modality!==t.modality,l=e+1<f&&i[e+1].attributes;o.floor!==a.floor?(t=(e+1<f?i[e+1]:t).modality,u=g.createLeg(m._getLayerName(a),t,a.z*m.geoinformation.meters_per_pixel,h),p+=r,d+=n,m.addPointToLeg(u,a,d,p,l),c.legs.push(u)):s?(u=g.createLeg(m._getLayerName(a),t.modality,a.z*m.geoinformation.meters_per_pixel,h),m.addPointToLeg(u,o,d,p,t.attributes),p+=r,d+=n,m.addPointToLeg(u,a,d,p,l),c.legs.push(u)):(p+=r,d+=n,m.addPointToLeg(u,a,d,p,l))}),c.length=d,c.duration=p,c.legs=_.filter(c.legs,function(t){return 0<t.points.length}),void 0===c.destinationIndices?c.destinationIndices=[h]:c.destinationIndices.push(h),!0}return!1},g.createLeg=function(t,e,i,r){return{dataset:t,modality:e,destinationIndex:r,points:[],height:i}},g.prototype.runInOrder=function(t,e,i,r){for(var n,o,a={legs:[],length:0,duration:0,status:200},s=0,l=e.length;s<l;s++){if(n=e[s],t=this.run(t,n,i),o=r?r[s]:s,!1===this._appendRunResult(a,t,o)){a.status=404,a.error="Route not found.src not routable.dst not routable.";break}t=n}return a},g.prototype.runClosest=function(t,e,i){for(var r,n,o=1e99,a=!1,s=0,l=e.length;s<l;s++)r=e[s],n=this.run(t,r,i),!(r={legs:[],length:0,duration:0,status:200})!==this._appendRunResult(r,n,s)&&((n=i.fastest?r.duration:r.length)<o&&(o=n,a=r));return!1!==a?a:{legs:[],length:0,duration:0,error:"Route not found",status:404}},g.prototype.computeRoute=function(t){var e=t.routingParameters||{},i={src:t.src,dst:t.dst,routingParameters:e};void 0!==e.requestType&"shortest"===e.requestType?(i.fastest=!1,i.weight=1):(i.fastest=!0,this.geoinformation=this.geoinformation||{},this.geoinformation.meters_per_pixel=this.geoinformation.meters_per_pixel||1,i.weight=this.geoinformation.meters_per_pixel/this.maxSpeed);var r,n,o,a,s={},l=!1;if(void 0!==e.excludedAttributes)if(u=e.excludedAttributes,Array.isArray(u))for(h=0,r=u.length;h<r;h++)n=u[h],-1!==(n=_.indexOf(this.attributes,n))&&(l=s[n]=!0);else"string"==typeof u&&(-1!==(n=_.indexOf(this.attributes,u))&&(l=s[n]=!0));if(0==s.length&&(s=!1),i.hasExcludedAttributes=l,i.excludedAttributes=s,u=!(l={}),void 0!==e.excludedModalities)if(s=e.excludedModalities,Array.isArray(s))for(h=0,r=s.length;h<r;h++)n=s[h],-1!==(n=this.modalityToID[n])&&(u=l[n]=!0);else"string"==typeof s&&(-1!==(n=this.modalityToID[s])&&(u=l[n]=!0));i.hasExcludedModalities=u,i.excludedModalities=l,void 0!==e.remapResultingModality?(i.remapResultingModalityByID={},Object.keys(e.remapResultingModality).forEach(function(t){o=this.modalityToID[t],a=this.modalityToID[e.remapResultingModality[t]],void 0!==o&&void 0!==a&&(i.remapResultingModalityByID[o]=a)},this),i.hasRemapResultinModality=!0):(i.hasRemapResultinModality=!1,i.remapResultingModalityByID={});var c,s=this.processSnapToEdgeRoutingNodes(i),h=!1,u={legs:[],length:0,duration:0,status:200};if(!1!==(l=this.getRoutingNode(i.src)))if("node"===(l=l._hint).type)if(startNode=l.node,Array.isArray(i.dst)){for(n=[],h=0,r=i.dst.length;h<r;h++){if(!1===(c=this.getRoutingNode(i.dst[h]))){u.status=404,u.error="routable.dst "+h+" not routable.";break}if("node"!==(c=c._hint).type){u.status=500,u.error="dst "+h+" is on edge, even after filtering..";break}c=c.node,n.push(c)}if(200==u.status)switch(void 0===t.destinationOrder&&(t.destinationOrder="optimalFinishOnLast"),1==i.dst.length&&(t.destinationOrder="inOrder"),t.destinationOrder){case"inOrder":u=this.runInOrder(startNode,n,i);break;case"closest":u=this.runClosest(startNode,n,i);break;case"optimal":u=(h=new d(this,startNode,n,i,!1)).compute();break;case"optimalFinishOnLast":u=(h=new d(this,startNode,n,i,!0)).compute();break;default:u.status=500,u.error="Bad destination order: "+t.destinationOrder}}else!1===(c=this.getRoutingNode(i.dst))?(u.status=404,u.error="routable.dst not routable."):"node"===(c=c._hint).type?(c=c.node,startNode.id===c.id?(h=0<startNode.modalityEdges.length?startNode.modalityEdges[0]:{modality:0,edge:{attributes:!1}},r=g.createLeg(this._getLayerName(startNode),h.modality,startNode.z*this.geoinformation.meters_per_pixel,-1),this.addPointToLeg(r,startNode,0,0,h.edge.attributes),u.legs.push(r)):(h=this.run(startNode,c,i),!1===this._appendRunResult(u,h,0)&&(u.status=404,u.error="Route not found.src not routable.dst not routable."))):(u.status=500,u.error="dst is on edge, even after filtering..");else u.status=500,u.error="src is on edge, even after filtering..";else u.status=404,u.error="Route not found.src not routable.dst not routable.";return this.rollbackEdgeRoutingNodes(s),u.request=t,u},g.prototype._displayNetwork=function(o){var a=this;_.each(a.floors,function(t,e){var n=t.name;_.each(a.nodesByFloor[e],function(t){var e,i=2,r="#ff0000";t.isVirtual||(t.isAccess?(i=1.5,r="#0000ff"):t.isIntersection&&(i=2.5,r="#808080"),e=a.geoinformation.convertSVGToPoint(t),o.addPOI({position:{x:e.x,y:e.y,z:0},text:t.id,floor:n,scale:i,color:r,opacity:.5,overlay:!0}))})})},g}),mt("com/visioglobe/common/navigation/NavigationSolver",["vector","underscoretiny"],function(e,s){function _(t,e,i){this.routingSolver=t,this.metersPerPixel=e,this.hasIntersections=i||!1}return _._getVector=function(t){return new e(t.x,t.y,0)},_._subVectors=function(t,e){return t.subtract(e)},_._crossVectors=function(t,e){return t.cross(e)},_._computeAngle=function(t,e){var i=t.dot(e),t=_._crossVectors(e,t);return.999999<i?0:i<-.999999?180:(i=180*Math.acos(i)/Math.PI,-(i=t.z<0?-i:i))},_.prototype._defaultNavigationParameters={straightAngleThreshold:30,distanceFromCouloirThreshold:2,nearPlacesThreshold:10,minimumInstructionLength:0},_.prototype._getParam=function(t,e){return void 0===t&&console.log("BAD: undefined modality for getParam"),void 0===e&&console.log("BAD: undefined parameterName for getParam"),void 0!==this.mModalityParameters&&void 0!==this.mModalityParameters[t]&&void 0!==this.mModalityParameters[t][e]?this.mModalityParameters[t][e]:void 0!==this._defaultNavigationParameters[e]?this._defaultNavigationParameters[e]:1/0},_.prototype._angle2maneuver=function(t,e){var i=this._getParam(e,"straightAngleThreshold"),e=0<t,t=Math.abs(t);return t<i?"eVgManeuverTypeGoStraight":t<45?!0==e?"eVgManeuverTypeTurnGentleRight":"eVgManeuverTypeTurnGentleLeft":t<135?!0==e?"eVgManeuverTypeTurnRight":"eVgManeuverTypeTurnLeft":!0==e?"eVgManeuverTypeTurnSharpRight":"eVgManeuverTypeTurnSharpLeft"},_.prototype.computeNavigation=function(t,e){(e=e||{}).algorithm=e.algorithm||"auto";var i=e.algorithm;return"intersectionAlgorithm"===(i="auto"===i&&this.hasIntersections?"intersectionAlgorithm":i)?this.computeNavigationIntersection(t,e):this.computeNavigationOriginal(t,e)},_.prototype.computeNavigationOriginal=function(t,e){(e=e||{}).mergeFloorChangeInstructions=void 0===e.mergeFloorChangeInstructions||e.mergeFloorChangeInstructions,e.modalityParameters=e.modalityParameters||{};var i=e.mergeFloorChangeInstructions;if(this.mModalityParameters=e.modalityParameters||{},0===t.legs.length)return{instructions:[{length:0,duration:0,maneuverType:"eVgManeuverTypeEnd",icon:"transit_instruction_end.png",destinationIndex:0}],parameters:e,route:t,_algorithm:"originalAlgorithm, prefer to use explicit intersections algorithm"};for(var r=[],n=(n=t.legs[t.legs.length-1]).points[n.points.length-1]._cumultime,o=0,a=t.legs,s=0,l=a.length;s<l;s++){for(var c=a[s],h=c.points.slice(0),u=!1;h.length<2;)u=!0,h.push(h[0]);var p={positions:[],attributes:[]};p.position=h[0],p.height=p.position._svg.z*this.metersPerPixel,p.modality=c.modality,p.dataset=c.dataset,p.destinationIndex=c.destinationIndex,o=h[0]._cumullength,p.time=h[0]._cumultime;var d=_._getVector(h[0]._svg),f=_._getVector(h[1]._svg);p.positions.push(h[0]),h[0]._routing.edgeAttributes&&p.attributes.push(h[0]._routing.edgeAttributes),u||(p.positions.push(h[1]),h[1]._routing.edgeAttributes&&p.attributes.push(h[1]._routing.edgeAttributes));for(var m,g=_._subVectors(d,f).length()*this.metersPerPixel,v=0,u=2,y=h.length;u<y;u++){var b=_._subVectors(d,f).normalize(),x=_._getVector(h[u]._svg),w=(d=_._subVectors(d,x)).clone().normalize(),v=_._computeAngle(b,w);Math.abs(v),v=_._crossVectors(b,w).length()*d.length()*this.metersPerPixel,v=Math.abs(v),d=this._getParam(c.modality,"distanceFromCouloirThreshold"),this._getParam(c.modality,"straightAngleThreshold"),(v=d<v||!1)&&(d=_._subVectors(f,x).normalize(),d=_._computeAngle(b,d),(Math.abs(d)<this._getParam(c.modality,"straightAngleThreshold")||g<this._getParam(c.modality,"minimumInstructionLength"))&&(v=!1,f.clone())),v?(g=_._computeAngle(b,_._subVectors(f,x).normalize()),p.length=h[u-1]._cumullength-o,p.duration=h[u-1]._cumultime-p.time,p.maneuverType=this._angle2maneuver(g,c.modality),this._computeNearPlaces(p,b,g),r.push(p),o=h[u-1]._cumullength,(p={positions:[],attributes:[]}).time=h[u-1]._cumultime,g=_._subVectors(x,f).length()*this.metersPerPixel,lCurrentDuration=0,f.clone(),p.position=h[u-1],p.height=p.position._svg.z*this.metersPerPixel,p.dataset=c.dataset,p.destinationIndex=c.destinationIndex,p.modality=c.modality,p.positions.push(p.position),h[u-1]._routing.edgeAttributes&&p.attributes.push(h[u-1]._routing.edgeAttributes)):g+=_._subVectors(x,f).length()*this.metersPerPixel,d=f.clone(),f=x.clone(),_._subVectors(d,f).normalize(),p.positions.push(h[u]),h[u]._routing.edgeAttributes&&p.attributes.push(h[u]._routing.edgeAttributes)}p.maneuverType="eVgManeuverTypeGoStraight",0<g&&(f=_._getVector({x:0,y:0}),1<(y=p.positions.length)&&(f=_._subVectors(_._getVector(p.positions[y-1]._svg),_._getVector(p.positions[y-2]._svg)).normalize()),this._computeNearPlaces(p,f,0),p.length=h[u-1]._cumullength-o,p.duration=h[u-1]._cumultime-p.time,r.push(p),o=h[u-1]._cumullength,(p={positions:[],attributes:[]}).time=h[u-1]._cumultime),!1===i&&(s===l-1?(p.maneuverType="eVgManeuverTypeEnd",p.destinationIndex=c.destinationIndex,p.length=0,p.duration=0):(f=(m=a[s+1]).dataset,y=m.destinationIndex,b=c.dataset,x=c.destinationIndex,v=m.modality,d=c.modality,w=h[0]._svg.z,(m=m.points[0]._svg.z)<w?(p.maneuverType="eVgManeuverTypeGoDown",p.length=0):w<m?(p.maneuverType="eVgManeuverTypeGoUp",p.length=0):w===m&&b!==f?(p.maneuverType="eVgManeuverTypeChangeLayer",p.length=0):d!==v?(p.maneuverType="eVgManeuverTypeChangeModality",p.length=0):x!==y?(p.maneuverType="eVgManeuverTypeWaypoint",p.length=0):console.log("This should not happen yet")),0===g&&void 0===p.position&&console.log("BAD1"),0<g&&(p.position=h[h.length-1],p.height=p.position._svg.z*this.metersPerPixel,p.positions.push(p.position),p.position._routing.edgeAttributes&&p.attributes.push(p.position._routing.edgeAttributes)),p.dataset=c.dataset,p.destinationIndex=c.destinationIndex,p.modality=c.modality,p.duration=h[u-1]._cumultime-p.time,p.length=h[u-1]._cumullength-o,this._computeNearPlaces(p),r.push(p),(p={positions:[]}).time=h[u-1]._cumultime)}for(i=0,o=r.length;i<o;i++)(p=r[i]).totalTime=n,this._uniqueAndConvertAttributes(p),void 0===p.duration&&console.log("HBXX fixme mDuration: "+i),void 0===p.time&&console.log("HBXX fixme time: "+i),void 0===p.length&&console.log("HBXX fixme length: "+i),p.icon=this._getIconName(p);return{instructions:r=0===r.length?[{length:0,duration:0,maneuverType:"eVgManeuverTypeEnd",icon:"transit_instruction_end.png",destinationIndex:0}]:r,parameters:e,route:t,_algorithm:"originalAlgorithm, prefer to use explicit intersections algorithm"}},_.prototype._getIconName=function(t){var e="";switch(t.maneuverType){case"eVgManeuverTypeUnknown":e="";break;case"eVgManeuverTypeGoStraight":e="transit_instruction_straight.png";break;case"eVgManeuverTypeTurnGentleRight":e="transit_instruction_turn_gentle_right.png";break;case"eVgManeuverTypeTurnGentleLeft":e="transit_instruction_turn_gentle_left.png";break;case"eVgManeuverTypeTurnRight":e="transit_instruction_turn_right.png";break;case"eVgManeuverTypeTurnLeft":e="transit_instruction_turn_left.png";break;case"eVgManeuverTypeTurnSharpRight":e="transit_instruction_turn_sharp_right.png";break;case"eVgManeuverTypeTurnSharpLeft":e="transit_instruction_turn_sharp_left.png";break;case"eVgManeuverTypeUTurnLeft":e="transit_instruction_uturn_left.png";break;case"eVgManeuverTypeUTurnRight":e="transit_instruction_uturn_right.png";break;case"eVgManeuverTypeStart":e="transit_instruction_start.png";break;case"eVgManeuverTypeEnd":e="transit_instruction_end.png";break;case"eVgManeuverTypeGoUp":e="transit_instruction_up.png";break;case"eVgManeuverTypeGoDown":e="transit_instruction_down.png";break;case"eVgManeuverTypeChangeModality":e="transit_instruction_modality_change.png";break;case"eVgManeuverTypeChangeLayer":e="transit_instruction_layer_change.png";break;case"eVgManeuverTypeWaypoint":e="transit_instruction_intermediate_destination.png";break;default:console.log("bad icon?")}return e},_.prototype._computeNearPlaces=function(r,n,t){var o,e,i,a=this;r.nearPlaces=[],void 0!==this.routingSolver&&(void 0===n&&(n=_._getVector({x:0,y:0})),r.actionAngle=t=void 0===t?0:t,o=_._getVector(r.positions[r.positions.length-1]._svg),i=this._getParam(r.modality,"nearPlacesThreshold")/a.metersPerPixel,e=a.routingSolver.getLayerID(r.dataset),i=this.routingSolver.getAccessNearWithoutZ(o,i,e),s.each(i,function(t){var e,i=0;0===n.x&&0===n.y||(e=_._getVector(t.node),0===(e=_._subVectors(o,e)).x&&0===e.y||(e=e.normalize(),i=_._computeAngle(n,e))),r.nearPlaces.push({id:t.accessName,distance:Math.sqrt(t.distSq)*a.metersPerPixel,angle:i})}),i=function(o){return function(t,e){var i=0<o,r=t.angle-(n=0<o?90+.5*o:.5*o-90),n=e.angle-n;return Math.abs(r-n)<.01?t.distance-e.distance:i?0<=r&&n<0?-1:r<0&&0<=n?1:0<=r?r-n:n-r:0<=r&&n<0?1:r<0&&0<=n?-1:0<=r?r-n:n-r}},e=function(t,e){return t.distance-e.distance},r.nearPlaces=0===t?r.nearPlaces.sort(e):r.nearPlaces.sort(i(t)))},_.prototype.computeNavigationIntersection=function(t,e){(e=e||{}).mergeFloorChangeInstructions=void 0===e.mergeFloorChangeInstructions||e.mergeFloorChangeInstructions,e.modalityParameters=e.modalityParameters||{},e.firstNodeAsIntersection=void 0!==e.firstNodeAsIntersection&&e.firstNodeAsIntersection;var i=e.mergeFloorChangeInstructions;this.mModalityParameters=e.modalityParameters||{};var r=e.firstNodeAsIntersection;if(0===t.legs.length)return{instructions:[{length:0,duration:0,maneuverType:"eVgManeuverTypeEnd",icon:"transit_instruction_end.png",destinationIndex:0}],parameters:e,route:t,_algorithm:"intersectionAlgorithm"};for(var n,o=[],a=0,s=t.legs,l=0,c=!1,h=0,u=s.length;h<u;h++){for(var p=s[h],d=p.points.slice(0),f=!1;d.length<2;)f=!0,d.push(d[0]);n={position:d[0],positions:[],attributes:[],height:d[0]._svg.z*this.metersPerPixel,time:d[0]._cumultime,modality:p.modality,dataset:p.dataset,destinationIndex:p.destinationIndex},a=d[0]._cumullength,0<o.length&&((v=o[o.length-1]).duration=n.time-v.time,v.length=n.position._cumullength-v.position._cumullength);var m=_._getVector(d[0]._svg),l=_._getVector(d[1]._svg);n.positions.push(d[0]),d[0]._routing.edgeAttributes&&n.attributes.push(d[0]._routing.edgeAttributes),f||(n.positions.push(d[1]),d[1]._routing.edgeAttributes&&n.attributes.push(d[1]._routing.edgeAttributes));for(var g=this._getParam(p.modality,"straightAngleThreshold"),v=_._subVectors(m,l).normalize(),y=_._getVector({x:0,y:0}),b=0,x=0,w=d[1]._routing.isIntersection||0==h&&r||0<h&&s[h].destinationIndex!=s[h-1].destinationIndex&&r,f=2,M=d.length;f<M;f++)m=_._getVector(d[f]._svg),y=_._subVectors(l,m).normalize(),b=_._computeAngle(v,y),x=Math.abs(b),(x=w&&g<x)&&(n.length=d[f-1]._cumullength-a,n.duration=d[f-1]._cumultime-n.time,n.maneuverType=this._angle2maneuver(b,p.modality),a=d[f-1]._cumullength,this._computeNearPlaces(n,v,b),o.push(n),v=n,(n={position:d[f-1],positions:[],attributes:[],height:v.height,time:d[f-1]._cumultime,modality:v.modality,dataset:v.dataset,destinationIndex:v.destinationIndex}).positions.push(n.position),d[f-1]._routing.edgeAttributes&&n.attributes.push(d[f-1]._routing.edgeAttributes)),l.clone(),l=m.clone(),v=y,w=d[f]._routing.isIntersection,n.positions.push(d[f]),d[f]._routing.edgeAttributes&&n.attributes.push(d[f]._routing.edgeAttributes);n.maneuverType="eVgManeuverTypeGoStraight",0<(l=d[f-1]._cumullength-a)?(this._computeNearPlaces(n,v,0),n.length=d[f-1]._cumullength-a,n.duration=d[f-1]._cumultime-n.time,a=d[f-1]._cumullength,o.push(n),n={positions:[],attributes:[],time:d[f-1]._cumultime}):c=!0,i&&!c||(c=!1,h===u-1?(n.maneuverType="eVgManeuverTypeEnd",n.length=0,n.duration=0):(g=p.dataset,m=p.modality,v=p.destinationIndex,y=(w=s[h+1]).dataset,M=w.modality,b=w.destinationIndex,x=d[0]._svg.z,(w=w.points[0]._svg.z)<x?n.maneuverType="eVgManeuverTypeGoDown":x<w?n.maneuverType="eVgManeuverTypeGoUp":x===w&&g!==y?n.maneuverType="eVgManeuverTypeChangeLayer":m!==M?n.maneuverType="eVgManeuverTypeChangeModality":v!==b?n.maneuverType="eVgManeuverTypeWaypoint":console.log("This should not happen yet")),0===l&&void 0===n.position&&console.log("BAD1"),0<l&&(n.position=d[d.length-1],n.height=n.position._svg.z*this.metersPerPixel,n.positions.push(n.position),n.position._routing.edgeAttributes&&n.attributes.push(n.position._routing.edgeAttributes)),n.dataset=p.dataset,n.destinationIndex=p.destinationIndex,n.modality=p.modality,n.duration=d[f-1]._cumultime-n.time,n.length=d[f-1]._cumullength-a,this._computeNearPlaces(n),o.push(n))}for(i=(n=t.legs[t.legs.length-1]).points[n.points.length-1]._cumultime,r=0,a=o.length;r<a;r++)n=o[r],o[r].totalTime=i,this._uniqueAndConvertAttributes(n),void 0===o[r].duration&&console.log("fixme duration: "+r),void 0===o[r].time&&console.log("fixme time: "+r),void 0===o[r].length&&console.log("fixme length: "+r),o[r].icon=this._getIconName(o[r]);return{instructions:o=0===o.length?[{length:0,duration:0,maneuverType:"eVgManeuverTypeEnd",icon:"transit_instruction_end.png",destinationIndex:0}]:o,parameters:e,route:t,_algorithm:"intersectionAlgorithm"}},_.prototype._uniqueAndConvertAttributes=function(t){for(var e={},i=[],r=!1,n=0,o=t.attributes.length;n<o;n++)for(var a=t.attributes[n],s=0,l=a.length;s<l;s++){var c=a[s];void 0===e[c]&&(i.push(this.routingSolver.attributes[c]),r=e[c]=!0)}r&&(t.attributes=i)},_}),mt("com/visioglobe/web/SVG3Loader",["./helpers/SvgUtils","./helpers/ExtrudeGeometry","com/visioglobe/common/utils/Utils","three"],function(v,y,c,b){function t(t){console.log("SVG3Loader"),this.scene=new b.Scene,this.material=new b.MeshBasicMaterial({color:16777215,specular:13421772,vertexColors:b.VertexColors,transparent:!1}),this.floors={},this.svgHeight=2048,this.geoinformation={meters_per_pixel:1},this.synchronousLoading=this.generateWalls=this.generateRoofs=!0,this.debug=!1}return t.prototype.initialize=function(){this.debug&&console.log("initialize")},t.prototype.convertSVGTo3D=function(t){var e={};return e.x=(t.x-this.svgHeight/2)*this.geoinformation.meters_per_pixel,e.y=(this.svgHeight/2-t.y)*this.geoinformation.meters_per_pixel,t.z&&(e.z=t.z),e},t.prototype.convertPathToShape=function(t){var e=t.getAttribute("d");if(void 0===e)return null;var i,r=new b.Shape,n=r,o=new v.Transform;t.getAttribute("transform")&&(o=t.getAttribute("transform"),o=v.Transform.parse(o)),t=null,(e=v.Parser.path(e)).reset();for(var a,s,l,c=!1;!e.isEnd();)switch(e.nextCommand(),c&&(n=new b.Shape,r.holes.push(n),c=!1),e.command.toUpperCase()){case"Z":v.equalsPoints(i,t,.01)&&n.curves.splice(-1,1);break;case"M":for(a=e.getAsCurrentPoint().clone(),o.multiplyVector(a),a=this.convertSVGTo3D(a),n.moveTo(a.x,a.y),t=i=a;!e.isCommandOrEnd();)a=e.getAsCurrentPoint().clone(),o.multiplyVector(a),a=this.convertSVGTo3D(a),v.equalsPoints(a,t,.01)||n.lineTo(a.x,a.y),t=a;break;case"L":for(;!e.isCommandOrEnd();)a=e.getAsCurrentPoint().clone(),o.multiplyVector(a),a=this.convertSVGTo3D(a),v.equalsPoints(a,t,.01)||n.lineTo(a.x,a.y),t=a;break;case"C":for(;!e.isCommandOrEnd();)a=e.getAsControlPoint().clone(),s=e.getAsControlPoint().clone(),l=e.getAsCurrentPoint().clone(),o.multiplyVector(a),a=this.convertSVGTo3D(a),o.multiplyVector(s),s=this.convertSVGTo3D(s),o.multiplyVector(l),l=this.convertSVGTo3D(l),n.bezierCurveTo(a.x,a.y,s.x,s.y,l.x,l.y);break;case"S":for(;!e.isCommandOrEnd();)a=e.getReflectedControlPoint().clone(),s=e.getAsControlPoint().clone(),l=e.getAsCurrentPoint().clone(),o.multiplyVector(a),a=this.convertSVGTo3D(a),o.multiplyVector(s),s=this.convertSVGTo3D(s),o.multiplyVector(l),l=this.convertSVGTo3D(l),n.bezierCurveTo(a.x,a.y,s.x,s.y,l.x,l.y);break;case"H":for(;!e.isCommandOrEnd();)s=e.getScalar(),(a=e.current.clone()).x="h"===e.command?a.x+s:s,e.current.x=a.x,o.multiplyVector(a),a=this.convertSVGTo3D(a),n.lineTo(a.x,a.y);break;case"V":for(;!e.isCommandOrEnd();)s=e.getScalar(),(a=e.current.clone()).y="v"===e.command?a.y+s:s,e.current.y=a.y,o.multiplyVector(a),a=this.convertSVGTo3D(a),n.lineTo(a.x,a.y);break;default:return null}return r},t.prototype.addPathToScene=function(t,e,i){var r=this.convertPathToShape(t);if(null===r||r.curves.length<=1)console.log("Cannot convert to shape.");else{void 0===(l=t.getAttribute("fill"))&&(l=e.color);var n,o,a,s=v.Parser.color(l),l=this.floors[i.floor],l=!1!==i.lod?l.lods[i.lod]:l.floorContentLOD,c=0;e.reflection?c=1:e.water&&(c=2);for(var h=c;l.children.length<c+1;)l.add(new b.Mesh(void 0,this.material));if(e.reflection?l.children[c].userData={reflection:!0}:e.water&&(l.children[c].userData={water:!0}),this.generateRoofs){n={amount:e.thickness,steps:1,bevelEnabled:!1,generateSides:!1,generateTop:!0,generateBottom:!1};try{for((o=new y(r,n)).computeBoundingBox(),a=new b.Color(s),f=0,m=o.faces.length;f<m;++f)o.faces[f].color=a}catch(t){return void console.log("ExtrudeGeometry failed",t)}a=l.children[c].geometry.faces.length,l.children[c].geometry.merge(o),void 0!==(t=t.getAttribute("vg_id"))&&((f=new b.Vector3).addVectors(o.boundingBox.max,o.boundingBox.min),f.multiplyScalar(.5),i={id:t,floor:i.floor,originalColor:s,nbFaces:o.faces.length,faces_offset:a,position:f},l.userData.pickables=l.userData.pickables||[],l.userData.pickables.push(i))}if(this.generateWalls&&0<e.thickness&&!1!==e.wall_geometry){n={amount:e.thickness,steps:1,bevelEnabled:!1,generateSides:!0,generateTop:!1,generateBottom:!1},(o=new y(r,n)).computeVertexNormals();var u=new b.Color(s),p=new b.Color(s);e.wall_color_gradient&&(r=parseFloat(e.wall_color_gradient_top_ratio),isNaN(r)||u.multiplyScalar(r),e=parseFloat(e.wall_color_gradient_bottom_ratio),isNaN(bottom_ratio)||p.multiplyScalar(e));for(var d=["a","b","c"],f=0,m=o.faces.length;f<m;++f){var g=o.faces[f];Object.keys(d).forEach(function(t){g.vertexColors[t]=0<o.vertices[g[d[t]]].z?u:p})}l.children[h].geometry.merge(o)}}},t.prototype.addSvgPath=function(t,e,i){this.addPathToScene(t,e,i)},t.prototype.loadItem=function(t){this.debug&&console.log("loadItem");var e=t.element,i=t.info.type,r=e.getAttribute("onabort");if(r&&JSON.parse(r),e.getAttribute("id")&&e.setAttribute("vg_id",e.getAttribute("id")),"vg-model"!==i&&"vg-image"!==i&&"vg-label"!==i)switch(e.name||e.localName){case"rect":v.convertRectToPath(e),this.addSvgPath(e,t.parameters,t.info);break;case"polygon":case"polyline":v.convertPolygonToPath(e),this.addSvgPath(e,t.parameters,t.info);break;case"ellipse":v.convertEllipseToPath(e),this.addSvgPath(e,t.parameters,t.info);break;case"circle":v.convertCircleToPath(e),this.addSvgPath(e,t.parameters,t.info);break;case"path":this.addSvgPath(e,t.parameters,t.info)}},t.prototype.parseBoolean=function(t,e){return void 0===t?e||!1:!1!==t&&"false"!==t&&"off"!==t&&"0"!==t&&0!==t},t.prototype.loadSVG3=function(t,e,i){this.debug&&console.log("loadSVG3"),t=t.querySelector("svg"),this.svgHeight=parseInt(t.getAttribute("height"),10);var o=t.getAttribute("onabort"),o=JSON.parse(o);e&&e(o),void 0!==o.builder_parameters&&void 0!==o.builder_parameters.distance_coeff&&(o.geo.distance_coef=o.builder_parameters.distance_coeff),this.geoinformation=o.geo,this.scene.userData={svgHeight:this.svgHeight,geoinformation:this.geoinformation,proj4string:o.proj4string,offsetX:o.offsetX,offsetY:o.offsetY},this.debug&&console.log("height= ",this.svgHeight);var a=this,s=[];if(c.queryChildren(t,"g[id^=floor]").forEach(function(t){var n=t.getAttribute("id").substr(5),i=new b.Object3D,e=new b.Object3D;i.add(e),a.scene.add(i),i.userData={name:n},a.floors[n]={object:i,content:e,lods:{}},a.debug&&console.log("floor= ",n),c.queryChildren(t,"g[id^=lod]").forEach(function(t){var r=t.getAttribute("id").substr(3),e=new b.Object3D;i.add(e),e.userData={index:parseInt(r,10)},a.floors[n].lods[r]=e,a.debug&&console.log(" lod= ",r),c.queryChildren(t,"g").forEach(function(t){var i=t.getAttribute("id");a.debug&&console.log("  type",i),c.queryChildren(t,"*:not(.vghelper)").forEach(function(t){a.debug&&console.log("   child");var e={thickness:0,color:10526880};void 0!==o.parameters.styles[i]&&void 0!==o.parameters.styles[i].footprint&&!0===o.parameters.styles[i].footprint||(o.parameters.styles[i]&&(e.thickness=parseFloat(o.parameters.styles[i].extrusion_height),e.color=o.parameters.styles[i].color,e.wall_geometry=a.parseBoolean(o.parameters.styles[i].wall_geometry,!1),e.wall_color_gradient=a.parseBoolean(o.parameters.styles[i].wall_color_gradient,!1),e.wall_color_gradient_top_ratio=parseFloat(o.parameters.styles[i].wall_color_gradient_top_ratio),e.wall_color_gradient_bottom_ratio=parseFloat(o.parameters.styles[i].wall_color_gradient_bottom_ratio),e.reflection=a.parseBoolean(o.parameters.styles[i].reflection),e.water=a.parseBoolean(o.parameters.styles[i].water)),s.push({element:t,parameters:e,info:{floor:n,lod:r,type:i}}))})})})}),this.synchronousLoading)return Object.keys(s).forEach(function(t){this.loadItem(s[t])},this),Promise.resolve();var r=0,n=Math.ceil(s.length/100),l=function(){for(var t=Math.min(s.length-r,n),e=0;e<t;++e)this.loadItem(s[r]),++r;return r===s.length?(i(1),Promise.resolve()):(i(r/s.length),Promise.resolve().bind(this).call(l).delay(0))};return Promise.resolve().bind(this).call(l).delay(0)},t.prototype.getVgFile=function(t,e,i,r){t instanceof b.Scene||!r||(t.object.userData.proj4string=r.proj4string,t.object.userData.offsetX=r.offsetX,t.object.userData.offsetY=r.offsetY),e={scene:t,routing:e,pois:i};var n=function(e,i){return Object.keys(e).forEach(function(t){e[t]=i.apply(this,[t,e[t]]),null!==e[t]&&"object"==typeof e[t]&&n(e[t],i)},this),e};return t instanceof b.Scene||n(e,function(t,e){return e="number"==typeof e?parseFloat(e.toFixed(1)):e}),e},t}),mt("com/visioglobe/web/helpers/SceneLoader",["three"],function(D){return D.SceneLoader=function(t){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){},this.callbackSync=function(){},this.callbackProgress=function(){},this.geometryHandlers={},this.hierarchyHandlers={},this.addGeometryHandler("ascii",D.JSONLoader),this.manager=void 0!==t?t:D.DefaultLoadingManager},D.SceneLoader.prototype={constructor:D.SceneLoader,load:function(e,i,t,r){var n=this;new D.XHRLoader(n.manager).load(e,function(t){n.parse(JSON.parse(t),i,e)},t,r)},addGeometryHandler:function(t,e){this.geometryHandlers[t]={loaderClass:e}},addHierarchyHandler:function(t,e){this.hierarchyHandlers[t]={loaderClass:e}},parse:function(t,r,e){function u(t,e){return"relativeToHTML"==e?t:E+t}function p(){P.object?d(x.scene,P.object.children):d(x.scene,P.objects)}function d(t,e){var i,r,n,o,a,s;for(s in e){var l=x.objects[s],c=e[s];if(void 0===l){if(c.type&&c.type in A.hierarchyHandlers)void 0===c.loading&&(g=x.materials[c.material],c.loading=!0,A.hierarchyHandlers[c.type].loaderObject.load(u(c.url,P.urlBaseType),function(e,i,r,n){return function(t){!function(t,e,i,r,n){var o=n.rotation,a=n.quaternion,s=n.scale;t.position.fromArray(n.position),a?t.quaternion.fromArray(a):t.rotation.fromArray(o),t.scale.fromArray(s),r&&t.traverse(function(t){t.material=r});var l=void 0===n.visible||n.visible;t.traverse(function(t){t.visible=l}),i.add(t),t.name=e,x.objects[e]=t,p()}(t.content||(t.dae?t.scene:t),e,i,r,n),--b,A.onLoadComplete(),f()}}(s,t,g,c)));else if(void 0!==c.geometry)(m=x.geometries[c.geometry])&&(g=x.materials[c.material],r=c.position,n=c.rotation,o=c.scale,i=c.matrix,a=c.quaternion,(g=!c.material?new D.MultiMaterial(x.face_materials[c.geometry]):g)instanceof D.MultiMaterial&&0===g.materials.length&&(g=new D.MultiMaterial(x.face_materials[c.geometry])),c.skin?l=new D.SkinnedMesh(m,g):c.morph?(l=new D.MorphAnimMesh(m,g),void 0!==c.duration&&(l.duration=c.duration),void 0!==c.time&&(l.time=c.time),void 0!==c.mirroredLoop&&(l.mirroredLoop=c.mirroredLoop),g.morphNormals&&m.computeMorphNormals()):l=new D.Mesh(m,g),l.name=s,i?(l.matrixAutoUpdate=!1,l.matrix.set(i[0],i[4],i[8],i[12],i[1],i[5],i[9],i[13],i[2],i[6],i[10],i[14],i[3],i[7],i[11],i[15]),l.matrix.decompose(l.position,l.quaternion,l.scale)):(l.position.fromArray(r),a?l.quaternion.fromArray(a):l.rotation.fromArray(n),l.scale.fromArray(o)),l.visible=c.visible,l.castShadow=c.castShadow,l.receiveShadow=c.receiveShadow,t.add(l),x.objects[s]=l);else if("AmbientLight"===c.type||"PointLight"===c.type||"DirectionalLight"===c.type||"SpotLight"===c.type||"HemisphereLight"===c.type){switch(i=c.color,r=c.intensity,n=c.distance,o=c.position,a=c.rotation,c.type){case"AmbientLight":y=new D.AmbientLight(i);break;case"PointLight":(y=new D.PointLight(i,r,n)).position.fromArray(o);break;case"DirectionalLight":(y=new D.DirectionalLight(i,r)).position.fromArray(c.direction);break;case"SpotLight":(y=new D.SpotLight(i,r,n)).angle=c.angle,y.position.fromArray(o),y.target.set(o[0],o[1]-n,o[2]),y.target.applyEuler(new D.Euler(a[0],a[1],a[2],"XYZ"));break;case"HemisphereLight":(y=new D.DirectionalLight(i,r,n)).target.set(o[0],o[1]-n,o[2]),y.target.applyEuler(new D.Euler(a[0],a[1],a[2],"XYZ"))}t.add(y),y.name=s,x.lights[s]=y,x.objects[s]=y}else"PerspectiveCamera"===c.type||"OrthographicCamera"===c.type?(r=c.position,n=c.rotation,a=c.quaternion,"PerspectiveCamera"===c.type?v=new D.PerspectiveCamera(c.fov,c.aspect,c.near,c.far):"OrthographicCamera"===c.type&&(v=new D.OrthographicCamera(c.left,c.right,c.top,c.bottom,c.near,c.far)),v.name=s,v.position.fromArray(r),void 0!==a?v.quaternion.fromArray(a):void 0!==n?v.rotation.fromArray(n):c.target&&v.lookAt((new D.Vector3).fromArray(c.target)),t.add(v),x.cameras[s]=v,x.objects[s]=v):((l=new D.Object3D).name=s,void 0!==c.matrix?((i=new D.Matrix4).fromArray(c.matrix),i.decompose(l.position,l.quaternion,l.scale)):(void 0!==c.position&&l.position.fromArray(c.position),void 0!==c.rotation?l.rotation.fromArray(c.rotation):void 0!==c.quaternion&&l.quaternion.fromArray(c.quaternion),void 0!==c.scale&&l.scale.fromArray(c.scale)),l.visible=void 0!==c.visible&&c.visible,t.add(l),x.objects[s]=l,x.empties[s]=l);if(l){if(void 0!==c.userData)for(var h in c.userData)l.userData[h]=c.userData[h];if(void 0!==c.groups)for(i=0;i<c.groups.length;i++)r=c.groups[i],void 0===x.groups[r]&&(x.groups[r]=[]),x.groups[r].push(s)}}void 0!==l&&void 0!==c.children&&d(l,c.children)}}function f(){if(A.callbackProgress({totalModels:a,totalTextures:s,loadedModels:a-b,loadedTextures:s-o},x),A.onLoadProgress(),0===b&&0===o){for(var t=0;t<S.length;t++){var e=S[t],i=x.objects[e.targetName];i?e.object.target=i:(e.object.target=new D.Object3D,x.scene.add(e.object.target)),e.object.target.userData.targetInverse=e.object}r(x)}}var m,g,v,i,n,y,b,o,a,s,x,l,c,h,w,M,_,A=this,E=D.LoaderUtils.extractUrlBase(e),S=[],P=t;for(l in this.geometryHandlers)t=this.geometryHandlers[l].loaderClass,this.geometryHandlers[l].loaderObject=new t;for(l in this.hierarchyHandlers)t=this.hierarchyHandlers[l].loaderClass,this.hierarchyHandlers[l].loaderObject=new t;if(o=b=0,x={scene:new D.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}},P.transform&&(l=P.transform.position,t=P.transform.rotation,e=P.transform.scale,l&&x.scene.position.fromArray(l),t&&x.scene.rotation.fromArray(t),e&&x.scene.scale.fromArray(e),l||t||e)&&(x.scene.updateMatrix(),x.scene.updateMatrixWorld()),P.animations)for(var T in x.scene.animations=[],P.animations){var C,O=P.animations[T];void 0===O.duration?(C={name:O.name,duration:0,tracks:[]},O.tracks.forEach(function(t){var i={name:t.name,times:[],values:[],type:"float"===t.type?"number":t.type};t.keys.forEach(function(t){var e=t.time/O.fps;C.duration=Math.max(C.duration,e),i.times.push(e),i.values.push(t.value)}),C.tracks.push(i)}),x.scene.animations.push(D.AnimationClip.parse(C))):x.scene.animations.push(D.AnimationClip.parse(O))}for(c in l=function(t){return function(){o-=t,f(),A.onLoadComplete()}},P.fogs)t=P.fogs[c],"linear"===t.type?i=new D.Fog(0,t.near,t.far):"exp2"===t.type&&(i=new D.FogExp2(0,t.density)),t=t.color,i.color.setRGB(t[0],t[1],t[2]),x.fogs[c]=i;for(h in P.geometries)i=P.geometries[h],i.type in this.geometryHandlers&&(b+=1,A.onLoadStart());for(n in P.objects)!function t(e,i){if(i(e),void 0!==e.children)for(var r in e.children)t(e.children[r],i)}(P.objects[n],function(t){t.type&&t.type in A.hierarchyHandlers&&(b+=1,A.onLoadStart())});for(h in a=b,P.geometries)"cube"===(i=P.geometries[h]).type?((m=new D.BoxGeometry(i.width,i.height,i.depth,i.widthSegments,i.heightSegments,i.depthSegments)).name=h,x.geometries[h]=m):"plane"===i.type?((m=new D.PlaneGeometry(i.width,i.height,i.widthSegments,i.heightSegments)).name=h,x.geometries[h]=m):"sphere"===i.type?((m=new D.SphereGeometry(i.radius,i.widthSegments,i.heightSegments)).name=h,x.geometries[h]=m):"cylinder"===i.type?((m=new D.CylinderGeometry(i.topRad,i.botRad,i.height,i.radSegs,i.heightSegs)).name=h,x.geometries[h]=m):"torus"===i.type?((m=new D.TorusGeometry(i.radius,i.tube,i.segmentsR,i.segmentsT)).name=h,x.geometries[h]=m):"icosahedron"===i.type?((m=new D.IcosahedronGeometry(i.radius,i.subdivisions)).name=h,x.geometries[h]=m):i.type in this.geometryHandlers?(R=this.geometryHandlers[i.type].loaderObject).load(u(i.url,P.urlBaseType),function(i){return function(t,e){t.name=i,x.geometries[i]=t,x.face_materials[i]=e,p(),--b,A.onLoadComplete(),f()}}(h)):"Geometry"===i.type?((n=(R=new D.JSONLoader).parse(i.data)).geometry.name=i.uuid,x.geometries[i.uuid]=n.geometry):"embedded"===i.type&&((n=P.embeds[i.id]).metadata=P.metadata,n&&function(i){return function(t,e){t.name=i,x.geometries[i]=t,x.face_materials[i]=e}}(h)((n=this.geometryHandlers.ascii.loaderObject.parse(n,"")).geometry,n.materials));for(w in P.textures)if(h=P.textures[w],Array.isArray(h.url))for(o+=h.url.length,n=0;n<h.url.length;n++)A.onLoadStart();else o+=1,A.onLoadStart();for(w in s=o,P.textures){if(void 0!==(h=P.textures[w]).mapping&&void 0!==D[h.mapping]&&(h.mapping=D[h.mapping]),Array.isArray(h.url)){for(n=h.url.length,i=[],T=0;T<n;T++)i[T]=u(h.url[T],P.urlBaseType);null!==(R=D.Loader.Handlers.get(i[0]))?(n=R.load(i,l(n)),void 0!==h.mapping&&(n.mapping=h.mapping)):(n=(new D.CubeTextureLoader).load(i,l(n))).mapping=h.mapping}else{if(h.image){for(T in n=!1,P.images)if(P.images[T].uuid===h.image){n=P.images[T];break}n&&(h.url=n.url)}var R,L=u(h.url,P.urlBaseType),I=l(1);null!==(R=D.Loader.Handlers.get(L))?n=R.load(L,I):(n=new D.Texture,(R=new D.ImageLoader).setCrossOrigin(""),function(e,i){R.load(L,function(t){t.toDataURL=function(){return i},e.image=t,e.needsUpdate=!0,I()})}(n,h.url)),void 0!==h.mapping&&(n.mapping=h.mapping),void 0!==D[h.minFilter]&&(n.minFilter=D[h.minFilter]),void 0!==D[h.magFilter]&&(n.magFilter=D[h.magFilter]),h.anisotropy&&(n.anisotropy=h.anisotropy),h.repeat&&(n.repeat.set(h.repeat[0],h.repeat[1]),1!==h.repeat[0]&&(n.wrapS=D.RepeatWrapping),1!==h.repeat[1]&&(n.wrapT=D.RepeatWrapping)),h.offset&&n.offset.set(h.offset[0],h.offset[1]),h.wrap&&(void 0!==(i={repeat:D.RepeatWrapping,mirror:D.MirroredRepeatWrapping})[h.wrap[0]]&&(n.wrapS=i[h.wrap[0]]),void 0!==i[h.wrap[1]]&&(n.wrapT=i[h.wrap[1]]))}x.textures[w]=n,h.loadedTexture=n}for(M in P.materials){for(_ in(w=P.materials[M]).parameters)"envMap"===_||"map"===_||"lightMap"===_||"bumpMap"===_||"normalMap"===_||"alphaMap"===_?w.parameters[_]=x.textures[w.parameters[_]]:"shading"===_?w.parameters[_]="flat"===w.parameters[_]?D.FlatShading:D.SmoothShading:"side"===_?w.parameters[_]="double"==w.parameters[_]?D.DoubleSide:"back"==w.parameters[_]?D.BackSide:D.FrontSide:"blending"===_?w.parameters[_]=w.parameters[_]in D?D[w.parameters[_]]:D.NormalBlending:"combine"===_?w.parameters[_]=w.parameters[_]in D?D[w.parameters[_]]:D.MultiplyOperation:"vertexColors"===_?"face"==w.parameters[_]?w.parameters[_]=D.FaceColors:w.parameters[_]&&(w.parameters[_]=D.VertexColors):"wrapRGB"===_?(l=w.parameters[_],w.parameters[_]=new D.Vector3(l[0],l[1],l[2])):"normalScale"===_&&(l=w.parameters[_],w.parameters[_]=new D.Vector2(l[0],l[1]));if(void 0===w.parameters){if(w.map){for(T in n=!1,P.textures)if(P.textures[T].uuid===w.map){n=P.textures[T];break}n&&(w.map=n.loadedTexture)}M=w.uuid,g="MeshFaceMaterial"===w.type||"MultiMaterial"===w.type?w.materials:new D[w.type](w)}else void 0!==w.parameters.opacity&&w.parameters.opacity<1&&(w.parameters.transparent=!0),void 0!==w.parameters.ambient&&(void 0===w.parameters.color&&(w.parameters.color=w.parameters.ambient),delete w.parameters.ambient),void 0!==w.parameters.emissive&&(void 0===w.parameters.color&&(w.parameters.color=w.parameters.emissive),delete w.parameters.emissive),void 0!==w.parameters.reflectionMap&&delete w.parameters.reflectionMap,g="MeshFaceMaterial"===w.type||"MultiMaterial"===w.type?w.parameters.materials:new D[w.type](w.parameters);g.name=M,x.materials[M]=g}for(M in P.materials)if(w=P.materials[M],w.parameters&&w.parameters.materials){for(_=[],T=0;T<w.parameters.materials.length;T++)_.push(x.materials[w.parameters.materials[T]]);x.materials[M]=_}p(),x.cameras&&P.defaults&&P.defaults.camera&&(x.currentCamera=x.cameras[P.defaults.camera]),x.fogs&&P.defaults&&P.defaults.fog&&(x.scene.fog=x.fogs[P.defaults.fog]),A.callbackSync(x),f()}},D.SceneLoader}),mt("com/visioglobe/common/SlotHelper",["com/visioglobe/common/utils/Utils","bluebird"],function(p,t){function d(){}return d.compareVersions=function(t,e){for(var i=t.split(/\./),r=e.split(/\./),n=i.length,o=r.length;o<n;)r.push("0"),o++;for(;n<o;)i.push("0"),n++;for(o=0;o<n;o++){var a=parseInt(i[o],10),s=parseInt(r[o],10);if(a<s)return-1;if(s<a)return 1}return 0},d.checkSlotDescription=function(l,c,h,u){return new t(function(t,e){var i,r,n="string"==typeof h.sdkType?[h.sdkType]:h.sdkType,o=h.sdkVersion,a=h.minimumDataSDKVersion||h.sdkVersion,s=new Date;void 0!==l.version&&1==l.version||e(Error("missing overall version or not equal to 1")),!0===u&&e(Error("error: slot.descrition refers to another slot description")),Array.isArray(l.maps)&&0<l.maps.length?("string"==typeof(i=l.maps[0]).sdk_type&&-1!==n.indexOf(i.sdk_type)||e(Error("missing or wrong slot sdk_type: "+i.sdk_type)),void 0===i.sdk_version&&e(Error("missing slot attribute sdk_version")),void 0===i.sdk_min_version&&(i.sdk_min_version=i.sdk_version),1==d.compareVersions(i.sdk_min_version,o)&&e(Error("data's minimum sdk_version "+i.sdk_min_version+" is higher than this SDK's version "+o+" Data too new, update SDK, or get different data")),-1==d.compareVersions(i.sdk_version,a)&&e(Error("data's sdk_version "+i["sdk.version"]+" is smaller than this SDK's minimumDataSDKVersion "+a+" Data is too old, update data")),void 0!==i.expiry_date&&(n=new Date(i.expiry_date+" UTC"),isNaN(n.getTime())&&e(Error("Bad slot expiry_date: "+i.expiry_date)),n<s&&e(Error("map has expired on: "+i.expiry_date))),"string"==typeof i.path?(s=p.extendDeep({},c),n=c.path.replace(/\/[^/]+$/,"/"),/\//.test(n)||(n=""),o=/http|https|\/\//i,a=/^\/[^/]/,i.base_url?(r=i.base_url,n=o.test(r)||a.test(r)?r+"/"+i.path:n+r+"/"+i.path):n+=i.path,i.name&&(s.mapName=i.name),s.path=n,t(s)):e(Error("invalid slot.description: maps missing .path"))):e(Error("invalid slot.description: missing maps, or not array or length == 0")),l=null})},d}),A=this,P=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],mt.amd?mt("sha256",[],function(){return E}):"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=exports=E:exports=E:A.jsSHA=E,mt("com/visioglobe/common/utils/MapChecker",["sha256"],function(o){return{check:function(t,e,i){if(i=i||{},void 0===t||void 0===t.pois||void 0===t.pois.hedVersion)return!0;var r=JSON.stringify({expiration:t.expiration,nbRoutingNodes:t.routing?t.routing.nodes.length:0,nbRoutingEdges:t.routing?t.routing.edges.length:0}),n=new o("SHA-256","TEXT");return n.update(e+r),hashedCredential=n.getHash("HEX"),hashedCredential!==t.credentials?!(i.message="map integrity failure"):"never"===t.expiration||(t=new Date(t.expiration),!(new Date>t)||(i.message="map expired on "+t,!1))}}}),mt("com/visioglobe/common/Notifications",[],function(){function t(){this.onNotificationHandlers={},this.onStickyNotification={}}return t.prototype.on=function(t,e,i){i=i||!1;var r=t.split(/ /);1!=r.length?Object.keys(r).forEach(function(t){this.on(r[t],e)},this):(void 0===this.onNotificationHandlers[t]&&(this.onNotificationHandlers[t]=[]),this.onNotificationHandlers[t].push({callback:e,once:i}),void 0!==this.onStickyNotification[t]&&e(this.onStickyNotification[t].event))},t.prototype.off=function(t,e){var i=t.split(/ /);if(1==i.length){if(void 0===this.onNotificationHandlers[t])return!1;if(void 0===e)return this.onNotificationHandlers[t]=[],!0;for(var r=this.onNotificationHandlers[t],n=0,o=r.length;n<o;++n)if(r[n].callback===e)return r.splice(n,1),!0;return!1}Object.keys(i).forEach(function(t){this.off(i[t],e)},this)},t.prototype.trigger=function(t,e,i){var r,n=t.split(/ /);if(1!=n.length)Object.keys(n).forEach(function(t){if(!1===(r=this.trigger(n[t],e,i)))return!1},this);else if(i&&(this.onStickyNotification[t]={event:o}),void 0!==this.onNotificationHandlers[t]){for(var o={type:t,args:e},a=this.onNotificationHandlers[t],s=[],l=0,c=a.length;l<c;++l)s.push(a[l]);for(l=0,c=s.length;l<c;++l)if(a=s[l],r=a.callback(o),a.once&&this.off(t,a.function),!1===r)return!1}},t}),mt("com/visioglobe/common/Statistics",["require","com/visioglobe/common/utils/Utils"],function(t){var s=t("com/visioglobe/common/utils/Utils");return function(t){this.mapviewer=t,this.sendingData=!1,this.statURL="https://s.visioglobe.com/stats/SDKStatLogger.php",this.secretCode="L3sStatsS3r0ntHash33s",this.logVersion=this.dbVersion=1,this.lastLogTime=s.now(),this.minLogPositionInterval=30,this.delayedLogging=void 0,this.statDB={},this.shortDelay=6e4,this.longDelay=9e5,this.sendDelay=this.shortDelay,this.oldLogDelay=604800,this.sendDelayWhenNoFreshData=this.longDelay,this.appID=!1,this.statDB.indexedDB={},this.statDB.indexedDB.db=null;var i=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB;"webkitIndexedDB"in window&&!("IDBKeyRange"in window)&&(window.IDBKeyRange=window.webkitIDBKeyRange),"webkitIndexedDB"in window&&!("IDBTransaction"in window)&&(window.IDBTransaction=window.webkitIDBTransaction);var a=this;this.statDB.indexedDB.db=null,this.statDB.indexedDB.onerror=function(t){console.log(t)},this.statDB.indexedDB.open=function(){var e=i.open("stats",a.dbVersion);e.onupgradeneeded=function(t){e.result.createObjectStore("stat",{keyPath:"timestamp"})},e.onsuccess=function(t){a.statDB.indexedDB.db=t.target.result,a.logStat("sessionInfo",null)},e.onfailure=a.statDB.indexedDB.onerror},this.statDB.indexedDB.addStat=function(t){var e=a.statDB.indexedDB.db;null!=e&&((t=e.transaction("stat","readwrite").objectStore("stat").put(t)).onsuccess=function(t){a.sendingData||(setTimeout(a.sendStats,a.sendDelay),a.sendingData=!0)},t.onerror=function(t){console.error("Error Adding an item: ",t)})},this.statDB.indexedDB.getAllStatItems=function(e){var t=a.statDB.indexedDB.db.transaction("stat","readwrite").objectStore("stat"),i=IDBKeyRange.lowerBound(0),t=t.openCursor(i),r=[],n=[];t.onsuccess=function(t){0==!!(t=t.target.result)?0<r.length?e(r,n):a.sendingData||(setTimeout(a.sendStats,a.sendDelay),a.sendingData=!0):(r.push(t.value),n.push(t.primaryKey),t.continue())},t.onerror=a.statDB.indexedDB.onerror},this.statDB.indexedDB.getOldStatItems=function(e){var t=a.statDB.indexedDB.db.transaction("stat","readwrite").objectStore("stat"),i=IDBKeyRange.upperBound((new Date).getTime()-a.oldLogDelay),t=t.openCursor(i),r=[],n=[];t.onsuccess=function(t){0==!!(t=t.target.result)?0<r.length?e(n):a.sendingData||(setTimeout(a.sendStats,a.sendDelay),a.sendingData=!0):(r.push(t.value),n.push(t.primaryKey),t.continue())},t.onerror=a.statDB.indexedDB.onerror},this.statDB.indexedDB.deleteStats=function(t){for(var e=t.length,i=a.statDB.indexedDB.db.transaction("stat","readwrite").objectStore("stat"),r=0;r<t.length;r++){var n=t[r],o=i.delete(n);o.onsuccess=function(t){0!==--e||a.sendingData||(setTimeout(a.sendStats,a.sendDelay),a.sendingData=!0)},o.onerror=function(t){console.error("Error deleteing "+n+": ",t)}}},this.sendData=function(t,e){var i=JSON.stringify(t),t=new FormData;t.append("compress",!1),t.append("log",i),t.append("hash",s.sha1(i+a.secretCode)),t.append("sdk_timestamp",s.now()),null!==s.getCookie("sdk_stat_session_id")&&t.append("sdk_stat_session_id",s.getCookie("sdk_stat_session_id")),s.request(a.statURL,"POST",t,{crossDomain:!0}).then(function(t){t=JSON.parse(t.response),s.setCookie("sdk_stat_session_id",t.sdk_stat_session_id,30),a.statDB.indexedDB.deleteStats(e),a.sendDelay=a.shortDelay}).catch(function(t){console.log("error :(",t.message),a.sendDelay=a.longDelay,a.statDB.indexedDB.getOldStatItems(a.statDB.indexedDB.deleteStats)})},this.sendStats=function(){a.sendingData=!1,a.statDB.indexedDB.getAllStatItems(a.sendData)},this.lastData=this.lastType=void 0,this.logStatCaller=function(){void 0!==a.lastType&&void 0!==a.lastData&&a.logStat(a.lastType,a.lastData)},this.logStat=function(t,e){var i;if("sessionInfo"===t&&(i={},i={type:t,appCodeName:(i=window.navigator).appCodeName,appName:i.appName,appVersion:i.appVersion,language:i.language,platform:i.platform,product:i.product,productSub:i.productSub,userAgent:i.userAgent,vendor:i.vendor,vendorSub:i.vendorSub,timestamp:s.now(),sdkVersion:a.mapviewer.version,sdkName:"web",version:a.logVersion,platformVersion:i.oscpu},void 0!==a.mapParameters&&(i.mapPath=a.mapParameters.path||a.mapParameters.svg||a.mapParameters.mapContentString,void 0!==a.mapviewer.mapName&&!1!==a.mapviewer.mapName&&(i.mapName=a.mapviewer.mapName)),a.appID&&(i.appID=a.appID),a.statDB.indexedDB.addStat(i)),"mapLoaded"===t&&(i={type:t,mapPath:e.path||"",timestamp:s.now()},a.statDB.indexedDB.addStat(i)),"position"===t){if(void 0!==a.delayedLogging&&clearTimeout(a.delayedLogging),(i=s.now())-a.lastLogTime<a.minLogPositionInterval)return a.lastType=t,a.lastData=e,void(a.delayedLogging=setTimeout(a.logStatCaller,1e3*(a.minLogPositionInterval+1)));a.lastLogTime=i,i={type:t,id:e.id,position:a.mapviewer.convertPointToLatLon(e.position),floor:a.mapviewer.getCurrentFloor(),timestamp:s.now()},void 0!==a.mapParameters&&(i.mapPath=a.mapParameters.path||"",void 0!==a.mapviewer.mapName&&!1!==a.mapviewer.mapName&&(i.mapName=a.mapviewer.mapName)),a.statDB.indexedDB.addStat(i)}if("routing"===t){var r=void 0,n=void 0;if("string"==typeof e.src?r={id:e.src}:"object"==typeof e.src?void 0!==e.src.x&&void 0!==e.src.y&&((i={position:a.mapviewer.convertPointToLatLon(e.src)}).position.floor=a.mapviewer.getCurrentFloor(),r=i):r=e.src,"string"==typeof e.dst)n={id:e.dst};else if("array"==typeof e.dst||"object"==typeof e.dst||0<e.dst.length)for(var n=[],o=0;o<e.dst.length;o++)"string"==typeof e.dst[o]?n.push({id:e.dst[o]}):"object"==typeof e.dst[o]?void 0!==e.dst[o].x&&void 0!==e.dst[o].y&&((i={position:a.mapviewer.convertPointToLatLon(e.dst[o])}).position.floor=a.mapviewer.getCurrentFloor(),n.push(i)):n.push(e.dst[o]);else"object"==typeof e.dst?void 0!==e.dst.x&&void 0!==e.dst.y&&((i={position:a.mapviewer.convertPointToLatLon(e.dst)}).position.floor=a.mapviewer.getCurrentFloor(),n=[i]):n=e.dst;i={type:t,src:r,dst:n,timestamp:s.now()},void 0!==a.mapParameters&&(i.mapPath=a.mapParameters.path||"",void 0!==a.mapviewer.mapName&&!1!==a.mapviewer.mapName&&(i.mapName=a.mapviewer.mapName)),a.statDB.indexedDB.addStat(i)}"selectPlace"===t&&(i={type:t,id:e.vg.id,floor:e.vg.floor,timestamp:s.now()},void 0!==a.mapParameters&&(i.mapPath=a.mapParameters.path||"",void 0!==a.mapviewer.mapName&&!1!==a.mapviewer.mapName&&(i.mapName=a.mapviewer.mapName)),a.statDB.indexedDB.addStat(i))},this.getURL=function(){return a.statURL},this.setURL=function(t){a.statURL=t,a.logStat("sessionInfo",null)},this.getAppID=function(){return a.appID},this.setAppID=function(t){a.appID=t,a.logStat("sessionInfo",null)},this.setMapParameters=function(t){a.mapParameters=t},this.statDB.indexedDB.open()}}),mt("com/visioglobe/web/TiledImage",["three","underscoretiny"],function(h,n){function t(t,e){if(e.overlay=void 0!==e.overlay&&e.overlay,this.options=e,this.mapviewer=e.mapviewer,this.spriteLayer=this.mapviewer.scene,this.floor=this.mapviewer.getFloor(this.options.floor),null===this.floor)return console.log("Warning: POI was not created, required floor doesn't exist."),null;var i;if(null!==this.floor){if(i=void 0!==this.options.lod?this.floor.getLOD(this.options.lod):this.floor.floorContentLOD,!this.options.overlay&&!i)return null;this.spriteLayer=i.contentNode}this.textureLoader=this.mapviewer.textureLoader,this.planeGeometry=new h.PlaneGeometry(1,1),this.updateQuadtree=this.useTexture=!0,this.distanceCoef=.25,this.prunedTilesByLevel=[];for(var r=0;r<=this.options.depth;++r)i=n.filter(this.options.pruned,function(t){return t[2]===r}),this.prunedTilesByLevel.push(i);this.camera=t,this.rootNode=this.loadTile(0,0,0),this.rootNode.rotation.set(0,0,this.options.angle*Math.PI/180),this.rootNode.scale.x=this.options.scale.x,this.rootNode.scale.y=this.options.scale.y,this.rootNode.scale.z=this.options.scale.z,this.rootNode.position.x=this.options.position.x,this.rootNode.position.y=this.options.position.y,this.rootNode.position.z=this.options.position.z,this.rootNode.updateMatrix(),this.rootNode.updateMatrixWorld(!0),this.floor.tiledImages||(this.floor.tiledImages=[]),this.update()}return(t.prototype.constructor=t).prototype.loadTile=function(t,e,i){var r=this,n=new h.Object3D;n.visible=!1;var o,a,s=this.textureLoader.load(this.options.name+""+i+"/"+t+"-"+e+".png",function(){a.quadtree.loaded=!0,r.mapviewer.mustUpdateCameraObjects=!0,r.mapviewer.requestRedraw()},function(){},(o=a=n,function(){o.quadtree.loaded=!1})),l=new h.MeshBasicMaterial({wireframe:this.mapviewer.wireframe,color:16777215,side:h.FrontSide,transparent:!0,depthWrite:!1,depthTest:!this.options.overlay&&this.mapviewer.useDepthWriteForPOIs});l.originalMap=s,l.map=l.originalMap,(s=new h.Mesh(this.planeGeometry,l)).renderOrder=-this.mapviewer.constructor.renderDepthPOI,this.options.overlay&&(s.renderOrder=-this.mapviewer.constructor.renderDepthPOIOverlay),s.visible=!1,l=Math.pow(2,i),s.scale.x=1/l,s.scale.y=1/l,s.scale.z=1/l;var c=.5/l*(l-1);return s.position.x=t/l-c,s.position.y=-e/l+c,n.add(s),n.quadtree={x:t,y:e,z:i},n},t.prototype.refineQuadtree=function(t){function e(t,e,i,r){o(e,i,r)||(e=n.loadTile(e,i,r),t.add(e),e.updateMatrixWorld(!0))}var n=this,i=function(t){for(var e=!0,i=1;i<t.children.length;++i)if(!t.children[i].quadtree.loaded){e=!1;break}return e},o=function(e,i,t){return!!n.prunedTilesByLevel[t].find(function(t){return t[0]===e&&t[1]===i})||0!==t&&o(parseInt(e/2),parseInt(i/2),t-1)},r=t.children[0].getWorldPosition(),a=t.children[0].getWorldScale(),r=n.camera.getWorldPosition().distanceTo(r)*n.distanceCoef<a.x;if(t.quadtree.z<n.options.depth&&r)if(t.isQueried||(e(t,2*t.quadtree.x+0,2*t.quadtree.y+0,t.quadtree.z+1),e(t,2*t.quadtree.x+1,2*t.quadtree.y+0,t.quadtree.z+1),e(t,2*t.quadtree.x+0,2*t.quadtree.y+1,t.quadtree.z+1),e(t,2*t.quadtree.x+1,2*t.quadtree.y+1,t.quadtree.z+1),t.isQueried=!0),i(t))for(t.visible=!0,t.children[0].visible=!1,i=1;i<t.children.length;++i)this.refineQuadtree(t.children[i]);else for(t.visible=!0,t.children[0].visible=!0,i=1;i<t.children.length;++i)t.children[i].visible=!1;else for(t.visible=!0,t.children[0].visible=!0,i=1;i<t.children.length;++i)t.children[i].visible=!1},t.prototype.update=function(){this.updateQuadtree&&this.refineQuadtree(this.rootNode)},t.prototype.add=function(){-1===this.spriteLayer.children.indexOf(this.rootNode)&&this.spriteLayer.add(this.rootNode),-1===this.floor.tiledImages.indexOf(this)&&this.floor.tiledImages.push(this)},t.prototype.remove=function(){this.spriteLayer.remove(this.rootNode);var t=this.floor.tiledImages.indexOf(this);-1!==t&&this.floor.tiledImages.splice(t,1)},t}),mt("text!com/visioglobe/web/shaders/depth.frag",[],function(){return"varying vec3 vPos;void main(){float a=vPos.z;float b=clamp(1.0-a/5.0,0.0,1.0);gl_FragColor=vec4(vec3(b),1.0);}"}),mt("text!com/visioglobe/web/shaders/depth.vert",[],function(){return"varying vec3 vPos;void main(){vPos=position;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}"}),mt("text!com/visioglobe/web/shaders/water.frag",[],function(){return"float a(const in vec4 b){const vec4 c=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);float d=dot(b,c);return d;}varying vec2 vUv;varying vec3 vPos;varying vec3 vColor;uniform sampler2D tDiffuse;uniform sampler2D tDepth;uniform sampler2D tNoise;uniform float viewWidth;uniform float viewHeight;uniform vec3 uColor;uniform float near;uniform float far;uniform float time;uniform vec3 eye;uniform vec3 sunDirection;uniform vec3 sunColor;vec4 e(vec2 f){vec2 g=(f/103.0)+vec2(time/17.0,time/29.0);vec2 h=f/107.0-vec2(time/-19.0,time/31.0);vec2 i=f/vec2(897.0,983.0)+vec2(time/101.0,time/97.0);vec2 j=f/vec2(991.0,877.0)-vec2(time/109.0,time/-113.0);vec4 k=(texture2D(tNoise,g))+(texture2D(tNoise,h))+(texture2D(tNoise,i))+(texture2D(tNoise,j));return k*0.5-1.0;}void l(const vec3 m,const vec3 n,float o,float p,float q,inout vec3 r,inout vec3 s){vec3 t=normalize(reflect(-sunDirection,m));float u=max(0.0,dot(n,t));s+=pow(u,o)*sunColor*p;r+=max(dot(sunDirection,m),0.0)*sunColor*q;}void main(){vec2 v=gl_FragCoord.xy*vec2(1.0/viewWidth,1.0/viewHeight);vec4 w=texture2D(tDepth,v);float d=w.x;float x=d*0.5;vec4 k=e(vPos.xy*4.0);vec3 m=normalize(k.xzy*vec3(2.0,1.0,2.0));vec3 q=vec3(0.0);vec3 y=vec3(0.0);vec3 z=eye-vPos;vec3 A=normalize(z);l(m,A,100.0,2.0,0.5,q,y);vec4 B=texture2D(tDiffuse,v+m.xz*(1.0-w.x)*0.025);vec3 C=vColor;gl_FragColor=vec4(mix(C.xyz,B.xyz,0.5),1.0);}"}),mt("text!com/visioglobe/web/shaders/water.vert",[],function(){return"attribute vec3 color;varying vec2 vUv;varying vec3 vPos;varying vec3 vColor;void main(){vUv=uv;vPos=position;vColor=color;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}"}),function(t,s,c){function o(t,e,i){return setTimeout(l(t,i),e)}function i(t,e,i){return Array.isArray(t)&&(n(t,i[e],i),1)}function n(t,e,i){if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==c)for(r=0;r<t.length;)e.call(i,t[r],r,t),r++;else for(var r in t)t.hasOwnProperty(r)&&e.call(i,t[r],r,t)}function a(t,e,i){for(var r=Object.keys(e),n=0;n<r.length;)(!i||i&&t[r[n]]===c)&&(t[r[n]]=e[r[n]]),n++;return t}function r(t,e){return a(t,e,!0)}function e(t,e,i){var r;e=e.prototype,(r=t.prototype=Object.create(e)).constructor=t,r._super=e,i&&a(r,i)}function l(t,e){return function(){return t.apply(e,arguments)}}function h(t,e){return"function"==typeof t?t.apply(e&&e[0]||c,e):t}function u(e,t,i){n(f(t),function(t){e.addEventListener(t,i,!1)})}function p(e,t,i){n(f(t),function(t){e.removeEventListener(t,i,!1)})}function d(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function f(t){return t.trim().split(/\s+/g)}function m(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var r=0;r<t.length;){if(i&&t[r][i]==e||!i&&t[r]===e)return r;r++}return-1}function g(t){return Array.prototype.slice.call(t,0)}function v(t,i,e){for(var r=[],n=[],o=0;o<t.length;){var a=i?t[o][i]:t[o];m(n,a)<0&&r.push(t[o]),n[o]=a,o++}return r=e?i?r.sort(function(t,e){return t[i]>e[i]}):r.sort():r}function y(t,e){for(var i,r=e[0].toUpperCase()+e.slice(1),n=0;n<X.length;){if((i=(i=X[n])?i+r:e)in t)return i;n++}return c}function b(t){return(t=t.ownerDocument).defaultView||t.parentWindow}function x(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){h(e.options.enable,[e])&&i.handler(t)},this.init()}function w(t,e,i){var r=i.pointers.length,n=i.changedPointers.length,o=1&e&&0==r-n;i.isFirst=!!o,i.isFinal=!!(12&e&&0==r-n),o&&(t.session={}),i.eventType=e,e=t.session,n=(r=i.pointers).length,e.firstInput||(e.firstInput=M(i)),1<n&&!e.firstMultiple?e.firstMultiple=M(i):1===n&&(e.firstMultiple=!1);var o=e.firstInput,a=((n=e.firstMultiple)?n:o).center,s=i.center=_(r);i.timeStamp=J(),i.deltaTime=i.timeStamp-o.timeStamp,i.angle=S(a,s),i.distance=E(a,s);var o=i.center,a=e.offsetDelta||{},s=e.prevDelta||{},l=e.prevInput||{};1!==i.eventType&&4!==l.eventType||(s=e.prevDelta={x:l.deltaX||0,y:l.deltaY||0},a=e.offsetDelta={x:o.x,y:o.y}),i.deltaX=s.x+(o.x-a.x),i.deltaY=s.y+(o.y-a.y),i.offsetDirection=A(i.deltaX,i.deltaY),o=n?(o=n.pointers,E(r[0],r[1],it)/E(o[0],o[1],it)):1,i.scale=o,r=n?(n=n.pointers,S(r[1],r[0],it)-S(n[1],n[0],it)):0,i.rotation=r,a=e.lastInterval||i,r=i.timeStamp-a.timeStamp,8!=i.eventType&&(25<r||a.velocity===c)?(o=a.deltaX-i.deltaX,n=l=(a=a.deltaY-i.deltaY)/r||0,s=K(r=s=o/r||0)>K(l)?s:l,o=A(o,a),e.lastInterval=i):(s=a.velocity,r=a.velocityX,n=a.velocityY,o=a.direction),i.velocity=s,i.velocityX=r,i.velocityY=n,i.direction=o,e=t.element,d(i.srcEvent.target,e)&&(e=i.srcEvent.target),i.target=e,t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function M(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:Y(t.pointers[i].clientX),clientY:Y(t.pointers[i].clientY)},i++;return{timeStamp:J(),pointers:e,center:_(e),deltaX:t.deltaX,deltaY:t.deltaY}}function _(t){var e=t.length;if(1===e)return{x:Y(t[0].clientX),y:Y(t[0].clientY)};for(var i=0,r=0,n=0;n<e;)i+=t[n].clientX,r+=t[n].clientY,n++;return{x:Y(i/e),y:Y(r/e)}}function A(t,e){return t===e?1:K(t)>=K(e)?0<t?2:4:0<e?8:16}function E(t,e,i){var r=e[(i=i||et)[0]]-t[i[0]];return t=e[i[1]]-t[i[1]],Math.sqrt(r*r+t*t)}function S(t,e,i){return i=i||et,180*Math.atan2(e[i[1]]-t[i[1]],e[i[0]]-t[i[0]])/Math.PI}function P(){this.evEl=nt,this.evWin=ot,this.allow=!0,this.pressed=!1,x.apply(this,arguments)}function T(){this.evEl=lt,this.evWin=ct,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function C(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,x.apply(this,arguments)}function O(){this.evTarget=pt,this.targetIds={},x.apply(this,arguments)}function R(){x.apply(this,arguments);var t=l(this.handler,this);this.touch=new O(this.manager,t),this.mouse=new P(this.manager,t)}function L(t,e){this.manager=t,this.set(e)}function I(t){this.id=Z++,this.manager=null,this.options=r(t||{},this.defaults),t=this.options.enable,this.options.enable=t===c||t,this.state=1,this.simultaneous={},this.requireFail=[]}function D(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function F(t,e){e=e.manager;return e?e.get(t):t}function j(){I.apply(this,arguments)}function N(){j.apply(this,arguments),this.pY=this.pX=null}function k(){j.apply(this,arguments)}function z(){I.apply(this,arguments),this._input=this._timer=null}function U(){j.apply(this,arguments)}function V(){j.apply(this,arguments)}function B(){I.apply(this,arguments),this.pCenter=this.pTime=!1,this._input=this._timer=null,this.count=0}function H(t,e){var i=(e=e||{}).recognizers;return e.recognizers=i===c?H.defaults.preset:i,new G(t,e)}function G(t,e){this.options=r(e=e||{},H.defaults),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=new((t=this).options.inputClass||($?T:tt?O:Q?R:P))(t,w),this.touchAction=new L(this,this.options.touchAction),W(this,!0),n(e.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function W(t,i){var r=t.element;n(t.options.cssProps,function(t,e){r.style[y(r.style,e)]=i?t:""})}var X=" webkit moz MS ms o".split(" "),q=s.createElement("div"),Y=Math.round,K=Math.abs,J=Date.now,Z=1,Q="ontouchstart"in t,$=y(t,"PointerEvent")!==c,tt=Q&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),et=["x","y"],it=["clientX","clientY"];x.prototype={handler:function(){},init:function(){this.evEl&&u(this.element,this.evEl,this.domHandler),this.evTarget&&u(this.target,this.evTarget,this.domHandler),this.evWin&&u(b(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(b(this.element),this.evWin,this.domHandler)}};var rt={mousedown:1,mousemove:2,mouseup:4},nt="mousedown",ot="mousemove mouseup";e(P,x,{handler:function(t){var e=rt[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&this.allow&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var at={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},st={2:"touch",3:"pen",4:"mouse",5:"kinect"},lt="pointerdown",ct="pointermove pointerup pointercancel";t.MSPointerEvent&&(lt="MSPointerDown",ct="MSPointerMove MSPointerUp MSPointerCancel"),e(T,x,{handler:function(t){var e=this.store,i=!1,r=t.type.toLowerCase().replace("ms",""),r=at[r],n=st[t.pointerType]||t.pointerType,o="touch"==n,a=m(e,t.pointerId,"pointerId");1&r&&(0===t.button||o)?a<0&&(e.push(t),a=e.length-1):12&r&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:n,srcEvent:t}),i&&e.splice(a,1))}});var ht={touchstart:1,touchmove:2,touchend:4,touchcancel:8};e(C,x,{handler:function(t){var e,i,r=ht[t.type];1===r&&(this.started=!0),this.started&&(e=g(t.touches),i=g(t.changedTouches),e=[e=12&r?v(e.concat(i),"identifier",!0):e,i],12&r&&0==e[0].length-e[1].length&&(this.started=!1),this.callback(this.manager,r,{pointers:e[0],changedPointers:e[1],pointerType:"touch",srcEvent:t}))}});var ut={touchstart:1,touchmove:2,touchend:4,touchcancel:8},pt="touchstart touchmove touchend touchcancel";e(O,x,{handler:function(t){var e=ut[t.type],i=function(t,e){var i=g(t.touches),r=this.targetIds;if(3&e&&1===i.length)return r[i[0].identifier]=!0,[i,i];var n=g(t.changedTouches),o=[],a=this.target,s=i.filter(function(t){return d(t.target,a)});if(1===e)for(i=0;i<s.length;)r[s[i].identifier]=!0,i++;for(i=0;i<n.length;)r[n[i].identifier]&&o.push(n[i]),12&e&&delete r[n[i].identifier],i++;return o.length?[v(s.concat(o),"identifier",!0),o]:void 0}.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:t})}}),e(R,x,{handler:function(t,e,i){var r="mouse"==i.pointerType;if("touch"==i.pointerType)this.mouse.allow=!1;else if(r&&!this.mouse.allow)return;12&e&&(this.mouse.allow=!0),this.callback(t,e,i)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var dt=y(q.style,"touchAction"),ft=dt!==c;L.prototype={set:function(t){"compute"==t&&(t=this.compute()),ft&&(this.manager.element.style[dt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return n(this.manager.recognizers,function(t){h(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(t){if(-1<t.indexOf("none"))return"none";var e=-1<t.indexOf("pan-x"),i=-1<t.indexOf("pan-y");return e&&i?"pan-x pan-y":e||i?e?"pan-x":"pan-y":-1<t.indexOf("manipulation")?"manipulation":"auto"}(e.join(" "))},preventDefaults:function(t){if(!ft){var e=t.srcEvent;if(t=t.offsetDirection,this.manager.session.prevented)e.preventDefault();else{var i=-1<(n=this.actions).indexOf("none"),r=-1<n.indexOf("pan-y"),n=-1<n.indexOf("pan-x");if(i||r&&6&t||n&&24&t)return this.preventSrc(e)}}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}},I.prototype={defaults:{},set:function(t){return a(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(i(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=F(t,this)).id]||(e[t.id]=t).recognizeWith(this),this},dropRecognizeWith:function(t){return i(t,"dropRecognizeWith",this)||(t=F(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(i(t,"requireFailure",this))return this;var e=this.requireFail;return-1===m(e,t=F(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){return i(t,"dropRequireFailure",this)||(t=F(t,this),-1<(t=m(this.requireFail,t))&&this.requireFail.splice(t,1)),this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(e){function t(t){i.manager.emit(i.options.event+(t?16&r?"cancel":8&r?"end":4&r?"move":2&r?"start":"":""),e)}var i=this,r=this.state;r<8&&t(!0),t(),8<=r&&t(!0)},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){t=a({},t),h(this.options.enable,[this,t])?(56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)):(this.reset(),this.state=32)},process:function(t){},getTouchAction:function(){},reset:function(){}},e(j,I,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,r=6&e;return t=this.attrTest(t),r&&(8&i||!t)?16|e:r||t?4&i?8|e:2&e?4|e:2:32}}),e(N,j,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push("pan-y"),24&t&&e.push("pan-x"),e},directionTest:function(t){var e=this.options,i=!0,r=t.distance,n=t.direction,o=t.deltaX,a=t.deltaY;return n&e.direction||(r=6&e.direction?(n=0===o?1:o<0?2:4,i=o!=this.pX,Math.abs(t.deltaX)):(n=0===a?1:a<0?8:16,i=a!=this.pY,Math.abs(t.deltaY))),t.direction=n,i&&r>e.threshold&&n&e.direction},attrTest:function(t){return j.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=D(t.direction);e&&this.manager.emit(this.options.event+e,t),this._super.emit.call(this,t)}}),e(k,j,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){this._super.emit.call(this,t),1!==t.scale&&this.manager.emit(this.options.event+(t.scale<1?"in":"out"),t)}}),e(z,I,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,r=t.distance<e.threshold,n=t.deltaTime>e.time;if(this._input=t,!r||!i||12&t.eventType&&!n)this.reset();else if(1&t.eventType)this.reset(),this._timer=o(function(){this.state=8,this.tryEmit()},e.time,this);else if(4&t.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=J(),this.manager.emit(this.options.event,this._input)))}}),e(U,j,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),e(V,j,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:30,pointers:1},getTouchAction:function(){return N.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return 30&i?e=t.velocity:6&i?e=t.velocityX:24&i&&(e=t.velocityY),this._super.attrTest.call(this,t)&&i&t.direction&&t.distance>this.options.threshold&&K(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=D(t.direction);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),e(B,I,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,r=t.distance<e.threshold,n=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&n&&i){if(4!=t.eventType)return this.failTimeout();if(i=!this.pTime||t.timeStamp-this.pTime<e.interval,r=!this.pCenter||E(this.pCenter,t.center)<e.posThreshold,this.pTime=t.timeStamp,this.pCenter=t.center,this.count=r&&i?this.count+1:1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=o(function(){this.state=8,this.tryEmit()},e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=o(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),H.VERSION="2.0.4",H.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[U,{enable:!1}],[k,{enable:!1},["rotate"]],[V,{direction:6}],[N,{direction:6},["swipe"]],[B],[B,{event:"doubletap",taps:2},["tap"]],[z]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},G.prototype={set:function(t){return a(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var i,r=this.recognizers,n=e.curRecognizer;(!n||n&&8&n.state)&&(n=e.curRecognizer=null);for(var o=0;o<r.length;)i=r[o],2===e.stopped||n&&i!=n&&!i.canRecognizeWith(n)?i.reset():i.recognize(t),!n&&14&i.state&&(n=e.curRecognizer=i),o++}},get:function(t){if(t instanceof I)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(i(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),(t.manager=this).touchAction.update(),t},remove:function(t){if(i(t,"remove",this))return this;var e=this.recognizers;return t=this.get(t),e.splice(m(e,t),1),this.touchAction.update(),this},on:function(t,e){var i=this.handlers;return n(f(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},off:function(t,e){var i=this.handlers;return n(f(t),function(t){e?i[t].splice(m(i[t],e),1):delete i[t]}),this},emit:function(t,e){var i,r,n;this.options.domEvents&&(i=t,r=e,(n=s.createEvent("Event")).initEvent(i,!0,!0),(n.gesture=r).target.dispatchEvent(n));var o=this.handlers[t]&&this.handlers[t].slice();if(o&&o.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var a=0;a<o.length;)o[a](e),a++}},destroy:function(){this.element&&W(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},a(H,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:G,Input:x,TouchAction:L,TouchInput:O,MouseInput:P,PointerEventInput:T,TouchMouseInput:R,SingleTouchInput:C,Recognizer:I,AttrRecognizer:j,Tap:B,Pan:N,Swipe:V,Pinch:k,Rotate:U,Press:z,on:u,off:p,each:n,merge:r,extend:a,inherit:e,bindFn:l,prefixed:y}),mt.amd?mt("hammer",[],function(){return H}):"undefined"!=typeof module&&module.exports?module.exports=H:t.Hammer=H}(window,document),mt("text!com/visioglobe/web/resources/visioglobe.png.base64",[],function(){return"iVBORw0KGgoAAAANSUhEUgAAAJEAAAAxCAYAAADaxEvNAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABmdJREFUeNrsXLtyIkcUbbRbThx4HCgffcEOmaoULMqcLf4BM4SOEF8AfAHwBYz8A6DQkWaDrVIm9gsYZ67aQONgq1zlxN3Mbbg03UPPg+fcU9VIGuiefpw+9zGNGCMQCAQCgUAgEAiFUaMpSMGXbw5/9TTvxOzuek4TRCTSkabJXz8CcRoWNeZQPvMy48SKiUTVJI7LX3u8CAI5BVub8fLEyRQQiapBHqE2wxTFkSrzl+a9n0CtPAPxIl4GVSFTrYLkcUB5Hrb8nLWSzDKSURCxw4urIWL70v2nWsUIJBZ8qix2ohpl+DRfvjWAoKq6CVXqE4nOn0A+f50oyjPey+ImZBoqkd0MVCkmEp0ngYaK+QphQaM937cPyoTN2/2lEalWAQKpCznii9g94P0bYEKdSyXSVQVMGCZQ+6AEEri7DpekScwnAxP3fEnTfHXBBPIUH6h9tJA7ic42iZSYWDJnJx7Gv6IobHRwBTIT+xmZtl8zpRNIiQ6KHiJQeBIEWisS7ssECH/WeH+hJBrz8g8vraUZOwJ+/G3oIHPa/v5HNwYiBZw4n9j6MYuIGvuW7UkT2F21R0q0tx0fLfM/d9c3ew/jzfCAKKL4yntd5B/14PmdTXs+FI/M2eYOG/Lyxku/lAZf4gkvb7z0T2ienS2SJ2op4ZNPlJ9AHsi5o4TieQnUgAUR7XVOfO5HSI06RKKc4HZdPimXk1oMt06I2gtOeuaTZONspVTJWSZyrHMSqV5qg7dO/YzmX/hGj0w8BD6e73YcEnEzJBxBlxMgzFhPmJuI1zvbCduDGoXnPoy8SrQAUiwzsbvCTQhPn1FUUUPviesNCFtHqtONfBwTBrxeH/lFr3CfNlelQNOPBwj9cUQUgWkZmwjO64p+yNA8TVntEriJ/9bRtDdbqtOtk5aE7PH+qEdOpHkcpIyhCWNX7zkHRQzypA7y+kQBCjsfLD7/gAik+ipyIj4pA54gpzsNkSYUZjBZqhO/YJuJSAkX7vUKn2Oavkx2EShTBJlsKl174toUPmNCg22fWXJgw6WNYWq4pzzl+Qwb7SBKNEBhaYffeGRiMHSqo9S1idp8tMN0JwPF9Sd+X1sHeqgQMlQm0YEiJvpGUSBf2bWxZhGcDArkK5sgQkTwVmH/S/xZVVMFtmNIuyfeyJJM7b2TSMgl71iATE1a1hWrSWDpD+EF6WYgShopG4gEGyZYMbeumHTk72GFbOv6gkyyDfCG2jK5nDg+W2e6W4Yoc6sfMIYp9EOMock/M9PdU1NXKPErzHszK4mKhPgDw8QUUiENWjDIIsCkHKuqCX8PNDsT142KkhmZzkQNdCqTXJtr+pFmwnVj8HTj140BNnakmav9hviqGgnZ13QwjwqJtkPeXgx1xUQuwIl/Es4j5JfywtSHOGe9rPAs2tvrczHY3PLbKh+keiHH/qB5ojGytT0svSWo0D3bPDYhBy0ikwhFIpX8wmABAr3tUJvxoaIzqRhz5Ny54ISylWOYQ4WUtm8gIRcaoqmFLhIhWJt2rHxCAOpZc39lKJFUmIZGjbAKPeYkqRicyB2NQNma4Og2UCQyBNUi2GEOpvSr/L2ge1CcROC/hCgq8BUHMszDbgOhBEEDIJQ8udjI2JSbYYcyg6NadBG9lH7gvpRuqkt/zMTKewCL/Z0e23wiP9jDRMQZHV28GD012gNS9gz5l1XUojuuAnWzRDTRisy64ypJiO9p+mHjLHcUsm4FBZB03KoLuaTjKJFOjfBi5FUh8HU6hh3rWEY5K/9K6d8C/taF9HOlz484eOD1WuieHsseEo/ZOmvc46RpbRBrc7wmN2AI0auqlFjBTGPw5TNMtR6//nOeQKXMp/gDpvv6sJ1K6BZiukPyJbqW7bUh2nNTcjAxUxJtsEHEtYlhobNBHFd5iQdI+UztBSnPz7wd89nGZLAcQ5w30i3tPBHs3jCHCnUNtn/XQsnM88ymPYgO60DsuaYtcf1G52RC/utek0OZw7XIMB8jA5H6qL1YIcBs+d6tk/Vs+BzuV9fMSdoYwtU9c4L+P1E5uZfVYw/rp/gXhCuiQCmw9s+IRNVVGtcUvUC042SNpi4J74kiVvAhMlNTAKqDOiASEdIiHmZICayiv6oe+31H/NiN/77++fLDh1/EN2r/5eVv8H1c+ClU6XddREQgEAgEAoFAqA7+F2AAKuGVMqSUek0AAAAASUVORK5CYII="}),mt("text!com/visioglobe/web/resources/laser.png.base64",[],function(){return"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"}),mt("text!com/visioglobe/web/resources/water.jpg.base64",[],function(){return"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"}),mt("com/visioglobe/web/MapviewerPrivate","require com/visioglobe/web/helpers/StringUtils com/visioglobe/web/helpers/MathUtils com/visioglobe/common/utils/Utils com/visioglobe/web/helpers/CachedTexture com/visioglobe/web/Camera com/visioglobe/web/helpers/ExtrudeGeometry com/visioglobe/web/Floor com/visioglobe/web/Path com/visioglobe/web/helpers/PathGeometry com/visioglobe/web/Place com/visioglobe/web/poi/POIFactory com/visioglobe/web/helpers/Skybox com/visioglobe/web/helpers/SvgUtils com/visioglobe/web/helpers/PathUtils com/visioglobe/web/CameraDrivenExplorer com/visioglobe/common/MultiBuildingView com/visioglobe/web/TrackballManipulator com/visioglobe/common/routing/AStarRoutingSolver com/visioglobe/common/navigation/NavigationSolver com/visioglobe/web/SVG3Loader com/visioglobe/web/helpers/SceneLoader com/visioglobe/common/SlotHelper com/visioglobe/common/utils/MapChecker com/visioglobe/web/helpers/TextureAtlas com/visioglobe/web/helpers/TextGenerator com/visioglobe/common/Notifications com/visioglobe/common/Statistics com/visioglobe/web/TiledImage text!com/visioglobe/web/shaders/depth.frag text!com/visioglobe/web/shaders/depth.vert text!com/visioglobe/web/shaders/water.frag text!com/visioglobe/web/shaders/water.vert text!com/visioglobe/web/shaders/sky.frag text!com/visioglobe/web/shaders/sky.vert underscoretiny hammer three bluebird text!com/visioglobe/web/resources/visioglobe.png.base64 text!com/visioglobe/web/resources/laser.png.base64 text!com/visioglobe/web/resources/water.jpg.base64".split(" "),function(t){var wt=t("com/visioglobe/web/helpers/StringUtils"),Mt=t("com/visioglobe/web/helpers/MathUtils"),_t=t("com/visioglobe/common/utils/Utils"),At=t("com/visioglobe/web/helpers/CachedTexture"),Et=t("com/visioglobe/web/Camera"),St=t("com/visioglobe/web/helpers/ExtrudeGeometry"),Pt=t("com/visioglobe/web/Floor"),Tt=t("com/visioglobe/web/Path"),Ct=t("com/visioglobe/web/helpers/PathGeometry"),Ot=t("com/visioglobe/web/Place"),Rt=t("com/visioglobe/web/poi/POIFactory"),Lt=t("com/visioglobe/web/helpers/Skybox"),It=t("com/visioglobe/web/helpers/SvgUtils"),Dt=t("com/visioglobe/web/helpers/PathUtils"),Ft=t("com/visioglobe/web/CameraDrivenExplorer"),jt=t("com/visioglobe/common/MultiBuildingView"),Nt=t("com/visioglobe/web/TrackballManipulator"),kt=t("com/visioglobe/common/routing/AStarRoutingSolver"),zt=t("com/visioglobe/common/navigation/NavigationSolver");t("com/visioglobe/web/SVG3Loader"),t("com/visioglobe/web/helpers/SceneLoader");var Ut=t("com/visioglobe/common/SlotHelper"),Vt=t("com/visioglobe/common/utils/MapChecker");t("com/visioglobe/web/helpers/TextureAtlas");var Bt=t("com/visioglobe/web/helpers/TextGenerator"),Ht=t("com/visioglobe/common/Notifications"),Gt=t("com/visioglobe/common/Statistics"),Wt=t("com/visioglobe/web/TiledImage");t("text!com/visioglobe/web/shaders/depth.frag"),t("text!com/visioglobe/web/shaders/depth.vert"),t("text!com/visioglobe/web/shaders/water.frag"),t("text!com/visioglobe/web/shaders/water.vert"),t("text!com/visioglobe/web/shaders/sky.frag"),t("text!com/visioglobe/web/shaders/sky.vert");function Xt(){}var qt=t("underscoretiny"),Yt=t("hammer"),Kt=t("three"),Jt=t("bluebird"),Zt=_t.getURLParameters(),Qt=window.console;Qt||((Qt={}).log=Xt,Qt.warn=Xt,Qt.error=Xt,Qt.time=Xt,Qt.timeEnd=Xt),Qt.time=Qt.time||Xt,Qt.timeEnd=Qt.timeEnd||Xt;var $t=function(){var h;function r(){function s(t){var e=k.getBoundingClientRect();return{left:t.center.x-e.left,top:t.center.y-e.top}}function i(t,e){var i=Date.now();if(!(0!==dt&&200<i-dt||i-pt<200)&&(pt=i,!1===L.customPreManipulatorListener||!1!==L.customPreManipulatorListener(e))){switch(L.manipulatorTypeName){case"map":case"trackball":!1!==(i=_(t))&&0<i.length&&$(e,i[0].target,i[0].vg.poi)}!1!==L.customPostManipulatorListener&&L.customPostManipulatorListener(e)}}var n,o,a,l,c=!1,h=0,u=1;L.onTapWithCenter=i;var t=new Yt.Manager(N.domElement);if(t.add(new Yt.Pan({threshold:0,pointers:0})),t.add(new Yt.Rotate({threshold:0})).recognizeWith(t.get("pan")),t.add(new Yt.Pinch({threshold:0})).recognizeWith([t.get("pan"),t.get("rotate")]),t.add(new Yt.Tap({event:"doubletap",taps:2})),t.add(new Yt.Tap),t.on("panstart panmove",function(t){if(L.manipulator.panManipulatorEnabled&&(!1===L.customPreManipulatorListener||!1!==L.customPreManipulatorListener(t))){switch(L.manipulatorTypeName){case"map":"panstart"==t.type?(e=s(t),n=L.convertScreenToPoint(e)):(e=s(t),e=L.convertScreenToPoint(e),i=L.publicCamera.position,L.publicCamera.position={x:n.x-e.x+i.x,y:n.y-e.y+i.y,radius:i.radius});break;case"trackball":var e,i,r;"panstart"==t.type?(o=t.center,a=L.publicCamera.pitch,l=L.publicCamera.rotation,e=s(t),c=e.top<.5*_t.getElementHeight(k)):(e=t.center.x-o.x,i=t.center.y-o.y,r=!1,L.manipulator.pitchManipulatorEnabled&&(0==c&&(i=-i),L.publicCamera.pitch=a+L.manipulator.rotationSpeed*i,r=!0),L.manipulator.rotationManipulatorEnabled&&(0==c&&(e=-e),L.publicCamera.rotation=l+L.manipulator.rotationSpeed*e,r=!0),r&&L.manipulator.update())}!1!==L.customPostManipulatorListener&&L.customPostManipulatorListener(t)}}),t.on("rotatestart rotatemove",function(t){var e,i,r,n,o;!1===L.manipulator.rotationManipulatorEnabled||!1!==L.customPreManipulatorListener&&!1===L.customPreManipulatorListener(t)||("map"===L.manipulatorTypeName&&("rotatestart"==t.type?h=L.publicCamera.rotation:(r=s(t),e=L.convertScreenToPoint(r),i=r.top,r=r.left,n=L.viewportWidth-r-1,o=L.viewportHeight-i-1,L.publicCamera.rotation=h+t.rotation,L.manipulator.panManipulatorEnabled&&(e=L.getViewpointFromPositions({points:[e],top:i,bottom:o,left:r,right:n}),L.publicCamera.position=e))),!1!==L.customPostManipulatorListener&&L.customPostManipulatorListener(t))}),t.on("pinchstart pinchmove",function(t){if(!1!==L.manipulator.zoomManipulatorEnabled&&(!1===L.customPreManipulatorListener||!1!==L.customPreManipulatorListener(t))){switch(L.manipulatorTypeName){case"map":var e,i,r,n,o,a;"pinchstart"==t.type?(L.publicCamera.position.radius,u=L.publicCamera.position.radius||1):((e=L.publicCamera.position).radius=u/t.scale,n=s(t),i=L.convertScreenToPoint(n),r=n.top,n=n.left,o=L.viewportWidth-n-1,a=L.viewportHeight-r-1,L.publicCamera.position=e,e=L.getViewpointFromPositions({points:[i],top:r,bottom:a,left:n,right:o}),L.publicCamera.position=e);break;case"trackball":"pinchstart"==t.type?(L.publicCamera.position.radius,u=L.publicCamera.position.radius||1):((e=L.publicCamera.position).radius=u/t.scale,L.publicCamera.position=e)}!1!==L.customPostManipulatorListener&&L.customPostManipulatorListener(t)}}),t.on("tap",function(t){ut=!1;var e=s(t);return i({x:e.left,y:e.top},t)}),t.on("doubletap",function(t){}),void 0!==J&&(t.add(new Yt.Press({time:100})),t.on("press",function(t){var e=s(t);!1!==(e=_({x:e.left,y:e.top}))&&0<e.length&&((e=e[0].target).vg&&e.vg.poi&&J(t,e))})),k.addEventListener("mousedown",e,!1),k.addEventListener("mousemove",A,!1),k.addEventListener("mouseup",d,!1),document.addEventListener("mouseup",p,!1),k.addEventListener("mouseout",M,!1),k.addEventListener("contextmenu",S,!1),t="mousewheel",navigator&&navigator.userAgent&&-1!=navigator.userAgent.indexOf("Firefox")&&(t="DOMMouseScroll"),k.addEventListener(t,E),void 0!==(t=L.getExtraData().background))switch(t.type){case"image":k.style["background-image"]="url("+F+t.file+")",k.style["background-size"]="cover";break;case"gradient":k.style.background="linear-gradient("+t.start+","+t.stop+")";break;case"color":k.style["background-color"]=t.color}L.resizeInternal(_t.getElementWidth(k),_t.getElementHeight(k),!1)}function m(t){var e=new Pt(L,t);return e.index=et.length,et.push(e),it[t]=e}function y(t){var e=t.getAttribute("d");if(void 0===e)return[];var i=new It.Transform;t.getAttribute("transform")&&(s=t.getAttribute("transform"),i=It.Transform.parse(s));try{function r(t){if(t instanceof Kt.LineCurve)s(t.v1),s(t.v2);else if(t instanceof Kt.QuadraticBezierCurve)s(t.v0),s(t.v1),s(t.v2);else if(t instanceof Kt.CubicBezierCurve)s(t.v0),s(t.v1),s(t.v2),s(t.v3);else if(t instanceof Kt.SplineCurve)t.points.forEach(function(t){s(t)});else{if(!(t instanceof Kt.EllipseCurve))throw Error("weird Curve type");Qt.log("EllipseCurve not transformed")}}var n=Dt.transformSVGPath(e),o=Kt.ShapeUtils.isClockWise(n.subPaths[0].getPoints()),a=n.toShapes(!o),s=function(t){i.multiplyVector(t);var e=P(t);t.x=e.x,t.y=e.y};return a.forEach(function(t){t.curves.forEach(r),t.holes.forEach(function(t){t.curves.forEach(r)})}),a}catch(t){return Qt.log("convertPathToShape failed",t),[]}}function b(t,e){if(!t)return t;var i,r,n=t.replace(e,"").split(/(_x[0-9A-Fa-f]*_)/);for(i in n)-1!==n[i].indexOf("_x")&&(r=parseInt(n[i].substr(2),16),n[i]=String.fromCharCode(r));return n.join("")}function g(t){null!==t&&(t.geoinformation?((ft=t.geoinformation).rotation_angle_in_degrees=parseFloat(ft.rotation_angle_in_degrees),ft.meters_per_pixel=parseFloat(ft.meters_per_pixel),ft.geo_xref=parseFloat(ft.geo_xref),ft.geo_yref=parseFloat(ft.geo_yref),ft.pixel_xref=parseFloat(ft.pixel_xref),L.cameraNorthRotation=-ft.rotation_angle_in_degrees):L.cameraNorthRotation=!1,qt.each(t.features,function(t,e){L.layersParameters[wt.ucfirst(e)]={thickness:parseFloat(t.extrusion_height),side_color:t.side_color}}),t.proj4string&&t.offsetX&&t.offsetY&&!1===L.initializeProjection(t)&&Qt.log("Cannot initialize projection"))}function v(){var t=ft.rotation_angle_in_degrees*Mt.DEG2RAD;ft.matrixUTMToSVG=new Kt.Matrix4,ft.matrixUTMToSVG.elements[0]=Math.cos(-t)/ft.meters_per_pixel,ft.matrixUTMToSVG.elements[1]=-Math.sin(-t)/ft.meters_per_pixel,ft.matrixUTMToSVG.elements[2]=-Math.sin(-t)/ft.meters_per_pixel,ft.matrixUTMToSVG.elements[3]=-Math.cos(-t)/ft.meters_per_pixel,ft.matrixUTMToSVG.elements[4]=U,ft.matrixUTMToSVG.elements[5]=U,ft.matrixSVGToUTM=new Kt.Matrix4,ft.matrixSVGToUTM.elements[0]=Math.cos(t)*ft.meters_per_pixel,ft.matrixSVGToUTM.elements[1]=-Math.sin(t)*ft.meters_per_pixel,ft.matrixSVGToUTM.elements[2]=Math.sin(t)*ft.meters_per_pixel,ft.matrixSVGToUTM.elements[3]=Math.cos(t)*ft.meters_per_pixel,ft.matrixSVGToUTM.elements[4]=-U,ft.matrixSVGToUTM.elements[5]=U}function x(t,e){void 0===e&&(e=!1),L.manipulator.maxRadius=.5*t/Math.tan(.5*Math.min(V.fovY,V.fovX)*Mt.DEG2RAD),L.manipulator.wholeRadius=L.manipulator.maxRadius,void 0!==Zt.radius||e||(L.manipulator.radius=L.manipulator.maxRadius),L.layersParameters.global.fog.far=3*t,L.sideInMeters=t,L.camera.far=L.layersParameters.global.fog.far;e=L.getFootprint("limits");0!=e?L.publicCamera.setBoundary(e.points):L.publicCamera.setBoundary([{x:-(e=.5*t),y:-e},{x:e,y:-e},{x:e,y:e},{x:-e,y:e},{x:-e,y:-e}]),L.manipulator.update()}function f(t,e,i){var r=Qt.log;Qt.log=function(){},"Fence"!==i.type&&function(t,e,i){var r=y(t);if(null!==r&&r.length){var n=L.getFloor(i.floor),o=n.getLOD(i.lod);null===o&&(o=n.floorContentLOD),n=b(t.getAttribute("vg_id"),"VgID"),null===(t=t.getAttribute("fill"))&&(t=e.color),t=It.Parser.color(t);for(var a=0;a<r.length;++a){var s=r[a],l=new Kt.MeshBasicMaterial({color:16777215,vertexColors:Kt.VertexColors,transparent:!1}),c={amount:e.thickness,steps:1,bevelEnabled:!1,generateSides:!1,generateTop:!0,generateBottom:!1};try{for(var h=new St(s,c),u=new Kt.Color(t),p=h.faces,c=0,d=p.length;c<d;++c)p[c].color=u}catch(t){Qt.log("ExtrudeGeometry failed",t),Qt.log(t.stack);break}e.is_reflection&&(ot.uniforms.uColor.value=new Kt.Color(t),l=ot),(c=new Kt.Matrix4).makeTranslation(0,0,e.offset),h.applyMatrix(c),(l=new Kt.Mesh(h,l)).matrixAutoUpdate=!1,l.geometry.computeBoundingBox(),c=o.node,e.is_reflection&&(c=o.node);var f=0;if(W&&0!==c.children.length?(f=c.children[0].geometry.faces.length,c.children[0].geometry.merge(l.geometry)):c.add(l),void 0!==n&&(l.vg={id:n,floor:i.floor,originalColor:t,nb_faces:l.geometry.faces.length,faces_offset:f,layer:c},o.pickables.push(l),void 0===L.places_list[n]&&(L.places_list[n]=[]),L.places_list[n].push(l),(c=new Kt.Vector3).addVectors(l.geometry.boundingBox.max,l.geometry.boundingBox.min),c.multiplyScalar(.5),c.multiply(l.scale),c.add(l.position),l.vg.position=c),0<e.thickness&&e.wall_geometry&&L.layersParameters.wall.enabled){d=9671571,d=t,l=new Kt.MeshBasicMaterial({color:16777215,vertexColors:Kt.VertexColors,transparent:!1}),c={amount:e.thickness,steps:1,bevelEnabled:!1,generateSides:!0,generateTop:!1,generateBottom:!1},(h=new St(s,c)).computeVertexNormals(),s=new Kt.Color(d),f=new Kt.Color(d),e.wall_color_gradient&&(d=parseFloat(e.wall_color_gradient_top_ratio),isNaN(d)||s.multiplyScalar(d),d=parseFloat(e.wall_color_gradient_bottom_ratio),isNaN(d)||f.multiplyScalar(d));for(var m=["a","b","c"],c=0,d=h.faces.length;c<d;++c){var g,v=h.faces[c];for(g in m)v.vertexColors[g]=0<h.vertices[v[m[g]]].z?s:f}(c=new Kt.Matrix4).makeTranslation(0,0,e.offset),h.applyMatrix(c),(l=new Kt.Mesh(h,l)).matrixAutoUpdate=!1,0===(s=o.getOrCreateLayer(L.layersParameters.wall.order)).children.length?s.add(l):s.children[0].geometry.merge(l.geometry)}}}else Qt.log("Cannot convert to shape.")}(t,e,i),Qt.log=r}function w(){(c=L.getFloor(st))?(L.currentFloorName=st,L.currentFloor=c):(L.currentFloorName=et[0].name,L.currentFloor=et[0]);for(var t,e,i=0,r=et.length;i<r;++i){(c=et[i]).setEnabled(c.name===L.currentFloorName),c.name===L.currentFloorName&&(L.current_lod=c.lods[c.lods.length-1].index);for(var n=0,o=c.lods.length;n<o;++n)void 0!==(s=c.lods[n])&&(s.setEnabled(c.name===L.currentFloorName&&s.index===L.current_lod),s.node.traverse(function(t){}))}for(t in L.places_list)new Ot(L,L.places_list[t],t,ft.meters_per_pixel);if(i=new Kt.Vector3(0,0,-1),r=new Kt.Vector3,n=new Kt.Raycaster(r,i),G)for(t in L.pois)for(e in o=L.pois[t]){var a,s,l,c,h=o[e];void 0!==(s=h.options("lod"))&&(a=h.options("position"),c=h.options("floor"),c=L.getFloor(c),r.copy({x:a.x,y:a.y,z:1e3}),n.set(r,i),l=c.floorContentLOD.pickables,s=c.getLOD(s),l=l.concat(s.node),0===(c=n.intersectObjects(l,!0)).length||(c=c[0].point.z)!==a.z&&(a.z=c,h.options("position",a,!0)))}return L.mustUpdateCameraObjects=!0,L.requestRedraw(),Jt.resolve()}function a(u,p){var d,f;return new Jt(function(t,e){G=!1;var i={};Vt.check(u,"String.length*Math.cos(window.length)",i)||e(Error(i.message)),f=(d=u).scene,i=new Kt.ObjectLoader,f instanceof Kt.Scene||(f=i.parse(f)),p(.6,"sceneLoader parse finished"),t()}).delay(0).tap(function(){void 0!==d.extra_data&&(L.extraData=d.extra_data),void 0!==d.map_name&&(L.mapName=d.map_name);var t={};if(void 0!==d.routing)for(var e=0;e<d.routing.floors.length;++e)t[(r=d.routing.floors[e]).name]=r;for(new Kt.Box3,e=0;e<f.children.length;++e){var i=f.children[e].userData.name,r=m(i);void 0!==t[i]&&(r.heightMin=t[i].zmin,r.heightMax=t[i].zmax),(i=f.children[e].children.slice())[0].traverse(function(t){t.matrixAutoUpdate=!1,void 0!==t.userData.water&&!0===t.userData.water&&r.floorContentLOD.groundObjects.push(t)}),r.floorContentLOD.node.add(i[0]);for(var n=1,o=i.length;n<o;++n){var a=i[n],s=r.createLOD(a.userData.index);if(a.traverse(function(t){t.matrixAutoUpdate=!1,void 0!==t.userData.water&&!0===t.userData.water&&s.groundObjects.push(t)}),s.node.add(a),void 0!==a.userData.pickables){s.pickables=a.userData.pickables;for(var l=0,c=s.pickables.length;l<c;++l){var h=s.pickables[l];void 0===L.places_list[h.id]&&(L.places_list[h.id]=[]);var u={};u.vg=h,u.geometry=a.children[0].geometry,L.places_list[h.id].push(u)}}}}for(e=0,t=et.length;e<t;++e)r=et[e],L.scene.add(r.node);z=f.userData.svgHeight,U=z/2,g({features:[],geoinformation:f.userData.geoinformation,proj4string:f.userData.proj4string,offsetX:f.userData.offsetX,offsetY:f.userData.offsetY}),v(),void 0!==d.routing&&(e={convertSVGToPoint:P,convertPointToSVG:T,convertPointToLatLon:L.convertPointToLatLon.bind(L),convertLatLonToPoint:L.convertLatLonToPoint.bind(L),meters_per_pixel:ft.meters_per_pixel,rotation_angle_in_degrees:ft.rotation_angle_in_degrees},L.routingSolver=new kt({routing:d.routing},e),L.navigationSolver=new zt(L.routingSolver,e.meters_per_pixel,L.routingSolver.hasIntersections()),L.setRoutingURL("#javascript")),x(z*ft.meters_per_pixel),p(.75,"setup except POIs finished")}).delay(0).then(function(){if(void 0!==d.pois){var t=(o=d.pois).pois,e=o.images,i=o.labels,r=o.models,n=o.tiledImages;L.loaderStatistics.pois+=e.length,L.loaderStatistics.pois+=r.length,L.loaderStatistics.pois+=i.length,n&&(L.loaderStatistics.pois+=n.length),L.deferredPoiLoading.active=!0;for(var o=(a=L.deferredPoiLoading).setPlaceName,a=a.setPlaceIcon,s=L.pois_floor_table,l=0,c=t.length;l<c;++l){var h=t[l];s[h.poiID]=h}if(void 0!==d.pois.polygons)for(l=0,c=(t=d.pois.polygons).length;l<c;++l)h=t[l],void 0===L.polygons_table[h.poiID]&&(L.polygons_table[h.poiID]=[]),L.polygons_table[h.poiID].push(h);if(void 0!==d.pois.points)for(l=0,c=(h=d.pois.points).length;l<c;++l)t=h[l],L.pofs_table[t.poiID]=t;for(l=0,c=e.length;l<c;++l)t={x:(h=e[l]).centerX,y:h.centerY,z:h.altitude},"facing"===h.type&&(t.z+=.5*h.width),t=P(t),L.addPOI({url:F+"icons/"+h.imageName+".png",id:h.poiID,position:t,scale:{x:h.width,y:h.height,z:1},floor:s[h.poiID].floorName,lod:h.lod,fixed:"fixed"===h.type,angle:h.angleInDegrees,face2d:"facing"!==h.type,image:!0,clickable:!(!h.poiID||null!==h.poiID.match(/^mapIcon/)),track:!1}),L.loaderStatistics.pois--;for(l=0,c=r.length;l<c;++l)t=P(t={x:(e=r[l]).centerX,y:e.centerY,z:e.altitude}),L.addPOI({model:F+"models/"+e.modelName+".json",id:e.poiID,startAnimations:e.startAnimations,textureAnimation:e.textureAnimation,position:t,scale:{x:e.width,y:e.height,z:1},floor:s[e.poiID].floorName,lod:e.lod,fixed:"fixed"===e.type,angle:e.angleInDegrees,face2d:"facing"!==e.type,clickable:!(!e.poiID||null!==e.poiID.match(/^mapModel/)),track:!1}),L.loaderStatistics.pois--;if(n)for(l=0,c=n.length;l<c;++l)t=P(t={x:(r=n[l]).centerX,y:r.centerY,z:r.altitude}),L.addTiledImages({position:t,scale:{x:r.width,y:r.height,z:1},floor:s[r.poiID].floorName,lod:r.lod,id:r.poiID,clickable:!0,mapviewer:L,angle:r.angleInDegrees,name:F+r.name,tileSize:r.tileSize,depth:r.depth,pruned:r.pruned});for(l=0,c=i.length;l<c;++l)e=s[n=(r=i[l]).poiID],t=P(t={x:r.centerX,y:r.centerY,z:r.altitude}),L.addPOI({id:n,text:o[n]||e.name,url:a[n],color:r.fontColor,position:t,scale:{x:1,y:1,z:1},floor:e.floorName,lod:r.lod,fixed:!0,angle:r.angleInDegrees,width:r.width,height:r.height,flip:!0,clickable:!(!r.poiID||null!==r.poiID.match(/^mapLabel/))}),L.loaderStatistics.pois--;L.deferredPoiLoading.active=!1,L.deferredPoiLoading.setPlaceIcon={},L.deferredPoiLoading.setPlaceName={}}return u=d=null,p(1,"done"),w()})}function s(t,e){return Jt.resolve(t).tap(function(){e(.25,"map downloaded")}).delay(0).then(JSON.parse).tap(function(){e(.5,"json parsed")}).delay(0).then(function(t){return a(t,e)}).catch(function(t){return Jt.reject(t)})}function i(t,e){O=!1,L.useDepthWriteForPOIs=!1;var i=t.querySelector("svg");z=parseInt(i.getAttribute("height"),10),U=z/2;var n=i.getAttribute("onabort");if(1<(n=JSON.parse(n)).version)return Jt.reject(Error("map data version "+n.version+", this SDK supports 1. Please update SDK"));!function(t){var e,i={};for(e in t.parameters)"object"!=typeof(n=t.parameters[e])&&(i[e]=n);for(e in t=t.parameters.styles){var r,n=t[e];for(r in i)void 0===n[r]&&(n[r]=i[r])}}(n),n.parameters.background&&(L.extraData={},L.extraData.background=n.parameters.background),i={features:n.parameters.styles,geoinformation:n.geo,proj4string:n.proj4string,offsetX:n.offsetX,offsetY:n.offsetY},void 0!==n.builder_parameters&&void 0!==n.builder_parameters.distance_coeff&&(i.geoinformation.distance_coef=n.builder_parameters.distance_coeff),g(i),v(),void 0!==n.routing&&(i={convertSVGToPoint:P,convertPointToSVG:T,convertPointToLatLon:L.convertPointToLatLon.bind(L),convertLatLonToPoint:L.convertLatLonToPoint.bind(L),meters_per_pixel:ft.meters_per_pixel},L.routingSolver=new kt({routing:n.routing},i),L.navigationSolver=new zt(L.routingSolver,i.meters_per_pixel,L.routingSolver.hasIntersections()),L.setRoutingURL("#javascript"));var r,o=[];for(r in n.parameters.styles)o.push(r);o.sort(function(t,e){return(t=n.parameters.styles[t]&&void 0!==n.parameters.styles[t].extrusion_height?parseFloat(n.parameters.styles[t].extrusion_height):0)-(e=n.parameters.styles[e]&&void 0!==n.parameters.styles[e].extrusion_height?parseFloat(n.parameters.styles[e].extrusion_height):0)}),x(z*ft.meters_per_pixel);var a=[],s={};void 0!==n.routing&&void 0!==n.routing.floors&&qt.each(n.routing.floors,function(t){s[t.name]=t}),t.querySelectorAll("svg>g[id^=floor]").forEach(function(t){var e=t.getAttribute("id").substr(5),r={};r.floor=e;var i=L.getFloor(r.floor);null===i&&(i=m(r.floor),L.scene.add(i.node),void 0!==s[r.floor]&&(i.heightMin=s[r.floor].zmin,i.heightMax=s[r.floor].zmax)),_t.queryChildren(t,"g[id^=vg-common-foreground]>g[id^=vg-model]").forEach(function(t){var e={thickness:0,offset:0,order:o.indexOf("vg-model")};qt.extend(e,n.parameters.styles["vg-model"]),e.thickness=parseFloat(e.extrusion_height),e.order=0,_t.queryChildren(t,"image").forEach(function(t){a.push({element:t,type:"vg-model",parameters:qt.extend({},e),layer_info:qt.extend({},r)})})}),_t.queryChildren(t,"g[id^=lod]").forEach(function(t){var e=t.getAttribute("id").substr(3);r.lod=parseInt(e,10),null===i.getLOD(r.lod)&&i.createLOD(r.lod),_t.queryChildren(t,"g").forEach(function(t){var e=t.getAttribute("id");r.type=e;var i={lod:0,thickness:0,offset:0,order:o.indexOf(e)};qt.extend(i,n.parameters.styles[e]),void 0!==i.footprint&&!0===i.footprint||(i.thickness=parseFloat(i.extrusion_height),i.order=0,_t.queryChildren(t,"*:not(.vghelper)").forEach(function(t){a.push({element:t,type:e,parameters:qt.extend({},i),layer_info:qt.extend({},r)})}))})})});function l(t,e){var i=t.element,r=t.type;if(n=(n=i.getAttribute("onabort"))&&JSON.parse(n),i.getAttribute("id")&&i.setAttribute("vg_id",i.getAttribute("id")),"vg-model"===r){!n||"fixed"!==n.vg_orientationType&&"fixed"!==n.vg_orientationtype?!n||"facing"!==n.vg_orientationType&&"facing"!==n.vg_orientationtype?i.setAttribute("vg_face2d","true"):i.setAttribute("vg_face2d","false"):i.setAttribute("vg_orientationType","fixed"),n&&void 0!==n.vg_model&&i.setAttribute("vg_model",n.vg_model);var r=t.layer_info,n=i.getAttribute("transform"),o=It.Transform.parse(n),a=null===i.getAttribute("x")?0:parseFloat(i.getAttribute("x")),s=null===i.getAttribute("y")?0:parseFloat(i.getAttribute("y")),n=parseFloat(i.getAttribute("width")),l=parseFloat(i.getAttribute("height")),c=new It.Point(a,s);o.multiplyVector(c),a=new It.Point(a+n,s+l),o.multiplyVector(a);var o=o.decompose(),n=n*Math.abs(o.sx),l=l*Math.abs(o.sy),c=P(c={x:(c.x+a.x)/2,y:(c.y+a.y)/2,z:0}),a=b(i.getAttribute("vg_id"),"VgID"),s=i.getAttribute("vg_model"),h="fixed"===i.getAttribute("vg_orientationType"),i=null===i.getAttribute("vg_face2d")||"true"===i.getAttribute("vg_face2d");L.addPOI({model:F+s,id:a,position:c,scale:{x:n*ft.meters_per_pixel,y:l*ft.meters_per_pixel,z:1},floor:r.floor,lod:r.lod,fixed:h,angle:o.angle,face2d:i,clickable:!(!a||null!==a.match(/^mapModel/)),track:!1})}else if("vg-image"===r)!n||"fixed"!==n.vg_orientationType&&"fixed"!==n.vg_orientationtype?!n||"facing"!==n.vg_orientationType&&"facing"!==n.vg_orientationtype?i.setAttribute("vg_face2d","true"):i.setAttribute("vg_face2d","false"):i.setAttribute("vg_orientationType","fixed"),r=t.layer_info,n=i.getAttribute("transform"),o=It.Transform.parse(n),c=L.layersParameters.sprite,s=null===i.getAttribute("x")?0:parseFloat(i.getAttribute("x")),h=null===i.getAttribute("y")?0:parseFloat(i.getAttribute("y")),n=parseFloat(i.getAttribute("width")),l=parseFloat(i.getAttribute("height")),a=new It.Point(s,h),o.multiplyVector(a),s=new It.Point(s+n,h+l),o.multiplyVector(s),o=o.decompose(),n*=Math.abs(o.sx),l*=Math.abs(o.sy),c=P(c={x:(a.x+s.x)/2,y:(a.y+s.y)/2,z:c.offset}),a=b(i.getAttribute("vg_id"),"VgID"),s=i.getAttribute("xlink:href"),h="fixed"===i.getAttribute("vg_orientationType"),i=null===i.getAttribute("vg_face2d")||"true"===i.getAttribute("vg_face2d"),L.addPOI({url:F+s,id:a,position:c,scale:{x:n*ft.meters_per_pixel,y:l*ft.meters_per_pixel,z:1},floor:r.floor,lod:r.lod,fixed:h,angle:o.angle,face2d:i,image:!0,clickable:!(!a||null!==a.match(/^mapIcon/)),track:!1});else if("vg-label"===r){n&&n.vg_legend&&i.setAttribute("vg_legend",n.vg_legend);var r=t.layer_info,c=i.querySelector("rect"),n=i.querySelector("text"),a=i.getAttribute("transform"),s=It.Transform.parse(a),h=L.layersParameters.sprite,u=null===c.getAttribute("x")?0:parseFloat(c.getAttribute("x")),p=null===c.getAttribute("y")?0:parseFloat(c.getAttribute("y")),l=parseFloat(c.getAttribute("width")),o=parseFloat(c.getAttribute("height")),d=new It.Point(u,p);s.multiplyVector(d),u=new It.Point(u+l,p+o),s.multiplyVector(u),s=s.decompose(),l*=Math.abs(s.sx),o*=Math.abs(s.sy),h=P(h={x:(d.x+u.x)/2,y:(d.y+u.y)/2,z:h.offset}),L.layersParameters.debugLabel.enabled&&(It.convertRectToPath(rect),c.getAttribute("fill","#ff0000"),c.getAttribute("transform",a),f(c,L.layersParameters.debugLabel,r)),a=b(i.getAttribute("vg_id"),"VgLabel"),Math.min(Math.abs(l),Math.abs(o)),c=null!==n?It.Parser.color(n.getAttribute("fill")):It.Parser.color(c.getAttribute("stroke")),d="",null!==n&&"true"===i.getAttribute("vg_legend")?d=b(n.text()):null===n&&i.getAttribute("vg_legend")&&(d=i.getAttribute("vg_legend")),L.addPOI({id:a,text:d,color:c,position:h,scale:{x:1,y:1,z:1},floor:r.floor,lod:r.lod,fixed:!0,angle:s.angle,width:l*ft.meters_per_pixel,height:o*ft.meters_per_pixel,flip:!0,clickable:!1})}else switch(i.localName){case"rect":It.convertRectToPath(i),f(i,t.parameters,t.layer_info);break;case"polygon":case"polyline":It.convertPolygonToPath(i),f(i,t.parameters,t.layer_info);break;case"ellipse":It.convertEllipseToPath(i),f(i,t.parameters,t.layer_info);break;case"circle":It.convertCircleToPath(i),f(i,t.parameters,t.layer_info);break;case"path":f(i,t.parameters,t.layer_info)}}var c=0,h=Math.ceil(a.length/100),u=0,p=function(){for(;;){var t=c;if(l.apply(L,[a[t],t]),u++,++c===a.length)return e(1),w();if(u===h)return u=0,e(c/a.length),Jt.resolve(p()).delay(0)}};return Jt.resolve(p()).delay(0)}function l(t,e){return Jt.resolve(t).tap(function(){e(.25,"map downloaded")}).delay(0).then(function(t){var e=new DOMParser;return Jt.resolve(e.parseFromString(t,"application/xml"))}).tap(function(){e(.5,"json parsed")}).delay(0).then(function(t){return i(t,e)}).catch(function(t){return Jt.reject(t)})}function c(e,t){e.progressHandler(0,"ajax request called, method: "+t);var i=0,r={progressCallBack:function(t){t.lengthComputable?e.progressHandler(t.loaded/t.total*.25):(i=Math.min(i+.0024,.24),e.progressHandler(i))}};return"jsonp"===t&&(r.crossDomain=!0),void 0!==e.mapName&&(L.mapName=e.mapName),_t.request(e.path,"GET",null,r)}function e(t){switch(ut=!1,dt=Date.now(),L.manipulatorTypeName){case"map":case"trackball":if(t.target!==N.domElement)break;qt.each(L.pois_with_selector,function(t,e){document.querySelector(t.selector).style["pointer-events"]="none"});var e=u(t);ct=t.button,h=e.x,ht=e.y}return!1}function p(t){return ut=!1,n(t)}function d(t){return ut=!1,n(t)}function n(t){var e;switch(0==ct&&0==t.button&&(e=u(t),L.onTapWithCenter(e,t)),L.manipulatorTypeName){case"map":case"trackball":qt.each(L.pois_with_selector,function(t,e){document.querySelector(t.selector).style["pointer-events"]="all"})}ct=-1}function M(t){ct=-1}function u(t){return void 0===t.offsetX?{x:t.layerX-t.target.offsetLeft,y:t.layerY-t.target.offsetTop}:{x:t.offsetX,y:t.offsetY}}function _(t){var u=[],e=new Kt.Vector3(t.x/L.viewportWidth*2-1,2*-(t.y/L.viewportHeight)+1,.5);if(e.unproject(L.camera),t=L.camera instanceof Kt.OrthographicCamera?((e=new Kt.Vector3(t.x/L.viewportWidth*2-1,2*-(t.y/L.viewportHeight)+1,1)).unproject(L.camera),(t=new Kt.Vector3(t.x/L.viewportWidth*2-1,2*-(t.y/L.viewportHeight)+1,-1)).unproject(L.camera),e.sub(t).normalize(),new Kt.Raycaster(t,e)):new Kt.Raycaster(L.camera.position,e.sub(L.camera.position).normalize()),e=[],O){for(var i=0,r=L.activeLODList.length;i<r;++i)e.push(L.activeLODList[i].node);t=t.intersectObjects(e,!0),qt.each(t,function(t,e){var i=!1,r=t.object;if(!1!==r.visible&&-1===Q.indexOf(r)){var n,o,a=r.parent.userData.pickables;if(void 0!==a)for(var s=0,l=a.length;s<l;++s){var c=a[s],h=!1;if(t.object.geometry instanceof Kt.Geometry?h=t.faceIndex>=c.faces_offset&&t.faceIndex<c.faces_offset+c.nb_faces:t.object.geometry instanceof Kt.BufferGeometry&&(h=t.faceIndex>=3*c.faces_offset&&t.faceIndex<3*(c.faces_offset+c.nb_faces)),h&&void 0!==(n=L.places[c.id])){o=c;break}}if(void 0===n)if(r.vg&&r.vg.batch)(r=r.vg.batch.getPickableFromIntersection(t))&&r.options.poi.clickable&&(n=r.publicObject,i=(o=r.options).poi.overlay);else if(void 0!==r&&void 0!==r.vg&&null!==r.vg.id&&r.vg.poi&&r.vg.poi.clickable){if(1===(n=L.pois[r.vg.id]).length)n=n[0];else for(s=0,l=n.length;s<l;s++)if(qt.isMatch(r.vg.poi,n[s].options())){n=n[s];break}o=r.vg,i=r.vg.poi.overlay}if(void 0===n)return!1;u.push({vg:o,target:n,distance:t.distance,overlay:i})}})}else{for(i=0,r=L.activeLODList.length;i<r;++i)e.push(L.activeLODList[i].pickables);e=e.concat.apply([],e),t=t.intersectObjects(e,!0),qt.each(t,function(t,e){var i,r,n=!1,o=t.object;if(!1!==o.visible&&-1===Q.indexOf(t.object)&&!(void 0===o.vg||void 0===o.vg.id&&void 0===o.vg.batch||null===o.vg.id||o.vg.poi&&!1===o.vg.poi.clickable)){if(r=o.vg,o.vg.batch)(a=o.vg.batch.getPickableFromIntersection(t))&&a.options.poi.clickable&&(i=a.publicObject,n=(r=a.options).poi.overlay);else if(void 0===(i=L.places[o.vg.id])){if(0===o.vg.poi._opacity)return;if(n=o.vg.poi.overlay,1===(i=L.pois[o.vg.id]).length)i=i[0];else for(var a=0,s=i.length;a<s;a++)if(qt.isMatch(o.vg.poi,i[a].options())){i=i[a];break}}void 0!==i&&u.push({vg:r,target:i,distance:t.distance,overlay:n})}})}return u.sort(function(t,e){return t.overlay===e.overlay?t.distance-e.distance:t.overlay?-1:1}),0<u.length?[u[0]]:[]}function A(t){if(ut){switch(L.manipulatorTypeName){case"map":case"trackball":if(t.target!==N.domElement)break;t.preventDefault();var e=u(t);if(L.trigger("mousemove",{event:t,position:e}),0!==ct)if(1===ct){if(L.manipulator.zoomManipulatorEnabled&&(L.manipulator.radius*=1+L.manipulator.zoomSpeed*(ht-e.y),L.manipulator.update(),!1!==L.customPostManipulatorListener&&!1===L.customPostManipulatorListener({type:"dragmiddle",center:e,event:t})))break}else if(2===ct){var i=!1;if(L.manipulator.pitchManipulatorEnabled&&(L.publicCamera.pitch+=L.manipulator.rotationSpeed*(e.y-ht),i=!0),L.manipulator.rotationManipulatorEnabled&&(L.publicCamera.rotation+=L.manipulator.rotationSpeed*(e.x-h),i=!0),i&&(L.manipulator.update(),!1!==L.customPostManipulatorListener&&!1===L.customPostManipulatorListener({type:"dragright",center:e,event:t})))break}else if(!1!==(i=_(e))){var r,n,o,a,s,l,c=Q.slice(0);for(r in Q=i,c){for(n in s=(o=c[r]).vg.id,l=!1,i)if(a=i[n],a=a.vg.id,s===a){l=!0;break}l||(s=o.vg,o=o.target,!(a=!0)!==(a=s.poi&&s.poi.onObjectMouseOut?s.poi.onObjectMouseOut(t,o,yt):a)&&void 0!==K&&K(t,o,yt))}for(n in i)a=i[n],s=a.vg,o=a.target,c=!0,s.poi&&s.poi.onObjectMouseOver&&(c=s.poi.onObjectMouseOver(t,o,yt)),!1!==c&&void 0!==Y&&Y(t,o,yt);yt++}h=e.x,ht=e.y}return!1}ut=!0}function E(t,e){if(void 0===e&&(t.wheelDeltaY?e=t.wheelDeltaY:t.wheelDelta?e=t.wheelDelta:t.detail&&(e=-t.detail),void 0===e&&window.event&&((t=window.event).wheelDeltaY?e=t.wheelDeltaY:t.wheelDelta?e=t.wheelDelta:t.detail&&(e=-t.detail))),!1===L.customPreManipulatorListener||!1!==L.customPreManipulatorListener({type:"wheel",delta:e})){switch(L.manipulatorTypeName){case"map":case"trackball":var i,r;t.preventDefault(),void 0!==e&&L.manipulator.zoomManipulatorEnabled&&(i=k.getBoundingClientRect(),i={left:t.clientX-i.left,top:t.clientY-i.top},positionBefore=L.convertScreenToPoint(i),L.manipulator.radius=0<e?.8*L.manipulator.radius:L.manipulator.radius/.8,L.manipulator.update(),"map"==L.manipulatorTypeName&&(i=L.convertScreenToPoint(i),r=L.publicCamera.position,L.publicCamera.position={x:positionBefore.x-i.x+r.x,y:positionBefore.y-i.y+r.y,radius:r.radius}))}if(!1===L.customPostManipulatorListener||!1!==L.customPostManipulatorListener({type:"wheel",delta:e}))return!1}}function S(t){return t.target!==N.domElement||t.preventDefault(),!1}function P(t){var e={};return e.x=(t.x-U)*ft.meters_per_pixel,e.y=(U-t.y)*ft.meters_per_pixel,void 0!==t.z&&(e.z=t.z),e}function T(t){var e={};return e.x=t.x/ft.meters_per_pixel+U,e.y=U-t.y/ft.meters_per_pixel,void 0!==t.z&&(e.z=t.z),e}function o(t,e,i,r,n,o){for(var a in void 0===t.initialValue&&(t.initialValue={}),e)n?t.initialValue[a]=t[a]:(void 0===t.initialValue[a]&&(t.initialValue[a]=t[a]),t[a]=e[a]);if(r=r||0,n)n=e;else for(var s in n={},e)void 0!==t.initialValue[s]&&(n[s]=t.initialValue[s]);if(0===i&&0===r){for(s in n)t[s]=n[s];"function"==typeof o&&o()}else t=new te.Tween(t).to(n,i).delay(r).start(),"function"==typeof o&&t.onUpdate(o)}function C(t,i,e,r){e=t.index<e.index?-1:1,e=lt.translate.clone().multiplyScalar(e);var n=r&&"number"==typeof r.animationDuration?r.animationDuration:lt.transitionTime;return o(t.node.position,{x:e.x,y:e.y,z:e.z},n,0,i,function(){t.node.updateMatrix(),t.node.updateMatrixWorld(!0)}),t.node.traverse(function(t){if(void 0!==t.material)if(t.material instanceof Kt.MeshFaceMaterial)for(var e in t.material.materials)o(t.material.materials[e],{opacity:0},n,0,i);else o(t.material,{opacity:0},n,0,i)}),new Jt(function(t,e){0===n?t():new te.Tween({dummy:0}).to({dummy:1},n).onComplete(function(){L.forcePoiUpdateOpacity||(L.forcePoiUpdateOpacity=!0,L.updateCameraObjects(),L.forcePoiUpdateOpacity=!1,L.requestRedraw()),t()}).start()})}var O=!(this.wireframe=!1);this.useDepthWriteForPOIs=!0;var L=this;this.pois={},this._anonymous_poi_counter=0,this.pois_with_selector=[],this.places_list={},this.polygons_table={},this.pofs_table={},this.pois_floor_table={},this.places={},this.plugins={},this.viewportHeight=this.viewportWidth=0,this.skybox=this.camera=this.scene=null,this.nbUpdatableObjects=0,this.mustUpdateCameraObjects=!1,this.textures={},this.models={},this.loaderStatistics={models:0,textures:0,pois:0},this.current_lod=2,this.currentFloorName="",this.currentFloor=null,this.activeLODList=[],this.manipulator=null,this.manipulatorTypeName="map",this.customPostManipulatorListener=this.customPreManipulatorListener=!1,this.globalCameraUpdatebleLinks=[],this.mapName=this.extraData=this.navigationSolver=this.routingSolver=!1,this.deferredPoiLoading={active:!1,setPlaceName:{},setPlaceIcon:{}},this.publicLodFactor=1,this.publicCamera=null,this.layersParameters={receiveShadow:{order:9},wall:{enabled:!0,order:10},debugLabel:{enabled:!1,order:87,offset:5.5,thickness:0},reflection:{order:89},sprite:{order:90,offset:2,scale:2},overlay:{order:91},global:{fog:{color:0,near:6500,far:7e3}}};var R=null,I=null,D=!1,F="",j="";this.logStatistics=!1,this.statistics=void 0;var N,k,z,U,V={fovX:45,fovY:45,near:1,far:7e3,update:function(t,e){var i,r;0!==t&&0!==e&&(i=.5*this.fovY*Mt.DEG2RAD,r=Math.tan(i)/e,this.projectedPixelSize=Math.tan(i)/e,this.cosFovY=Math.cos(i),this.fovX=2*Math.atan(r*t)*Mt.RAD2DEG)}},B=!1,H=!1,G=!0,W=!1;new Kt.Box3;var X=0,q=Date.now();this.plane_geometry=new Kt.PlaneBufferGeometry(1,1),this.plane_geometry.vg={permanent:!0};var t=void 0===Zt.vgcontinuous;t||(this.nbUpdatableObjects=1);var Y,K,J,Z=!1,Q=[],$=function(t,e,i){},tt=!1,et=[];this.floors=et;var it={};this.publicFloors=!1;var rt,nt,ot,at,st="",lt={translate:new Kt.Vector3(0,0,2048),opacity:!0,transitionTime:500},ct=-1,ht=h=0,ut=!1,pt=0,dt=0,ft={rotation_angle_in_degrees:0,meters_per_pixel:.2,geo_xref:0,geo_yref:0,utm_zone:1},mt=!1,gt=0,vt=0;this.initialize=function(t,n){for(var e in $t.available_plugins){var i=$t.available_plugins[e];this.plugins[i.name]=new i.factory(this)}k=t,this.viewportWidth=_t.getElementWidth(k),this.viewportHeight=_t.getElementHeight(k),this.vgbatchfacing=this.vgnobatchicon=this.vgnobatch=!1,void 0!==Zt.vgnobatch&&(this.vgnobatch=!0),void 0!==Zt.vgnobatchicon&&(this.vgnobatchicon=!0),void 0!==Zt.vgnobatchfacing&&(this.vgnobatchfacing=!0),void 0!==n.optimizations&&(void 0!==(e=n.optimizations).load1&&(G=!e.load1),void 0!==e.framerate1&&(W=e.framerate1),void 0!==e.nobatch&&(this.vgnobatch=e.nobatch)),st=n.initialFloorName||st,e={antialias:void 0===n.antialias||n.antialias,stencil:!1,alpha:!0,bugPixelStorei:n.bugPixelStorei,bugWP81:n.bugWP81,disable_console:void 0===n.disable_console||n.disable_console,useSkeleton:!1,recomputeCameraInverse:!1},Kt.ImageLoader.crossOrigin="",this.textureLoader=new Kt.TextureLoader,this.textureLoader.setCrossOrigin("");try{N=new Kt.WebGLRenderer(e)}catch(t){return Jt.reject(t)}return N&&N.setSize||Qt.log("bad"),(this.renderer=N).setSize(this.viewportWidth,this.viewportHeight),N.setPixelRatio(window.devicePixelRatio||1),k.innerHTML="",k.appendChild(N.domElement),(t=document.createElement("img")).src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",Kt.Texture.DEFAULT_IMAGE=t,this.scene=new Kt.Scene,this.clock=new Kt.Clock,this.scene.autoUpdate=!1,this.scene.matrixAutoUpdate=!1,this.scene.fog=!1,V.update(this.viewportWidth,this.viewportHeight),this.camera=void 0!==n.cameraType&&"orthographic"===n.cameraType?new Kt.OrthographicCamera(this.viewportWidth/-2,this.viewportWidth/2,this.viewportHeight/2,this.viewportHeight/-2,.1,2e4):new Kt.PerspectiveCamera(V.fovY,this.viewportWidth/this.viewportHeight,V.near,V.far),this.camera.matrixAutoUpdate=!1,this.camera.position.copy({x:0,y:0,z:300}),this.camera.updateMatrix(),this.scene.add(this.camera),this.manipulator=new Nt(this,this.camera),L.manipulator.update(),this.camera instanceof Kt.OrthographicCamera&&(this.publicCamera.pitch=-90,this.publicCamera.pitchManipulatorEnabled=!1,this.publicCamera.rotationManipulatorEnabled=!1),(e=new Kt.AmbientLight(4473924)).matrixAutoUpdate=!1,this.scene.add(e),(at=new Kt.DirectionalLight(16777215,1)).matrixAutoUpdate=!1,at.position.set(0,100,100),at.target.position.set(0,0,0),at.updateMatrix(),this.scene.add(at),J=n.onObjectMouseDown,Y=n.onObjectMouseOver,K=n.onObjectMouseOut,$=function(t,e,i){void 0!==L.logStatistics&&L.logStatistics&&void 0===e.vg.poi&&L.statistics.logStat("selectPlace",e);var r=!0;if(!1===(r=i&&i.onObjectMouseUp?i.onObjectMouseUp(t,e):r)||!1===L.trigger("mouseup",{event:t,element:e}))return!1;n.onObjectMouseUp&&n.onObjectMouseUp(t,e)},void 0===n.progressHandler&&(n.progressHandler=Xt),void 0!==n.path||void 0!==n.svg||void 0!==n.mapContentString?L.loadMap(n).then(function(){r(),L.trigger("initializeCompleted",void 0,!0),L.logStatisticsParameters=n,L.logStatistics&&void 0===L.statistics&&(L.statistics=new Gt(L)),void 0!==L.statistics&&L.statistics.setMapParameters(n)}).catch(function(t){return L.trigger("initializeFailed",void 0,!0),Jt.reject(t)}):Jt.reject(Error("missing .path or .mapContentString parameter"))},this.setSkybox=function(t){if(void 0!==t&&void 0!==t.type)switch(null!==this.skybox&&this.skybox.dispose(),this.skybox=new Lt(this),void 0!==t&&"number"==typeof t.fov&&this.skybox.setFov(t.fov),t.type){case"faces":this.skybox.initializeWithFaces(t.data);break;case"strip":this.skybox.initializeWithStrip(t.data);break;case"gradient":this.skybox.initializeWithGradient(t.data)}},this.synthesizeVenueLayout=function(){var t=100;if(void 0!==Zt.gap&&(t=parseFloat(Zt.gap)),0===(r=this.getFloors()).length)return Qt.log("ERROR: no floors found!"),!1;var e,i=[];for(e in r)i.push(r[e]);i.sort(function(t,e){return t.heightMin-e.heightMin});var r={config:{venue_layout:{buildings:{},defaultBuilding:"default",version:1,layer:""}}},n={defaultFloor:i[0].name,displayIndex:0,floors:{}},o={},a=0,s=0;for(e in i){var l=i[e];o[l.name]={layer:l.name,levelIndex:a,stackGap:t,stackHeightMax:l.heightMax-l.heightMin,stackHeightMin:0},0==(l.heightMax+l.heightMin)/2&&(n.defaultFloor=l.name,s=a),a++}if(0!=s)for(e in o)o[e].levelIndex-=s;return n.floors=o,r.config.venue_layout.buildings.default=n,r},this.setupMultiBuildingView=function(t){var e,i=this.getExtraData();if(!i||!i.config||!i.config.venue_layout){if(!1===(i=this.synthesizeVenueLayout()))return Qt.log("ERROR: no vg_venue_layout, mode not supported, you need data setup for multibuilding on map editor AND synthesizeVenueLayout failed."),!1;"multibuilding"===t.viewType&&(t.viewType="multifloor")}if(i&&i.resources){var r,n,o=[];for(n in"string"==typeof(r=window.navigator.userLanguage||window.navigator.language)&&(r=r.replace(/-.*/,""),o.push(r)),o.push("default"),o)if(r=o[n],i.resources[r]&&i.resources[r].localized&&1==i.resources[r].localized.version&&i.resources[r].localized.locale&&i.resources[r].localized.locale[r]&&i.resources[r].localized.locale[r].venueLayout){e=i.resources[r].localized.locale[r].venueLayout;break}}return this.multiBuildingView=new jt(this,i.config.venue_layout,e,t),this.cameraDrivenExplorer=new Ft(this.multiBuildingView),this.camera instanceof Kt.OrthographicCamera&&(this.multiBuildingView.globalModePitch=-90,this.multiBuildingView.buildingModePitch=-90,this.multiBuildingView.floorModePitch=-90),!0},this.setup=function(){this.animateBind=this.animate.bind(this),this.publicCamera=new Et(this)},this.getFloor=function(t){return void 0===(t=it[t])?null:t},this.setShapeColor=function(t,e){var i=(W?t.vg.layer.children[0]:t).geometry,r=t.vg.nb_faces,n=t.vg.faces_offset,o=t.vg.position.z,a=new Kt.Color(e),s=new Kt.Color(a);void 0!==t.vg.topRatio&&s.multiplyScalar(t.vg.topRatio);var l=new Kt.Color(a);if(void 0!==t.vg.bottomRatio&&l.multiplyScalar(t.vg.bottomRatio),i instanceof Kt.Geometry){for(var c=i.faces,h=["a","b","c"],u=n;u<n+r;++u){var p=c[u];if(0<p.vertexColors.length)for(var d=0;d<p.vertexColors.length;++d){var f=i.vertices[p[h[d]]];p.vertexColors[d]=f.z>o?s:f.z<o?l:a}else p.color=a}i.elementsNeedUpdate=!0}else if(i instanceof Kt.BufferGeometry){for(c=i.getAttribute("position"),i=i.getAttribute("color"),u=n;u<n+r;++u)for(h=d=3*u;h<d+3;h++)o<(p=c.getZ(h))?(i.setX(h,s.r),i.setY(h,s.g),i.setZ(h,s.b)):p<o?(i.setX(h,l.r),i.setY(h,l.g),i.setZ(h,l.b)):(i.setX(h,a.r),i.setY(h,a.g),i.setZ(h,a.b));i.needsUpdate=!0}},this.loadMap=function(i,r){var t=i.svg||i.mapContentString;if(void 0!==i.mapName&&(L.mapName=i.mapName),void 0!==i.mapContentDirectory&&(F=i.mapContentDirectory+"/"),"string"==typeof t)return(null!==t.match(/^</)?l:s)(t,i.progressHandler);i.path=i.path||"map.svg";var n="ajax";i.useJSONP&&(n="jsonp");function o(t){"//"!==(F=(t=t.match(/^(.*\/)[^\/]+$/))&&0<t.length?t[1]:F).substr(0,2)&&-1===F.indexOf("http://")&&-1===F.indexOf("https://")||-1===F.indexOf("/content/")||L.setRoutingURL(F.replace("/content/","/route"))}return o(i.path),null!==i.path.match(/.svg$/)?c(i,n).then(function(t){return l(t.response,i.progressHandler)}).catch(function(t){return"404"===t.message?(i.path=i.path.replace(".svg",".json"),c(i,n).then(function(t){return s(t.response,i.progressHandler)})):Jt.reject(t)}):c(i,n).then(function(t){var e=JSON.parse(t.response);return void 0!==e.maps?Ut.checkSlotDescription(e,i,{sdkType:["web","kiosk"],sdkVersion:L.version,minimumDataSDKVersion:L.minimumDataSDKVersion},r).tap(function(){i.progressHandler(0,"start download")}).delay(0).then(function(t){return o(t.path),c(t,n)}).then(function(t){return(-1!==e.maps[0].path.indexOf(".svg")?l:s)(t.response,i.progressHandler)}):Jt.resolve(e).tap(function(){i.progressHandler(.5,"json parsed")}).delay(0).then(function(t){return a(t,i.progressHandler)}).catch(function(t){return Jt.reject(t)})}).catch(function(t){return"404"===t.message&&null!==i.path.match(/map.json$/)?(i.path=i.path.replace(".json",".svg"),c(i,n).then(function(t){return l(t.response,i.progressHandler)}).catch(function(t){return Jt.reject(t)})):Jt.reject(t)})},this.unloadMap=function(){if(0===this.floors.length||!this.isLoaded())return!1;this.renderer.clear(),null!==this.skybox&&this.skybox.dispose();for(var t=Object.keys(this.pois),e=t.length-1;0<=e;e--)for(var i=this.pois[t[e]],r=i.length-1;0<=r;r--)i[r].remove();for(this.pois={},this._anonymous_poi_counter=0,this.pois_with_selector=[],this.pois_floor_table={},this.places={},this.places_list={},this.polygons_table={},this.pofs_table={},this.nbUpdatableObjects=0,e=(t=Object.keys(this.textures)).length-1;0<=e;e--)this.textures[t[e]].texture.dispose();for(this.textures={},e=(t=Object.keys(this.models)).length-1;0<=e;e--)Rt.removeModel(this,t[e]);for(this.models={},e=et.length-1;0<=e;e--)if(et[e].node.traverse(function(t){t instanceof Kt.Mesh&&t.geometry.dispose()}),this.scene.remove(et[e].node),et[e].tiledImages){for(t=0,i=et[e].tiledImages.length;t<i;++t)et[e].tiledImages[t].remove();et[e].tiledImages=[],delete et[e].tiledImages}return this.floors=et=[],this.publicFloors=null,this.currentFloorName="",this.currentFloor=null,this.activeLODList=[],this.navigationSolver=this.routingSolver=!1,void 0!==this.multiBuildingView&&null!==this.multiBuildingView&&(this.multiBuildingView.removeCallbacks(),this.multiBuildingView=null),void 0!==this.cameraDrivenExplorer&&null!==this.cameraDrivenExplorer&&(this.cameraDrivenExplorer.setEnabled(!1),this.cameraDrivenExplorer=null),!0};var yt=0;this.requestRedraw=function(){H&&(Z||!1!==B||(B=requestAnimationFrame(L.animateBind)))},this.requestContinuousUpdate=function(t){H&&(Z=t,!1===B&&(B=requestAnimationFrame(L.animateBind)))};function bt(t,e){var i=Math.sin(ft.rotation_angle_in_degrees*Math.PI/180),r=Math.cos(ft.rotation_angle_in_degrees*Math.PI/180),t=t-ft.pixel_xref,e=e-ft.pixel_yref;return[ft.meters_per_pixel*(t*r-e*i),ft.meters_per_pixel*(t*i+e*r)]}var xt;this.setAutoUpdateLOD=function(t){for(var e=0,i=et.length;e<i;e++)et[e].setAutoUpdateLOD(t)},this.forcePoiUpdateOpacity=!1,this._updateObjectOpacity=function(t,e){var n;t.vg.poi&&t.vg.poi.visibilityRampStartVisible&&t.vg.poi.visibilityRampFullyVisible&&t.vg.poi.visibilityRampStartInvisible&&t.vg.poi.visibilityRampFullyInvisible&&(n=L.computeOpacity(t.position,t.vg.poi,e),t.visible=0!=n&&!1!==t.vg.poi.visible,e=t.vg.poi._opacity,!this.forcePoiUpdateOpacity&&e===n||(t.vg.poi._opacity=n,t.traverse(function(t){if(t.material)if(void 0!==t.material.materials)for(var e=t.material.materials,i=0,r=e.length;i<r;++i)e[i].opacity=n;else if(void 0!==t.material.length)for(i=0,r=t.material.length;i<r;++i)t.material[i].opacity=n;else t.material.opacity=n;t.vg&&t.vg.poi&&t.vg.poi.selector&&(e=document.querySelector(t.vg.poi.selector),0===n||!1===t.vg.poi.visible?e.style.display="none":(e.style.opacity=n,e.style.display=""))})))},this.updateCameraObjects=function(){for(var t,e,i,r,n=0,o=et.length;n<o;n++){if((i=et[n]).isAutoUpdateLOD()&&i.isEnabled())for(var a=this.computeTargetLod(i.name),s=0,l=i.lods.length;s<l;s++)i.lods[s].setEnabled(s==a);if(i.isEnabled()&&i.tiledImages)for(s=0,l=i.tiledImages.length;s<l;++s)(r=i.tiledImages[s]).update();i.name==this.currentFloorName&&(this.current_lod=a)}for(n=0,o=L.activeLODList.length;n<o;++n){for(i=L.activeLODList[n],s=L.camera.position.clone(),i.node.worldToLocal(s),l=0,r=i.rampObjects.length;l<r;++l)a=i.rampObjects[l],this._updateObjectOpacity(a,s);for(s=0,l=i.cameraUpdatableObjects.length;s<l;++s)(a=i.cameraUpdatableObjects[s]).updateMatrix(),a.updateMatrixWorld();if(i.tiledImages)for(s=0,l=i.tiledImages.length;s<l;++s)(r=i.tiledImages[s]).update()}for(o=new Kt.Vector3,n=0,a=this.pois_with_selector.length;n<a;++n)(s=this.pois_with_selector[n]).selector&&(l=document.querySelector(s.selector),i=L.getFloor(s.floor),(i=void 0!==s.lod?i.getLOD(s.lod):i.floorContentLOD).isActive()&&i.isContentEnabled()&&s.visible?(o.copy(s.position),i=L.getFloor(s.floor).getPosition(),o.add(i),o.project(L.camera),1<o.z?l.style.display="none":(0===s._opacity&&(l.style.display=""),i=(o.x+1)/2*this.viewportWidth,r=(1-o.y)/2*this.viewportHeight,t=_t.getElementWidth(l),e=_t.getElementHeight(l),i+=t*(s.alignment.x-1)/2,r-=e*(s.alignment.y+1)/2,""!==l.textContent&&(i=Math.round(i),r=Math.round(r)),l.style.transform="translate("+i+"px,"+r+"px)",l.style["webkit-transform"]="translate("+i+"px,"+r+"px)")):(l.style.display="none",s._opacity=0));for(n=0,o=L.globalCameraUpdatebleLinks.length;n<o;++n)L.globalCameraUpdatebleLinks[n].updateCamerafacing()},this.removeLink=function(t){for(var e=0,i=L.globalCameraUpdatebleLinks.length;e<i;e++)if(L.globalCameraUpdatebleLinks[e]===t)return L.globalCameraUpdatebleLinks.splice(e,1),!0;return!1},this.addLink=function(t){this.globalCameraUpdatebleLinks.push(t)},this.removePath=function(t){var e=t.lod.pathObjects.indexOf(t);-1!==e&&t.lod.pathObjects.splice(e,1)},this.addActiveLOD=function(t){this.activeLODList.push(t)},this.removeActiveLOD=function(t){for(var e=0,i=L.activeLODList.length;e<i;e++)if(L.activeLODList[e]===t)return L.activeLODList.splice(e,1),!0;return!1},this.computeTargetLod=function(t){var e=0;if(null===R||I!==t){var i,r,n,o,a,s,l=this.getFloor(t).lods.length;if(R=[],I=t,ft.meters_per_pixel)for(ft.distance_coef||(ft.distance_coef=.5),!1===D&&(t=z,o=n=i=(r=bt(0,0))[0],s=a=r[1],i=(r=bt(0,t))[0],r=r[1],n=Math.min(n,i),a=Math.min(a,r),o=Math.max(o,i),s=Math.max(s,r),i=(r=bt(t,t))[0],r=r[1],n=Math.min(n,i),a=Math.min(a,r),o=Math.max(o,i),s=Math.max(s,r),i=(r=bt(t,0))[0],r=r[1],n=Math.min(n,i),a=Math.min(a,r),o=Math.max(o,i),s=Math.max(s,r),D=Math.max(o-n,s-a)),i=.5*D*ft.distance_coef,i/=1800*(t=Math.tan(.5*V.fovY*Mt.DEG2RAD)/this.viewportHeight),t=0;t<l-1;t++)R.push(i),i*=.5;else if(i=800,1<l)for(n=700/(l-1),t=0;t<l-1;t++)R.push(i-=n)}for(l=this.manipulator.radius/this.publicLodFactor,ft.meters_per_pixel&&(l=l*Math.sin(-this.publicCamera.pitch*Mt.DEG2RAD)*ft.meters_per_pixel),t=0,i=R.length;t<i&&l<R[t];++t)e++;return e},this.computeOpacity=(xt=new Kt.Vector3,function(t,e,i){return xt.copy(t),xt.sub(i),(t=xt.length())<e.visibilityRampStartVisible||t>e.visibilityRampFullyInvisible?0:t<e.visibilityRampFullyVisible?Kt.Math.mapLinear(t,e.visibilityRampStartVisible,e.visibilityRampFullyVisible,0,1):t<=e.visibilityRampStartInvisible?1:Kt.Math.mapLinear(t,e.visibilityRampFullyInvisible,e.visibilityRampStartInvisible,0,1)}),this.frameRate=this.frameCounter=0,this.frameRateRange=60,this.frameTimes=[],this.frameLastTime=0,this.frameRateDivider=1,navigator&&navigator.userAgent&&-1!=navigator.userAgent.indexOf("Windows Phone")&&(this.frameRateDivider=3),this.frameRateProbing=!1,this.frameTimeLastProbe=0,this.animate=function(t){if(B=!1,this.frameCounter++,!Z||!H||(B=requestAnimationFrame(L.animateBind),0==this.frameCounter%this.frameRateDivider)){L.mustUpdateCameraObjects&&(L.updateCameraObjects(),L.mustUpdateCameraObjects=!1);for(var e=0,i=L.activeLODList.length;e<i;++e)for(var r=L.activeLODList[e],n=0,o=r.pathObjects.length;n<o;++n)(t=r.pathObjects[n].mesh).vg.path&&t.material.map&&(t.material.map.offset.x=-X*t.vg.path.speed);this.render()}},this.postRenderListeners=[],this.postRenderListenersRemoveList=[],this.addPostRenderListener=function(t){this.postRenderListeners.push(t)},this.removePostRenderListener=function(t){for(var e=0,i=this.postRenderListeners.length;e<i;e++)if(this.postRenderListeners[e]===t)return this.postRenderListenersRemoveList.push(t),!0;return!1},this.render=function(){if(0<this.nbUpdatableObjects)for(var t,e=this.clock.getDelta(),i=0,r=L.activeLODList.length;i<r;++i)for(var n=L.activeLODList[i],o=0,a=n.animatedObjects.length;o<a;++o)(t=n.animatedObjects[o]).updateMatrixWorld(!0),t.vg.mixer.update(e);for(te.update(),document.body.contains(k)&&(N.autoClear=!1,N.clear(),null!==this.skybox&&this.skybox.render(),N.render(this.scene,this.camera)),X=(Date.now()-q)/1e3,i=0;i<this.postRenderListeners.length;i++)this.postRenderListeners[i]();for(L.trigger("redraw",void 0);0<this.postRenderListenersRemoveList.length;)for(e=this.postRenderListenersRemoveList.pop(),i=0,r=this.postRenderListeners.length;i<r;i++)if(this.postRenderListeners[i]===e){this.postRenderListeners.splice(i,1);break}},this.animateObject=o,this.getGeoinformation=function(){return ft},this.convertPointToScreen=function(t){return(t=new Kt.Vector3(t.x,t.y,t.z||0)).project(L.camera),{left:.5*this.viewportWidth*(t.x+1),top:.5*this.viewportHeight*(1-t.y)}},this.convertScreenToPoint=function(t,e){e=e||0;var i=new Kt.Vector3(2*t.left/L.viewportWidth-1,1-2*t.top/L.viewportHeight,1);if(i.unproject(L.camera),this.camera instanceof Kt.OrthographicCamera){var r=new Kt.Vector3(2*t.left/L.viewportWidth-1,1-2*t.top/L.viewportHeight,-1);if(r.unproject(L.camera),i.z==r.z)return{x:r.x,y:r.y,z:e};t=r.clone();return t.sub(i),t.multiplyScalar((r.z-e)/t.z),r.sub(t),{x:r.x,y:r.y,z:e}}return i=i.clone().sub(L.camera.position).normalize(),Math.abs(i.z)<.001?{x:(i=L.publicCamera.position).x,y:i.y,z:0}:(r=(L.camera.position.z-e)/-i.z,{x:(i=(i=i.clone().multiplyScalar(r)).add(L.camera.position)).x,y:i.y,z:i.z})},this.convertLatLonToPoint=function(t){if(!mt)return{x:0,y:0,z:1,valid:!1};t=new ee.Point([t.lon,t.lat]);var e={},i=(t={x:(t=ee.transform(rt,nt,t)).x-gt,y:t.y-vt}).x,r=t.y;return e.x=i*ft.matrixUTMToSVG.elements[0]+r*ft.matrixUTMToSVG.elements[1]+ft.matrixUTMToSVG.elements[4],e.y=i*ft.matrixUTMToSVG.elements[2]+r*ft.matrixUTMToSVG.elements[3]+ft.matrixUTMToSVG.elements[5],void 0!==t.z&&(e.z=t.z),e.z=2,P(e)},this.convertPointToLatLon=function(t){if(!mt)return{lat:0,lon:0,valid:!1};var e=(i=T(t)).x+ft.matrixSVGToUTM.elements[4],i=ft.matrixSVGToUTM.elements[5]-i.y;return t=new ee.Point([e*ft.matrixSVGToUTM.elements[0]+i*ft.matrixSVGToUTM.elements[1]+gt,e*ft.matrixSVGToUTM.elements[2]+i*ft.matrixSVGToUTM.elements[3]+vt,t.z||0]),{lat:(t=ee.transform(nt,rt,t)).y,lon:t.x}},this.offsetPosition=function(t,e,i,r){t=T(t),e=Math.PI*(e+ft.rotation_angle_in_degrees)/180,i=Math.PI*i/180,t.z=t.z||0;var n=r/ft.meters_per_pixel;return P(r={x:t.x+Math.sin(e)*Math.cos(i)*n,y:t.y-Math.cos(e)*Math.cos(i)*n,z:t.z+Math.sin(i)*r})},this.computeHeadingAngle=function(t,e,i){return t=zt._getVector(T(t)),e=zt._getVector(T(e)),i=zt._getVector(T(i)),e=zt._subVectors(e,t),t=zt._subVectors(i,t),e.z=0,(t.z=0)!=e.lengthSq()&&0!=t.lengthSq()&&zt._computeAngle(e.normalize(),t.normalize())},this.computeDistance=function(t,e){var i=zt._getVector(T(t)),r=zt._getVector(T(e)),e=(t.z||0)-(e.z||0);return(i=zt._subVectors(r,i)).z=0,i=i.length()*ft.meters_per_pixel,0==e?i:Math.sqrt(i*i+e*e)},this.initializeProjection=function(t){if(mt=!1,"string"!=typeof t.proj4string)return!1;var e=t.proj4string.replace(/\+proj=(\S+).*$/,"$1");return!!e.match(/utm|somerc|tmerc|lcc/)&&(rt=new ee.Proj("WGS84"),e=e.toUpperCase()+"00",ee.defs[e]=t.proj4string,nt=new ee.Proj(e),gt=parseFloat(t.offsetX)||0,vt=parseFloat(t.offsetY)||0,mt=!0)},this.textGenerator=new Bt,this.addPOI=function(t){return Rt.createPOI({container:k,_mapviewer:L,MapviewerPrivate:$t},t)},this.addTiledImages=function(t){new Wt(L.camera,t).add()},this.addRoutingPath=function(t){return!!(t=this.addRoutingPrivatePath(t))&&t.getPublicPath()},this.addRoutingPrivatePath=function(t){var e,i={};if(i.points=t.points,void 0===i.points||i.points.length<2)return!1;if(2===(e=i.points).length&&e[0].x===e[1].x&&e[0].y===e[1].y&&e[0].z===e[1].z)return!1;i.url=t.url,i.speed=void 0!==t.speed?t.speed:0,i.repeat=t.repeat||-1,i.overlay=void 0!==t.overlay?t.overlay:!L.useDepthWriteForPOIs,i.segments=t.segments||-1,i.thickness=void 0!==t.thickness?t.thickness:2,i.lod=t.lod,i.floor=t.floor||L.currentFloorName,i.visible=void 0===t.visible||t.visible,i.color=void 0!==t.color?t.color:16777215,i.opacity=void 0!==t.opacity?t.opacity:1,i.interpolationStart=t.interpolationStart||0,i.interpolationEnd=void 0===t.interpolationEnd?1:t.interpolationEnd,i.interpolationTextureLikeWindow=void 0===t.interpolationTextureLikeWindow||t.interpolationTextureLikeWindow,i.thickness<0&&(i.thickness*=-1),t=new Kt.CurvePath;var r,n=e.length;for(s=0;s<n;s++)e[s].z=e[s].z||0,e[s]=new Kt.Vector3(e[s].x,e[s].y,e[s].z);if(2===n)t.add(new Kt.LineCurve3(e[0],e[1]));else{var o=new Kt.Vector3,a=new Kt.Vector3,s=0;for(a.subVectors(e[s+1],e[s]).multiplyScalar(.5).add(e[s]),t.add(new Kt.LineCurve3(e[s],a.clone())),o.subVectors(e[s=1],e[s-1]),o.multiplyScalar(.5),o.add(e[s-1]),s=1;s<n-1;++s)a.subVectors(e[s+1],e[s]),a.multiplyScalar(.5),a.add(e[s]),t.add(new Kt.CubicBezierCurve3(o.clone(),e[s],e[s],a.clone())),o=a.clone();o.subVectors(e[(s=n-2)+1],e[s]),o.multiplyScalar(.5),o.add(e[s]),t.add(new Kt.LineCurve3(o,e[s+1]))}return e=t.getLength(),i.segments<0&&(i.segments=Math.ceil(-e/i.segments)),(o=i.repeat)<0&&(o*=-e/i.thickness),n=(s=new Ct(t,{segments:i.segments,radius:i.thickness,segmentsRadius:2,closed:!1,debug:!1,interpolationStart:i.interpolationStart,interpolationEnd:i.interpolationEnd,interpolationTextureLikeWindow:i.interpolationTextureLikeWindow,zOffset:$t.zOffsetPath})).geometry,a=new Kt.MeshBasicMaterial({color:i.color,opacity:i.opacity,wireframe:!1,transparent:!0,depthWrite:!1,depthTest:!i.overlay}),i.url?((r=new At(L,i.url,!1)).wrapS=Kt.RepeatWrapping,r.wrapT=Kt.RepeatWrapping,r.repeat.x=o,r.repeat.y=-1,a.map=r):i.speed=0,(o=new Kt.Mesh(n,a)).matrixAutoUpdate=!1,o.renderOrder=-(i.overlay?$t.renderDepthPathOverlay:$t.renderDepthPath)-n.vertices[0].z,o.doubleSided=!1,a=L.scene,(a=null!==(n=null===(n=L.getFloor(i.floor))?L.getFloor(L.currentFloorName):n)?(void 0!==i.lod?n.getLOD(i.lod):n.floorContentLOD).contentNode:a).add(o),o.updateMatrixWorld(!0),o.vg={path:i},t=new Tt(L,i,t,e,o,s,n.floorContentLOD),n.floorContentLOD.pathObjects.push(t),0!==i.speed&&i.visible&&L.incrementUpdatableObjects(),i.visible&&L.requestRedraw(),t},this.addRoutingLink=function(t){if(void 0===(t=t||{}).startPoint||void 0===t.endPoint)return!1;var e=L.getFloor(t.startFloor||L.currentFloorName);if(null===e)return!1;var i=L.getFloor(t.endFloor||L.currentFloorName);if(null===i)return!1;var r=e.getPosition(),n={x:t.startPoint.x,y:t.startPoint.y,z:t.startPoint.z||0},o=i.getPosition(),a={x:t.endPoint.x,y:t.endPoint.y,z:t.endPoint.z||0};return(!(t={floor:e.name,points:[n,{x:o.x-r.x+a.x,y:o.y-r.y+a.y,z:o.z-r.z+a.z}],segments:1,url:t.url,color:t.color,repeat:t.repeat,speed:t.speed,thickness:t.thickness,visible:t.visible,opacity:t.opacity,interpolationStart:t.interpolationStart,interpolationEnd:t.interpolationEnd,interpolationTextureLikeWindow:t.interpolationTextureLikeWindow,overlay:t.overlay}).points||2==t.points.length)&&(!(this.mustUpdateCameraObjects=!0)!==(t=this.addRoutingPrivatePath(t))&&(t.setLinkOptions({cameraFacing:!0,startFloor:e,endFloor:i,startPoint:n,endPoint:a}),this.addLink(t),t.getPublicLink()))},this.recreateAndUpdateMeshFromPathGeometry=function(t,e,i){i=void 0===i||i;var r=e.parent;r&&r.remove(e);var n=e.vg||{},o=e.doubleSided||!1,a=e.material;return e.geometry.dispose(),(e=new Kt.Mesh(t.clone(),a)).matrixAutoUpdate=!1,e.renderOrder=-(n.path.overlay?$t.renderDepthPathOverlay:$t.renderDepthPath),0<t.vertices.length&&(e.renderOrder+=t.vertices[0].z),e.vg=n,e.doubleSided=o,r&&(r.add(e),e.updateMatrixWorld(!0)),e.traverse(function(t){t.visible=i}),L.requestRedraw(),e},this.plugin=function(t){return this.plugins[t]},this.incrementUpdatableObjects=function(){++this.nbUpdatableObjects,this.requestContinuousUpdate(!0),t=!1},this.decrementUpdatableObjects=function(){0===this.nbUpdatableObjects?Qt.log("ERROR INTERNAL: decrementUpdatableObjects below 0"):(--this.nbUpdatableObjects,0===this.nbUpdatableObjects&&(this.requestContinuousUpdate(!1),t=!0))},this.computeRoute=function(a){return new Jt(function(i,e){if(void 0!==a&&void 0!==a.src&&void 0!==a.dst){var t={src:a.src,dst:a.dst};void 0!==L.logStatistics&&L.logStatistics&&L.statistics.logStat("routing",t);var r,n=["computeNavigation","language","routingParameters","navigationParameters"];for(r in n){var o=n[r];void 0!==a[o]&&(t[o]=a[o])}t.version=this.version,t.sdk="VisioWeb","#javascript"===L.getRoutingURL()&&!1!==this.routingSolver?((t=this.routingSolver.computeRoute(a)).sdkVersion=L.version,t.routingServerVersion="javascript",200===t.status&&a.computeNavigation&&!1!==this.navigationSolver&&(t.navigation=this.navigationSolver.computeNavigation(t,a.navigationParameters)),i({request:a,data:t})):(a.src===a.dst&&e(Error("routeRequest invalid, src same as dst")),_t.request(j,"GET",t,{crossDomain:!0}).then(function(t){var e=JSON.parse(t.response);Qt.log(t),i({request:a,data:e})}).catch(function(t){e(t)}))}else e(Error("routeRequest invalid, maybe missing src or dst"))}.bind(this)).tap(function(t){L.trigger("routeComputed",{request:t.request,data:t.data})}).then(function(t){return void 0!==a.success&&a.success(t),t}).catch(function(t){throw void 0!==a.error&&a.error(),t})},this.getRoutingModalities=function(){return!1!==L.routingSolver&&"#javascript"===L.getRoutingURL()&&L.routingSolver.getModalities()},this.getRoutingAttributes=function(){return!1!==L.routingSolver&&"#javascript"===L.getRoutingURL()&&L.routingSolver.getAttributes()},this.getRoutingNode=function(t,e){return!1!==L.routingSolver&&"#javascript"===L.getRoutingURL()?L.routingSolver.getRoutingNode(t,e):t},this.getLoaderStatistics=function(){return this.loaderStatistics.requestRedraw=!1!==B,this.loaderStatistics},this.isLoaded=function(){return 0==this.loaderStatistics.models&&0==this.loaderStatistics.textures},this.queryNearPlaces=function(t,e){return!1!==L.routingSolver&&"#javascript"===L.getRoutingURL()?L.routingSolver.queryNearPlaces(t,e):[]},this.start=function(){H=!0,t?L.requestRedraw():L.requestContinuousUpdate(!0)},this.stop=function(){H=!1},this.getFloors=function(){if(!this.publicFloors){this.publicFloors=[];for(var t=0,e=et.length;t<e;t++)this.publicFloors.push(et[t].getPublicFloor());for(this.publicFloors.sort(function(t,e){return void 0!==t.heightMin&&void 0!==t.heightMax&&void 0!==e.heightMin&&void 0!==e.heightMax?t.heightMax+t.heightMin-(e.heightMax+e.heightMin):0}),t=0,e=this.publicFloors.length;t<e;t++)this.publicFloors[t].index=t}return this.publicFloors},this.setPlaceName=function(t,e){this.deferredPoiLoading.active&&(this.deferredPoiLoading.setPlaceName[t]=e);var i=this.pois[t];if(void 0!==i)for(var r in void 0===e?e={text:""}:"string"==typeof e&&(e={text:e}),i){r=i[r];r.options("image")||r.options("model")||r.options(e)}},this.setPlaceIcon=function(t,e){this.deferredPoiLoading.active&&(this.deferredPoiLoading.setPlaceIcon[t]=e);var i=this.pois[t];if(void 0!==i)for(var r in void 0===e?e={url:""}:"string"==typeof e&&(e={url:e}),i){r=i[r];r.options("image")||r.options("model")||r.options(e)}},this.getPlace=function(t){return void 0!==this.places[t]&&this.places[t]},this.isInside2D=function(t,e){return Mt.isInside2D(t,e)},this.isInsideFootprint=function(e,t){t=this.getFootprint(t);return!!t&&("number"==typeof t.length?t.some(function(t){return this.isInside2D(e,t.points)},this):this.isInside2D(e,t.points))},this.getFootprint=function(t){if(void 0!==(r=this.publicFootprintsTable[t]))return r;if(void 0!==this.polygons_table[t]&&0<this.polygons_table[t].length){var e=(r=this.pois_floor_table[t])?r.floorName:void 0,i=this.polygons_table[t];if(1<i.length)for(var r=[],n=0;n<i.length;n++){for(var o,a=i[n].points.split(/,/),s=[],l=0,c=a.length;l<c;++l)o=a[l].split(/ /),s.push(P({x:parseFloat(o[0]),y:parseFloat(o[1])}));r.push({id:t,points:s,floor:e})}else{for(s=[],c=(a=i[l=0].points.split(/,/)).length;l<c;++l)o=a[l].split(/ /),s.push(P({x:parseFloat(o[0]),y:parseFloat(o[1])}));r={id:t,points:s,floor:e}}return this.publicFootprintsTable[t]=r}return!1},this.publicFootprintsTable={},this.publicFootprintsTableInitialized=!1,this.getFootprintPoints=function(t){return"number"==typeof(t=this.getFootprint(t)).length?(points=[],t.forEach(function(t){points.push.apply(points,t.points)}),points):t.points},this.getFootprints=function(){if(!this.publicFootprintsTableInitialized){for(id in this.polygons_table)this.getFootprint(id);this.publicFootprintsTableInitialized=!0}return this.publicFootprintsTable},this.publicPOFTable={},this.publicPOFTableInitialized=!1,this.getPOF=function(t){if(e=this.publicPOFTable[t])return e;if(void 0===this.pofs_table[t])return!1;var e=this.pofs_table[t],i=P({x:parseFloat(e.x),y:parseFloat(e.y)}),r=this.pois_floor_table[t],e={id:t,x:i.x,y:i.y,height:e.height,headingInDegrees:e.headingInDegrees,floor:r?r.floorName:void 0};return this.publicPOFTable[t]=e},this.getPOFs=function(){if(!this.publicPOFTableInitialized){for(id in this.pofs_table)this.getPOF(id);this.publicPOFTableInitialized=!0}return this.publicPOFTable},this.getPlaces=function(){return this.places},this.setPlaceColor=function(t,e){return!(!t||!t.setColor)&&t.setColor(e)},this.resetPlaceColor=function(t){var e=!1;if(void 0===t||!1===t)return e;if(t instanceof Array)for(var i in t)t[i].resetColor&&(t[i].resetColor(),e=!0);else t.resetColor&&(e=t.resetColor());return e},this.getRoutingURL=function(){return j},this.setRoutingURL=function(t){j=t},this.changeFloor=function(t,e){if(void 0===t)return Jt.reject();if(this.currentFloorName===t)return Jt.resolve();if(!1===L.trigger("floorWillChange",{current:L.currentFloorName,target:t}))return Jt.reject();var i=L.currentFloorName,r=this.currentFloor,n=r.getLOD(L.current_lod);if(!n||tt)return Jt.reject();var o=this.getFloor(t),a=this.computeTargetLod(t),s=o.getLOD(a);if(null===s&&0!==o.lods.length)for(var l in o.lods){a=l,s=o.lods[l];break}return tt=!0,L.incrementUpdatableObjects(),C(r,!0,o,e).then(function(){return r.setEnabled(!1),n.setEnabled(!1),o.setEnabled(!0),s.setEnabled(!0),L.currentFloorName=t,L.currentFloor=o,L.current_lod=a,L.mustUpdateCameraObjects=!0,C(o,!1,r,e)}).then(function(){L.mustUpdateCameraObjects=!0,L.decrementUpdatableObjects(),L.requestRedraw(),tt=!1,L.trigger("floorChanged",{current:i,target:t})})},this.resize=function(t,e){return this.resizeInternal(t,e,!0)},this.resizeInternal=function(t,e,i){this.viewportWidth=t,this.viewportHeight=e,V.update(this.viewportWidth,this.viewportHeight),void 0!==z&&void 0!==ft&&x(z*ft.meters_per_pixel,!0);var r=this.camera;return r.aspect=this.viewportWidth/this.viewportHeight,r instanceof Kt.OrthographicCamera?(r.left=this.viewportWidth/-2,r.right=this.viewportWidth/2,r.top=this.viewportHeight/2,r.bottom=this.viewportHeight/-2,this.orthographicNormalizedZoom=r.aspect<1?this.viewportWidth/this.sideInMeters:this.viewportHeight/this.sideInMeters):r.fov=V.fovY,null!==this.skybox&&this.skybox.update(V.fovY,r.aspect),r.updateProjectionMatrix(),L.manipulator.update(),N.setSize(this.viewportWidth,this.viewportHeight),N.domElement.style.width=this.viewportWidth,N.domElement.style.height=this.viewportHeight,R=null,L.requestRedraw(),this.trigger("resize",{mapWidth:t,mapHeight:e},!0),i&&this.render(),!0},this.getCurrentFloor=function(){return this.currentFloorName},this.getViewpointFromPositions=function(t){var e=t.top||0,i=t.bottom||0,r=t.left||0,n=t.right||0,o=t.points;if(void 0===o||!o.length)return!1;var a,s,l="number"==typeof t.pitch,c="number"==typeof t.heading;l&&(a=this.publicCamera.pitch,this.publicCamera.pitch=t.pitch),c&&(s=this.publicCamera.heading,this.publicCamera.heading=t.heading),t=!1,(l||c)&&(t=function(){l&&(this.publicCamera.pitch=a),c&&(this.publicCamera.heading=s)}.bind(this));var h,u,p=new Kt.Vector3(L.camera.matrix.elements[0],L.camera.matrix.elements[1],L.camera.matrix.elements[2]),d=new Kt.Vector3(L.camera.matrix.elements[4],L.camera.matrix.elements[5],L.camera.matrix.elements[6]),f=new Kt.Vector3(L.camera.matrix.elements[8],L.camera.matrix.elements[9],L.camera.matrix.elements[10]),m=.5*L.viewportWidth,g=m/(C=.5*L.viewportHeight),v=Math.tan(Kt.Math.degToRad(.5*L.camera.fov)),y=v*(C-e)/C,b=-v*(C-i)/C,x=(g=v*g)*(m-n)/m,w=-g*(m-r)/m;for(O in g=.5*(y+b),v=.5*(x+w),h=y-b,u=x-w,this.helpers)L.scene.remove(this.helpers[O]);if(this.helpers=[],1===o.length)return void 0===(f=o[0])||void 0===f.x||void 0===f.y?(t&&t(),!1):(p=L.convertScreenToPoint({left:m+.5*(r-n),top:C+.5*(e-i)},f.z||0),d=L.publicCamera.position,f={x:f.x-p.x+d.x,y:f.y-p.y+d.y,radius:d.radius},t&&t(),f);for(var M,_,A,E,S,P=new Kt.Vector3(o[0].x,o[0].y,o[0].z||0),T=P.clone(),C=-f.dot(new Kt.Vector3(o[0].x,o[0].y,o[0].z||0)),O=1,R=o.length;O<R;++O)m=o[O],P.x=Math.max(P.x,m.x),P.y=Math.max(P.y,m.y),P.z=Math.max(P.z,m.z||0),T.x=Math.min(T.x,m.x),T.y=Math.min(T.y,m.y),T.z=Math.min(T.z,m.z||0),C=Math.min(C,-f.dot(new Kt.Vector3(o[O].x,o[O].y,o[O].z||0)));if((m=new Kt.Vector3).addVectors(T,P),m.multiplyScalar(.5),m=m.sub(f.clone().multiplyScalar(C+f.dot(m))),(C=new Kt.Vector3(o[0].x,o[0].y,o[0].z||0)).sub(m),P.x-T.x<1e-6&&P.y-T.y<1e-6&&P.z-T.z<1e-6)return f=this.getViewpointFromPositions({points:[o[0]],top:e,bottom:i,left:r,right:n}),t&&t(),f;if(L.camera instanceof Kt.OrthographicCamera)return t&&t(),t=Math.max(P.x-T.x,P.y-P.y),{x:m.x,y:m.y,radius:this.manipulator.wholeRadius*t/this.sideInMeters};for(M=C.dot(f),S=R=C.dot(d),T=P=C.dot(p),R+=M*y,S+=M*b,P+=M*x,T+=M*w,n=i=e=r=0,O=1;O<o.length;++O)(C=new Kt.Vector3(o[O].x,o[O].y,o[O].z||0)).sub(m),M=C.dot(f),A=_=C.dot(d),E=C=C.dot(p),R<(_+=M*y)&&(R=_,r=O),(A+=M*b)<S&&(S=A,e=O),(E+=M*w)<T&&(T=E,n=O),P<(C+=M*x)&&(P=C,i=O);return O=.5*(R+S),y=.5*(P+T),(u=(P-T)/u)<(h=(R-S)/h)?(u=h,O=m.clone().add(d.clone().multiplyScalar(O-u*g)).add(p.clone().multiplyScalar(y-u*v)).add(f.clone().multiplyScalar(u)),d=new Kt.Vector3(o[n].x,o[n].y,o[n].z).sub(O.clone().sub(f.clone().multiplyScalar(u))),g=new Kt.Vector3(o[i].x,o[i].y,o[i].z).sub(O.clone().sub(f.clone().multiplyScalar(u))),o=u-d.dot(f),u-=g.dot(f),d=((d=d.dot(p))*u+(g=g.dot(p))*o-2*v*o*u)/(o+u),O.add(p.clone().multiplyScalar(d))):(O=m.clone().add(d.clone().multiplyScalar(O-u*g)).add(p.clone().multiplyScalar(y-u*v)).add(f.clone().multiplyScalar(u)),p=new Kt.Vector3(o[r].x,o[r].y,o[r].z).sub(O.clone().sub(f.clone().multiplyScalar(u))),v=new Kt.Vector3(o[e].x,o[e].y,o[e].z).sub(O.clone().sub(f.clone().multiplyScalar(u))),o=u-p.dot(f),u-=v.dot(f),p=((p=p.dot(d))*u+(v=v.dot(d))*o-2*g*o*u)/(o+u),O.add(d.clone().multiplyScalar(p))),p=O.z/f.z,f=f.clone().multiplyScalar(O.z/f.z),O.sub(f),t&&t(),{x:O.x,y:O.y,radius:p}},this.notifications=new Ht,this.on=function(t,e){return this.notifications.on(t,e,!1)},this.once=function(t,e){return this.notifications.on(t,e,!0)},this.off=function(t,e){return this.notifications.off(t,e)},this.trigger=function(t,e,i){return this.notifications.trigger(t,e,i)},this.animateValue=function(e,i,t){var r,n,o,a,s;if(void 0!==t)return e=parseFloat(e),i=parseFloat(i),t.duration=void 0!==t.duration?t.duration:1e3,"number"==typeof t.duration&&(r=new te.Tween(e).to(i,t.duration),L.incrementUpdatableObjects(),"function"==typeof t.step&&r.onUpdate((s=t.step,function(t){s(e+t*(i-e))})),r.onComplete((a=t.complete,function(){var t;L.decrementUpdatableObjects(),r.onStop(null),"function"==typeof a&&(t=function(){setTimeout(function(){a()},0),L.removePostRenderListener(t)},L.addPostRenderListener(t),L.requestRedraw())})),r.onStop((o=t.stop,function(){L.decrementUpdatableObjects(),r.onStop(null),"function"==typeof o&&o()})),r.start(),n=r,{stop:function(){n.stop()},repeat:function(t){n.repeat(t)},yoyo:function(t){n.yoyo(t)}})},this.cameraNorthRotation=!1,Object.defineProperty(this,"isAccelerated",{get:function(){return!0}}),Object.defineProperty(this,"version",{get:function(){return"1.8.11"}}),Object.defineProperty(this,"minimumDataSDKVersion",{get:function(){return"1.4.0"}}),Object.defineProperty(this,"sdkType",{get:function(){return"web"}}),Object.defineProperty(this,"revision",{get:function(){return"9200359"}}),this.getExtraData=function(){return this.extraData},this.getMapName=function(){return this.mapName},this.getPOIs=function(){return qt.extend({},this.pois)},this.getPOI=function(t){return this.pois[t]},this.getLogStatistic=function(){return this.logStatistics},this.setLogStatistic=function(t){(this.logStatistics=t)?(void 0===this.statistics&&(this.statistics=new Gt(L)),this.statistics.setMapParameters(this.logStatisticsParameters)):this.statistics=void 0},this.getLogStatisticURL=function(){return this.statistics.getURL()},this.setLogStatisticURL=function(t){this.statistics.setURL(t)},this.getLogStatisticAppID=function(){return this.statistics.getAppID()},this.setLogStatisticAppID=function(t){this.statistics.setAppID(t)},this.setup()};return $t.available_plugins=[],$t.zOffsetPOI=.1,$t.zOffsetPath=.1,$t.renderDepthPOIOverlay=-4e5,$t.renderDepthPathOverlay=-3e5,$t.renderDepthPath=-2e5,$t.renderDepthPOIFacing=-15e4,$t.renderDepthPOI=-1e5,$t}),mt("com/visioglobe/web/Mapviewer",["com/visioglobe/web/MapviewerPrivate","underscoretiny"],function(t,e){return function(){var n=new t,o={initialize:!0,setSkybox:!0,start:!0,stop:!0,loadMap:!0,unloadMap:!0,getFloors:!0,setPlaceName:!0,setPlaceIcon:!0,getPlace:!0,getPlaces:!0,getPOI:!0,getPOIs:!0,setPlaceColor:!0,resetPlaceColor:!0,computeRoute:!0,getRoutingURL:!0,setRoutingURL:!0,changeFloor:!0,resize:!0,getCurrentFloor:!0,getExtraData:!0,getMapName:!0,getRoutingAttributes:!0,getRoutingModalities:!0,getRoutingNode:!0,queryNearPlaces:!0,getViewpointFromPositions:!0,convertLatLonToPoint:!0,convertPointToLatLon:!0,offsetPosition:!0,computeHeadingAngle:!0,computeDistance:!0,initializeProjection:!0,addPOI:!0,addRoutingPath:!0,addRoutingLink:!0,convertScreenToPoint:!0,convertPointToScreen:!0,addPostRenderListener:!0,removePostRenderListener:!0,plugin:!0,isInside2D:!0,isInsideFootprint:!0,getFootprint:!0,getFootprintPoints:!0,getFootprints:!0,getPOF:!0,getPOFs:!0,setAutoUpdateLOD:!0,on:!0,once:!0,off:!0,trigger:!0,animateValue:!0,getLoaderStatistics:!0,isLoaded:!0,requestRedraw:!0,getLogStatistic:!0,setLogStatistic:!0,getLogStatisticURL:!0,setLogStatisticURL:!0,getLogStatisticAppID:!0,setLogStatisticAppID:!0,setupMultiBuildingView:!0};return Object.defineProperty(this,"lodFactor",{get:function(){return n.publicLodFactor},set:function(t){t<=0||(n.publicLodFactor=t,n.manipulator.update())}}),Object.defineProperty(this,"multiBuildingView",{get:function(){return void 0!==n.multiBuildingView&&n.multiBuildingView.publicMultiBuildingView}}),Object.defineProperty(this,"cameraDrivenExplorer",{get:function(){return void 0!==n.cameraDrivenExplorer&&n.cameraDrivenExplorer.publicCameraDrivenExplorer}}),Object.defineProperty(this,"camera",{get:function(){return n.publicCamera}}),Object.defineProperty(this,"cameraNorthRotation",{get:function(){return n.cameraNorthRotation}}),Object.defineProperty(this,"isAccelerated",{get:function(){return n.isAccelerated}}),Object.defineProperty(this,"version",{get:function(){return n.version}}),Object.defineProperty(this,"minimumDataSDKVersion",{get:function(){return n.minimumDataSDKVersion}}),Object.defineProperty(this,"sdkType",{get:function(){return n.sdkType}}),Object.defineProperty(this,"revision",{get:function(){return n.revision}}),Object.defineProperty(this,"frameRateDivider",{get:function(){return n.frameRateDivider},set:function(t){t<=0||(n.frameRateDivider=t)}}),Object.keys(o).forEach(function(t){var e,i,r;void 0!==n[t]&&(r=o[t],(e=this)[i=t]=!0!==r?function(){return r.apply(e,arguments)}:function(){return n[i].apply(n,arguments)})},this),this}}),mt("text!com/visioglobe/web/shaders/gradient.frag",[],function(){return"uniform vec3 spots[NB_SPOTS];varying vec3 vPos;uniform vec4 gradient[NB_GRADIENTS];float a(float b,float c,float d,float e,float f){return e+(b-c)*(f-e)/(d-c);}vec3 g(float h){h=clamp(h,gradient[0].w,gradient[NB_GRADIENTS-1].w);vec3 i;for(int j=0;j<NB_GRADIENTS-1;++j){if(h>=gradient[j].w&&h<=gradient[j+1].w){h=a(h,gradient[j].w,gradient[j+1].w,0.0,1.0);vec3 k=gradient[j].xyz;vec3 l=gradient[j+1].xyz;i=mix(k,l,h);}}return i;}void main(){vec2 m=vPos.xy;float n=0.0;float o[NB_SPOTS];for(int j=0;j<NB_SPOTS;++j){vec2 p=spots[j].xy-m;float q=sqrt(p.x*p.x+p.y*p.y);float r=1.0/pow(q,1.0);n+=r;o[j]=r*spots[j].z;}float s=0.0;for(int j=0;j<NB_SPOTS;++j){s+=o[j]/n;}vec3 i=g(s);gl_FragColor=vec4(i.rgb,1.0);}"}),mt("text!com/visioglobe/web/shaders/gradient.vert",[],function(){return"varying vec3 vPos;void main(){vPos=position;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}"}),mt("com/visioglobe/web/plugins/GradientPlugin",["com/visioglobe/web/MapviewerPrivate","text!com/visioglobe/web/shaders/gradient.frag","text!com/visioglobe/web/shaders/gradient.vert","three"],function(t,a,l,c){t.available_plugins.push({name:"gradient",factory:function(s){function e(){Object.keys(this.parameters.gradient).forEach(function(t){var e=new c.Color(this.parameters.gradient[t].value);o.push(new c.Vector4(e.r,e.g,e.b,this.parameters.gradient[t].parameter))},this)}var n={},o=[];this.initialize=function(t){console.log("Running gradient plugin"),this.parameters=t,this.inverse_lookup={},Object.keys(this.parameters.spots_lookup).forEach(function(e){var i=this.parameters.spots_lookup[e];Object.keys(i).forEach(function(t){this.inverse_lookup[i[t].id]={id:e}},this)},this),e.apply(this);Object.keys(this.parameters.spots_lookup).forEach(function(t){var r=this.parameters.spots_lookup[t],e=s.places_list[t];void 0!==e&&Object.keys(e).forEach(function(t){t=e[t];var i=[];Object.keys(r).forEach(function(t){t=r[t].id;var e=s.pois[t];void 0!==e&&1===e.length&&(e=(e=e[0]).options("position"),this.inverse_lookup[t].index=i.length,i.push(new c.Vector3(e.x,e.y,0)))},this),1===r.length?t.material.vertexColors=c.NoColors:1<r.length&&(t.material=function(t){if(void 0!==n[t])return n[t];var e=new c.ShaderMaterial({defines:{NB_SPOTS:t,NB_GRADIENTS:o.length},uniforms:{spots:{type:"v3v",value:[]},gradient:{type:"v4v",value:o}},depthWrite:!0,vertexShader:l,fragmentShader:a});return n[t]=e}(i.length).clone(),t.material.uniforms.gradient.value=o,t.material.uniforms.spots.value=i)},this)},this),void 0!==this.parameters.spots&&this.updateSpots(this.parameters.spots),s.requestRedraw()},this.updateSpots=function(a){return void 0!==this.inverse_lookup&&(Object.keys(a).forEach(function(i){var t,r,n,o=this.inverse_lookup[i];void 0!==o&&(t=o.id,r=this.parameters.spots_lookup[t].length,void 0!==(n=s.places_list[t])&&Object.keys(n).forEach(function(t){var e;t=n[t],1===r?(e=function(t,e){t=c.Math.clamp(t,e[0].parameter,e[e.length-1].parameter);for(var i=0;i<e.length-1&&!(t<=e[i+1].parameter);)++i;t=c.Math.mapLinear(t,e[i].parameter,e[i+1].parameter,0,1);var r=new c.Color(e[i].value),i=new c.Color(e[i+1].value);return r.lerp(i,t)}(parseFloat(a[i].value),this.parameters.gradient),void 0!==a[i].duration&&0<a[i].duration?(s.incrementUpdatableObjects(),new te.Tween(t.material.color).to(e,parseFloat(a[i].duration)).onComplete(function(){s.decrementUpdatableObjects()}).start()):t.material.color.copy(e)):1<r&&(void 0!==a[i].duration&&0<a[i].duration?(s.incrementUpdatableObjects(),new te.Tween(t.material.uniforms.spots.value[o.index]).to({z:parseFloat(a[i].value)},parseFloat(a[i].duration)).onComplete(function(){s.decrementUpdatableObjects()}).start()):t.material.uniforms.spots.value[o.index].z=parseFloat(a[i].value))},this))},this),s.requestRedraw(),!0)},this.updateGradient=function(t){this.parameters.gradient=t,o.splice(0,o.length),e.apply(this),Object.keys(n).forEach(function(t){n[t].defines.NB_GRADIENTS=o.length}),Object.keys(this.parameters.spots_lookup).forEach(function(t){var e=this.parameters.spots_lookup[t],i=s.places_list[t];void 0!==i&&Object.keys(i).forEach(function(t){t=i[t],1!==e.length&&(t.material.needsUpdate=!0)},this)},this),s.requestRedraw()}}})}),mt("com/visioglobe/web/plugins/IconsPlugin",["com/visioglobe/web/MapviewerPrivate","com/visioglobe/web/helpers/CachedTexture"],function(t,i){t.available_plugins.push({name:"icons",factory:function(e){this.loadAsset=function(t){new i(e,t,!0)}}})}),mt("com/visioglobe/web/plugins/PoiPlugin",["com/visioglobe/web/MapviewerPrivate"],function(t){t.available_plugins.push({name:"poi",factory:function(e){this.getPois=function(){return e.getPois()},this.getPoi=function(t){return e.getPoi(t)}}})});var Y,l=l||{};return(Y=new function(){var t=0,e=document.createEvent("Event");e.initEvent("mapviewerready",!0,!0),this.wait=function(){++t},this.go=function(){0===--t&&document.dispatchEvent(e)}}).wait(),document.onreadystatechange=function(){"complete"===document.readyState&&Y.go()},Y.wait(),t(["com/visioglobe/web/plugins/GradientPlugin"],function(){Y.go()}),Y.wait(),t(["com/visioglobe/web/plugins/IconsPlugin"],function(){Y.go()}),Y.wait(),t(["com/visioglobe/web/plugins/PoiPlugin"],function(){Y.go()}),Y.wait(),t(["com/visioglobe/web/Mapviewer","com/visioglobe/common/utils/Utils"],function(t,e){l.mapviewer=l.mapviewer||{},l.mapviewer.web=l.mapviewer.web||{},l.mapviewer.web.Mapviewer=t,l.mapviewer.common={utils:{getURLParameters:e.getURLParameters}},l.mapviewer.Mapviewer=l.mapviewer.Mapviewer||t,Y.go()}),mt("com/visioglobe/web/main",function(){}),l}(vg);